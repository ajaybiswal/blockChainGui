{"version":3,"sources":["components/filter.js"],"names":["noop","Filter","el","params","elRequired","_bindEventListenerCallbacks","_addEventListeners","_initFilterDisplay","_cacheElements","moduleEls","querySelectorAll","defaultOption","onAfterExpand","_onAfterExpand","bind","onAfterCollapse","_onAfterCollapse","length","i","moduleOptions","key","moduleInsts","_filterToggleContainer","querySelector","_toggleFilterButton","_toggleFilterLabel","_tagsContainer","_tagsCounter","_clearAllButton","_filterContent","_modulesContainer","_viewMoreButton","_viewLessButton","_filterFooter","_buttonGroupEl","_applyFiltersButton","_onResizeBound","_onResize","_toggleViewBound","_toggleView","_toggleFilterClickBound","toggleFilterClick","_onClearAllBound","_onClearAll","_onScrollBound","_onScroll","window","addEventListener","_removeEventListeners","removeEventListener","initializingFilter","extraModulesExpanded","_determineFilterLayout","currentBreakpoint","innerWidth","_curCol","_isDropdownState","_applyExpandCollapseLayout","_showModule","_expandCollapseState","_removeExpandCollapseLayout","clearTimeout","_timeout","removeAttribute","_hideModule","_maxCol","hiddenModules","document","_updateFilterLayout","_isFilterExpanded","_dispatchVisibilityEvent","toggleFilter","option","noStateChange","toggleEl","toggleClass","action","innerHTML","_calculateApplyBtnPosition","setTimeout","e","createEvent","initEvent","dispatchEvent","filterOffsets","getBoundingClientRect","height","windowHeight","innerHeight","scrollTop","pageYOffset","documentElement","body","filterHiddenBefore","top","filterHiddenAfter","percentInView","inViewport","hiddenBefore","hiddenAfter","bottom","clientHeight","buttonGroupHeight","offsetHeight","filterWidth","width","style","left","_applyBtnPositionFixed","_applyBtnPositionRelative","currentButtonPosition","parseInt","getComputedStyle","listBottom","viewportHeight","distanceToMove","isNaN","animationListener","keyframe","setAttribute","getAttribute","requestID","requestAnimationFrame","moveApplyBtn","incrementer","buttonHeight","cancelAnimationFrame","onClearAll","start","end","tags","j","_applyExpand","_disapplyExpand","createTagEl","input","label","clearCallback","tagEl","createElement","className","insertBefore","clearAllTagEls","removeChild","counter","showModuleClearButton","moduleName","enableClearBtn","disableModuleClearButton","disableClearBtn","hideModuleClearButton","hideClearBtn","moduleClearButtonStatus","getClearButtonStatus","prototype","_whitelistedParams","defaults","maxCol","_isModuleExpand"],"mappings":"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","file":"filter.js","sourcesContent":["/**\n * # Filter\n * A container for a set of form fields used to filter a data set or search results\n *\n * @example\n * new Filter(el);\n *\n * @module components/filter.js\n */\nimport BaseComponent from './base';\nimport addClass from '../helpers/dom/add-class';\nimport hasClass from '../helpers/dom/has-class';\nimport toggleClass from '../helpers/dom/toggle-class';\nimport removeClass from '../helpers/dom/remove-class';\nimport FilterModule from './filter-module';\nimport animateHeight from '../helpers/animation/height';\nimport {get as getBreakpoint} from '../helpers/dom/breakpoint';\n\nconst noop = function() {};\n\nclass Filter extends BaseComponent {\n\n  /**\n   * Filter constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  constructor(el, params = {}) {\n    params.elRequired = true;\n\n    if (!super(el, params)) {\n      return;\n    }\n\n    this._bindEventListenerCallbacks();\n    this._addEventListeners();\n    this._initFilterDisplay();\n  }\n\n\n  /**\n   * Store a reference to the needed elements\n   * @param {Element} el\n   */\n  _cacheElements(el) {\n    this.el = el;\n    this.moduleEls = this.el.querySelectorAll('.spark-filter-module');\n\n    // These options are here so that the modules can communicate with the filter to do certain tasks\n    var defaultOption = {\n      onAfterExpand: this._onAfterExpand.bind(this),\n      onAfterCollapse: this._onAfterCollapse.bind(this),\n      //onShowAllComplete: this._onShowAllComplete.bind(this),\n    };\n\n    if (this.moduleEls.length > 0) {\n      for(var i = 0; i < this.moduleEls.length; i ++) {\n        if(typeof this.moduleOptions[i] !== 'undefined') {\n          for(var key in defaultOption) {\n            this.moduleOptions[i][key] = defaultOption[key];\n          }\n          this.moduleInsts[i] = new FilterModule(this.moduleEls[i], this.moduleOptions[i]);\n        }\n        else {\n          this.moduleInsts[i] = new FilterModule(this.moduleEls[i], defaultOption);\n        }\n      }\n    }\n\n    this._filterToggleContainer = this.el.querySelector('.spark-filter__toggle-container');\n    this._toggleFilterButton = this.el.querySelector('.spark-filter__toggle-button');\n    this._toggleFilterLabel = this.el.querySelector('.spark-filter__toggle-button span');\n    this._tagsContainer = this.el.querySelector('.spark-filter__tags-container');\n    this._tagsCounter = this.el.querySelector('.spark-filter__applied-filters-counter');\n    this._clearAllButton = this.el.querySelector('.spark-filter__clear-all');\n    this._filterContent = this.el.querySelector('.spark-filter__content');\n    this._modulesContainer = this.el.querySelector('.spark-filter__modules-container');\n    this._viewMoreButton = this.el.querySelector('.spark-filter__view-more-filters');\n    this._viewLessButton = this.el.querySelector('.spark-filter__view-less-filters');\n    this._filterFooter = this.el.querySelector('.spark-filter__footer');\n    this._buttonGroupEl = this.el.querySelector('.spark-filter__apply-btn-container');\n    this._applyFiltersButton = this.el.querySelector('.spark-filter__btn-apply');\n  }\n\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n  _bindEventListenerCallbacks() {\n    this._onResizeBound = this._onResize.bind(this);\n    this._toggleViewBound = this._toggleView.bind(this);\n    this._toggleFilterClickBound = this.toggleFilterClick.bind(this);\n    this._onClearAllBound = this._onClearAll.bind(this);\n    this._onScrollBound = this._onScroll.bind(this);\n  }\n\n\n  /**\n   * Add event listeners\n   */\n  _addEventListeners() {\n    window.addEventListener('resize', this._onResizeBound);\n    window.addEventListener('scroll', this._onScrollBound);\n    !this._viewMoreButton || this._viewMoreButton.addEventListener('click', this._toggleViewBound);\n    !this._viewLessButton || this._viewLessButton.addEventListener('click', this._toggleViewBound);\n    !this._toggleFilterButton || this._toggleFilterButton.addEventListener('click', this._toggleFilterClickBound);\n    !this._clearAllButton || this._clearAllButton.addEventListener('click', this._onClearAllBound);\n  }\n\n\n  /**\n   * Remove event listeners\n   */\n  _removeEventListeners() {\n    window.removeEventListener('resize', this._onResizeBound);\n    window.removeEventListener('scroll', this._onScrollBound);\n    !this._viewMoreButton || this._viewMoreButton.removeEventListener('click', this._toggleViewBound);\n    !this._viewLessButton || this._viewLessButton.removeEventListener('click', this._toggleViewBound);\n    !this._toggleFilterButton || this._toggleFilterButton.removeEventListener('click', this._toggleFilterClickBound);\n    !this._clearAllButton || this._clearAllButton.removeEventListener('click', this._onClearAllBound);\n  }\n\n\n  /**\n   * Initialize filter\n   */\n   _initFilterDisplay() {\n     this.initializingFilter = true;\n\n     if (this.moduleEls.length > 0) {\n       this.extraModulesExpanded = false;\n     }\n\n     addClass(this.el, 'spark-filter--initializing');\n\n     this._determineFilterLayout();\n   }\n\n\n  /**\n   * Determine which filter layout should be displayed i.e. Expand/Collapse view or Wide view\n   */\n  _determineFilterLayout() {\n    this.currentBreakpoint = getBreakpoint(window.innerWidth);\n\n    switch (this.currentBreakpoint) {\n      case 'xs':\n        this._curCol = 1;\n        break;\n      case 'sm':\n        this._curCol = 2;\n        break;\n      case 'md':\n        this._curCol = 3;\n        break;\n      default:\n        this._curCol = 4;\n        break;\n    }\n\n    if (this._curCol <= 1) {\n      // Display expand-collapse filter\n      if(!this._isDropdownState) {\n        this._applyExpandCollapseLayout();\n        this._showModule();\n      }\n    }\n    else {\n      // Display wide-screen filter\n      if(this._expandCollapseState) {\n        this._removeExpandCollapseLayout();\n      }\n\n      if ( hasClass(this._buttonGroupEl, 'is-fixed') ) {\n        clearTimeout(this._timeout);\n        this._filterFooter.removeAttribute('style');\n        this._buttonGroupEl.removeAttribute('style');\n        removeClass(this._buttonGroupEl, 'is-fixed');\n      }\n\n      this._showModule();\n\n      if (!this.extraModulesExpanded) {\n        this._hideModule(this._curCol, this._maxCol - 1);\n      }\n    }\n\n    // Determine whether to show or hide View More/Less buttons\n    if (!this._isDropdownState) {\n      let hiddenModules = document.querySelectorAll('.spark-filter-module.hide');\n\n      if (!this.extraModulesExpanded && hiddenModules.length === 0) {\n        addClass(this._viewMoreButton, 'hide');\n      }\n      else if (!this.extraModulesExpanded && hiddenModules.length > 0) {\n        removeClass(this._viewMoreButton, 'hide');\n      }\n    }\n  }\n\n\n  /**\n   * Update the filter layout as necessary\n   */\n  _updateFilterLayout() {\n    this._determineFilterLayout();\n  }\n\n\n  /**\n   * Expand or collapse extra filters\n   */\n  _toggleView() {\n    if (this._isFilterExpanded && !this.extraModulesExpanded) {\n      this._showModule();\n      this._dispatchVisibilityEvent();\n    }\n    else if (this._isFilterExpanded && this.extraModulesExpanded) {\n      this._hideModule(this._curCol, this._maxCol - 1);\n    }\n\n    this.extraModulesExpanded = !this.extraModulesExpanded;\n    toggleClass(this._viewMoreButton, 'hide');\n    toggleClass(this._viewLessButton, 'hide');\n  }\n\n\n  /**\n   * Handle click event when filter toggles are clicked\n   */\n  toggleFilterClick(){\n    if (this.initializingFilter) {\n      this.initializingFilter = false;\n    }\n\n    this.toggleFilter();\n  }\n\n\n  /**\n   * To hide or show filter module\n   * @params {String} toggle; collapse; expand;\n   * @params {Boolean} Change the value of `this._isFilterExpanded` based on the boolean value\n   */\n  toggleFilter(option, noStateChange) {\n    if (hasClass(this.el, 'spark-filter--initializing') && !this.initializingFilter) {\n      removeClass(this.el, 'spark-filter--initializing');\n      addClass(this.el, 'spark-filter--initialized');\n    }\n\n    if (option === 'expand') {\n      if (!this.initializingFilter) {\n        removeClass(this._filterContent, 'hide');\n\n        animateHeight({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'expand'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Hide';\n      }\n      else {\n        removeClass(this._filterContent, 'hide');\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = true;\n      }\n    }\n    else if(option === 'collapse'){\n      if (!this.initializingFilter) {\n        addClass(this._filterContent, 'hide');\n\n        animateHeight({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'collapse'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Show';\n      }\n      else {\n        addClass(this._filterContent, 'hide');\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = false;\n      }\n    }\n    else {\n      toggleClass(this._filterContent, 'hide');\n\n      if (hasClass(this.el, 'filter-expanded')) {\n        animateHeight({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'collapse',\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Show';\n      }\n      else {\n        animateHeight({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'expand',\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Hide';\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = !this._isFilterExpanded;\n\n        if ( hasClass(this.el, 'spark-filter--dropdown') && ( !(hasClass(this._filterContent, 'hide')) ) ) {\n          this._calculateApplyBtnPosition();\n        }\n      }\n    }\n\n    if ( !(hasClass(this.el, 'spark-filter--dropdown')) && hasClass(this._buttonGroupEl, 'is-fixed') ){\n      clearTimeout(this._timeout);\n      this._filterFooter.removeAttribute('style');\n      this._buttonGroupEl.removeAttribute('style');\n      removeClass(this._buttonGroupEl, 'is-fixed');\n    }\n\n    this._dispatchVisibilityEvent();\n  }\n\n\n  /**\n   * On-resize handler that updates layout as needed based on screen dimensions\n   */\n  _onResize() {\n    this._updateFilterLayout();\n  }\n\n\n  /**\n   * On-scroll handler that determines Apply button positioning at the xs breakpoint\n   */\n  _onScroll() {\n    if(this._isDropdownState) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  }\n\n\n  /**\n   * Callback triggered after the expansion of a module at the xs breakpoint\n   */\n  _onAfterExpand() {\n    if ( !(hasClass(this._buttonGroupEl, 'is-fixed')) ) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  }\n\n\n  /**\n   * Callback triggered after the collapse of a module at the xs breakpoint\n   */\n  _onAfterCollapse() {\n    this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n  }\n\n\n  /**\n   * Callback triggered after Show all is complete at the xs breakpoint\n   */\n\n  /* TODO: This is not required anymore as show all is not available at the xs breakpoint anymore\n  _onShowAllComplete() {\n    if(this._isDropdownState) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  }\n  */\n\n\n  /**\n   * Dispatch a custom event so content inside the Filter can respond\n   */\n  _dispatchVisibilityEvent() {\n    var e = document.createEvent('Event');\n    e.initEvent('spark.visible-children', true, true);\n    this.el.dispatchEvent(e);\n  }\n\n  /**\n   * Calculate the position of the Apply button at the xs breakpoint\n   */\n  _calculateApplyBtnPosition() {\n\n    let filterOffsets = this.el.getBoundingClientRect();\n\n    if ( filterOffsets.height > 255 ) { // 3 collapsed module heights + filter header height = 255\n      let windowHeight = window.innerHeight;\n      let scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n      let filterHiddenBefore = scrollTop - (filterOffsets.top + document.body.scrollTop);\n      let filterHiddenAfter = (filterOffsets.top + document.body.scrollTop + filterOffsets.height) - (scrollTop + windowHeight);\n\n      if (!((scrollTop > (filterOffsets.top + document.body.scrollTop) + filterOffsets.height) || ((filterOffsets.top + document.body.scrollTop) > scrollTop + window.innerHeight))) {\n        var percentInView = 100;\n        var inViewport;\n        var hiddenBefore = 0;\n        var hiddenAfter = 0;\n\n        if (filterHiddenBefore > 0) {\n            percentInView -= (filterHiddenBefore * 100) / filterOffsets.height;\n            hiddenBefore = filterHiddenBefore;\n        }\n\n        if (filterHiddenAfter > 0) {\n            percentInView -= (filterHiddenAfter * 100) / filterOffsets.height;\n            hiddenAfter = filterHiddenAfter;\n        }\n\n        inViewport = ((filterOffsets.height - (hiddenAfter + hiddenBefore)) / windowHeight)*100;\n      }\n\n      if (( filterOffsets.bottom > (window.innerHeight || document.documentElement.clientHeight) ) && (percentInView > 45 || inViewport > 50)) {\n        let buttonGroupHeight = this._buttonGroupEl.offsetHeight;\n        let filterWidth = filterOffsets.width;\n\n        this._filterFooter.style.height = buttonGroupHeight + 'px';\n        addClass(this._buttonGroupEl, 'is-fixed');\n        this._buttonGroupEl.style.width = (filterWidth - 2) + 'px'; // accounting for border width\n        this._buttonGroupEl.style.left = (filterOffsets.left + 1) + 'px'; // accounting for left border\n\n        this._applyBtnPositionFixed();\n      }\n      else {\n        this._applyBtnPositionRelative();\n      }\n    }\n  }\n\n\n  /**\n   * Set position:relative for the Apply button\n   */\n  _applyBtnPositionRelative() {\n\n    //function attachApplyBtn(){\n    let currentButtonPosition = parseInt( getComputedStyle(this._buttonGroupEl).bottom );\n    let listBottom = this._modulesContainer.getBoundingClientRect().bottom;\n    let viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n    let buttonGroupHeight = this._buttonGroupEl.getBoundingClientRect().height;\n    let distanceToMove = viewportHeight - (listBottom + buttonGroupHeight);\n\n    if ( !(isNaN(currentButtonPosition)) ) {\n      var animationListener = function(){\n        this._filterFooter.removeAttribute('style');\n        this._buttonGroupEl.removeAttribute('style');\n        removeClass(this._buttonGroupEl, 'is-fixed');\n        removeClass(this._buttonGroupEl, 'spark-filter__apply-btn-container--animate');\n        this._buttonGroupEl.removeEventListener('animationend', animationListener);\n      };\n\n      this._buttonGroupEl.addEventListener('animationend', animationListener.bind(this), false);\n\n      let keyframe = '-webkit-transform: translateY(-' + distanceToMove + 'px); transform: translateY(-' + distanceToMove + 'px);';\n\n      this._buttonGroupEl.setAttribute('style', this._buttonGroupEl.getAttribute('style') + ' ' + keyframe);\n      addClass(this._buttonGroupEl, 'spark-filter__apply-btn-container--animate');\n    }\n  }\n\n\n  /**\n   * Set position:fixed for the Apply button\n   */\n  _applyBtnPositionFixed() {\n    var requestID = requestAnimationFrame( moveApplyBtn.bind(this) );\n    var incrementer = .1;\n\n    function moveApplyBtn() {\n      incrementer += .01;\n      var currentButtonPosition = parseInt( getComputedStyle(this._buttonGroupEl).bottom );\n      var buttonHeight = parseInt( getComputedStyle(this._buttonGroupEl).height );\n\n      if (currentButtonPosition < (buttonHeight * -1)) {\n        currentButtonPosition = (buttonHeight * -1);\n      }\n\n      if ( currentButtonPosition > -1 ) {\n        this._buttonGroupEl.style.bottom = '0px';\n        cancelAnimationFrame(requestID);\n      }\n      else if (currentButtonPosition < 0) {\n        currentButtonPosition += (1 / incrementer);\n        this._buttonGroupEl.style.bottom = currentButtonPosition + 'px';\n        requestAnimationFrame( moveApplyBtn.bind(this) );\n      }\n    }\n  }\n\n\n  /**\n   * Callback for Clear all\n   */\n  _onClearAll() {\n    (this.onClearAll || noop)();\n  }\n\n\n  /**\n   * Show all modules\n   */\n  _showModule() {\n    for(var i = 0; i < this.moduleEls.length; i++) {\n      removeClass(this.moduleEls[i], 'hide');\n    }\n  }\n\n\n  /**\n   * Hide certain modules\n   * @param {Number} start index\n   * @param {Number} end index\n   */\n  _hideModule(start, end) {\n    end = end || this.moduleEls.length - 1;\n    for(var i = start; i <= end; i++) {\n      addClass(this.moduleEls[i], 'hide');\n    }\n  }\n\n\n  /**\n   * Apply Expand/Collapse layout for the filter\n   * Used when the filter gets to the xs breakpoint\n   */\n  _applyExpandCollapseLayout() {\n    addClass(this.el,'spark-filter--dropdown');\n    this._expandCollapseState = true;\n\n    let tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    if (tags.length > 0) {\n      for(var i = 0; i < tags.length; i++) {\n        addClass(tags[i], 'hide');\n      }\n      removeClass(this._tagsCounter, 'hide');\n    }\n\n    addClass(this._viewMoreButton, 'hide');\n    addClass(this._viewLessButton, 'hide');\n\n    if (this._applyFiltersButton) {\n      removeClass(this._applyFiltersButton, 'spark-btn--sm');\n      addClass(this._applyFiltersButton, 'spark-btn--block');\n    }\n\n    for(var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._applyExpand();\n    }\n\n    this._isDropdownState = true;\n    this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n  }\n\n\n  /**\n   * Remove Expand/Collapse layout and apply the horizontal layout for the filter\n   * Used when the screen size is larger than the xs breakpoint\n   */\n  _removeExpandCollapseLayout() {\n\n    removeClass(this.el,'spark-filter--dropdown');\n    this._expandCollapseState = false;\n    this._filterFooter.removeAttribute('style');\n    this._buttonGroupEl.removeAttribute('style');\n    removeClass(this._buttonGroupEl, 'is-fixed');\n\n    let tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    if (tags.length > 0) {\n      for(var i = 0; i < tags.length; i++) {\n        removeClass(tags[i], 'hide');\n      }\n      addClass(this._tagsCounter, 'hide');\n    }\n\n    if (this.extraModulesExpanded) {\n      removeClass(this._viewLessButton, 'hide');\n    }\n    else {\n      removeClass(this._viewMoreButton, 'hide');\n    }\n\n    if(this._applyFiltersButton) {\n      addClass(this._applyFiltersButton, 'spark-btn--sm');\n      removeClass(this._applyFiltersButton, 'spark-btn--block');\n    }\n\n    for(var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._disapplyExpand();\n    }\n    this._isDropdownState = false;\n  }\n\n\n  /**\n   * Generate a tag element in filter, which will be directly posted inside `.spark-filter__tags-container`\n   * @param {string} input name - Name of the input to allow any callbacks to target input specifically\n   * @param {string} tag label - The label to be displayed in the tag. This could be the input's label or another user defined label\n   * @param {function} callback function for `X` button\n   */\n  createTagEl(input, label, clearCallback) {\n    var tagEl = document.createElement('div');\n    tagEl.className = hasClass(this.el,'spark-filter--dropdown') ? 'spark-filter__tag hide' : 'spark-filter__tag';\n    tagEl.setAttribute('data-filter-name', input);\n    tagEl.innerHTML = '<span class=\"spark-filter__tag__label\">'+ label +\n                      '</span><i class=\"spark-icon spark-filter__tag__close\"></i>';\n\n    this._tagsContainer.insertBefore(tagEl, this._clearAllButton);\n\n    // create event listener after adding element to DOM\n    tagEl.querySelector('.spark-filter__tag__close').addEventListener('click', (clearCallback || noop));\n\n    removeClass(this._clearAllButton, 'hide');\n\n    // Show tag count if on small screen and this is initial application of filters\n    if ( hasClass(this.el,'spark-filter--dropdown') ) removeClass(this._tagsCounter, 'hide');\n  }\n\n\n  /**\n   * Remove all tags\n   */\n  clearAllTagEls() {\n    var tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    for(var i=0; i < tags.length; i ++) {\n      this._tagsContainer.removeChild(tags[i]);\n    }\n\n    // Reset counter\n    var counter = this._tagsContainer.querySelector('span');\n    counter.innerHTML = '0';\n\n    addClass(this._clearAllButton, 'hide');\n    addClass(this._tagsCounter, 'hide');\n  }\n\n\n  /**\n   * Show Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n  showModuleClearButton(moduleName) {\n    for(var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        this.moduleInsts[i].enableClearBtn();\n      }\n    }\n  }\n\n\n  /**\n   * Disable Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n  disableModuleClearButton(moduleName) {\n    for(var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        this.moduleInsts[i].disableClearBtn();\n      }\n    }\n  }\n\n\n  /**\n   * Hide Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n   hideModuleClearButton(moduleName) {\n     for(var i = 0; i < this.moduleInsts.length; i++) {\n       if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n         this.moduleInsts[i].hideClearBtn();\n       }\n     }\n   }\n\n\n  /**\n   * Get Module Clear button status\n   *  @param {Element} moduleName An identifier for the module being targeted\n   */\n  moduleClearButtonStatus(moduleName) {\n    for(var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        return this.moduleInsts[i].getClearButtonStatus();\n      }\n    }\n  }\n}\n\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\nFilter.prototype._whitelistedParams = ['onClearAll', 'moduleOptions'];\n\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nFilter.prototype.defaults = {\n  el: null,\n  moduleEls: [],\n  _filterToggleContainer: null,\n  _toggleFilterButton: null,\n  _toggleFilterLabel: null,\n  _tagsContainer: null,\n  _tagsCounter: null,\n  _clearAllButton: null,\n  _filterContent: null,\n  _modulesContainer: null,\n  _viewMoreButton: null,\n  _viewLessButton: null,\n  _filterFooter: null,\n  _buttonGroupEl: null,\n  _applyFiltersButton: null,\n  moduleInsts: [],\n  moduleOptions: [],\n  maxCol: 4,\n  onClearAll: noop,\n  extraModulesExpanded: false,\n  _isFilterExpanded: false,\n  _isDropdownState: false,\n  _isModuleExpand: true,\n  _curCol: 4,\n  _onResizeBound: null,\n  _toggleViewBound: null,\n  _toggleFilterClickBound: null,\n  _onClearAllBound: null,\n  _onScrollBound: null,\n};\n\nexport default Filter;\n"]}