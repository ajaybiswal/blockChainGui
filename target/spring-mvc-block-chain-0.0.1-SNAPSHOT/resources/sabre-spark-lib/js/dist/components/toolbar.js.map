{"version":3,"sources":["components/toolbar.js"],"names":["Toolbar","el","_init","change","_closeAll","v","document","createDocumentFragment","i","items","length","appendChild","visibleContainer","_initItems","_calculateStyles","update","remove","leaveElement","_removeListeners","sparktoolbarcon","showMoreButton","sparktoolbarshowmore","parentNode","removeChild","undefined","toolbarItem","parent","order","a","priority","attributes","value","hasContent","querySelector","helper","label","closeOnClick","width","offsetWidth","height","offsetHeight","dropdown","sparktoolbardropdown","toggleDropdown","open","o","window","setTimeout","positionDropdown","e","createEvent","initEvent","dispatchEvent","_toggleShowMore","handleClick","preventDefault","target","b","parentElement","style","left","right","pos","getBoundingClientRect","pageXOffset","documentElement","clientWidth","sparktoolbar","_closeItems","_getOpenItems","push","hiddenContainer","isOpen","isFocus","_setupListeners","tabindex","querySelectorAll","_handleWindowClick","_handleWindowClickH","bind","addEventListener","_handleResize","_handleResizeH","_handleKeyDown","_handleKeyDownH","_handleFocus","_handleFocusH","_handleBlur","_handleBlurH","_handleVisibleChildren","_handleVisibleChildrenH","removeEventListener","contains","_focusLast","focus","_lastFocus","keyCode","previousSibling","nextSibling","click","stopPropagation","c","indexOf","splice","_positionShowMore","showMore","visible","hidden","sort","_prioritySort","visibleWidth","_orderSort","h","l","r"],"mappings":"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","file":"toolbar.js","sourcesContent":["/**\n * # Toolbar\n * Setup a responsive toolbar\n *\n * @example\n * new Toolbar(el);\n *\n * @module components/toolbar.js\n */\nimport debounce from '../helpers/util/debounce';\nimport addClass from '../helpers/dom/add-class';\nimport hasClass from '../helpers/dom/has-class';\nimport removeClass from '../helpers/dom/remove-class';\nimport {boolean as getBooleanAttribute} from '../helpers/dom/parse-attribute';\n\nclass Toolbar {\n\n  /**\n   * Toolbar constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  constructor(el) {\n    if (!el) return;\n    this._init(el);\n  }\n\n\n  /**\n   * This function will update cached sizing when an element in the toolbar is changed\n   * or, when toolbar items are added or removed\n   */\n  change() {\n    this._closeAll();\n    removeClass(this.el, ['ready', 'show-more', 'measured']);\n    var v = document.createDocumentFragment();\n    for (var i = 0; i < this.items.length; i++) {\n      v.appendChild(this.items[i].el);\n    }\n    this.visibleContainer.appendChild(v);\n    this._initItems();\n    addClass(this.el, 'measured');\n    this._calculateStyles();\n    addClass(this.el, 'ready');\n    return this;\n  }\n\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   */\n  update(el) {\n\n    if (el) {\n      this.remove(true);\n      this._init(el);\n    }\n    else {\n      this.change();\n    }\n\n    return this;\n  }\n\n\n\n  /**\n   * Remove the element from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n  remove(leaveElement) {\n    this._removeListeners();\n    delete this.el.sparktoolbarcon;\n    delete this.showMoreButton.sparktoolbarshowmore;\n    for(var i = 0; i < this.items.length; i++) {\n      this.items[i].remove();\n    }\n    if (!leaveElement && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n      this.el = undefined;\n    }\n    return this;\n  }\n\n\n  /**\n   * Setup a toolbarItem Instance to track the state of individual toolbar items\n   * @param {Element} parent Reference to parent toolbar\n   * @param {Element} el Node to initalize as toolbarItem\n   * @param {Number} order The original index of the item in list of toolbarItems (used for maintaining order when sorting)\n   */\n  toolbarItem(parent, el, order) {\n    //Setup and cache the values for this item\n    var a = {};\n    a.parent = parent;\n    a.el = el;\n    //cache the priority value present on the toolbar element if it is present, else default to 0\n    a.priority = a.el.attributes['data-priority'] ? a.el.attributes['data-priority'].value : 0;\n    a.order = a.el.attributes['data-order'] ? a.el.attributes['data-order'].value : order;\n    a.hasContent = a.el.querySelector('.spark-toolbar__item--content') ? true : false;\n    a.helper = a.el.querySelector('.spark-toolbar__item-helper');\n    a.label = a.el.attributes.label ? a.el.attributes.label.value : false;\n    a.closeOnClick = hasClass(a.el, 'spark-toolbar__item--close-more-on-click');\n    a.width = a.el.offsetWidth;\n    a.height = a.el.offsetHeight;\n    a.dropdown = el.querySelector('.spark-toolbar__item--content');\n    if (a.dropdown) {\n      a.dropdown.sparktoolbardropdown = true;\n    }\n    /**\n     * Call method to toggle the open state, optional param sets open state to value\n     * Can get current state by referencing a.toggleDropdown.open\n     * @param {Boolean} open Set state to this regardless of current state\n     */\n    a.toggleDropdown = function(open) {\n      var o = typeof open !== 'undefined' ? !open : a.toggleDropdown.open;\n      if (o) {\n        a.toggleDropdown.open = false;\n        removeClass(a.el, 'animate');\n        window.setTimeout(function() {\n          removeClass(a.el, 'open');\n        }, 100);\n      }\n      else {\n        if (a.hasContent) {\n          a.toggleDropdown.open = true;\n          addClass(a.el, 'open');\n          a.positionDropdown();\n          var e = document.createEvent('Event');\n          e.initEvent('spark.visible-children', true, true);\n          a.dropdown.dispatchEvent(e);\n          window.setTimeout(function() {\n            addClass(a.el, 'animate');\n          }, 0);\n        }\n        else {\n          a.parent._toggleShowMore(false);\n        }\n      }\n    };\n    /**\n     * Click handler for local element - determines to close element\n     * conditionally based on presence of spark-toolbar__item--close-on-click\n     * closes parent's more dropdown conditionally as well\n     * @param {Boolean} open Set state to this regardless of current state\n     */\n    a.handleClick = function(e) {\n\n      if (getBooleanAttribute(a.el, 'disabled')) {\n        e.preventDefault();\n        return;\n      }\n\n      if (!a.toggleDropdown.open) {\n        a.toggleDropdown(true);\n      }\n      else {\n        if (e.target === a.el || e.target === a.helper) {\n          a.toggleDropdown();\n        }\n        else {\n          var b = e.target;\n          while (b !== a.el) {\n            if (hasClass(b, 'spark-toolbar__item--close-on-click')) {\n              a.toggleDropdown(false);\n              //close the mode section, as event originated inside a close-on-click area\n              a.parent._toggleShowMore(false);\n              break;\n            }\n            b = b.parentElement;\n          }\n        }\n      }\n      //e.preventDefault();\n    };\n    //perform bounds checking on dropdown open to position dropdown inside visual area\n    //this is called each time a dropdown is opened, in case the state of the component has\n    //changed since initialization\n    a.positionDropdown = function() {\n      if (a.dropdown) {\n        a.dropdown.style.left = '';\n        a.dropdown.style.right = '';\n        var pos = a.dropdown.getBoundingClientRect();\n        var left = window.pageXOffset;\n        var right = window.pageXOffset + document.documentElement.clientWidth;\n        if (pos.right > right) {\n          a.dropdown.style.left = 'inherit';\n          a.dropdown.style.right = 0;\n        }\n        if (pos.left < left) {\n          a.dropdown.style.left = 0;\n          a.dropdown.style.right = 'inherit';\n        }\n      }\n    };\n    a.remove = function() {\n      if (a.el) {\n        delete a.el.sparktoolbar;\n      }\n      if (a.dropdown) {\n        delete a.dropdown.sparktoolbardropdown;\n      }\n    };\n    a.el.sparktoolbar = a;\n    return a;\n  }\n\n\n  /**\n   * Close any open items, and more dropdown\n   */\n  _closeAll() {\n    this._closeItems();\n    this._toggleShowMore(false);\n  }\n\n\n  /**\n   * Returns array of open toolbarItems\n   */\n  _getOpenItems() {\n    var a = [];\n    for (var i = 0; i < this.items.length; i++) {\n      if (this.items[i].toggleDropdown.open) {\n        a.push(this.items[i]);\n      }\n    }\n    return a;\n  }\n\n\n  /**\n   * Close any open items\n   * @param {Array} a Optional array of toolbarItems to close, defaults to all open items\n   */\n  _closeItems(a) {\n    a = typeof a === 'undefined' ? this._getOpenItems() : a;\n    for (var i = 0; i < a.length; i++) {\n      a[i].toggleDropdown(false);\n    }\n  }\n\n\n  /**\n   * Setup the toolbar element, cache properties, and initalize styling\n   * when complete, show toolbar\n   * @param {Element} el The node to initalize on\n   */\n  _init(el) {\n    this.el = el;\n    //store a reference to this on the node to expedite event handling\n    this.el.sparktoolbarcon = this;\n    this.visibleContainer = this.el.querySelector('.spark-toolbar__container--visible');\n    this.hiddenContainer = this.el.querySelector('.spark-toolbar__container--hidden');\n    this.showMoreButton = this.el.querySelector('.spark-toolbar__show-more');\n    this.showMoreButton.sparktoolbarshowmore = true;\n    this.isOpen = false;\n    this.isFocus = false;\n    this._setupListeners();\n    this.el.style.width = '100%';\n    this._initItems();\n    addClass(this.el, 'measured');\n    this._calculateStyles();\n    this.tabindex = this.el.attributes.tabindex ? this.el.attributes.tabindex.value : 0;\n    addClass(this.el, 'ready');\n  }\n\n\n  _initItems() {\n    var items = this.el.querySelectorAll('.spark-toolbar__item');\n    this.items = [];\n    for (var i = 0; i < items.length; i++) {\n      this.items[i] = new this.toolbarItem(this, items[i], i);\n    }\n  }\n\n\n  /**\n   * Setup event listeners for clicks and resize events\n   */\n  _setupListeners() {\n    this._handleWindowClick = this._handleWindowClickH.bind(this);\n    document.addEventListener('click', this._handleWindowClick);\n    this._handleResize = debounce(this._handleResizeH.bind(this), 100);\n    window.addEventListener('resize', this._handleResize);\n    this._handleKeyDown = this._handleKeyDownH.bind(this);\n    this.el.addEventListener('keydown', this._handleKeyDown);\n    this._handleFocus = this._handleFocusH.bind(this);\n    document.addEventListener('focus', this._handleFocus, true);\n    this._handleBlur = this._handleBlurH.bind(this);\n    document.addEventListener('blur', this._handleBlur, true);\n    this._handleVisibleChildren = this._handleVisibleChildrenH.bind(this);\n    document.addEventListener('spark.visible-children', this._handleVisibleChildren, true);\n  }\n\n\n  /**\n   * Remove event listeners for clicks and resize events\n   */\n  _removeListeners() {\n    document.removeEventListener('click', this._handleWindowClick);\n    window.removeEventListener('resize', this._handleResize);\n    this.el.removeEventListener('keydown', this._handleKeyDown);\n    document.removeEventListener('blur', this._handleBlur, true);\n    document.removeEventListener('focus', this._handleFocus, true);\n    document.removeEventListener('spark.visible-children', this._handleVisibleChildren, true);\n  }\n\n\n  /**\n   * reset our tab index when user focuses outside of element (gets immediately reset to -1 if focus is placed back inside element)\n   * @param {Event} e The FocusEvent\n   */\n  _handleBlurH(e) {\n    if (this.el.contains(e.target)) {\n      this.el.attributes.tabindex.value = this.tabindex;\n    }\n  }\n\n\n  /**\n   * focus handler, works in conjunction with blur handler to set correct tabindex value\n   * @param {Event} e The FocusEvent\n   */\n  _handleFocusH(e) {\n    //if we're not being focused, reset our tabindex so we are accessible again, and close anything open\n    if (!this.el.contains(e.target)) {\n      this._closeAll();\n      this.el.attributes.tabindex.value = this.tabindex;\n    }\n    else {\n      //set our tabindex to -1 so the user can shift-tab out of our element\n      this.el.attributes.tabindex.value = -1;\n      if (e.target.sparktoolbarcon) {\n        this._focusLast();\n        return;\n      }\n      //handle focusing an item\n      if (e.target.sparktoolbar) {\n        e.target.sparktoolbar.el.focus();\n        return;\n      }\n      var a = e.target;\n      //harder case - look up the tree to find if we're focusing inside content\n      while (!a.sparktoolbarcon) {\n        if (a.sparktoolbar) {\n          break;\n        }\n        //if we are - give our parent element a tabindex so the user can refocus the menu using shift-tab\n        if (a.sparktoolbardropdown) {\n          this.el.attributes.tabindex.value = this.tabindex;\n          return;\n        }\n        a = a.parentElement;\n      }\n    }\n  }\n\n\n  /**\n   * reset our focus to the last menu item that was focused\n   */\n  _focusLast() {\n    if (!this._lastFocus) {\n      var a = this.visibleContainer.querySelector('.spark-toolbar__item') || this.hiddenContainer.querySelector('.spark-toolbar__item');\n      this._lastFocus = a.sparktoolbar;\n    }\n    if (this.hiddenContainer.contains(this._lastFocus.el)) {\n      this._toggleShowMore(true);\n    }\n    this._lastFocus.el.focus();\n  }\n\n\n  /**\n   * keydown handler, used for keyboard navigation\n   * @param {Event} e The KeyDown Event\n   */\n  _handleKeyDownH(e) {\n    var a = e.target;\n    //find the nearest toolbaritem\n    while (!a.sparktoolbarcon) {\n      if (a.sparktoolbar) {\n        break;\n      }\n      if (a.sparktoolbardropdown) {\n        return;\n      }\n      a = a.parentElement;\n    }\n    if (a.sparktoolbar) {\n      //handle keys\n      switch (e.keyCode) {\n        //left arrow\n        //up arrow\n        case 37:\n        case 38:\n          if (a.previousSibling && a.previousSibling.sparktoolbar) {\n            this._lastFocus = a.previousSibling.sparktoolbar;\n            a.previousSibling.focus();\n          }\n          else {\n            if (this.visibleContainer.querySelector('.spark-toolbar__item') !== a.sparktoolbar.el) {\n              a = this.visibleContainer.querySelector('.spark-toolbar__item:last-of-type');\n              if (a) {\n                this._toggleShowMore(false);\n                this._lastFocus = a.sparktoolbar;\n                a.focus();\n              }\n            }\n          }\n          this._closeItems();\n          e.preventDefault();\n          break;\n        //right arrow\n        //down arrow\n        case 39:\n        case 40:\n          if (a.nextSibling && a.nextSibling.sparktoolbar) {\n            this._lastFocus = a.nextSibling.sparktoolbar;\n            a.nextSibling.focus();\n          }\n          else {\n            if (this.hiddenContainer.querySelector('.spark-toolbar__item:last-of-type') !== a.sparktoolbar.el) {\n              a = this.hiddenContainer.querySelector('.spark-toolbar__item');\n              if (a) {\n                this._toggleShowMore(true);\n                this._lastFocus = a.sparktoolbar;\n                a.focus();\n              }\n            }\n          }\n          this._closeItems();\n          e.preventDefault();\n          break;\n        //spacebar\n        case 32:\n          e.preventDefault();\n          //we only want to toggle the toolbar if we are actually focused directly on it;\n          if (e.target.sparktoolbar) {\n            e.target.sparktoolbar.el.click();\n          }\n          break;\n        //enter\n        case 13:\n          //we only want to toggle the toolbar if we are actually focused directly on it;\n          if (e.target.sparktoolbar) {\n            e.target.sparktoolbar.el.click();\n          }\n          break;\n      }\n    }\n  }\n\n\n  /**\n   * Hanldes the spark.visible-children event to resize the component when it is made visible.\n   * @param {Event} e The spark.visible-children event\n   */\n  _handleVisibleChildrenH(e) {\n    if(e.target.contains(this.el)) {\n      window.setTimeout(function() {\n        this.change();\n      }.bind(this),0);\n    }\n  }\n\n\n  /**\n   * Event handler for click events, handles window clicks, control element clicks,\n   * and forwards events to toolbarItem click handlers as needed\n   * @param {Event} e The click event\n   */\n  _handleWindowClickH(e) {\n\n    if (getBooleanAttribute(e.target, 'disabled')) {\n      e.preventDefault();\n      return;\n    }\n\n    //Check to see if the click was outside of the toolbar\n    if (!this.el.contains(e.target)) {\n      this._closeItems();\n      this._toggleShowMore(false);\n    }\n    else {\n      var a = e.target;\n      //traverse the dom node tree until we find an element that handles the event,\n      //or we reach the toolbar root node\n      if(a === this.visibleContainer || a === this.el) {\n        e.stopPropagation();\n        e.preventDefault();\n        return;\n      }\n      while (a !== this.el) {\n        if (a.sparktoolbar) {\n          var c = this._getOpenItems();\n          if (c.indexOf(a.sparktoolbar) >= 0) {\n            c.splice(c.indexOf(a.sparktoolbar), 1);\n          }\n          this._closeItems(c);\n          if (!this.hiddenContainer.contains(e.target)) {\n            this._toggleShowMore(false);\n          }\n          return a.sparktoolbar.handleClick(e);\n        }\n        if (a.sparktoolbarshowmore) {\n          this._closeItems();\n          this._toggleShowMore();\n          return;\n        }\n        a = a.parentElement;\n      }\n      this._closeAll();\n    }\n  }\n\n\n  /**\n   * Toggle the state of the show more dropdown, optional parameter overrides toggle and\n   * sets state to passed value\n   * @param {Boolean} open The new state of the show more dropdown\n   */\n  _toggleShowMore(open) {\n    var o = typeof open !== 'undefined' ? !open : this.isOpen;\n    if (o) {\n      removeClass(this.el, 'animate');\n      window.setTimeout(function() {\n        removeClass(this.el, 'open');\n        this.isOpen = false;\n      }.bind(this), 100);\n    }\n    else {\n      this.isOpen = true;\n      addClass(this.el, 'open');\n      this._positionShowMore();\n      window.setTimeout(function() {\n        addClass(this.el, 'animate');\n      }.bind(this), 0);\n    }\n  }\n\n\n  /**\n  * Do bounds checking on show-more dropdown when it is opened, and position it accordingly\n  */\n  _positionShowMore() {\n    this.hiddenContainer.style.right = '0px';\n    var pos = this.hiddenContainer.getBoundingClientRect();\n    var left = window.pageXOffset;\n    var right = window.pageXOffset + document.documentElement.clientWidth;\n    if (pos.right > right) {\n      this.hiddenContainer.style.right = 'calc(' + (pos.right - right) + 'px + 1rem)';\n    }\n    if (pos.left < left) {\n      this.hiddenContainer.style.right = 'calc(' + (pos.left - left) + 'px - 1rem)';\n    }\n  }\n\n\n  /**\n   * Resize event helper, closes items then triggers recalculation of styles\n   */\n  _handleResizeH() {\n    this._closeAll();\n    this._calculateStyles();\n  }\n\n\n  /**\n   * Reevaluates the available area of the toolbar and places toolbarItems into\n   * the hidden container, as necessary. Should not call with any specified value\n   * for showMore (used internally)\n   * @param {Boolean} showMore Used to conditionally evaluate styling when showMore area is used\n   */\n  _calculateStyles(showMore) {\n    this.el.style.width = '100%';\n    showMore = typeof showMore !== 'undefined' ? showMore : false;\n    if (!showMore) {\n      removeClass(this.el, 'show-more');\n    }\n    var visible = [];\n    var hidden = [];\n    var i;\n    //sort items by their priority to ensure higher-priority items are always placed\n    //into the visible area first\n    this.items.sort(this._prioritySort);\n    //get container width and start placing items into their containers\n    var visibleWidth = this.visibleContainer.clientWidth;\n    for (i = 0; i < this.items.length; i++) {\n      if (visibleWidth - this.items[i].width >= 0) {\n        visible.push(this.items[i]);\n        visibleWidth -= this.items[i].width;\n      }\n      else {\n        if (!showMore) {\n          addClass(this.el, 'show-more');\n          return this._calculateStyles(true);\n        }\n        hidden.push(this.items[i]);\n      }\n    }\n    //sort items back into their original order before inserting them into the document\n    visible.sort(this._orderSort);\n    hidden.sort(this._orderSort);\n    var v = document.createDocumentFragment();\n    var h = document.createDocumentFragment();\n    for (i = 0; i < visible.length; i++) {\n      v.appendChild(visible[i].el);\n    }\n    for (i = 0; i < hidden.length; i++) {\n      h.appendChild(hidden[i].el);\n    }\n    this.visibleContainer.appendChild(v);\n    this.hiddenContainer.appendChild(h);\n    this.el.style.width = '';\n  }\n\n\n  /**\n   * Sorts toolbar items in descending order based on their priority value\n   */\n  _prioritySort(l, r) {\n    return r.priority - l.priority;\n  }\n\n\n  /**\n   * Sorts toolbar items in ascending order based on their order value\n   */\n  _orderSort(l, r) {\n    return l.order - r.order;\n  }\n}\n\nexport default Toolbar;\n"]}