{"version":3,"sources":["filter-module.js"],"names":["noop","FilterModule","el","params","elRequired","_bindEventListenerCallbacks","_addEventListeners","_cacheElements","_showAllEl","querySelector","_clearEl","_hiddenEls","Array","prototype","slice","call","querySelectorAll","_headerEl","_bodyEl","_modalEl","onShowAll","modalInst","_onShowAllBound","_onShowAll","bind","_onClearBound","_onClear","addEventListener","_removeEventListeners","removeEventListener","_isExpand","toggleHiddenContent","onClear","enableClarBtn","disableClearBtn","i","length","_applyExpand","modalClsNames","push","curEl","className","firstElementChild","remove","setAttribute","_expandInst","onAfterExpand","onAfterCollapse","_disapplyExpand","pop","removeAttribute","_whitelistedParams","defaults","dataSet"],"mappings":"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","file":"filter-module.js","sourcesContent":["/**\n * # Filter Module\n * Major part of filter\n *\n * @example\n * new FilterModule(el, params);\n *\n * @module components/filter-module.js\n */\nimport BaseComponent from './base';\nimport toggleClass from '../helpers/dom/toggle-class';\nimport removeClass from '../helpers/dom/remove-class';\nimport addClass from '../helpers/dom/add-class';\nimport Expand from './expand';\nimport Modal from './modal';\n\nconst noop = function() {};\n\nclass FilterModule extends BaseComponent {\n\n  /**\n   * Filter Module constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  constructor(el, params = {}) {\n\n    params.elRequired = true;\n\n    if (!super(el, params)) {\n      return;\n    }\n\n    this._bindEventListenerCallbacks();\n    this._addEventListeners();\n  }\n\n  /**\n   * Store a reference to the whole filter\n   * @param {Element} el\n   */\n  _cacheElements(el) {\n    this.el = el;\n    this._showAllEl = this.el.querySelector('.spark-filter-module__show-all');\n    this._clearEl = this.el.querySelector('.spark-filter-module__clear');\n    this._hiddenEls = Array.prototype.slice.call(this.el.querySelectorAll('.spark-filter-module--hide'));\n    this._headerEl = this.el.querySelector('.spark-filter-module__header');\n    this._bodyEl = this.el.querySelector('.spark-filter-module__body');\n    this._modalEl = this.el.querySelector('.spark-modal');\n    if(this.onShowAll === 'modal') {\n      this.modalInst = new Modal(this._showAllEl);\n    }\n  }\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n  _bindEventListenerCallbacks() {\n    this._onShowAllBound = this._onShowAll.bind(this);\n    this._onClearBound = this._onClear.bind(this);\n  }\n\n\n  /**\n   * Add event listeners for touchstart and mouse click.\n   */\n  _addEventListeners() {\n    !this._showAllEl || this._showAllEl.addEventListener('click', this._onShowAllBound);\n    !this._clearEl || this._clearEl.addEventListener('click', this._onClearBound);\n  }\n\n\n  /**\n   * Remove event listeners for touchstart and mouse click.\n   */\n  _removeEventListeners() {\n    if(this._showAllEl) {\n      this._showAllEl.removeEventListener('click', this._onShowAllBound);\n      this._clearEl.removeEventListener('click', this._onClearBound);\n    }\n  }\n\n  /*\n   * Callback after clicking `show all` link\n   */\n  _onShowAll() {\n    if(typeof this.onShowAll === 'function') {\n      (this.onShowAll || noop)(this);\n    }\n    else {\n      if(this.onShowAll === 'toggle' || (this.onShowAll === 'modal' && this._isExpand)) {\n        this.toggleHiddenContent();\n      }\n    }\n  }\n\n  /*\n   * callback after clicking `clear` button\n   */\n  _onClear() {\n    (this.onClear || noop)(this);\n  }\n\n  /*\n   * enable clear button\n   */\n  enableClarBtn() {\n    removeClass(this._clearEl, 'spark-filter-module__clear--disabled');\n  }\n\n  /*\n   * disable clear button\n   */\n  disableClearBtn() {\n    addClass(this._clearEl, 'spark-filter-module__clear--disabled');\n  }\n\n  /*\n   * Hide or show hidden element, basic for `show-all` link\n   *\n   */\n  toggleHiddenContent() {\n    for(var i = 0; i < this._hiddenEls.length; i ++) {\n      toggleClass(this._hiddenEls[i], 'show');\n    }\n  }\n\n  /*\n   * Change filter-module to expand/collapse variation\n   * Happens when filter change into modal variation\n   */\n  _applyExpand() {\n    if(this._modalEl) {\n      var modalClsNames = [\n        'spark-filter-module--hide',\n        '',\n        '',\n        '',\n      ];\n      this._hiddenEls.push(this._modalEl);\n      var curEl = this._modalEl;\n      for(var i = 0; i < modalClsNames.length; i++) {\n        curEl.className = modalClsNames[i];\n        curEl = curEl.firstElementChild;\n      }\n      this.modalInst.remove(true);\n    }\n    addClass(this.el, 'spark-panel', 'spark-panel--expand');\n    addClass(this._headerEl, 'spark-panel__header');\n    this._headerEl.setAttribute('role','heading');\n    addClass(this._bodyEl, 'spark-panel__content');\n    this._expandInst = new Expand(this.el, {\n      onAfterExpand: this.onAfterExpand,\n      onAfterCollapse: this.onAfterCollapse,\n    });\n    this._isExpand = true;\n  }\n\n  /*\n   * Change filter-module from expand/collapse to normal variation\n   *\n   */\n  _disapplyExpand() {\n    if(this._modalEl) {\n      var modalClsNames = [\n        'spark-modal',\n        'spark-modal__scroll',\n        'spark-modal__content col-xs-12 col-sm-10',\n        'spark-modal__body',\n      ];\n      this._hiddenEls.pop();\n      var curEl = this._modalEl;\n      for(var i = 0; i < modalClsNames.length; i++) {\n        curEl.className = modalClsNames[i];\n        curEl = curEl.firstElementChild;\n      }\n      this.modalInst = new Modal(this._showAllEl);\n    }\n    removeClass(this.el, 'spark-panel', 'spark-panel--expand');\n    removeClass(this._headerEl, 'spark-panel__header');\n    this._headerEl.removeAttribute('role');\n    removeClass(this._bodyEl, 'spark-panel__content');\n    this._expandInst.remove(true);\n    this._isExpand = false;\n  }\n}\n\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\nFilterModule.prototype._whitelistedParams = ['onShowAll', 'onClear', 'onAfterExpand', 'onAfterCollapse'];\n\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nFilterModule.prototype.defaults = {\n  el: null,\n  onShowAll: noop,\n  onClear: noop,\n  onAfterExpand: noop,\n  onAfterCollapse: noop,\n  modalInst: null,\n  _onShowAllBound: null,\n  _onClearBound: null,\n  _showAllEl: null,\n  _clearEl: null,\n  _hiddenEls: [],\n  _headerEl: null,\n  _bodyEl: null,\n  _modalEl: null,\n  _expandInst: null,\n  _isExpand: false,\n  dataSet: {},\n};\n\nexport default FilterModule;\n"]}