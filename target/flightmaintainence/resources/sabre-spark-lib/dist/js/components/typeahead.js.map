{"version":3,"sources":["js/dist/components/node_modules/browser-pack/_prelude.js","js/dist/components/js/dist/components/base.js","js/dist/components/js/dist/components/typeahead.js","js/dist/components/js/dist/helpers/dom/parse-attribute.js","js/dist/components/js/dist/helpers/dom/trigger-event.js","js/dist/components/js/dist/helpers/util/each.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1jCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"typeahead.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n                                                                                                                                                           * # Base Component\n                                                                                                                                                           * The base class for Spark JS components. This class should never be\n                                                                                                                                                           * instantiated directly.\n                                                                                                                                                           *\n                                                                                                                                                           * @param {Element} el\n                                                                                                                                                           * @param {Object} params\n                                                                                                                                                           *\n                                                                                                                                                           * @module components/base.js\n                                                                                                                                                           */\n\nvar noop = function noop() {};\n\nvar Base = function () {\n\n  /**\n   * Set parameters and cache elements.\n   */\n  function Base(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Base);\n\n    if (params.elRequired && !el) {\n      return;\n    }\n\n    this.setParams(this.defaults || {}, true);\n    this.setParams(params);\n    (this._cacheElements || noop).call(this, el, params);\n    (this._parseParams || noop).call(this);\n  }\n\n  /**\n   * Remove the component from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Base.prototype.remove = function remove(leaveElement) {\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    if (!leaveElement && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n\n    this.unsetParams(this.defaults);\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n\n\n  Base.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    (this._cacheElements || noop).call(this, el || this.el, params);\n    (this._parseParams || noop).call(this);\n\n    if (this._addEventListeners) {\n      this._addEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Set a hash of parameters if they're whitelisted or we're told to force the set.\n   * This is used to set initial values as well as set passed parameters.\n   * @param {Object} params\n   * @param {Boolean} force Force setting even if the param is not whitelisted.\n   */\n\n\n  Base.prototype.setParams = function setParams(params, force) {\n    var _this = this;\n\n    (0, _each2.default)(params, function (k, v) {\n      if (_this._whitelistedParams.indexOf(k) !== -1 || force) {\n        _this[k] = v;\n      }\n    });\n\n    return this;\n  };\n\n  /**\n   * Unset all parameters.\n   * @param {Array|Object} keys\n   * @param {Object} scope The object to unset the params from. Defaults to `this`.\n   */\n\n\n  Base.prototype.unsetParams = function unsetParams(keys, scope) {\n\n    keys = keys instanceof Array ? keys : Object.keys(keys);\n    scope = scope || this;\n    (0, _each2.default)(keys, function (k) {\n      delete scope[k];\n    });\n\n    return this;\n  };\n\n  return Base;\n}();\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nBase.prototype._whitelistedParams = [];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nBase.prototype.defaults = {};\n\nexports.default = Base;\nmodule.exports = exports['default'];\n//# sourceMappingURL=base.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _triggerEvent = require('../helpers/dom/trigger-event');\n\nvar _triggerEvent2 = _interopRequireDefault(_triggerEvent);\n\nvar _parseAttribute = require('../helpers/dom/parse-attribute');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Typeahead\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Listen to an input element and format it as the user types.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Typeahead(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/typeahead.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar noop = function noop() {};\n\nvar Typeahead = function (_BaseComponent) {\n  _inherits(Typeahead, _BaseComponent);\n\n  /**\n   * Typeahead constructor\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Typeahead(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Typeahead);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._maintainFocus(function () {\n      this._parseParams();\n      this._bindEventListenerCallbacks();\n      this._addEventListeners();\n    });\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Run the formatting.\n   * @param {Number} cursorIndex\n   */\n\n\n  Typeahead.prototype.run = function run(cursorIndex) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this.isRunning) return this;\n\n    this.isRunning = true;\n\n    var oldVal = this.inputEl.value;\n    var val = '';\n    var placeholder = '';\n    var i = 0;\n    var len = this.format.length;\n    var skipCount = 0;\n    var valDone = false;\n\n    for (; i < len; i++) {\n\n      // Add numbers\n      if (this.format[i] === '\\\\d') {\n\n        if (this.characters[i - skipCount]) {\n          val += this.characters[i - skipCount];\n        } else {\n          valDone = true;\n        }\n\n        placeholder += valDone ? this.placeholder[i] : '&nbsp;';\n      }\n      // Placeholder characters\n      else {\n\n          if (!valDone) {\n            val += this.format[i];\n          }\n\n          placeholder += this.format[i];\n\n          skipCount++;\n        }\n    }\n\n    if (this.isFocused) {\n      cursorIndex = cursorIndex === undefined ? this._getCaretEnd() : cursorIndex;\n    }\n\n    // If there are no characters, set the cursorIndex to be the last placeholder entry.\n    if (this.isFocused && !this.characters.length) {\n      cursorIndex = val.length;\n    }\n\n    // No characters and we shouldn't use just placeholder values\n    if (!this.characters.length && params.notOnlyPlaceholders) {\n      val = '';\n    }\n\n    this.inputEl.value = val;\n    this.placeholderEl.innerHTML = placeholder;\n\n    this._updateWidth();\n\n    if (this.isFocused) {\n      this._setCaretPositionTranslated(cursorIndex);\n    }\n\n    if (val !== oldVal) {\n      (0, _triggerEvent2.default)(this.inputEl, 'input');\n    }\n\n    this.isRunning = false;\n\n    if (val !== oldVal) {\n      (this.onChange || noop)(val, oldVal, this);\n    }\n\n    if (!this._atEnd && this.isFocused && this.characters.length === this.maxLength && this._caretIsAtEnd()) {\n      this._atEnd = true;\n      (this.onEnd || noop)(this);\n    } else {\n      this._atEnd = false;\n    }\n\n    return this;\n  };\n\n  /**\n   * Add a character to the characters array at a given index.\n   * @param {String} character\n   * @param {Number} start\n   * @param {Number} end\n   * @param {Boolean} skipCheck\n   */\n\n\n  Typeahead.prototype.addCharacterAtIndex = function addCharacterAtIndex(character, start, end, skipCheck) {\n\n    // Don't add at an index beyond what we can support.\n    if (this.maxLength && start >= this.maxLength) {\n      return this;\n    }\n\n    if (!skipCheck) {\n\n      var re;\n\n      // Try to build a regex for this format character.\n      try {\n        re = new RegExp(this.format[start]);\n      } catch (e) {\n        //\n      }\n\n      if (!re || !re.exec(character)) {\n        return this;\n      }\n    }\n\n    this.characters.splice(start, end - start, character);\n\n    // If we've added at an index that pushes the length beyond what we support,\n    // remove the trailing characters.\n    if (this.maxLength && this.characters.length > this.maxLength) {\n      this.characters.splice(this.maxLength, this.characters.length);\n    }\n\n    this.run(start + 1);\n\n    return this;\n  };\n\n  /**\n   * Add a character at the position of the caret.\n   * @param {String} character\n   */\n\n\n  Typeahead.prototype.addCharacterAtCaret = function addCharacterAtCaret(character) {\n\n    var pos = this._getCaretStart();\n    var re;\n\n    // If we're beyond the bounds of the format, stop.\n    if (this.format[pos] === undefined) {\n      (this.onEnd || noop)(this, character);\n      return this;\n    }\n\n    // Try to build a regex for this format character.\n    try {\n      re = new RegExp(this.format[pos]);\n    } catch (e) {}\n    //\n\n\n    // We couldn't build a regex (so it's invalid) or the regex failed (so it's invalid)\n    if (!re || !re.exec(character)) {\n      if (this._moveCaret('right')) {\n        this.addCharacterAtCaret(character);\n      }\n      return this;\n    }\n\n    this.addCharacterAtIndex(character, this._getCaretStartTranslated(), this._getCaretEndTranslated(), true);\n\n    return this;\n  };\n\n  /**\n   * Remove a character from the character array by index.\n   * @param {Number} index\n   * @param {Number} length Optional\n   * @param {Number} offset Optional\n   */\n\n\n  Typeahead.prototype.removeCharacterAtIndex = function removeCharacterAtIndex(index, length, offset) {\n\n    // Don't want a negative splice length or else we start\n    // removing characters from the end.\n    if (index + offset < 0) {\n      return this;\n    }\n\n    length = length !== undefined ? length : 1;\n    this.characters.splice(index + offset, length);\n    this.run(index + (offset || 1));\n\n    return this;\n  };\n\n  /**\n   * Remove the character at the caret.\n   * @param {Number} offset Optional An offset from the current position.\n   */\n\n\n  Typeahead.prototype.removeCharacterAtCaret = function removeCharacterAtCaret(offset) {\n\n    var start = this._getCaretStartTranslated();\n    var end = this._getCaretEndTranslated();\n    var length = 1;\n    var tmp;\n\n    if (start !== end) {\n\n      // If the end is less than the start, the user dragged from right to left.\n      // Just swap them to make it easier to handle.\n      if (end < start) {\n        tmp = start;\n        start = end;\n        end = tmp;\n      }\n\n      // The length of characters removed\n      length = end - start;\n\n      // Bump the start position @todo: haven't thought through why this is, but it's needed.\n      start++;\n    }\n\n    this.removeCharacterAtIndex(start, length, offset);\n\n    return this;\n  };\n\n  /**\n   * Remove the character in the current range.\n   */\n\n\n  Typeahead.prototype.removeCharactersInRange = function removeCharactersInRange() {\n    this.removeCharacterAtIndex(this._getCaretStartTranslated(), this._getCaretEndTranslated());\n    return this;\n  };\n\n  /**\n   * Set the value of the typeahead. Maintain the position of the caret.\n   * @param {String} value\n   */\n\n\n  Typeahead.prototype.setValue = function setValue(value) {\n\n    this.settingValue = true;\n    this.pause();\n\n    this.characters = (value + '').split('');\n    this.run();\n\n    if (this.isFocused) this._setCaretPosition(this._getCaretStart());\n\n    this.resume();\n    this.settingValue = false;\n\n    return this;\n  };\n\n  /**\n   * Get the value of the typeahead.\n   * @param {Boolean} asInt Get the value as a parsed integer.\n   * @return {String|Number}\n   */\n\n\n  Typeahead.prototype.getValue = function getValue(asInt) {\n    return asInt && this.inputEl.value ? parseInt(this.inputEl.value, 10) : this.inputEl.value;\n  };\n\n  /**\n   * Clear the selected value.\n   */\n\n\n  Typeahead.prototype.clearValue = function clearValue() {\n    this.pause();\n    this.characters = [];\n    this.run(0, { notOnlyPlaceholders: true });\n    return this.resume();\n  };\n\n  /**\n   * Take the date values from the inputs and set them as dates on the calendar.\n   */\n\n\n  Typeahead.prototype.updateValue = function updateValue() {\n    return this.setValue(this.inputEl.value);\n  };\n\n  /**\n   * Move the caret position.\n   * @param {Number} pos\n   */\n\n\n  Typeahead.prototype.moveCaret = function moveCaret(pos) {\n    this._setCaretPositionTranslated(pos);\n    return this;\n  };\n\n  /**\n   * Move the caret to the end of the input.\n   */\n\n\n  Typeahead.prototype.moveCaretToEnd = function moveCaretToEnd() {\n    return this.moveCaret(this.characters.length);\n  };\n\n  /**\n   * Move the caret to the start of the input.\n   */\n\n\n  Typeahead.prototype.moveCaretToStart = function moveCaretToStart() {\n    return this.moveCaret(0);\n  };\n\n  /**\n   * Pause events.\n   */\n\n\n  Typeahead.prototype.pause = function pause() {\n    this.pauseBlurFocus++;\n    return this;\n  };\n\n  /**\n   * Resume events.\n   */\n\n\n  Typeahead.prototype.resume = function resume() {\n    this.pauseBlurFocus--;\n    return this;\n  };\n\n  /**\n   * Disable entry into the input.\n   */\n\n\n  Typeahead.prototype.disable = function disable() {\n    this.inputEl.setAttribute('disabled', '');\n    return this;\n  };\n\n  /**\n   * Enable entry into the input.\n   */\n\n\n  Typeahead.prototype.enable = function enable() {\n    this.inputEl.removeAttribute('disabled');\n    return this;\n  };\n\n  /**\n   * Clear the value.\n   * Changed to clearValue in v2.0.0.\n   */\n\n\n  Typeahead.prototype.clear = function clear() {\n    return this.clearValue();\n  };\n\n  /**\n   * Augment default remove call w/ helper cleanup.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Typeahead.prototype.remove = function remove(leaveElement) {\n    _BaseComponent.prototype.remove.call(this, leaveElement);\n    return this;\n  };\n\n  /**\n   * Store a reference to the needed elements.\n   * @param {Object} el\n   */\n\n\n  Typeahead.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.inputEl = this.el.querySelector('[type=\"text\"], [type=\"email\"], [type=\"phone\"], textarea') || this._createDefaultInputElement();\n    this.placeholderEl = this.el.querySelector('.spark-input__placeholder') || this._createDefaultPlaceholderElement();\n  };\n\n  /**\n   * Parse parameters from the elements.\n   */\n\n\n  Typeahead.prototype._parseParams = function _parseParams() {\n\n    // Store the value characters\n    this.characters = this._parseCharacters(this.inputEl.value);\n\n    // Store format\n    this.format = this._parseFormat(this.format ? this.format : this.inputEl.getAttribute('data-typeahead-format'));\n\n    // Store the original placeholder\n    this.placeholder = this.placeholder ? this.placeholder : this.inputEl.getAttribute('placeholder').split('');\n\n    // Get the total number of characters we can have\n    this.maxLength = this._getCharactersAllowedCount(this.format);\n\n    this.matchPlaceholderSize = this.matchPlaceholderSize !== null ? this.matchPlaceholderSize : (0, _parseAttribute.boolean)(this.inputEl, 'data-match-placeholder-size', false);\n  };\n\n  /**\n   * Parse the format string into an array.\n   * @param  {String} format\n   * @return {Array}\n   */\n\n\n  Typeahead.prototype._parseFormat = function _parseFormat(format) {\n\n    var i = 0;\n    var len = format.length;\n    var arr = [];\n    var lastWasEscape = false;\n\n    for (; i < len; i++) {\n      if (format[i] === '\\\\' && !lastWasEscape) {\n        lastWasEscape = true;\n      } else {\n        arr.push((lastWasEscape ? '\\\\' : '') + format[i]);\n        lastWasEscape = false;\n      }\n    }\n\n    return arr;\n  };\n\n  /**\n   * Parse the characters string into an array, ignoring characters which don't\n   * match the format requirements.\n   * @param {String} characters\n   * @return {Array}\n   */\n\n\n  Typeahead.prototype._parseCharacters = function _parseCharacters(characters) {\n\n    var chars = characters.split('');\n    var i = 0;\n    var len = characters.length;\n    var regexes = [];\n    var arr = [];\n\n    for (; i < len; i++) {\n\n      // Try to build a regex for this format character.\n      try {\n        // Make sure this format starts with an escape character.\n        regexes[i] = this.format[i][0] === '\\\\' ? new RegExp(this.format[i]) : null;\n      } catch (e) {}\n      //\n\n\n      // If we were able to create a regex and our char passes, add it to the array\n      // of characters to return.\n      if (regexes[i] && regexes[i].exec(chars[i])) {\n        arr.push(chars[i]);\n      }\n    }\n\n    return arr;\n  };\n\n  /**\n   * Create the default input element.\n   * @return {Element}\n   */\n\n\n  Typeahead.prototype._createDefaultInputElement = function _createDefaultInputElement() {\n\n    var el = document.createElement('input');\n    el.className = 'spark-input__field';\n    el.setAttribute('data-typeahead', '');\n    el.setAttribute('type', 'tel');\n\n    this.el.appendChild(el);\n\n    return el;\n  };\n\n  /**\n   * Create the default input element.\n   * @return {Element}\n   */\n\n\n  Typeahead.prototype._createDefaultPlaceholderElement = function _createDefaultPlaceholderElement() {\n    var el = document.createElement('span');\n    el.className = 'spark-input__placeholder';\n    this.el.appendChild(el);\n    return el;\n  };\n\n  /**\n   * Get the maximum number of characters allowed.\n   * @param {Array} format\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCharactersAllowedCount = function _getCharactersAllowedCount(format) {\n\n    var i = 0;\n    var len = format.length;\n    var allowed = 0;\n\n    for (; i < len; i++) {\n      if (format[i] === '\\\\d') {\n        allowed++;\n      }\n    }\n\n    return allowed;\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Typeahead.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onKeydownBound = this._onKeydown.bind(this);\n    this._onKeypressBound = this._onKeypress.bind(this);\n    this._onFocusBound = this._onFocus.bind(this);\n    this._onBlurBound = this._onBlur.bind(this);\n    this._onPlaceholderClickBound = this._onPlaceholderClick.bind(this);\n  };\n\n  /**\n   * Add event listeners to keypress and keydown.\n   */\n\n\n  Typeahead.prototype._addEventListeners = function _addEventListeners() {\n    this.inputEl.addEventListener('keydown', this._onKeydownBound, false);\n    this.inputEl.addEventListener('keypress', this._onKeypressBound, false);\n    this.inputEl.addEventListener('focus', this._onFocusBound, false);\n    this.placeholderEl.addEventListener('click', this._onPlaceholderClickBound, false);\n  };\n\n  /**\n   * Add event listeners to keypress and keydown.\n   */\n\n\n  Typeahead.prototype._removeEventListeners = function _removeEventListeners() {\n\n    this.inputEl.removeEventListener('keydown', this._onKeydownBound);\n    this.inputEl.removeEventListener('keypress', this._onKeypressBound);\n    this.inputEl.removeEventListener('focus', this._onFocusBound);\n    this.placeholderEl.removeEventListener('click', this._onPlaceholderClickBound);\n\n    window.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n  };\n\n  /**\n   * Get the position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._getCaretStart = function _getCaretStart() {\n\n    return this._maintainFocus(function () {\n\n      var caretPosition;\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        caretPosition = sel.text.length;\n      } else if (this.inputEl.selectionStart || this.inputEl.selectionStart === 0) {\n        caretPosition = this.inputEl.selectionStart;\n      }\n\n      return caretPosition;\n    });\n  };\n\n  /**\n   * Get the end position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._getCaretEnd = function _getCaretEnd() {\n\n    return this._maintainFocus(function () {\n\n      var caretPosition;\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        caretPosition = sel.text.length;\n      } else if (this.inputEl.selectionEnd || this.inputEl.selectionEnd === 0) {\n        caretPosition = this.inputEl.selectionEnd;\n      }\n\n      return caretPosition;\n    });\n  };\n\n  /**\n   * Is the caret at the end of the input?\n   * @return {Boolean}\n   */\n\n\n  Typeahead.prototype._caretIsAtEnd = function _caretIsAtEnd() {\n    return this._getCaretStart() === this.maxLength;\n  };\n\n  /**\n   * Set the position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._setCaretPosition = function _setCaretPosition(pos) {\n\n    return this._maintainFocus(function () {\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        sel.moveStart('character', pos);\n        sel.moveEnd('character', 0);\n        sel.select();\n      } else if (this.inputEl.selectionStart || this.inputEl.selectionStart === 0) {\n        this.inputEl.selectionStart = pos;\n        this.inputEl.selectionEnd = pos;\n      }\n    });\n  };\n\n  /**\n   * Get the position of the caret translated to the corresponding index in the\n   * characters array. This means ignoring format characters.\n   * @param {Number} pos\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretPositionTranslated = function _getCaretPositionTranslated(pos) {\n\n    var i = 0;\n    var skipCount = 0;\n\n    for (; i < pos; i++) {\n\n      // Count non-numbers as a skip.\n      // @todo: this needs to work with more than numbers.\n      if (this.format[i] !== '\\\\d') {\n        skipCount++;\n      }\n    }\n\n    return pos - skipCount;\n  };\n\n  /**\n   * Get the starting position of the caret translated.\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretStartTranslated = function _getCaretStartTranslated() {\n    return this._getCaretPositionTranslated(this._getCaretStart());\n  };\n\n  /**\n   * Get the ending position of the caret translated.\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretEndTranslated = function _getCaretEndTranslated() {\n    return this._getCaretPositionTranslated(this._getCaretEnd());\n  };\n\n  /**\n   * Set the position of the caret translated to the corresponding index in the\n   * characters array. This means ignoring format characters.\n   * @param {Number} pos\n   */\n\n\n  Typeahead.prototype._setCaretPositionTranslated = function _setCaretPositionTranslated(pos) {\n\n    var i = 0;\n    var skipCount = 0;\n\n    for (; i < pos + skipCount; i++) {\n\n      // Count non-numbers as a skip.\n      // @todo: this needs to work with more than numbers.\n      if (this.format[i] !== undefined && this.format[i] !== '\\\\d') {\n        skipCount++;\n      }\n    }\n\n    this._setCaretPosition(pos + skipCount);\n  };\n\n  /**\n   * Move the caret position\n   * @param  {String} direction The direction of the movement\n   * @return {Boolean}           Was the caret actually moved?\n   */\n\n\n  Typeahead.prototype._moveCaret = function _moveCaret(direction) {\n\n    var curPos = this._getCaretStart();\n\n    if (direction === 'left') {\n      this._setCaretPosition(curPos - 1);\n    } else if (direction === 'right') {\n      this._setCaretPosition(curPos + 1);\n    }\n\n    return curPos !== this._getCaretStart();\n  };\n\n  /**\n   * Empty the input when we only have placeholders.\n   */\n\n\n  Typeahead.prototype._emptyWhenOnlyPlaceholders = function _emptyWhenOnlyPlaceholders() {\n    if (!this.characters.length) {\n      this.clear();\n    }\n  };\n\n  /**\n   * Run a callback function that may change the focus of the document, but\n   * make sure focus goes back to where it needs to be. Also, set the state\n   * so that blur/focus events don't fire from this instance.\n   * @param {Function} callback\n   */\n\n\n  Typeahead.prototype._maintainFocus = function _maintainFocus(callback) {\n\n    this.pause();\n\n    var originalActiveElement = document.activeElement;\n\n    //For IE\n    if (!originalActiveElement) {\n      originalActiveElement = document.body;\n    }\n\n    var output = (callback || noop).call(this);\n\n    // If we didn't have focus, go back to focusing on the original\n    if (originalActiveElement !== this.inputEl) {\n      this.inputEl.blur();\n      originalActiveElement ? originalActiveElement.focus() : null;\n    }\n\n    this.resume();\n\n    return output;\n  };\n\n  /**\n   * Update the width of the typeahead. If we should be matching the width\n   * of the placeholder, do so. Otherwise, take no action.\n   */\n\n\n  Typeahead.prototype._updateWidth = function _updateWidth() {\n\n    if (this.matchPlaceholderSize) {\n      this.placeholderEl.style.width = 'auto';\n      // Add 2px to account for caret width in IE...\n      this.inputEl.style.width = 'auto';\n      this.inputEl.style.width = this.placeholderEl.offsetWidth + 2 + 'px';\n      this.placeholderEl.style.width = '';\n    }\n  };\n\n  /**\n   * Listen for delete and arrows.\n   * @param  {Object} e\n   */\n\n\n  Typeahead.prototype._onKeydown = function _onKeydown(e) {\n\n    var code = e.keyCode || e.which;\n\n    if (code === this.pasteCode && (e.metaKey || e.ctrlKey)) {\n      return;\n    }\n\n    if (code === this.actionCodes.BACKSPACE) {\n      this.removeCharacterAtCaret(-1);\n      this._onBackspace();\n      e.preventDefault();\n    } else if (code === this.actionCodes.DELETE) {\n      this.removeCharacterAtCaret(0);\n      e.preventDefault();\n    } else if (code === this.actionCodes.LEFT) {\n      if (!this._getCaretStart()) {\n        (this.onBackspace || noop)();\n      }\n    } else if (code === this.actionCodes.RIGHT) {\n      if (this._getCaretStart() === this.characters.length) {\n        (this.onEnd || noop)();\n      }\n    } else {\n      if (this.ignoreCodes.indexOf(code) === -1) {\n        e.preventDefault();\n\n        // Account for Numpad keys\n        if (code >= 96 && code <= 105) {\n          code -= 48;\n        }\n\n        this.addCharacterAtCaret(String.fromCharCode(code));\n      }\n    }\n  };\n\n  /**\n   * When the keypress event fires, validate.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onKeypress = function _onKeypress(e) {\n    var code = e.keyCode || e.which;\n\n    if (this.ignoreCodes.indexOf(code) === -1) {\n      e.preventDefault();\n      this.characters = this._parseCharacters(this.inputEl.value);\n      this.run();\n      (this.onChange || noop)(this.getValue(), this);\n    }\n  };\n\n  /**\n   * When the input event fires, validate. This happens\n   * with a copy+paste.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onInput = function _onInput(e) {\n    e.preventDefault();\n    this.characters = this._parseCharacters(this.inputEl.value);\n    this.run();\n    (this.onInput || noop)(this.getValue(), this);\n  };\n\n  /**\n   * When we focus, run the formatting.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onFocus = function _onFocus() {\n\n    window.removeEventListener('blur', this._onBlurBound);\n    window.addEventListener('blur', this._onBlurBound, false);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.addEventListener('blur', this._onBlurBound, false);\n\n    if (this.isFocused || this.pauseBlurFocus || this.isRunning) return;\n\n    this.run();\n    (this.onFocus || noop)(this.getValue(), this);\n    this.isFocused = true;\n    this._oldVal = this.inputEl.value;\n  };\n\n  /**\n   * When we blur, if we have no characters, remove the placeholders.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onBlur = function _onBlur() {\n\n    window.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n\n    this.isFocused = false;\n\n    if (this.pauseBlurFocus || this.isRunning) return;\n\n    this._emptyWhenOnlyPlaceholders();\n\n    if (this._oldVal !== this.inputEl.value) {\n      (0, _triggerEvent2.default)(this.inputEl, 'change');\n    }\n\n    (this.onBlur || noop)(this.getValue(), this);\n  };\n\n  /**\n   * When the placeholder receives a click event, focus on the input. This happens in IE10 for some\n   * reason that I cannot fully fathom, but it has something to do with the explicit width being\n   * set on an empty element.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onPlaceholderClick = function _onPlaceholderClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.inputEl.focus();\n  };\n\n  /**\n   * When we backspace, if we have no characters left let listeners know.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onBackspace = function _onBackspace() {\n    if (!this._getCaretStart()) (this.onBackspace || noop)();\n  };\n\n  return Typeahead;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nTypeahead.prototype._whitelistedParams = ['format', 'placeholder', 'matchPlaceholderSize', 'onChange', 'onFocus', 'onBlur', 'onInput', 'onBackspace', 'onEnd'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nTypeahead.prototype.defaults = {\n  el: null,\n  inputEl: null,\n  placeholderEl: null,\n  placeholder: null,\n  characters: null,\n  format: null,\n  ignoreCodes: [9, // Tab\n  16, // Shift\n  17, // Ctrl\n  18, // Alt\n  20, // CAPS\n  91, // Meta\n  93, // Alt\n  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123 // F1-F12\n  ],\n  actionCodes: {\n    BACKSPACE: 8,\n    DELETE: 46,\n    LEFT: 37,\n    RIGHT: 39\n  },\n  pasteCode: 86, // v\n  pauseBlurFocus: 0,\n  matchPlaceholderSize: null,\n  maxLength: null,\n  isFocused: false,\n  isRunning: false,\n  onChange: null,\n  onFocus: null,\n  onBlur: null,\n  onInput: null,\n  onBackspace: null,\n  onEnd: null,\n  _atEnd: false,\n  _oldVal: null,\n  _onKeydownBound: null,\n  _onKeypressBound: null,\n  _onFocusBound: null,\n  _onBlurBound: null,\n  _onPlaceholderClickBound: null\n};\n\nexports.default = Typeahead;\nmodule.exports = exports['default'];\n//# sourceMappingURL=typeahead.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Parse DOM attributes\n * Given an element and an attribute name, parse that attribute\n * if it exists or return a default.\n *\n * @module helpers/dom/parse-attribute.js\n */\n\n/**\n * Get the boolean value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction boolean(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return val === 'true' || val === '' ? true : false;\n}\n\n/**\n * Get the numeric value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction number(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return parseInt(val, 10);\n}\n\n/**\n * Get the boolean value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction string(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return val;\n}\n\nexports.boolean = boolean;\nexports.number = number;\nexports.string = string;\n//# sourceMappingURL=parse-attribute.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Trigger Event\n * Trigger a DOM event on an element.\n *\n * @param {Element} el\n * @param {String} name\n *\n * @module helpers/dom/trigger-event.js\n */\nfunction triggerEvent(el, name) {\n\n  var event = void 0;\n\n  if (document.createEvent) {\n    event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventName = name;\n    el.dispatchEvent(event);\n  } else {\n    event = document.createEventObject();\n    event.eventType = name;\n    event.eventName = name;\n    el.fireEvent('on' + event.eventType, event);\n  }\n}\n\nexports.default = triggerEvent;\nmodule.exports = exports['default'];\n//# sourceMappingURL=trigger-event.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Each\n * Apply a callback function to a list of any kind: Array, NodeList, HTMLCollection or Object.\n *\n * @param {Array|NodeList|HTMLCollection|Object} list\n * @param {Function} cb\n *\n * @example\n * each([], callback);\n * each(el.children, callback);\n * each(el.childNodes, callback);\n * each({}, callback);\n *\n * @module helpers/util/each.js\n */\nfunction each(list, cb) {\n\n  if (!list) {\n    return;\n  }\n\n  if (typeof cb !== 'function') {\n    throw new Error('Cannot invoke `each` without a callback!');\n  }\n\n  var i = 0;\n  var len = list.length;\n\n  // Object\n  if (len === undefined) {\n    for (i in list) {\n      if (i !== 'prototype' && list.hasOwnProperty(i)) {\n        cb(i, list[i]);\n      }\n    }\n  }\n  // Array-like\n  else {\n      for (; i < len; i++) {\n        cb(list[i]);\n      }\n    }\n}\n\nexports.default = each;\nmodule.exports = exports['default'];\n//# sourceMappingURL=each.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvYmFzZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy90eXBlYWhlYWQuanMiLCJqcy9kaXN0L2hlbHBlcnMvZG9tL3BhcnNlLWF0dHJpYnV0ZS5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vdHJpZ2dlci1ldmVudC5qcyIsImpzL2Rpc3QvaGVscGVycy91dGlsL2VhY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2VhY2ggPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQmFzZSBDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgYmFzZSBjbGFzcyBmb3IgU3BhcmsgSlMgY29tcG9uZW50cy4gVGhpcyBjbGFzcyBzaG91bGQgbmV2ZXIgYmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2Jhc2UuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBCYXNlID0gZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBTZXQgcGFyYW1ldGVycyBhbmQgY2FjaGUgZWxlbWVudHMuXG4gICAqL1xuICBmdW5jdGlvbiBCYXNlKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZSk7XG5cbiAgICBpZiAocGFyYW1zLmVsUmVxdWlyZWQgJiYgIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRQYXJhbXModGhpcy5kZWZhdWx0cyB8fCB7fSwgdHJ1ZSk7XG4gICAgdGhpcy5zZXRQYXJhbXMocGFyYW1zKTtcbiAgICAodGhpcy5fY2FjaGVFbGVtZW50cyB8fCBub29wKS5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTSBhbmQgcHJlcGFyZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGJ5IGRlcmVmZXJlbmNpbmcgdmFsdWVzLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGxlYXZlRWxlbWVudCBMZWF2ZSB0aGUgZWxlbWVudCBpbnRhY3QuXG4gICAqL1xuXG5cbiAgQmFzZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuXG4gICAgaWYgKHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIGlmICghbGVhdmVFbGVtZW50ICYmIHRoaXMuZWwgJiYgdGhpcy5lbC5wYXJlbnROb2RlKSB7XG4gICAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbCk7XG4gICAgfVxuXG4gICAgdGhpcy51bnNldFBhcmFtcyh0aGlzLmRlZmF1bHRzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBPcHRpb25hbFxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShlbCkge1xuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG5cbiAgICBpZiAodGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMuX2NhY2hlRWxlbWVudHMgfHwgbm9vcCkuY2FsbCh0aGlzLCBlbCB8fCB0aGlzLmVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgYSBoYXNoIG9mIHBhcmFtZXRlcnMgaWYgdGhleSdyZSB3aGl0ZWxpc3RlZCBvciB3ZSdyZSB0b2xkIHRvIGZvcmNlIHRoZSBzZXQuXG4gICAqIFRoaXMgaXMgdXNlZCB0byBzZXQgaW5pdGlhbCB2YWx1ZXMgYXMgd2VsbCBhcyBzZXQgcGFzc2VkIHBhcmFtZXRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSBzZXR0aW5nIGV2ZW4gaWYgdGhlIHBhcmFtIGlzIG5vdCB3aGl0ZWxpc3RlZC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS5zZXRQYXJhbXMgPSBmdW5jdGlvbiBzZXRQYXJhbXMocGFyYW1zLCBmb3JjZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHBhcmFtcywgZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgIGlmIChfdGhpcy5fd2hpdGVsaXN0ZWRQYXJhbXMuaW5kZXhPZihrKSAhPT0gLTEgfHwgZm9yY2UpIHtcbiAgICAgICAgX3RoaXNba10gPSB2O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuc2V0IGFsbCBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0ga2V5c1xuICAgKiBAcGFyYW0ge09iamVjdH0gc2NvcGUgVGhlIG9iamVjdCB0byB1bnNldCB0aGUgcGFyYW1zIGZyb20uIERlZmF1bHRzIHRvIGB0aGlzYC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS51bnNldFBhcmFtcyA9IGZ1bmN0aW9uIHVuc2V0UGFyYW1zKGtleXMsIHNjb3BlKSB7XG5cbiAgICBrZXlzID0ga2V5cyBpbnN0YW5jZW9mIEFycmF5ID8ga2V5cyA6IE9iamVjdC5rZXlzKGtleXMpO1xuICAgIHNjb3BlID0gc2NvcGUgfHwgdGhpcztcbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKGtleXMsIGZ1bmN0aW9uIChrKSB7XG4gICAgICBkZWxldGUgc2NvcGVba107XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICByZXR1cm4gQmFzZTtcbn0oKTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5cblxuQmFzZS5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gW107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkJhc2UucHJvdG90eXBlLmRlZmF1bHRzID0ge307XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJhc2U7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhc2UuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfdHJpZ2dlckV2ZW50ID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vdHJpZ2dlci1ldmVudCcpO1xuXG52YXIgX3RyaWdnZXJFdmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmlnZ2VyRXZlbnQpO1xuXG52YXIgX3BhcnNlQXR0cmlidXRlID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vcGFyc2UtYXR0cmlidXRlJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAjIFR5cGVhaGVhZFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogTGlzdGVuIHRvIGFuIGlucHV0IGVsZW1lbnQgYW5kIGZvcm1hdCBpdCBhcyB0aGUgdXNlciB0eXBlcy5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbmV3IFR5cGVhaGVhZChlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL3R5cGVhaGVhZC5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9O1xuXG52YXIgVHlwZWFoZWFkID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhUeXBlYWhlYWQsIF9CYXNlQ29tcG9uZW50KTtcblxuICAvKipcbiAgICogVHlwZWFoZWFkIGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKi9cbiAgZnVuY3Rpb24gVHlwZWFoZWFkKGVsKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVHlwZWFoZWFkKTtcblxuICAgIHBhcmFtcy5lbFJlcXVpcmVkID0gdHJ1ZTtcblxuICAgIGlmICghKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0Jhc2VDb21wb25lbnQuY2FsbCh0aGlzLCBlbCwgcGFyYW1zKSksIF90aGlzKSkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5fbWFpbnRhaW5Gb2N1cyhmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLl9wYXJzZVBhcmFtcygpO1xuICAgICAgdGhpcy5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKTtcbiAgICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfSk7XG4gICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBSdW4gdGhlIGZvcm1hdHRpbmcuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBjdXJzb3JJbmRleFxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKGN1cnNvckluZGV4KSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cblxuICAgIGlmICh0aGlzLmlzUnVubmluZykgcmV0dXJuIHRoaXM7XG5cbiAgICB0aGlzLmlzUnVubmluZyA9IHRydWU7XG5cbiAgICB2YXIgb2xkVmFsID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICAgIHZhciB2YWwgPSAnJztcbiAgICB2YXIgcGxhY2Vob2xkZXIgPSAnJztcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGxlbiA9IHRoaXMuZm9ybWF0Lmxlbmd0aDtcbiAgICB2YXIgc2tpcENvdW50ID0gMDtcbiAgICB2YXIgdmFsRG9uZSA9IGZhbHNlO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuXG4gICAgICAvLyBBZGQgbnVtYmVyc1xuICAgICAgaWYgKHRoaXMuZm9ybWF0W2ldID09PSAnXFxcXGQnKSB7XG5cbiAgICAgICAgaWYgKHRoaXMuY2hhcmFjdGVyc1tpIC0gc2tpcENvdW50XSkge1xuICAgICAgICAgIHZhbCArPSB0aGlzLmNoYXJhY3RlcnNbaSAtIHNraXBDb3VudF07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFsRG9uZSA9IHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICBwbGFjZWhvbGRlciArPSB2YWxEb25lID8gdGhpcy5wbGFjZWhvbGRlcltpXSA6ICcmbmJzcDsnO1xuICAgICAgfVxuICAgICAgLy8gUGxhY2Vob2xkZXIgY2hhcmFjdGVyc1xuICAgICAgZWxzZSB7XG5cbiAgICAgICAgICBpZiAoIXZhbERvbmUpIHtcbiAgICAgICAgICAgIHZhbCArPSB0aGlzLmZvcm1hdFtpXTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwbGFjZWhvbGRlciArPSB0aGlzLmZvcm1hdFtpXTtcblxuICAgICAgICAgIHNraXBDb3VudCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICBjdXJzb3JJbmRleCA9IGN1cnNvckluZGV4ID09PSB1bmRlZmluZWQgPyB0aGlzLl9nZXRDYXJldEVuZCgpIDogY3Vyc29ySW5kZXg7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUgYXJlIG5vIGNoYXJhY3RlcnMsIHNldCB0aGUgY3Vyc29ySW5kZXggdG8gYmUgdGhlIGxhc3QgcGxhY2Vob2xkZXIgZW50cnkuXG4gICAgaWYgKHRoaXMuaXNGb2N1c2VkICYmICF0aGlzLmNoYXJhY3RlcnMubGVuZ3RoKSB7XG4gICAgICBjdXJzb3JJbmRleCA9IHZhbC5sZW5ndGg7XG4gICAgfVxuXG4gICAgLy8gTm8gY2hhcmFjdGVycyBhbmQgd2Ugc2hvdWxkbid0IHVzZSBqdXN0IHBsYWNlaG9sZGVyIHZhbHVlc1xuICAgIGlmICghdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCAmJiBwYXJhbXMubm90T25seVBsYWNlaG9sZGVycykge1xuICAgICAgdmFsID0gJyc7XG4gICAgfVxuXG4gICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gdmFsO1xuICAgIHRoaXMucGxhY2Vob2xkZXJFbC5pbm5lckhUTUwgPSBwbGFjZWhvbGRlcjtcblxuICAgIHRoaXMuX3VwZGF0ZVdpZHRoKCk7XG5cbiAgICBpZiAodGhpcy5pc0ZvY3VzZWQpIHtcbiAgICAgIHRoaXMuX3NldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkKGN1cnNvckluZGV4KTtcbiAgICB9XG5cbiAgICBpZiAodmFsICE9PSBvbGRWYWwpIHtcbiAgICAgICgwLCBfdHJpZ2dlckV2ZW50Mi5kZWZhdWx0KSh0aGlzLmlucHV0RWwsICdpbnB1dCcpO1xuICAgIH1cblxuICAgIHRoaXMuaXNSdW5uaW5nID0gZmFsc2U7XG5cbiAgICBpZiAodmFsICE9PSBvbGRWYWwpIHtcbiAgICAgICh0aGlzLm9uQ2hhbmdlIHx8IG5vb3ApKHZhbCwgb2xkVmFsLCB0aGlzKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX2F0RW5kICYmIHRoaXMuaXNGb2N1c2VkICYmIHRoaXMuY2hhcmFjdGVycy5sZW5ndGggPT09IHRoaXMubWF4TGVuZ3RoICYmIHRoaXMuX2NhcmV0SXNBdEVuZCgpKSB7XG4gICAgICB0aGlzLl9hdEVuZCA9IHRydWU7XG4gICAgICAodGhpcy5vbkVuZCB8fCBub29wKSh0aGlzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fYXRFbmQgPSBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQWRkIGEgY2hhcmFjdGVyIHRvIHRoZSBjaGFyYWN0ZXJzIGFycmF5IGF0IGEgZ2l2ZW4gaW5kZXguXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFyYWN0ZXJcbiAgICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0XG4gICAqIEBwYXJhbSB7TnVtYmVyfSBlbmRcbiAgICogQHBhcmFtIHtCb29sZWFufSBza2lwQ2hlY2tcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLmFkZENoYXJhY3RlckF0SW5kZXggPSBmdW5jdGlvbiBhZGRDaGFyYWN0ZXJBdEluZGV4KGNoYXJhY3Rlciwgc3RhcnQsIGVuZCwgc2tpcENoZWNrKSB7XG5cbiAgICAvLyBEb24ndCBhZGQgYXQgYW4gaW5kZXggYmV5b25kIHdoYXQgd2UgY2FuIHN1cHBvcnQuXG4gICAgaWYgKHRoaXMubWF4TGVuZ3RoICYmIHN0YXJ0ID49IHRoaXMubWF4TGVuZ3RoKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBpZiAoIXNraXBDaGVjaykge1xuXG4gICAgICB2YXIgcmU7XG5cbiAgICAgIC8vIFRyeSB0byBidWlsZCBhIHJlZ2V4IGZvciB0aGlzIGZvcm1hdCBjaGFyYWN0ZXIuXG4gICAgICB0cnkge1xuICAgICAgICByZSA9IG5ldyBSZWdFeHAodGhpcy5mb3JtYXRbc3RhcnRdKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy9cbiAgICAgIH1cblxuICAgICAgaWYgKCFyZSB8fCAhcmUuZXhlYyhjaGFyYWN0ZXIpKSB7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuY2hhcmFjdGVycy5zcGxpY2Uoc3RhcnQsIGVuZCAtIHN0YXJ0LCBjaGFyYWN0ZXIpO1xuXG4gICAgLy8gSWYgd2UndmUgYWRkZWQgYXQgYW4gaW5kZXggdGhhdCBwdXNoZXMgdGhlIGxlbmd0aCBiZXlvbmQgd2hhdCB3ZSBzdXBwb3J0LFxuICAgIC8vIHJlbW92ZSB0aGUgdHJhaWxpbmcgY2hhcmFjdGVycy5cbiAgICBpZiAodGhpcy5tYXhMZW5ndGggJiYgdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCA+IHRoaXMubWF4TGVuZ3RoKSB7XG4gICAgICB0aGlzLmNoYXJhY3RlcnMuc3BsaWNlKHRoaXMubWF4TGVuZ3RoLCB0aGlzLmNoYXJhY3RlcnMubGVuZ3RoKTtcbiAgICB9XG5cbiAgICB0aGlzLnJ1bihzdGFydCArIDEpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhIGNoYXJhY3RlciBhdCB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0LlxuICAgKiBAcGFyYW0ge1N0cmluZ30gY2hhcmFjdGVyXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5hZGRDaGFyYWN0ZXJBdENhcmV0ID0gZnVuY3Rpb24gYWRkQ2hhcmFjdGVyQXRDYXJldChjaGFyYWN0ZXIpIHtcblxuICAgIHZhciBwb3MgPSB0aGlzLl9nZXRDYXJldFN0YXJ0KCk7XG4gICAgdmFyIHJlO1xuXG4gICAgLy8gSWYgd2UncmUgYmV5b25kIHRoZSBib3VuZHMgb2YgdGhlIGZvcm1hdCwgc3RvcC5cbiAgICBpZiAodGhpcy5mb3JtYXRbcG9zXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAodGhpcy5vbkVuZCB8fCBub29wKSh0aGlzLCBjaGFyYWN0ZXIpO1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgLy8gVHJ5IHRvIGJ1aWxkIGEgcmVnZXggZm9yIHRoaXMgZm9ybWF0IGNoYXJhY3Rlci5cbiAgICB0cnkge1xuICAgICAgcmUgPSBuZXcgUmVnRXhwKHRoaXMuZm9ybWF0W3Bvc10pO1xuICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgLy9cblxuXG4gICAgLy8gV2UgY291bGRuJ3QgYnVpbGQgYSByZWdleCAoc28gaXQncyBpbnZhbGlkKSBvciB0aGUgcmVnZXggZmFpbGVkIChzbyBpdCdzIGludmFsaWQpXG4gICAgaWYgKCFyZSB8fCAhcmUuZXhlYyhjaGFyYWN0ZXIpKSB7XG4gICAgICBpZiAodGhpcy5fbW92ZUNhcmV0KCdyaWdodCcpKSB7XG4gICAgICAgIHRoaXMuYWRkQ2hhcmFjdGVyQXRDYXJldChjaGFyYWN0ZXIpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy5hZGRDaGFyYWN0ZXJBdEluZGV4KGNoYXJhY3RlciwgdGhpcy5fZ2V0Q2FyZXRTdGFydFRyYW5zbGF0ZWQoKSwgdGhpcy5fZ2V0Q2FyZXRFbmRUcmFuc2xhdGVkKCksIHRydWUpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBhIGNoYXJhY3RlciBmcm9tIHRoZSBjaGFyYWN0ZXIgYXJyYXkgYnkgaW5kZXguXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBpbmRleFxuICAgKiBAcGFyYW0ge051bWJlcn0gbGVuZ3RoIE9wdGlvbmFsXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBvZmZzZXQgT3B0aW9uYWxcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnJlbW92ZUNoYXJhY3RlckF0SW5kZXggPSBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXJBdEluZGV4KGluZGV4LCBsZW5ndGgsIG9mZnNldCkge1xuXG4gICAgLy8gRG9uJ3Qgd2FudCBhIG5lZ2F0aXZlIHNwbGljZSBsZW5ndGggb3IgZWxzZSB3ZSBzdGFydFxuICAgIC8vIHJlbW92aW5nIGNoYXJhY3RlcnMgZnJvbSB0aGUgZW5kLlxuICAgIGlmIChpbmRleCArIG9mZnNldCA8IDApIHtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIGxlbmd0aCA9IGxlbmd0aCAhPT0gdW5kZWZpbmVkID8gbGVuZ3RoIDogMTtcbiAgICB0aGlzLmNoYXJhY3RlcnMuc3BsaWNlKGluZGV4ICsgb2Zmc2V0LCBsZW5ndGgpO1xuICAgIHRoaXMucnVuKGluZGV4ICsgKG9mZnNldCB8fCAxKSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBjaGFyYWN0ZXIgYXQgdGhlIGNhcmV0LlxuICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0IE9wdGlvbmFsIEFuIG9mZnNldCBmcm9tIHRoZSBjdXJyZW50IHBvc2l0aW9uLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUucmVtb3ZlQ2hhcmFjdGVyQXRDYXJldCA9IGZ1bmN0aW9uIHJlbW92ZUNoYXJhY3RlckF0Q2FyZXQob2Zmc2V0KSB7XG5cbiAgICB2YXIgc3RhcnQgPSB0aGlzLl9nZXRDYXJldFN0YXJ0VHJhbnNsYXRlZCgpO1xuICAgIHZhciBlbmQgPSB0aGlzLl9nZXRDYXJldEVuZFRyYW5zbGF0ZWQoKTtcbiAgICB2YXIgbGVuZ3RoID0gMTtcbiAgICB2YXIgdG1wO1xuXG4gICAgaWYgKHN0YXJ0ICE9PSBlbmQpIHtcblxuICAgICAgLy8gSWYgdGhlIGVuZCBpcyBsZXNzIHRoYW4gdGhlIHN0YXJ0LCB0aGUgdXNlciBkcmFnZ2VkIGZyb20gcmlnaHQgdG8gbGVmdC5cbiAgICAgIC8vIEp1c3Qgc3dhcCB0aGVtIHRvIG1ha2UgaXQgZWFzaWVyIHRvIGhhbmRsZS5cbiAgICAgIGlmIChlbmQgPCBzdGFydCkge1xuICAgICAgICB0bXAgPSBzdGFydDtcbiAgICAgICAgc3RhcnQgPSBlbmQ7XG4gICAgICAgIGVuZCA9IHRtcDtcbiAgICAgIH1cblxuICAgICAgLy8gVGhlIGxlbmd0aCBvZiBjaGFyYWN0ZXJzIHJlbW92ZWRcbiAgICAgIGxlbmd0aCA9IGVuZCAtIHN0YXJ0O1xuXG4gICAgICAvLyBCdW1wIHRoZSBzdGFydCBwb3NpdGlvbiBAdG9kbzogaGF2ZW4ndCB0aG91Z2h0IHRocm91Z2ggd2h5IHRoaXMgaXMsIGJ1dCBpdCdzIG5lZWRlZC5cbiAgICAgIHN0YXJ0Kys7XG4gICAgfVxuXG4gICAgdGhpcy5yZW1vdmVDaGFyYWN0ZXJBdEluZGV4KHN0YXJ0LCBsZW5ndGgsIG9mZnNldCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBjaGFyYWN0ZXIgaW4gdGhlIGN1cnJlbnQgcmFuZ2UuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5yZW1vdmVDaGFyYWN0ZXJzSW5SYW5nZSA9IGZ1bmN0aW9uIHJlbW92ZUNoYXJhY3RlcnNJblJhbmdlKCkge1xuICAgIHRoaXMucmVtb3ZlQ2hhcmFjdGVyQXRJbmRleCh0aGlzLl9nZXRDYXJldFN0YXJ0VHJhbnNsYXRlZCgpLCB0aGlzLl9nZXRDYXJldEVuZFRyYW5zbGF0ZWQoKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgdmFsdWUgb2YgdGhlIHR5cGVhaGVhZC4gTWFpbnRhaW4gdGhlIHBvc2l0aW9uIG9mIHRoZSBjYXJldC5cbiAgICogQHBhcmFtIHtTdHJpbmd9IHZhbHVlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKHZhbHVlKSB7XG5cbiAgICB0aGlzLnNldHRpbmdWYWx1ZSA9IHRydWU7XG4gICAgdGhpcy5wYXVzZSgpO1xuXG4gICAgdGhpcy5jaGFyYWN0ZXJzID0gKHZhbHVlICsgJycpLnNwbGl0KCcnKTtcbiAgICB0aGlzLnJ1bigpO1xuXG4gICAgaWYgKHRoaXMuaXNGb2N1c2VkKSB0aGlzLl9zZXRDYXJldFBvc2l0aW9uKHRoaXMuX2dldENhcmV0U3RhcnQoKSk7XG5cbiAgICB0aGlzLnJlc3VtZSgpO1xuICAgIHRoaXMuc2V0dGluZ1ZhbHVlID0gZmFsc2U7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSB2YWx1ZSBvZiB0aGUgdHlwZWFoZWFkLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGFzSW50IEdldCB0aGUgdmFsdWUgYXMgYSBwYXJzZWQgaW50ZWdlci5cbiAgICogQHJldHVybiB7U3RyaW5nfE51bWJlcn1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoYXNJbnQpIHtcbiAgICByZXR1cm4gYXNJbnQgJiYgdGhpcy5pbnB1dEVsLnZhbHVlID8gcGFyc2VJbnQodGhpcy5pbnB1dEVsLnZhbHVlLCAxMCkgOiB0aGlzLmlucHV0RWwudmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIENsZWFyIHRoZSBzZWxlY3RlZCB2YWx1ZS5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLmNsZWFyVmFsdWUgPSBmdW5jdGlvbiBjbGVhclZhbHVlKCkge1xuICAgIHRoaXMucGF1c2UoKTtcbiAgICB0aGlzLmNoYXJhY3RlcnMgPSBbXTtcbiAgICB0aGlzLnJ1bigwLCB7IG5vdE9ubHlQbGFjZWhvbGRlcnM6IHRydWUgfSk7XG4gICAgcmV0dXJuIHRoaXMucmVzdW1lKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFRha2UgdGhlIGRhdGUgdmFsdWVzIGZyb20gdGhlIGlucHV0cyBhbmQgc2V0IHRoZW0gYXMgZGF0ZXMgb24gdGhlIGNhbGVuZGFyLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUudXBkYXRlVmFsdWUgPSBmdW5jdGlvbiB1cGRhdGVWYWx1ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5zZXRWYWx1ZSh0aGlzLmlucHV0RWwudmFsdWUpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIHRoZSBjYXJldCBwb3NpdGlvbi5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHBvc1xuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUubW92ZUNhcmV0ID0gZnVuY3Rpb24gbW92ZUNhcmV0KHBvcykge1xuICAgIHRoaXMuX3NldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkKHBvcyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdmUgdGhlIGNhcmV0IHRvIHRoZSBlbmQgb2YgdGhlIGlucHV0LlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUubW92ZUNhcmV0VG9FbmQgPSBmdW5jdGlvbiBtb3ZlQ2FyZXRUb0VuZCgpIHtcbiAgICByZXR1cm4gdGhpcy5tb3ZlQ2FyZXQodGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdmUgdGhlIGNhcmV0IHRvIHRoZSBzdGFydCBvZiB0aGUgaW5wdXQuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5tb3ZlQ2FyZXRUb1N0YXJ0ID0gZnVuY3Rpb24gbW92ZUNhcmV0VG9TdGFydCgpIHtcbiAgICByZXR1cm4gdGhpcy5tb3ZlQ2FyZXQoMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhdXNlIGV2ZW50cy5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24gcGF1c2UoKSB7XG4gICAgdGhpcy5wYXVzZUJsdXJGb2N1cysrO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZXN1bWUgZXZlbnRzLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUucmVzdW1lID0gZnVuY3Rpb24gcmVzdW1lKCkge1xuICAgIHRoaXMucGF1c2VCbHVyRm9jdXMtLTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogRGlzYWJsZSBlbnRyeSBpbnRvIHRoZSBpbnB1dC5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLmRpc2FibGUgPSBmdW5jdGlvbiBkaXNhYmxlKCkge1xuICAgIHRoaXMuaW5wdXRFbC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFbmFibGUgZW50cnkgaW50byB0aGUgaW5wdXQuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiBlbmFibGUoKSB7XG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQ2xlYXIgdGhlIHZhbHVlLlxuICAgKiBDaGFuZ2VkIHRvIGNsZWFyVmFsdWUgaW4gdjIuMC4wLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbiBjbGVhcigpIHtcbiAgICByZXR1cm4gdGhpcy5jbGVhclZhbHVlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEF1Z21lbnQgZGVmYXVsdCByZW1vdmUgY2FsbCB3LyBoZWxwZXIgY2xlYW51cC5cbiAgICogQHBhcmFtIHtCb29sZWFufSBsZWF2ZUVsZW1lbnQgTGVhdmUgdGhlIGVsZW1lbnQgaW50YWN0LlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuICAgIF9CYXNlQ29tcG9uZW50LnByb3RvdHlwZS5yZW1vdmUuY2FsbCh0aGlzLCBsZWF2ZUVsZW1lbnQpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZSBhIHJlZmVyZW5jZSB0byB0aGUgbmVlZGVkIGVsZW1lbnRzLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZWxcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9jYWNoZUVsZW1lbnRzID0gZnVuY3Rpb24gX2NhY2hlRWxlbWVudHMoZWwpIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy5pbnB1dEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCdbdHlwZT1cInRleHRcIl0sIFt0eXBlPVwiZW1haWxcIl0sIFt0eXBlPVwicGhvbmVcIl0sIHRleHRhcmVhJykgfHwgdGhpcy5fY3JlYXRlRGVmYXVsdElucHV0RWxlbWVudCgpO1xuICAgIHRoaXMucGxhY2Vob2xkZXJFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWlucHV0X19wbGFjZWhvbGRlcicpIHx8IHRoaXMuX2NyZWF0ZURlZmF1bHRQbGFjZWhvbGRlckVsZW1lbnQoKTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgcGFyYW1ldGVycyBmcm9tIHRoZSBlbGVtZW50cy5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9wYXJzZVBhcmFtcyA9IGZ1bmN0aW9uIF9wYXJzZVBhcmFtcygpIHtcblxuICAgIC8vIFN0b3JlIHRoZSB2YWx1ZSBjaGFyYWN0ZXJzXG4gICAgdGhpcy5jaGFyYWN0ZXJzID0gdGhpcy5fcGFyc2VDaGFyYWN0ZXJzKHRoaXMuaW5wdXRFbC52YWx1ZSk7XG5cbiAgICAvLyBTdG9yZSBmb3JtYXRcbiAgICB0aGlzLmZvcm1hdCA9IHRoaXMuX3BhcnNlRm9ybWF0KHRoaXMuZm9ybWF0ID8gdGhpcy5mb3JtYXQgOiB0aGlzLmlucHV0RWwuZ2V0QXR0cmlidXRlKCdkYXRhLXR5cGVhaGVhZC1mb3JtYXQnKSk7XG5cbiAgICAvLyBTdG9yZSB0aGUgb3JpZ2luYWwgcGxhY2Vob2xkZXJcbiAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5wbGFjZWhvbGRlciA/IHRoaXMucGxhY2Vob2xkZXIgOiB0aGlzLmlucHV0RWwuZ2V0QXR0cmlidXRlKCdwbGFjZWhvbGRlcicpLnNwbGl0KCcnKTtcblxuICAgIC8vIEdldCB0aGUgdG90YWwgbnVtYmVyIG9mIGNoYXJhY3RlcnMgd2UgY2FuIGhhdmVcbiAgICB0aGlzLm1heExlbmd0aCA9IHRoaXMuX2dldENoYXJhY3RlcnNBbGxvd2VkQ291bnQodGhpcy5mb3JtYXQpO1xuXG4gICAgdGhpcy5tYXRjaFBsYWNlaG9sZGVyU2l6ZSA9IHRoaXMubWF0Y2hQbGFjZWhvbGRlclNpemUgIT09IG51bGwgPyB0aGlzLm1hdGNoUGxhY2Vob2xkZXJTaXplIDogKDAsIF9wYXJzZUF0dHJpYnV0ZS5ib29sZWFuKSh0aGlzLmlucHV0RWwsICdkYXRhLW1hdGNoLXBsYWNlaG9sZGVyLXNpemUnLCBmYWxzZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIHRoZSBmb3JtYXQgc3RyaW5nIGludG8gYW4gYXJyYXkuXG4gICAqIEBwYXJhbSAge1N0cmluZ30gZm9ybWF0XG4gICAqIEByZXR1cm4ge0FycmF5fVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX3BhcnNlRm9ybWF0ID0gZnVuY3Rpb24gX3BhcnNlRm9ybWF0KGZvcm1hdCkge1xuXG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBsZW4gPSBmb3JtYXQubGVuZ3RoO1xuICAgIHZhciBhcnIgPSBbXTtcbiAgICB2YXIgbGFzdFdhc0VzY2FwZSA9IGZhbHNlO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKGZvcm1hdFtpXSA9PT0gJ1xcXFwnICYmICFsYXN0V2FzRXNjYXBlKSB7XG4gICAgICAgIGxhc3RXYXNFc2NhcGUgPSB0cnVlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXJyLnB1c2goKGxhc3RXYXNFc2NhcGUgPyAnXFxcXCcgOiAnJykgKyBmb3JtYXRbaV0pO1xuICAgICAgICBsYXN0V2FzRXNjYXBlID0gZmFsc2U7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGFycjtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgdGhlIGNoYXJhY3RlcnMgc3RyaW5nIGludG8gYW4gYXJyYXksIGlnbm9yaW5nIGNoYXJhY3RlcnMgd2hpY2ggZG9uJ3RcbiAgICogbWF0Y2ggdGhlIGZvcm1hdCByZXF1aXJlbWVudHMuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBjaGFyYWN0ZXJzXG4gICAqIEByZXR1cm4ge0FycmF5fVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX3BhcnNlQ2hhcmFjdGVycyA9IGZ1bmN0aW9uIF9wYXJzZUNoYXJhY3RlcnMoY2hhcmFjdGVycykge1xuXG4gICAgdmFyIGNoYXJzID0gY2hhcmFjdGVycy5zcGxpdCgnJyk7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBsZW4gPSBjaGFyYWN0ZXJzLmxlbmd0aDtcbiAgICB2YXIgcmVnZXhlcyA9IFtdO1xuICAgIHZhciBhcnIgPSBbXTtcblxuICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcblxuICAgICAgLy8gVHJ5IHRvIGJ1aWxkIGEgcmVnZXggZm9yIHRoaXMgZm9ybWF0IGNoYXJhY3Rlci5cbiAgICAgIHRyeSB7XG4gICAgICAgIC8vIE1ha2Ugc3VyZSB0aGlzIGZvcm1hdCBzdGFydHMgd2l0aCBhbiBlc2NhcGUgY2hhcmFjdGVyLlxuICAgICAgICByZWdleGVzW2ldID0gdGhpcy5mb3JtYXRbaV1bMF0gPT09ICdcXFxcJyA/IG5ldyBSZWdFeHAodGhpcy5mb3JtYXRbaV0pIDogbnVsbDtcbiAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAvL1xuXG5cbiAgICAgIC8vIElmIHdlIHdlcmUgYWJsZSB0byBjcmVhdGUgYSByZWdleCBhbmQgb3VyIGNoYXIgcGFzc2VzLCBhZGQgaXQgdG8gdGhlIGFycmF5XG4gICAgICAvLyBvZiBjaGFyYWN0ZXJzIHRvIHJldHVybi5cbiAgICAgIGlmIChyZWdleGVzW2ldICYmIHJlZ2V4ZXNbaV0uZXhlYyhjaGFyc1tpXSkpIHtcbiAgICAgICAgYXJyLnB1c2goY2hhcnNbaV0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhcnI7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSB0aGUgZGVmYXVsdCBpbnB1dCBlbGVtZW50LlxuICAgKiBAcmV0dXJuIHtFbGVtZW50fVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2NyZWF0ZURlZmF1bHRJbnB1dEVsZW1lbnQgPSBmdW5jdGlvbiBfY3JlYXRlRGVmYXVsdElucHV0RWxlbWVudCgpIHtcblxuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7XG4gICAgZWwuY2xhc3NOYW1lID0gJ3NwYXJrLWlucHV0X19maWVsZCc7XG4gICAgZWwuc2V0QXR0cmlidXRlKCdkYXRhLXR5cGVhaGVhZCcsICcnKTtcbiAgICBlbC5zZXRBdHRyaWJ1dGUoJ3R5cGUnLCAndGVsJyk7XG5cbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKGVsKTtcblxuICAgIHJldHVybiBlbDtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIHRoZSBkZWZhdWx0IGlucHV0IGVsZW1lbnQuXG4gICAqIEByZXR1cm4ge0VsZW1lbnR9XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fY3JlYXRlRGVmYXVsdFBsYWNlaG9sZGVyRWxlbWVudCA9IGZ1bmN0aW9uIF9jcmVhdGVEZWZhdWx0UGxhY2Vob2xkZXJFbGVtZW50KCkge1xuICAgIHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICBlbC5jbGFzc05hbWUgPSAnc3BhcmstaW5wdXRfX3BsYWNlaG9sZGVyJztcbiAgICB0aGlzLmVsLmFwcGVuZENoaWxkKGVsKTtcbiAgICByZXR1cm4gZWw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgbWF4aW11bSBudW1iZXIgb2YgY2hhcmFjdGVycyBhbGxvd2VkLlxuICAgKiBAcGFyYW0ge0FycmF5fSBmb3JtYXRcbiAgICogQHJldHVybiB7TnVtYmVyfVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENoYXJhY3RlcnNBbGxvd2VkQ291bnQgPSBmdW5jdGlvbiBfZ2V0Q2hhcmFjdGVyc0FsbG93ZWRDb3VudChmb3JtYXQpIHtcblxuICAgIHZhciBpID0gMDtcbiAgICB2YXIgbGVuID0gZm9ybWF0Lmxlbmd0aDtcbiAgICB2YXIgYWxsb3dlZCA9IDA7XG5cbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBpZiAoZm9ybWF0W2ldID09PSAnXFxcXGQnKSB7XG4gICAgICAgIGFsbG93ZWQrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYWxsb3dlZDtcbiAgfTtcblxuICAvKipcbiAgICogQ3JlYXRlIGJvdW5kIHZlcnNpb25zIG9mIGV2ZW50IGxpc3RlbmVyIGNhbGxiYWNrcyBhbmQgc3RvcmUgdGhlbS5cbiAgICogT3RoZXJ3aXNlIHdlIGNhbid0IHVuYmluZCBmcm9tIHRoZXNlIGV2ZW50cyBsYXRlciBiZWNhdXNlIHRoZVxuICAgKiBmdW5jdGlvbiBzaWduYXR1cmVzIHdvbid0IG1hdGNoLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzID0gZnVuY3Rpb24gX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzKCkge1xuICAgIHRoaXMuX29uS2V5ZG93bkJvdW5kID0gdGhpcy5fb25LZXlkb3duLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25LZXlwcmVzc0JvdW5kID0gdGhpcy5fb25LZXlwcmVzcy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uRm9jdXNCb3VuZCA9IHRoaXMuX29uRm9jdXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkJsdXJCb3VuZCA9IHRoaXMuX29uQmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uUGxhY2Vob2xkZXJDbGlja0JvdW5kID0gdGhpcy5fb25QbGFjZWhvbGRlckNsaWNrLmJpbmQodGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBldmVudCBsaXN0ZW5lcnMgdG8ga2V5cHJlc3MgYW5kIGtleWRvd24uXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleWRvd25Cb3VuZCwgZmFsc2UpO1xuICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIHRoaXMuX29uS2V5cHJlc3NCb3VuZCwgZmFsc2UpO1xuICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXNCb3VuZCwgZmFsc2UpO1xuICAgIHRoaXMucGxhY2Vob2xkZXJFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uUGxhY2Vob2xkZXJDbGlja0JvdW5kLCBmYWxzZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBldmVudCBsaXN0ZW5lcnMgdG8ga2V5cHJlc3MgYW5kIGtleWRvd24uXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XG5cbiAgICB0aGlzLmlucHV0RWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5ZG93bkJvdW5kKTtcbiAgICB0aGlzLmlucHV0RWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCB0aGlzLl9vbktleXByZXNzQm91bmQpO1xuICAgIHRoaXMuaW5wdXRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXNCb3VuZCk7XG4gICAgdGhpcy5wbGFjZWhvbGRlckVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25QbGFjZWhvbGRlckNsaWNrQm91bmQpO1xuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0IGluIHRoZSBlbGVtZW50LlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBpbmRleFxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENhcmV0U3RhcnQgPSBmdW5jdGlvbiBfZ2V0Q2FyZXRTdGFydCgpIHtcblxuICAgIHJldHVybiB0aGlzLl9tYWludGFpbkZvY3VzKGZ1bmN0aW9uICgpIHtcblxuICAgICAgdmFyIGNhcmV0UG9zaXRpb247XG5cbiAgICAgIC8vIElFIHN1cHBvcnRcbiAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgIHZhciBzZWwgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgc2VsLm1vdmVTdGFydCgnY2hhcmFjdGVyJywgLXRoaXMuaW5wdXRFbC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICBjYXJldFBvc2l0aW9uID0gc2VsLnRleHQubGVuZ3RoO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQgfHwgdGhpcy5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0ID09PSAwKSB7XG4gICAgICAgIGNhcmV0UG9zaXRpb24gPSB0aGlzLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQ7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBjYXJldFBvc2l0aW9uO1xuICAgIH0pO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGVuZCBwb3NpdGlvbiBvZiB0aGUgY2FyZXQgaW4gdGhlIGVsZW1lbnQuXG4gICAqIEByZXR1cm4ge051bWJlcn0gVGhlIGluZGV4XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fZ2V0Q2FyZXRFbmQgPSBmdW5jdGlvbiBfZ2V0Q2FyZXRFbmQoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fbWFpbnRhaW5Gb2N1cyhmdW5jdGlvbiAoKSB7XG5cbiAgICAgIHZhciBjYXJldFBvc2l0aW9uO1xuXG4gICAgICAvLyBJRSBzdXBwb3J0XG4gICAgICBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICB2YXIgc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHNlbC5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC10aGlzLmlucHV0RWwudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgY2FyZXRQb3NpdGlvbiA9IHNlbC50ZXh0Lmxlbmd0aDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbnB1dEVsLnNlbGVjdGlvbkVuZCB8fCB0aGlzLmlucHV0RWwuc2VsZWN0aW9uRW5kID09PSAwKSB7XG4gICAgICAgIGNhcmV0UG9zaXRpb24gPSB0aGlzLmlucHV0RWwuc2VsZWN0aW9uRW5kO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2FyZXRQb3NpdGlvbjtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogSXMgdGhlIGNhcmV0IGF0IHRoZSBlbmQgb2YgdGhlIGlucHV0P1xuICAgKiBAcmV0dXJuIHtCb29sZWFufVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2NhcmV0SXNBdEVuZCA9IGZ1bmN0aW9uIF9jYXJldElzQXRFbmQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldENhcmV0U3RhcnQoKSA9PT0gdGhpcy5tYXhMZW5ndGg7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0IGluIHRoZSBlbGVtZW50LlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBpbmRleFxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX3NldENhcmV0UG9zaXRpb24gPSBmdW5jdGlvbiBfc2V0Q2FyZXRQb3NpdGlvbihwb3MpIHtcblxuICAgIHJldHVybiB0aGlzLl9tYWludGFpbkZvY3VzKGZ1bmN0aW9uICgpIHtcblxuICAgICAgLy8gSUUgc3VwcG9ydFxuICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuICAgICAgICB0aGlzLmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgdmFyIHNlbCA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgICAgICBzZWwubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCAtdGhpcy5pbnB1dEVsLnZhbHVlLmxlbmd0aCk7XG4gICAgICAgIHNlbC5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIHBvcyk7XG4gICAgICAgIHNlbC5tb3ZlRW5kKCdjaGFyYWN0ZXInLCAwKTtcbiAgICAgICAgc2VsLnNlbGVjdCgpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQgfHwgdGhpcy5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0ID09PSAwKSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5zZWxlY3Rpb25TdGFydCA9IHBvcztcbiAgICAgICAgdGhpcy5pbnB1dEVsLnNlbGVjdGlvbkVuZCA9IHBvcztcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgY2FyZXQgdHJhbnNsYXRlZCB0byB0aGUgY29ycmVzcG9uZGluZyBpbmRleCBpbiB0aGVcbiAgICogY2hhcmFjdGVycyBhcnJheS4gVGhpcyBtZWFucyBpZ25vcmluZyBmb3JtYXQgY2hhcmFjdGVycy5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IHBvc1xuICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fZ2V0Q2FyZXRQb3NpdGlvblRyYW5zbGF0ZWQgPSBmdW5jdGlvbiBfZ2V0Q2FyZXRQb3NpdGlvblRyYW5zbGF0ZWQocG9zKSB7XG5cbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIHNraXBDb3VudCA9IDA7XG5cbiAgICBmb3IgKDsgaSA8IHBvczsgaSsrKSB7XG5cbiAgICAgIC8vIENvdW50IG5vbi1udW1iZXJzIGFzIGEgc2tpcC5cbiAgICAgIC8vIEB0b2RvOiB0aGlzIG5lZWRzIHRvIHdvcmsgd2l0aCBtb3JlIHRoYW4gbnVtYmVycy5cbiAgICAgIGlmICh0aGlzLmZvcm1hdFtpXSAhPT0gJ1xcXFxkJykge1xuICAgICAgICBza2lwQ291bnQrKztcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gcG9zIC0gc2tpcENvdW50O1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHN0YXJ0aW5nIHBvc2l0aW9uIG9mIHRoZSBjYXJldCB0cmFuc2xhdGVkLlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fZ2V0Q2FyZXRTdGFydFRyYW5zbGF0ZWQgPSBmdW5jdGlvbiBfZ2V0Q2FyZXRTdGFydFRyYW5zbGF0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkKHRoaXMuX2dldENhcmV0U3RhcnQoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgZW5kaW5nIHBvc2l0aW9uIG9mIHRoZSBjYXJldCB0cmFuc2xhdGVkLlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fZ2V0Q2FyZXRFbmRUcmFuc2xhdGVkID0gZnVuY3Rpb24gX2dldENhcmV0RW5kVHJhbnNsYXRlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5fZ2V0Q2FyZXRQb3NpdGlvblRyYW5zbGF0ZWQodGhpcy5fZ2V0Q2FyZXRFbmQoKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0IHRyYW5zbGF0ZWQgdG8gdGhlIGNvcnJlc3BvbmRpbmcgaW5kZXggaW4gdGhlXG4gICAqIGNoYXJhY3RlcnMgYXJyYXkuIFRoaXMgbWVhbnMgaWdub3JpbmcgZm9ybWF0IGNoYXJhY3RlcnMuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBwb3NcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9zZXRDYXJldFBvc2l0aW9uVHJhbnNsYXRlZCA9IGZ1bmN0aW9uIF9zZXRDYXJldFBvc2l0aW9uVHJhbnNsYXRlZChwb3MpIHtcblxuICAgIHZhciBpID0gMDtcbiAgICB2YXIgc2tpcENvdW50ID0gMDtcblxuICAgIGZvciAoOyBpIDwgcG9zICsgc2tpcENvdW50OyBpKyspIHtcblxuICAgICAgLy8gQ291bnQgbm9uLW51bWJlcnMgYXMgYSBza2lwLlxuICAgICAgLy8gQHRvZG86IHRoaXMgbmVlZHMgdG8gd29yayB3aXRoIG1vcmUgdGhhbiBudW1iZXJzLlxuICAgICAgaWYgKHRoaXMuZm9ybWF0W2ldICE9PSB1bmRlZmluZWQgJiYgdGhpcy5mb3JtYXRbaV0gIT09ICdcXFxcZCcpIHtcbiAgICAgICAgc2tpcENvdW50Kys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5fc2V0Q2FyZXRQb3NpdGlvbihwb3MgKyBza2lwQ291bnQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIHRoZSBjYXJldCBwb3NpdGlvblxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGRpcmVjdGlvbiBUaGUgZGlyZWN0aW9uIG9mIHRoZSBtb3ZlbWVudFxuICAgKiBAcmV0dXJuIHtCb29sZWFufSAgICAgICAgICAgV2FzIHRoZSBjYXJldCBhY3R1YWxseSBtb3ZlZD9cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9tb3ZlQ2FyZXQgPSBmdW5jdGlvbiBfbW92ZUNhcmV0KGRpcmVjdGlvbikge1xuXG4gICAgdmFyIGN1clBvcyA9IHRoaXMuX2dldENhcmV0U3RhcnQoKTtcblxuICAgIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0Jykge1xuICAgICAgdGhpcy5fc2V0Q2FyZXRQb3NpdGlvbihjdXJQb3MgLSAxKTtcbiAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3JpZ2h0Jykge1xuICAgICAgdGhpcy5fc2V0Q2FyZXRQb3NpdGlvbihjdXJQb3MgKyAxKTtcbiAgICB9XG5cbiAgICByZXR1cm4gY3VyUG9zICE9PSB0aGlzLl9nZXRDYXJldFN0YXJ0KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVtcHR5IHRoZSBpbnB1dCB3aGVuIHdlIG9ubHkgaGF2ZSBwbGFjZWhvbGRlcnMuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fZW1wdHlXaGVuT25seVBsYWNlaG9sZGVycyA9IGZ1bmN0aW9uIF9lbXB0eVdoZW5Pbmx5UGxhY2Vob2xkZXJzKCkge1xuICAgIGlmICghdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCkge1xuICAgICAgdGhpcy5jbGVhcigpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogUnVuIGEgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBtYXkgY2hhbmdlIHRoZSBmb2N1cyBvZiB0aGUgZG9jdW1lbnQsIGJ1dFxuICAgKiBtYWtlIHN1cmUgZm9jdXMgZ29lcyBiYWNrIHRvIHdoZXJlIGl0IG5lZWRzIHRvIGJlLiBBbHNvLCBzZXQgdGhlIHN0YXRlXG4gICAqIHNvIHRoYXQgYmx1ci9mb2N1cyBldmVudHMgZG9uJ3QgZmlyZSBmcm9tIHRoaXMgaW5zdGFuY2UuXG4gICAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fbWFpbnRhaW5Gb2N1cyA9IGZ1bmN0aW9uIF9tYWludGFpbkZvY3VzKGNhbGxiYWNrKSB7XG5cbiAgICB0aGlzLnBhdXNlKCk7XG5cbiAgICB2YXIgb3JpZ2luYWxBY3RpdmVFbGVtZW50ID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDtcblxuICAgIC8vRm9yIElFXG4gICAgaWYgKCFvcmlnaW5hbEFjdGl2ZUVsZW1lbnQpIHtcbiAgICAgIG9yaWdpbmFsQWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmJvZHk7XG4gICAgfVxuXG4gICAgdmFyIG91dHB1dCA9IChjYWxsYmFjayB8fCBub29wKS5jYWxsKHRoaXMpO1xuXG4gICAgLy8gSWYgd2UgZGlkbid0IGhhdmUgZm9jdXMsIGdvIGJhY2sgdG8gZm9jdXNpbmcgb24gdGhlIG9yaWdpbmFsXG4gICAgaWYgKG9yaWdpbmFsQWN0aXZlRWxlbWVudCAhPT0gdGhpcy5pbnB1dEVsKSB7XG4gICAgICB0aGlzLmlucHV0RWwuYmx1cigpO1xuICAgICAgb3JpZ2luYWxBY3RpdmVFbGVtZW50ID8gb3JpZ2luYWxBY3RpdmVFbGVtZW50LmZvY3VzKCkgOiBudWxsO1xuICAgIH1cblxuICAgIHRoaXMucmVzdW1lKCk7XG5cbiAgICByZXR1cm4gb3V0cHV0O1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIHdpZHRoIG9mIHRoZSB0eXBlYWhlYWQuIElmIHdlIHNob3VsZCBiZSBtYXRjaGluZyB0aGUgd2lkdGhcbiAgICogb2YgdGhlIHBsYWNlaG9sZGVyLCBkbyBzby4gT3RoZXJ3aXNlLCB0YWtlIG5vIGFjdGlvbi5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl91cGRhdGVXaWR0aCA9IGZ1bmN0aW9uIF91cGRhdGVXaWR0aCgpIHtcblxuICAgIGlmICh0aGlzLm1hdGNoUGxhY2Vob2xkZXJTaXplKSB7XG4gICAgICB0aGlzLnBsYWNlaG9sZGVyRWwuc3R5bGUud2lkdGggPSAnYXV0byc7XG4gICAgICAvLyBBZGQgMnB4IHRvIGFjY291bnQgZm9yIGNhcmV0IHdpZHRoIGluIElFLi4uXG4gICAgICB0aGlzLmlucHV0RWwuc3R5bGUud2lkdGggPSAnYXV0byc7XG4gICAgICB0aGlzLmlucHV0RWwuc3R5bGUud2lkdGggPSB0aGlzLnBsYWNlaG9sZGVyRWwub2Zmc2V0V2lkdGggKyAyICsgJ3B4JztcbiAgICAgIHRoaXMucGxhY2Vob2xkZXJFbC5zdHlsZS53aWR0aCA9ICcnO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogTGlzdGVuIGZvciBkZWxldGUgYW5kIGFycm93cy5cbiAgICogQHBhcmFtICB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25LZXlkb3duID0gZnVuY3Rpb24gX29uS2V5ZG93bihlKSB7XG5cbiAgICB2YXIgY29kZSA9IGUua2V5Q29kZSB8fCBlLndoaWNoO1xuXG4gICAgaWYgKGNvZGUgPT09IHRoaXMucGFzdGVDb2RlICYmIChlLm1ldGFLZXkgfHwgZS5jdHJsS2V5KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGlmIChjb2RlID09PSB0aGlzLmFjdGlvbkNvZGVzLkJBQ0tTUEFDRSkge1xuICAgICAgdGhpcy5yZW1vdmVDaGFyYWN0ZXJBdENhcmV0KC0xKTtcbiAgICAgIHRoaXMuX29uQmFja3NwYWNlKCk7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSBlbHNlIGlmIChjb2RlID09PSB0aGlzLmFjdGlvbkNvZGVzLkRFTEVURSkge1xuICAgICAgdGhpcy5yZW1vdmVDaGFyYWN0ZXJBdENhcmV0KDApO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gdGhpcy5hY3Rpb25Db2Rlcy5MRUZUKSB7XG4gICAgICBpZiAoIXRoaXMuX2dldENhcmV0U3RhcnQoKSkge1xuICAgICAgICAodGhpcy5vbkJhY2tzcGFjZSB8fCBub29wKSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gdGhpcy5hY3Rpb25Db2Rlcy5SSUdIVCkge1xuICAgICAgaWYgKHRoaXMuX2dldENhcmV0U3RhcnQoKSA9PT0gdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCkge1xuICAgICAgICAodGhpcy5vbkVuZCB8fCBub29wKSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodGhpcy5pZ25vcmVDb2Rlcy5pbmRleE9mKGNvZGUpID09PSAtMSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgLy8gQWNjb3VudCBmb3IgTnVtcGFkIGtleXNcbiAgICAgICAgaWYgKGNvZGUgPj0gOTYgJiYgY29kZSA8PSAxMDUpIHtcbiAgICAgICAgICBjb2RlIC09IDQ4O1xuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5hZGRDaGFyYWN0ZXJBdENhcmV0KFN0cmluZy5mcm9tQ2hhckNvZGUoY29kZSkpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUga2V5cHJlc3MgZXZlbnQgZmlyZXMsIHZhbGlkYXRlLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX29uS2V5cHJlc3MgPSBmdW5jdGlvbiBfb25LZXlwcmVzcyhlKSB7XG4gICAgdmFyIGNvZGUgPSBlLmtleUNvZGUgfHwgZS53aGljaDtcblxuICAgIGlmICh0aGlzLmlnbm9yZUNvZGVzLmluZGV4T2YoY29kZSkgPT09IC0xKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmNoYXJhY3RlcnMgPSB0aGlzLl9wYXJzZUNoYXJhY3RlcnModGhpcy5pbnB1dEVsLnZhbHVlKTtcbiAgICAgIHRoaXMucnVuKCk7XG4gICAgICAodGhpcy5vbkNoYW5nZSB8fCBub29wKSh0aGlzLmdldFZhbHVlKCksIHRoaXMpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgaW5wdXQgZXZlbnQgZmlyZXMsIHZhbGlkYXRlLiBUaGlzIGhhcHBlbnNcbiAgICogd2l0aCBhIGNvcHkrcGFzdGUuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25JbnB1dCA9IGZ1bmN0aW9uIF9vbklucHV0KGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgdGhpcy5jaGFyYWN0ZXJzID0gdGhpcy5fcGFyc2VDaGFyYWN0ZXJzKHRoaXMuaW5wdXRFbC52YWx1ZSk7XG4gICAgdGhpcy5ydW4oKTtcbiAgICAodGhpcy5vbklucHV0IHx8IG5vb3ApKHRoaXMuZ2V0VmFsdWUoKSwgdGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gd2UgZm9jdXMsIHJ1biB0aGUgZm9ybWF0dGluZy5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9vbkZvY3VzID0gZnVuY3Rpb24gX29uRm9jdXMoKSB7XG5cbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1ckJvdW5kKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIHRoaXMuX29uQmx1ckJvdW5kLCBmYWxzZSk7XG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG4gICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCwgZmFsc2UpO1xuXG4gICAgaWYgKHRoaXMuaXNGb2N1c2VkIHx8IHRoaXMucGF1c2VCbHVyRm9jdXMgfHwgdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcblxuICAgIHRoaXMucnVuKCk7XG4gICAgKHRoaXMub25Gb2N1cyB8fCBub29wKSh0aGlzLmdldFZhbHVlKCksIHRoaXMpO1xuICAgIHRoaXMuaXNGb2N1c2VkID0gdHJ1ZTtcbiAgICB0aGlzLl9vbGRWYWwgPSB0aGlzLmlucHV0RWwudmFsdWU7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gd2UgYmx1ciwgaWYgd2UgaGF2ZSBubyBjaGFyYWN0ZXJzLCByZW1vdmUgdGhlIHBsYWNlaG9sZGVycy5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9vbkJsdXIgPSBmdW5jdGlvbiBfb25CbHVyKCkge1xuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG5cbiAgICB0aGlzLmlzRm9jdXNlZCA9IGZhbHNlO1xuXG4gICAgaWYgKHRoaXMucGF1c2VCbHVyRm9jdXMgfHwgdGhpcy5pc1J1bm5pbmcpIHJldHVybjtcblxuICAgIHRoaXMuX2VtcHR5V2hlbk9ubHlQbGFjZWhvbGRlcnMoKTtcblxuICAgIGlmICh0aGlzLl9vbGRWYWwgIT09IHRoaXMuaW5wdXRFbC52YWx1ZSkge1xuICAgICAgKDAsIF90cmlnZ2VyRXZlbnQyLmRlZmF1bHQpKHRoaXMuaW5wdXRFbCwgJ2NoYW5nZScpO1xuICAgIH1cblxuICAgICh0aGlzLm9uQmx1ciB8fCBub29wKSh0aGlzLmdldFZhbHVlKCksIHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSBwbGFjZWhvbGRlciByZWNlaXZlcyBhIGNsaWNrIGV2ZW50LCBmb2N1cyBvbiB0aGUgaW5wdXQuIFRoaXMgaGFwcGVucyBpbiBJRTEwIGZvciBzb21lXG4gICAqIHJlYXNvbiB0aGF0IEkgY2Fubm90IGZ1bGx5IGZhdGhvbSwgYnV0IGl0IGhhcyBzb21ldGhpbmcgdG8gZG8gd2l0aCB0aGUgZXhwbGljaXQgd2lkdGggYmVpbmdcbiAgICogc2V0IG9uIGFuIGVtcHR5IGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25QbGFjZWhvbGRlckNsaWNrID0gZnVuY3Rpb24gX29uUGxhY2Vob2xkZXJDbGljayhlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5pbnB1dEVsLmZvY3VzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gd2UgYmFja3NwYWNlLCBpZiB3ZSBoYXZlIG5vIGNoYXJhY3RlcnMgbGVmdCBsZXQgbGlzdGVuZXJzIGtub3cuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25CYWNrc3BhY2UgPSBmdW5jdGlvbiBfb25CYWNrc3BhY2UoKSB7XG4gICAgaWYgKCF0aGlzLl9nZXRDYXJldFN0YXJ0KCkpICh0aGlzLm9uQmFja3NwYWNlIHx8IG5vb3ApKCk7XG4gIH07XG5cbiAgcmV0dXJuIFR5cGVhaGVhZDtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5UeXBlYWhlYWQucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsnZm9ybWF0JywgJ3BsYWNlaG9sZGVyJywgJ21hdGNoUGxhY2Vob2xkZXJTaXplJywgJ29uQ2hhbmdlJywgJ29uRm9jdXMnLCAnb25CbHVyJywgJ29uSW5wdXQnLCAnb25CYWNrc3BhY2UnLCAnb25FbmQnXTtcblxuLyoqXG4gKiBEZWZhdWx0IHZhbHVlcyBmb3IgaW50ZXJuYWwgcHJvcGVydGllcyB3ZSB3aWxsIGJlIHNldHRpbmcuXG4gKiBUaGVzZSBhcmUgc2V0IG9uIGVhY2ggY29uc3RydWN0aW9uIHNvIHdlIGRvbid0IGxlYWsgcHJvcGVydGllc1xuICogaW50byB0aGUgcHJvdG90eXBlIGNoYWluLlxuICogQHR5cGUge09iamVjdH1cbiAqL1xuVHlwZWFoZWFkLnByb3RvdHlwZS5kZWZhdWx0cyA9IHtcbiAgZWw6IG51bGwsXG4gIGlucHV0RWw6IG51bGwsXG4gIHBsYWNlaG9sZGVyRWw6IG51bGwsXG4gIHBsYWNlaG9sZGVyOiBudWxsLFxuICBjaGFyYWN0ZXJzOiBudWxsLFxuICBmb3JtYXQ6IG51bGwsXG4gIGlnbm9yZUNvZGVzOiBbOSwgLy8gVGFiXG4gIDE2LCAvLyBTaGlmdFxuICAxNywgLy8gQ3RybFxuICAxOCwgLy8gQWx0XG4gIDIwLCAvLyBDQVBTXG4gIDkxLCAvLyBNZXRhXG4gIDkzLCAvLyBBbHRcbiAgMTEyLCAxMTMsIDExNCwgMTE1LCAxMTYsIDExNywgMTE4LCAxMTksIDEyMCwgMTIxLCAxMjIsIDEyMyAvLyBGMS1GMTJcbiAgXSxcbiAgYWN0aW9uQ29kZXM6IHtcbiAgICBCQUNLU1BBQ0U6IDgsXG4gICAgREVMRVRFOiA0NixcbiAgICBMRUZUOiAzNyxcbiAgICBSSUdIVDogMzlcbiAgfSxcbiAgcGFzdGVDb2RlOiA4NiwgLy8gdlxuICBwYXVzZUJsdXJGb2N1czogMCxcbiAgbWF0Y2hQbGFjZWhvbGRlclNpemU6IG51bGwsXG4gIG1heExlbmd0aDogbnVsbCxcbiAgaXNGb2N1c2VkOiBmYWxzZSxcbiAgaXNSdW5uaW5nOiBmYWxzZSxcbiAgb25DaGFuZ2U6IG51bGwsXG4gIG9uRm9jdXM6IG51bGwsXG4gIG9uQmx1cjogbnVsbCxcbiAgb25JbnB1dDogbnVsbCxcbiAgb25CYWNrc3BhY2U6IG51bGwsXG4gIG9uRW5kOiBudWxsLFxuICBfYXRFbmQ6IGZhbHNlLFxuICBfb2xkVmFsOiBudWxsLFxuICBfb25LZXlkb3duQm91bmQ6IG51bGwsXG4gIF9vbktleXByZXNzQm91bmQ6IG51bGwsXG4gIF9vbkZvY3VzQm91bmQ6IG51bGwsXG4gIF9vbkJsdXJCb3VuZDogbnVsbCxcbiAgX29uUGxhY2Vob2xkZXJDbGlja0JvdW5kOiBudWxsXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUeXBlYWhlYWQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXR5cGVhaGVhZC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBQYXJzZSBET00gYXR0cmlidXRlc1xuICogR2l2ZW4gYW4gZWxlbWVudCBhbmQgYW4gYXR0cmlidXRlIG5hbWUsIHBhcnNlIHRoYXQgYXR0cmlidXRlXG4gKiBpZiBpdCBleGlzdHMgb3IgcmV0dXJuIGEgZGVmYXVsdC5cbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvZG9tL3BhcnNlLWF0dHJpYnV0ZS5qc1xuICovXG5cbi8qKlxuICogR2V0IHRoZSBib29sZWFuIHZhbHVlIG9mIGFuIGF0dHJpYnV0ZSBvbiBhbiBlbGVtZW50LFxuICogZmFsbGluZyBiYWNrIHRvIHRoZSBkZWZhdWx0IHZhbHVlLlxuICogQHBhcmFtICB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSAge1N0cmluZ30gbmFtZVxuICogQHBhcmFtICB7Qm9vbGVhbn0gZGVmXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICovXG5mdW5jdGlvbiBib29sZWFuKGVsLCBuYW1lLCBkZWYpIHtcbiAgdmFyIHZhbCA9IGVsLmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgaWYgKHZhbCA9PT0gbnVsbCkgcmV0dXJuIGRlZjtcbiAgcmV0dXJuIHZhbCA9PT0gJ3RydWUnIHx8IHZhbCA9PT0gJycgPyB0cnVlIDogZmFsc2U7XG59XG5cbi8qKlxuICogR2V0IHRoZSBudW1lcmljIHZhbHVlIG9mIGFuIGF0dHJpYnV0ZSBvbiBhbiBlbGVtZW50LFxuICogZmFsbGluZyBiYWNrIHRvIHRoZSBkZWZhdWx0IHZhbHVlLlxuICogQHBhcmFtICB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSAge1N0cmluZ30gbmFtZVxuICogQHBhcmFtICB7Qm9vbGVhbn0gZGVmXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICovXG5mdW5jdGlvbiBudW1iZXIoZWwsIG5hbWUsIGRlZikge1xuICB2YXIgdmFsID0gZWwuZ2V0QXR0cmlidXRlKG5hbWUpO1xuICBpZiAodmFsID09PSBudWxsKSByZXR1cm4gZGVmO1xuICByZXR1cm4gcGFyc2VJbnQodmFsLCAxMCk7XG59XG5cbi8qKlxuICogR2V0IHRoZSBib29sZWFuIHZhbHVlIG9mIGFuIGF0dHJpYnV0ZSBvbiBhbiBlbGVtZW50LFxuICogZmFsbGluZyBiYWNrIHRvIHRoZSBkZWZhdWx0IHZhbHVlLlxuICogQHBhcmFtICB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSAge1N0cmluZ30gbmFtZVxuICogQHBhcmFtICB7Qm9vbGVhbn0gZGVmXG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICovXG5mdW5jdGlvbiBzdHJpbmcoZWwsIG5hbWUsIGRlZikge1xuICB2YXIgdmFsID0gZWwuZ2V0QXR0cmlidXRlKG5hbWUpO1xuICBpZiAodmFsID09PSBudWxsKSByZXR1cm4gZGVmO1xuICByZXR1cm4gdmFsO1xufVxuXG5leHBvcnRzLmJvb2xlYW4gPSBib29sZWFuO1xuZXhwb3J0cy5udW1iZXIgPSBudW1iZXI7XG5leHBvcnRzLnN0cmluZyA9IHN0cmluZztcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhcnNlLWF0dHJpYnV0ZS5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBUcmlnZ2VyIEV2ZW50XG4gKiBUcmlnZ2VyIGEgRE9NIGV2ZW50IG9uIGFuIGVsZW1lbnQuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvZG9tL3RyaWdnZXItZXZlbnQuanNcbiAqL1xuZnVuY3Rpb24gdHJpZ2dlckV2ZW50KGVsLCBuYW1lKSB7XG5cbiAgdmFyIGV2ZW50ID0gdm9pZCAwO1xuXG4gIGlmIChkb2N1bWVudC5jcmVhdGVFdmVudCkge1xuICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0hUTUxFdmVudHMnKTtcbiAgICBldmVudC5pbml0RXZlbnQobmFtZSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgZXZlbnQuZXZlbnROYW1lID0gbmFtZTtcbiAgICBlbC5kaXNwYXRjaEV2ZW50KGV2ZW50KTtcbiAgfSBlbHNlIHtcbiAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50T2JqZWN0KCk7XG4gICAgZXZlbnQuZXZlbnRUeXBlID0gbmFtZTtcbiAgICBldmVudC5ldmVudE5hbWUgPSBuYW1lO1xuICAgIGVsLmZpcmVFdmVudCgnb24nICsgZXZlbnQuZXZlbnRUeXBlLCBldmVudCk7XG4gIH1cbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gdHJpZ2dlckV2ZW50O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cmlnZ2VyLWV2ZW50LmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIEVhY2hcbiAqIEFwcGx5IGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYSBsaXN0IG9mIGFueSBraW5kOiBBcnJheSwgTm9kZUxpc3QsIEhUTUxDb2xsZWN0aW9uIG9yIE9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge0FycmF5fE5vZGVMaXN0fEhUTUxDb2xsZWN0aW9ufE9iamVjdH0gbGlzdFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2JcbiAqXG4gKiBAZXhhbXBsZVxuICogZWFjaChbXSwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZHJlbiwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZE5vZGVzLCBjYWxsYmFjayk7XG4gKiBlYWNoKHt9LCBjYWxsYmFjayk7XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvZWFjaC5qc1xuICovXG5mdW5jdGlvbiBlYWNoKGxpc3QsIGNiKSB7XG5cbiAgaWYgKCFsaXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGludm9rZSBgZWFjaGAgd2l0aG91dCBhIGNhbGxiYWNrIScpO1xuICB9XG5cbiAgdmFyIGkgPSAwO1xuICB2YXIgbGVuID0gbGlzdC5sZW5ndGg7XG5cbiAgLy8gT2JqZWN0XG4gIGlmIChsZW4gPT09IHVuZGVmaW5lZCkge1xuICAgIGZvciAoaSBpbiBsaXN0KSB7XG4gICAgICBpZiAoaSAhPT0gJ3Byb3RvdHlwZScgJiYgbGlzdC5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBjYihpLCBsaXN0W2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gQXJyYXktbGlrZVxuICBlbHNlIHtcbiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSk7XG4gICAgICB9XG4gICAgfVxufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBlYWNoO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lYWNoLmpzLm1hcFxuIl19"}