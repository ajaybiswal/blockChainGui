{"version":3,"sources":["js/dist/components/node_modules/browser-pack/_prelude.js","js/dist/components/js/dist/components/base.js","js/dist/components/js/dist/components/expand.js","js/dist/components/js/dist/components/table.js","js/dist/components/js/dist/helpers/animation/height.js","js/dist/components/js/dist/helpers/dom/add-class.js","js/dist/components/js/dist/helpers/dom/has-class.js","js/dist/components/js/dist/helpers/dom/outer-height.js","js/dist/components/js/dist/helpers/dom/remove-class.js","js/dist/components/js/dist/helpers/dom/toggle-class.js","js/dist/components/js/dist/helpers/form/form-data.js","js/dist/components/js/dist/helpers/form/set-caret.js","js/dist/components/js/dist/helpers/traversal/get-index.js","js/dist/components/js/dist/helpers/traversal/get-parent.js","js/dist/components/js/dist/helpers/traversal/get-sibling-after.js","js/dist/components/js/dist/helpers/traversal/get-sibling-before.js","js/dist/components/js/dist/helpers/traversal/matches.js","js/dist/components/js/dist/helpers/util/each.js","js/dist/components/js/dist/helpers/util/trim.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzzCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"table.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n                                                                                                                                                           * # Base Component\n                                                                                                                                                           * The base class for Spark JS components. This class should never be\n                                                                                                                                                           * instantiated directly.\n                                                                                                                                                           *\n                                                                                                                                                           * @param {Element} el\n                                                                                                                                                           * @param {Object} params\n                                                                                                                                                           *\n                                                                                                                                                           * @module components/base.js\n                                                                                                                                                           */\n\nvar noop = function noop() {};\n\nvar Base = function () {\n\n  /**\n   * Set parameters and cache elements.\n   */\n  function Base(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Base);\n\n    if (params.elRequired && !el) {\n      return;\n    }\n\n    this.setParams(this.defaults || {}, true);\n    this.setParams(params);\n    (this._cacheElements || noop).call(this, el, params);\n    (this._parseParams || noop).call(this);\n  }\n\n  /**\n   * Remove the component from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Base.prototype.remove = function remove(leaveElement) {\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    if (!leaveElement && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n\n    this.unsetParams(this.defaults);\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n\n\n  Base.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    (this._cacheElements || noop).call(this, el || this.el, params);\n    (this._parseParams || noop).call(this);\n\n    if (this._addEventListeners) {\n      this._addEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Set a hash of parameters if they're whitelisted or we're told to force the set.\n   * This is used to set initial values as well as set passed parameters.\n   * @param {Object} params\n   * @param {Boolean} force Force setting even if the param is not whitelisted.\n   */\n\n\n  Base.prototype.setParams = function setParams(params, force) {\n    var _this = this;\n\n    (0, _each2.default)(params, function (k, v) {\n      if (_this._whitelistedParams.indexOf(k) !== -1 || force) {\n        _this[k] = v;\n      }\n    });\n\n    return this;\n  };\n\n  /**\n   * Unset all parameters.\n   * @param {Array|Object} keys\n   * @param {Object} scope The object to unset the params from. Defaults to `this`.\n   */\n\n\n  Base.prototype.unsetParams = function unsetParams(keys, scope) {\n\n    keys = keys instanceof Array ? keys : Object.keys(keys);\n    scope = scope || this;\n    (0, _each2.default)(keys, function (k) {\n      delete scope[k];\n    });\n\n    return this;\n  };\n\n  return Base;\n}();\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nBase.prototype._whitelistedParams = [];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nBase.prototype.defaults = {};\n\nexports.default = Base;\nmodule.exports = exports['default'];\n//# sourceMappingURL=base.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _height = require('../helpers/animation/height');\n\nvar _height2 = _interopRequireDefault(_height);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _getParent = require('../helpers/traversal/get-parent');\n\nvar _getParent2 = _interopRequireDefault(_getParent);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Expand\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Expand and collapse an element.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Expand(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/expand.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nvar Expand = function (_BaseComponent) {\n  _inherits(Expand, _BaseComponent);\n\n  /**\n   * Expand constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Expand(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Expand);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Expand\n   */\n\n\n  Expand.prototype.expand = function expand() {\n\n    (this.onBeforeExpand || noop)();\n\n    (0, _height2.default)({\n      el: this.el,\n      toggleClass: 'expanded',\n      toggleEl: '.spark-expand__content, .spark-panel__content'\n    });\n\n    this.isExpanded = true;\n    this._updateClasses();\n    var e = document.createEvent('Event');\n    e.initEvent('spark.visible-children', true, true);\n    this.el.dispatchEvent(e);\n\n    // If the expand element have input, focus on the first one.\n    if (this.el.querySelector('input')) {\n      this.el.querySelector('input').focus();\n    }\n\n    (this.onAfterExpand || noop)();\n\n    return this;\n  };\n\n  /**\n   * Collapse\n   */\n\n\n  Expand.prototype.collapse = function collapse() {\n\n    (this.onBeforeCollapse || noop)();\n\n    (0, _height2.default)({\n      el: this.el,\n      toggleEl: '.spark-expand__content, .spark-panel__content',\n      toggleValue: 'none',\n      action: 'collapse'\n    });\n\n    this.isExpanded = false;\n    this._updateClasses();\n\n    (this.onAfterCollapse || noop)();\n\n    return this;\n  };\n\n  /**\n   * Toggle the expand state.\n   */\n\n\n  Expand.prototype.toggle = function toggle() {\n    return this[this.isExpanded ? 'collapse' : 'expand']();\n  };\n\n  /**\n   * Store a reference to the element.\n   * @param {Element} el\n   */\n\n\n  Expand.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.isExpanded = (0, _hasClass2.default)(this.el, 'expanded');\n\n    this.accordionHeading = this.el.querySelector('[role=\"heading\"]');\n    this.accordionContent = this.el.querySelector('.spark-panel__content');\n\n    this.panelContent = this.el.querySelector('.spark-expand__content');\n    this.panelCollapsedButton = this.el.querySelector('.spark-expand__hide--expanded');\n    this.panelExpandedButton = this.el.querySelector('.spark-expand__show--expanded');\n  };\n\n  /**\n   * Update classes for the expand or collapse state.\n   */\n\n\n  Expand.prototype._updateClasses = function _updateClasses() {\n    (0, _toggleClass2.default)(this.el, 'expanded', this.isExpanded);\n    this._updateAriaAttributes();\n  };\n\n  /**\n   * Update aria attributes for the expand or collapse state.\n   */\n\n\n  Expand.prototype._updateAriaAttributes = function _updateAriaAttributes() {\n    if (this.isExpanded) {\n      this.accordionHeading ? this.accordionHeading.setAttribute('aria-expanded', 'true') : null;\n      this.accordionContent ? this.accordionContent.setAttribute('aria-hidden', 'false') : null;\n\n      this.panelContent ? this.panelContent.setAttribute('aria-hidden', 'false') : null;\n      this.panelCollapsedButton ? this.panelCollapsedButton.setAttribute('aria-hidden', 'true') : null;\n      this.panelExpandedButton ? this.panelExpandedButton.setAttribute('aria-hidden', 'false') : null;\n    } else {\n      this.accordionHeading ? this.accordionHeading.setAttribute('aria-expanded', 'false') : null;\n      this.accordionContent ? this.accordionContent.setAttribute('aria-hidden', 'true') : null;\n\n      this.panelContent ? this.panelContent.setAttribute('aria-hidden', 'true') : null;\n      this.panelCollapsedButton ? this.panelCollapsedButton.setAttribute('aria-hidden', 'false') : null;\n      this.panelExpandedButton ? this.panelExpandedButton.setAttribute('aria-hidden', 'true') : null;\n    }\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Expand.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onClickBound = this._onClick.bind(this);\n    this._onKeydownBound = this._onKeydown.bind(this);\n  };\n\n  /**\n   * Add event listeners for DOM events.\n   */\n\n\n  Expand.prototype._addEventListeners = function _addEventListeners() {\n    this.el.addEventListener('click', this._onClickBound);\n    this.el.addEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n\n\n  Expand.prototype._removeEventListeners = function _removeEventListeners() {\n    this.el.removeEventListener('click', this._onClickBound);\n    this.el.removeEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * When we are clicked, toggle the expanded state.\n   * @param {Object} e\n   */\n\n\n  Expand.prototype._onClick = function _onClick(e) {\n\n    if (!(0, _getParent2.default)(e.target, '.spark-expand__toggle, [data-role=\"toggle\"], [role=\"heading\"]', this.el)) {\n      return;\n    }\n\n    e.preventDefault();\n    this.toggle();\n  };\n\n  /**\n   * When the space or enter key is pressed on the toggle, toggle!\n   * @param {Object} e\n   */\n\n\n  Expand.prototype._onKeydown = function _onKeydown(e) {\n\n    if (!(0, _getParent2.default)(e.target, '.spark-expand__toggle, [data-role=\"toggle\"], [role=\"heading\"]', this.el)) {\n      return;\n    }\n\n    var code = e.keyCode || e.which;\n\n    // Space or enter\n    if (code === 32 || code === 13) {\n      e.preventDefault();\n      this.toggle();\n    }\n  };\n\n  return Expand;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nExpand.prototype._whitelistedParams = ['onBeforeExpand', 'onAfterExpand', 'onBeforeCollapse', 'onAfterCollapse'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nExpand.prototype.defaults = {\n  el: null,\n  isExpanded: false,\n  onBeforeExpand: null,\n  onAfterExpand: null,\n  onBeforeCollapse: null,\n  onAfterCollapse: null,\n  _onClickBound: null,\n  _onKeydownBound: null\n};\n\nexports.default = Expand;\nmodule.exports = exports['default'];\n//# sourceMappingURL=expand.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _expand = require('./expand');\n\nvar _expand2 = _interopRequireDefault(_expand);\n\nvar _setCaret = require('../helpers/form/set-caret');\n\nvar _setCaret2 = _interopRequireDefault(_setCaret);\n\nvar _formData = require('../helpers/form/form-data');\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _addClass = require('../helpers/dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('../helpers/dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _getParent = require('../helpers/traversal/get-parent');\n\nvar _getParent2 = _interopRequireDefault(_getParent);\n\nvar _getIndex = require('../helpers/traversal/get-index');\n\nvar _getIndex2 = _interopRequireDefault(_getIndex);\n\nvar _getSiblingBefore = require('../helpers/traversal/get-sibling-before');\n\nvar _getSiblingBefore2 = _interopRequireDefault(_getSiblingBefore);\n\nvar _getSiblingAfter = require('../helpers/traversal/get-sibling-after');\n\nvar _getSiblingAfter2 = _interopRequireDefault(_getSiblingAfter);\n\nvar _matches = require('../helpers/traversal/matches');\n\nvar _matches2 = _interopRequireDefault(_matches);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Table\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Table(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/table.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nvar Table = function (_BaseComponent) {\n  _inherits(Table, _BaseComponent);\n\n  /**\n   * Table constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Table(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Table);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n\n    _this._initRows();\n\n    if (_this.isSpreadsheet || _this.isEditRows) {\n      _this._deactivateAllInputs();\n    }\n\n    if (_this.isResizable) {\n      _this._initResize();\n    }\n\n    _this._disableRowsColumnsCells();\n\n    _this._initExpands();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Disable the form field in a table cell.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.disableCell = function disableCell(el) {\n    el.disabled = true;\n    (0, _addClass2.default)((0, _getParent2.default)(el, 'td'), 'spark-table__disabled-cell');\n    return this;\n  };\n\n  /**\n   * Enable the form field in a table cell.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.enableCell = function enableCell(el) {\n    el.disabled = false;\n    (0, _removeClass2.default)((0, _getParent2.default)(el, 'td'), 'spark-table__disabled-cell');\n    return this;\n  };\n\n  /**\n   * Disable a row and all the cells inside of it.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.disableRow = function disableRow(el) {\n    (0, _addClass2.default)(el, 'spark-table__disabled-row');\n    (0, _each2.default)(el.querySelectorAll('input, button, a'), function (i) {\n      i.disabled = true;\n    });\n    return this;\n  };\n\n  /**\n   * Enable a row and all the cells inside of it.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.enableRow = function enableRow(el) {\n    (0, _removeClass2.default)(el, 'spark-table__disabled-row');\n    (0, _each2.default)(el.querySelectorAll('input, button, a'), function (i) {\n      i.disabled = false;\n    });\n    return this;\n  };\n\n  /**\n   * Disable a column and all the cells inside of it.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.disableColumn = function disableColumn(el) {\n\n    var index = (0, _getIndex2.default)(el.parentNode.children, el);\n\n    (0, _each2.default)(this.tableEl.querySelectorAll('tbody tr'), function (row) {\n      this.disableCell(row.children[index].querySelector('input'));\n    }.bind(this));\n\n    (0, _addClass2.default)(el, 'spark-table__disabled-column');\n\n    return this;\n  };\n\n  /**\n   * Enable a column and all the cells inside of it.\n   * @param {Element} el\n   */\n\n\n  Table.prototype.enableColumn = function enableColumn(el) {\n\n    var index = (0, _getIndex2.default)(el.parentNode.children, el);\n\n    (0, _each2.default)(this.tableEl.querySelectorAll('tbody tr'), function (row) {\n      this.enableCell(row.children[index].querySelector('input'));\n    }.bind(this));\n\n    (0, _removeClass2.default)(el, 'spark-table__disabled-column');\n\n    return this;\n  };\n\n  /**\n   * Remove the table anc cleanup.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Table.prototype.remove = function remove(leaveElement) {\n    (0, _each2.default)(this._expands, function (e) {\n      e.remove(leaveElement);\n    });\n    return _BaseComponent.prototype.remove.call(this, leaveElement);\n  };\n\n  /**\n   * Activate a row.\n   * @param {Number|Element} row\n   */\n\n\n  Table.prototype.activateRow = function activateRow(row) {\n    row = typeof row === 'number' ? this.tableEl.querySelectorAll('tbody tr')[row] : row;\n    if (row) this._makeRowActive(row);\n    return this;\n  };\n\n  /**\n   * Activate multiple rows.\n   * @param {Array} rows\n   */\n\n\n  Table.prototype.activateRows = function activateRows(rows) {\n    (0, _each2.default)(rows, this.activateRow.bind(this));\n    return this;\n  };\n\n  /**\n   * Deactivate a row.\n   * @param {Number|Element} row\n   */\n\n\n  Table.prototype.deactivateRow = function deactivateRow(row) {\n    row = typeof row === 'number' ? this.tableEl.querySelectorAll('tbody tr')[row] : row;\n    if (row) this._makeRowInActive(row);\n    return this;\n  };\n\n  /**\n   * Deactivate multiple rows.\n   * @param {Array} rows\n   */\n\n\n  Table.prototype.deactivateRows = function deactivateRows(rows) {\n    (0, _each2.default)(rows, this.deactivateRow.bind(this));\n    return this;\n  };\n\n  /**\n   * Get an array of currently active rows.\n   * @return {Array}\n   */\n\n\n  Table.prototype.getActiveRows = function getActiveRows() {\n\n    var arr = [];\n\n    (0, _each2.default)(this.el.querySelectorAll('tbody tr.active'), function (tr) {\n      arr.push(tr);\n    });\n\n    return arr;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   */\n\n\n  Table.prototype.update = function update(el) {\n\n    this._removeEventListeners();\n\n    this._cacheElements(el || this.el);\n    this._parseParams();\n\n    this._addEventListeners();\n\n    this._initRows();\n\n    if (this.isSpreadsheet || this.isEditRows) {\n      this._deactivateAllInputs();\n    }\n\n    if (this.isResizable) {\n      this._initResize();\n    }\n\n    this._disableRowsColumnsCells();\n\n    this._initExpands();\n\n    return this;\n  };\n\n  /**\n   * Store a reference to the tabs list, each tab and each panel.\n   * Set which tab is active, or use the first.\n   * @param {Element} el\n   */\n\n\n  Table.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.tableEl = el.querySelector('table');\n  };\n\n  /**\n   * Parse parameters from the elements.\n   */\n\n\n  Table.prototype._parseParams = function _parseParams() {\n\n    if (!this.tableEl) {\n      return;\n    }\n\n    this.isSpreadsheet = this.isSpreadsheet !== null ? this.isSpreadsheet : (0, _hasClass2.default)(this.el, 'spark-table--spreadsheet') ? true : false;\n    this.isEditRows = this.isEditRows !== null ? this.isEditRows : (0, _hasClass2.default)(this.el, 'spark-table--edit-rows') ? true : false;\n    this.isResizable = this.isResizable !== null ? this.isResizable : (0, _hasClass2.default)(this.el, 'spark-table--resizable') ? true : false;\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Table.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n\n    this._onClickBound = this._onClick.bind(this);\n    this._onChangeBound = this._onChange.bind(this);\n    this._onFocusBound = this._onFocus.bind(this);\n    this._onBlurBound = this._onBlur.bind(this);\n\n    this._onTouchstartBound = this._onTouchstart.bind(this);\n    this._onTouchendBound = this._onTouchend.bind(this);\n    this._onKeydownBound = this._onKeydown.bind(this);\n\n    this._onMouseDownBound = this._onMouseDown.bind(this);\n    this._onMouseMoveBound = this._onMouseMove.bind(this);\n    this._onMouseUpBound = this._onMouseUp.bind(this);\n  };\n\n  /**\n   * Add event listeners for DOM events.\n   */\n\n\n  Table.prototype._addEventListeners = function _addEventListeners() {\n\n    this.el.addEventListener('click', this._onClickBound, false);\n    this.el.addEventListener('change', this._onChangeBound, false);\n    this.el.addEventListener('focus', this._onFocusBound, true);\n    this.el.addEventListener('blur', this._onBlurBound, true);\n\n    if (this.isSpreadsheet) {\n      this.el.addEventListener('touchstart', this._onTouchstartBound, false);\n      this.el.addEventListener('touchend', this._onTouchendBound, false);\n      this.el.addEventListener('keydown', this._onKeydownBound, false);\n    }\n\n    if (this.isResizable) {\n      this.tableEl.addEventListener('mousedown', this._onMouseDownBound, false);\n    }\n  };\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n\n\n  Table.prototype._removeEventListeners = function _removeEventListeners() {\n\n    this.el.removeEventListener('click', this._onClickBound);\n    this.el.removeEventListener('change', this._onChangeBound);\n    this.el.removeEventListener('focus', this._onFocusBound);\n    this.el.removeEventListener('blur', this._onBlurBound);\n\n    this.el.removeEventListener('touchstart', this._onTouchstartBound);\n    this.el.removeEventListener('touchend', this._onTouchendBound);\n    this.el.removeEventListener('keydown', this._onKeydownBound);\n\n    this.tableEl.removeEventListener('mousedown', this._onMouseDownBound);\n\n    this._removeResizeListeners();\n  };\n\n  /**\n   * Add listeners for mousemove and mouseup events.\n   */\n\n\n  Table.prototype._addResizeListeners = function _addResizeListeners() {\n    window.addEventListener('mousemove', this._onMouseMoveBound, false);\n    window.addEventListener('mouseup', this._onMouseUpBound, false);\n  };\n\n  /**\n   * Remove listeners for mosuemove and mouseup.\n   */\n\n\n  Table.prototype._removeResizeListeners = function _removeResizeListeners() {\n    window.removeEventListener('mousemove', this._onMouseMoveBound);\n    window.removeEventListener('mouseup', this._onMouseUpBound);\n  };\n\n  /**\n   * Toggle the active state on a row.\n   * @param {Object} row\n   */\n\n\n  Table.prototype._toggleRowActive = function _toggleRowActive(row) {\n\n    if ((0, _hasClass2.default)(row, 'active')) {\n      this._makeRowInActive(row);\n      this._uncheckSelectAll();\n    } else {\n      this._makeRowActive(row);\n    }\n  };\n\n  /**\n   * Make a row active\n   * @param {Element} row\n   */\n\n\n  Table.prototype._makeRowActive = function _makeRowActive(row) {\n    (0, _addClass2.default)(row, 'active');\n    (row.querySelector('.spark-table__checkbox input[type=\"checkbox\"]:not([disabled])') || {}).checked = true;\n  };\n\n  /**\n   * Make a row active\n   * @param  {Element} row\n   */\n\n\n  Table.prototype._makeRowInActive = function _makeRowInActive(row) {\n    (0, _removeClass2.default)(row, 'active');\n    (row.querySelector('.spark-table__checkbox input[type=\"checkbox\"]:not([disabled])') || {}).checked = false;\n  };\n\n  /**\n   * Toggle active on each row.\n   * @param {NodeList} rows\n   * @param {Boolean} active\n   */\n\n\n  Table.prototype._toggleRowsActive = function _toggleRowsActive(rows, active) {\n\n    var func = active ? '_makeRowActive' : '_makeRowInActive';\n    var i = 0;\n    var len = rows.length;\n\n    for (; i < len; i++) {\n      this[func](rows[i]);\n    }\n  };\n\n  /**\n   * Toggle whether everything should be selected. Find the checkbox input inside of the\n   * given element and invert its state.\n   * @param {Element} el\n   */\n\n\n  Table.prototype._toggleSelectAll = function _toggleSelectAll(el) {\n\n    var checkbox = el.querySelector('.spark-table__select-all input[type=\"checkbox\"]');\n\n    if (!checkbox) {\n      return;\n    }\n\n    this._toggleRowsActive(this.el.querySelectorAll('tbody tr'), !checkbox.checked);\n\n    checkbox.checked = !checkbox.checked;\n  };\n\n  /**\n   * Uncheck the select all checkboxes.\n   */\n\n\n  Table.prototype._uncheckSelectAll = function _uncheckSelectAll() {\n\n    var checkboxes = this.el.querySelectorAll('.spark-table__select-all input[type=\"checkbox\"]');\n    var i = 0;\n    var len = checkboxes.length;\n\n    for (; i < len; i++) {\n      checkboxes[i].checked = false;\n    }\n  };\n\n  /**\n   * Deactivate editing in all input fields.\n   */\n\n\n  Table.prototype._deactivateAllInputs = function _deactivateAllInputs() {\n\n    if (!this.tableEl) {\n      return;\n    }\n\n    this._deactivateInputs(this.tableEl);\n  };\n\n  /**\n   * Deactivate all the inputs inside an element\n   * @param {Element} el\n   */\n\n\n  Table.prototype._deactivateInputs = function _deactivateInputs(el) {\n\n    var inputs = el.querySelectorAll('input:not([type=\"checkbox\"])');\n    var i = 0;\n\n    var len = inputs.length;\n\n    for (; i < len; i++) {\n      this._deactivateInput(inputs[i]);\n    }\n  };\n\n  /**\n   * Make an input field readonly.\n   * @param {Element} input\n   */\n\n\n  Table.prototype._deactivateInput = function _deactivateInput(input) {\n    input.setAttribute('readonly', '');\n    (0, _removeClass2.default)(input.parentNode, 'editing');\n  };\n\n  /**\n   * Activate all the inputs inside an element\n   * @param {Element} el\n   */\n\n\n  Table.prototype._activateInputs = function _activateInputs(el) {\n\n    var inputs = el.querySelectorAll('input:not([type=\"checkbox\"])');\n    var i = 0;\n\n    var len = inputs.length;\n\n    for (; i < len; i++) {\n      this._activateInput(inputs[i]);\n    }\n  };\n\n  /**\n   * Make an input field readable.\n   * @param {Element} input\n   */\n\n\n  Table.prototype._activateInput = function _activateInput(input) {\n    input.removeAttribute('readonly');\n    (0, _addClass2.default)(input.parentNode, 'editing');\n    if (input.type !== 'checkbox' && input.type !== 'radio') {\n      (0, _setCaret2.default)(input, -1);\n    }\n  };\n\n  /**\n   * Activate an input, unless it's already enabled in which case\n   * the focus should move down a row.\n   * @param {Element} input\n   */\n\n\n  Table.prototype._activateInputOrFocusDown = function _activateInputOrFocusDown(input) {\n\n    // Currently readonly\n    if (input.getAttribute('readonly') === '') {\n      this._activateInput(input);\n      return;\n    }\n\n    this._focusDown(input, true);\n  };\n\n  /**\n   * Find all the rows, columns and cells that should be disabled.\n   */\n\n\n  Table.prototype._disableRowsColumnsCells = function _disableRowsColumnsCells() {\n    (0, _each2.default)(this.tableEl.querySelectorAll('td input[disabled]'), this.disableCell.bind(this));\n    (0, _each2.default)(this.tableEl.querySelectorAll('.spark-table__disabled-row'), this.disableRow.bind(this));\n    (0, _each2.default)(this.tableEl.querySelectorAll('.spark-table__disabled-column'), this.disableColumn.bind(this));\n  };\n\n  /**\n   * Move our focus up a row from the given element.\n   * @param {Element} input\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusUp = function _focusUp(input, force) {\n    return this._focusUpDown(input, 'up', force);\n  };\n\n  /**\n   * Move our focus down a row from the given element.\n   * @param {Element} input\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusDown = function _focusDown(input, force) {\n    return this._focusUpDown(input, 'down', force);\n  };\n\n  /**\n   * Focus on a row up or down from the given element.\n   * @param {Element} input\n   * @param {String} direction up|down\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusUpDown = function _focusUpDown(input, direction, force) {\n\n    // If we're not being told to force and the item is not read only\n    if (!force && input.getAttribute('readonly') === null) {\n      return;\n    }\n\n    this._deactivateInput(input);\n    var td = (0, _getParent2.default)(input, 'td', this.el);\n\n    if (!td) {\n      return;\n    }\n\n    var index = (0, _getIndex2.default)(td.parentNode.children, td);\n    var nextRow = (direction === 'up' ? _getSiblingBefore2.default : _getSiblingAfter2.default)(td.parentNode, 'tr');\n\n    if (!nextRow) {\n      return;\n    }\n\n    var newTd = nextRow.children[index];\n\n    if (!newTd) {\n      return;\n    }\n\n    var newInput = newTd.querySelector('input:not([type=\"checkbox\"]), select');\n\n    if (newInput) {\n      if (newInput.disabled) {\n        this._focusUpDown(newInput, direction, force);\n      } else {\n        newInput.focus();\n      }\n    }\n  };\n\n  /**\n   * Move our focus left a cell from the given element.\n   * @param {Element} input\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusLeft = function _focusLeft(input, force) {\n    return this._focusLeftRight(input, 'left', force);\n  };\n\n  /**\n   * Move our focus right a cell from the given element.\n   * @param {Element} input\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusRight = function _focusRight(input, force) {\n    return this._focusLeftRight(input, 'right', force);\n  };\n\n  /**\n   * Focus on a cell left or down from the given element.\n   * @param {Element} input\n   * @param {String} direction up|down\n   * @param {Boolean} force Force the move even if the element is active.\n   */\n\n\n  Table.prototype._focusLeftRight = function _focusLeftRight(input, direction, force) {\n\n    // If we're not being told to force and the item is not read only\n    if (!force && input.getAttribute('readonly') === null) {\n      return;\n    }\n\n    this._deactivateInput(input);\n    var td = (0, _getParent2.default)(input, 'td', this.el);\n\n    if (!td) {\n      return;\n    }\n\n    var newTd = (direction === 'left' ? _getSiblingBefore2.default : _getSiblingAfter2.default)(td, 'td');\n\n    if (!newTd) {\n      return;\n    }\n\n    var newInput = newTd.querySelector('input:not([type=\"checkbox\"]), select');\n\n    if (newInput) {\n      if (newInput.disabled) {\n        this._focusLeftRight(newInput, direction, force);\n      } else {\n        newInput.focus();\n      }\n    }\n  };\n\n  /**\n   * Check for two click events on the same element in short succession.\n   * @param {Element} el\n   */\n\n\n  Table.prototype._checkDoubleClick = function _checkDoubleClick(el) {\n\n    var now = Date.now();\n    var lastTime = this._lastClickTime;\n    var lastEl = this._lastClickEl;\n\n    this._lastClickTime = now;\n    this._lastClickEl = el;\n\n    if (el === lastEl && now - 500 < lastTime) {\n      return true;\n    }\n\n    return false;\n  };\n\n  /**\n   * Unset the last clicked element.\n   */\n\n\n  Table.prototype._clearClicked = function _clearClicked() {\n    this._lastClickEl = null;\n  };\n\n  /**\n   * Enable editing on a row.\n   * @param {Element} row\n   */\n\n\n  Table.prototype._editRow = function _editRow(row) {\n\n    if (!row) {\n      return;\n    }\n\n    this._editingCount++;\n\n    this._activateInputs(row);\n    (0, _formData.store)(row);\n    (0, _addClass2.default)(row, 'editing');\n    this._updateBindings();\n  };\n\n  /**\n   * Cancel editing a row.\n   * @param {Element} row\n   */\n\n\n  Table.prototype._cancelRow = function _cancelRow(row) {\n\n    if (!row) {\n      return;\n    }\n\n    this._editingCount--;\n\n    this._deactivateInputs(row);\n    (0, _formData.restore)(row);\n    (0, _removeClass2.default)(row, 'editing');\n    this._updateBindings();\n  };\n\n  /**\n   * Save a row.\n   * @param {Element} row\n   */\n\n\n  Table.prototype._saveRow = function _saveRow(row) {\n\n    if (!row) {\n      return;\n    }\n\n    this._editingCount--;\n\n    this._deactivateInputs(row);\n    (0, _formData.clear)(row);\n    (0, _removeClass2.default)(row, 'editing');\n    this._updateBindings();\n\n    (this.onRowSave || noop)((0, _getIndex2.default)(row.parentNode.children, row), row);\n  };\n\n  /**\n   * Delete a row.\n   * @param {Element} row\n   */\n\n\n  Table.prototype._deleteRow = function _deleteRow(row) {\n\n    if (!row) {\n      return;\n    }\n\n    (this.onRowDelete || noop)((0, _getIndex2.default)(row.parentNode.children, row), row);\n    row.parentNode.removeChild(row);\n  };\n\n  /**\n   * Confirm the deletion of a row.\n   * @param {Element} row\n   */\n\n\n  Table.prototype._confirmDelete = function _confirmDelete(row) {\n\n    if (!this.confirmDelete || typeof this.confirmDelete !== 'function') {\n      this._deleteRow(row);\n    } else {\n      this.confirmDelete(row, this._deleteRow);\n    }\n  };\n\n  /**\n   * Update data bindings.\n   */\n\n\n  Table.prototype._updateBindings = function _updateBindings() {\n    (0, _toggleClass2.default)(this.el, 'editing', this._editingCount);\n  };\n\n  /**\n   * Add handles to the header that can be grabbed for resizing.\n   */\n\n\n  Table.prototype._initResize = function _initResize() {\n\n    this._resizeEls = [];\n\n    var ths = this.tableEl.querySelectorAll('thead th');\n\n    (0, _each2.default)(ths, function (th) {\n      th.innerHTML = '<span class=\"spark-table__resize spark-table__resize--left\"></span>' + th.innerHTML + '<span class=\"spark-table__resize spark-table__resize--right\"></span>';\n      this._resizeEls.push(th);\n    }.bind(this));\n  };\n\n  /**\n   * Initialize rows active states.\n   */\n\n\n  Table.prototype._initRows = function _initRows() {\n\n    (0, _each2.default)(this.tableEl.querySelectorAll('td.spark-table__checkbox input:checked'), function (c) {\n      this._makeRowActive((0, _getParent2.default)(c, 'tr'));\n    }.bind(this));\n  };\n\n  /**\n   * Set the size of each column as a percentage so it can be adjusted\n   * while cells are resized.\n   * @param {String} unit Optional\n   * @param {Boolean} force Optional\n   */\n\n\n  Table.prototype._sizeColumns = function _sizeColumns(unit, force) {\n\n    unit = unit || '%';\n\n    if (this._sizeColumnsRun && !force) {\n      return;\n    }\n\n    var width = this.tableEl.offsetWidth;\n\n    (0, _each2.default)(this.tableEl.querySelectorAll('thead th'), function (th) {\n      if (unit === '%') th.style.width = Math.round(th.offsetWidth / width * 100000) / 100000 * 100 + '%';else th.style.width = th.offsetWidth + 'px';\n    }.bind(this));\n\n    this._sizeColumnsRun = true;\n  };\n\n  /**\n   * Initialize expand/collapse rows.\n   */\n\n\n  Table.prototype._initExpands = function _initExpands() {\n\n    var expands = this.tableEl.querySelectorAll('.spark-table-expand');\n\n    this._expands = [];\n\n    (0, _each2.default)(expands, function (e) {\n      this._expands.push(new _expand2.default(e, {\n        onBeforeExpand: this._onBeforeExpand.bind(this)\n      }));\n    }.bind(this));\n  };\n\n  /**\n   * Before an expand is called, size all the columns so that\n   * the expand does cause width changes.\n   */\n\n\n  Table.prototype._onBeforeExpand = function _onBeforeExpand() {\n    this._sizeColumns();\n  };\n\n  /**\n   * When we are clicked determine the proper action to take.\n   * @param  {Object} e\n   */\n\n\n  Table.prototype._onClick = function _onClick(e) {\n\n    var target = e.target || e.srcElement;\n    var row;\n    var selectAll;\n    var actionTaken = false;\n    var clearClicked = true;\n\n    // Select all rows checkbox\n    if ((selectAll = (0, _getParent2.default)(target, '.spark-table__select-all', this.el)) && !(0, _matches2.default)(target, 'input[type=\"checkbox\"]')) {\n      this._toggleSelectAll(selectAll);\n      actionTaken = true;\n    }\n    // Editable field\n    else if ((0, _matches2.default)(target, 'input:not([type=\"checkbox\"]):not([type=\"file\"]), select')) {\n\n        if (!target.disabled) {\n\n          // Listen for double clicks on a spreadsheet\n          if (this.isSpreadsheet) {\n            clearClicked = false;\n            if (this._checkDoubleClick(target)) {\n              clearClicked = true;\n              this._activateInput(target);\n            }\n          }\n\n          actionTaken = true;\n        }\n      }\n      // Edit button\n      else if ((0, _matches2.default)(target, '.spark-table__edit-row')) {\n          this._editRow((0, _getParent2.default)(target, 'tr', this.el));\n          actionTaken = true;\n        }\n        // Delete button\n        else if ((0, _matches2.default)(target, '.spark-table__delete-row')) {\n            this._confirmDelete((0, _getParent2.default)(target, 'tr', this.el));\n            actionTaken = true;\n          }\n          // Save button\n          else if ((0, _matches2.default)(target, '.spark-table__edit-row-save')) {\n              this._saveRow((0, _getParent2.default)(target, 'tr', this.el));\n              actionTaken = true;\n            }\n            // Cancel button\n            else if ((0, _matches2.default)(target, '.spark-table__edit-row-cancel')) {\n                this._cancelRow((0, _getParent2.default)(target, 'tr', this.el));\n                actionTaken = true;\n              }\n              // Select a row\n              else if (!(0, _getParent2.default)(target, 'button, a, .spark-toggle-switch', this.el) && !(0, _matches2.default)(target, '.spark-table__checkbox input[type=\"checkbox\"], select') && (row = (0, _getParent2.default)(target, 'tbody tr', this.el))) {\n                  if (!(row.querySelector('.spark-table__checkbox input[type=\"checkbox\"]') || {}).disabled) {\n                    this._toggleRowActive(row);\n                    actionTaken = true;\n                  }\n                }\n\n    if (clearClicked) {\n      this._clearClicked();\n    }\n\n    if (actionTaken) {\n      e.preventDefault();\n    }\n  };\n\n  /**\n   * When the change event fires on our element.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onChange = function _onChange(e) {\n\n    var target = e.target || e.srcElement;\n    var row;\n    var selectAll;\n\n    // Select all rows checkbox. We have to invert the checked value here because it\n    // get toggled back in the select all call.\n    if (selectAll = (0, _getParent2.default)(target, '.spark-table__select-all', this.el)) {\n      target.checked = !target.checked;\n      this._toggleSelectAll(selectAll);\n    }\n    // Checkbox for a row\n    else if ((0, _matches2.default)(target, '.spark-table__checkbox input[type=\"checkbox\"]') && (row = (0, _getParent2.default)(target, 'tbody tr', this.el))) {\n        this._toggleRowActive(row);\n      }\n  };\n\n  /**\n   * If this is a spreadsheet, whenever a field gains focus, highlight its parent.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onFocus = function _onFocus(e) {\n\n    var target = e.target || e.srcElement;\n\n    if (!this.isSpreadsheet || !(0, _matches2.default)(target, 'input:not([type=\"checkbox\"]), select')) {\n      return;\n    }\n\n    var td = (0, _getParent2.default)(target, 'td', this.el);\n    (0, _addClass2.default)(td, 'focus');\n  };\n\n  /**\n   * If this is a spreadsheet, whenever a field gains focus, highlight its parent.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onBlur = function _onBlur(e) {\n\n    if (!this.isSpreadsheet) {\n      return;\n    }\n\n    var target = e.target || e.srcElement;\n    var td = (0, _getParent2.default)(target, 'td', this.el);\n    (0, _removeClass2.default)(td, 'focus');\n    this._deactivateInput(target);\n  };\n\n  /**\n   * When a key is pressed, if this is a spreadsheet then we should detect\n   * enter or arrow keys.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onKeydown = function _onKeydown(e) {\n\n    var target = e.target || e.srcElement;\n\n    if (!this.isSpreadsheet || !(0, _matches2.default)(target, 'input:not([type=\"checkbox\"]), select')) {\n      return;\n    }\n\n    var code = e.keyCode || e.which;\n\n    switch (code) {\n      case this._keyCodes.ENTER:\n        this._activateInputOrFocusDown(target);\n        break;\n      case this._keyCodes.ESCAPE:\n        this._deactivateInput(target);\n        break;\n      case this._keyCodes.DOWN:\n        this._focusDown(target);\n        break;\n      case this._keyCodes.UP:\n        this._focusUp(target);\n        break;\n      case this._keyCodes.LEFT:\n        this._focusLeft(target);\n        break;\n      case this._keyCodes.RIGHT:\n        this._focusRight(target);\n        break;\n    }\n  };\n\n  /**\n   * Listen for a touch and hold on an input.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onTouchstart = function _onTouchstart(e) {\n\n    var target = e.target || e.srcElement;\n\n    if (!this.isSpreadsheet || !(0, _matches2.default)(target, 'input:not([type=\"checkbox\"])')) {\n      return;\n    }\n\n    this._touchStartEl = target;\n    this._touchStartTime = Date.now();\n    this._touchStartTimer = setTimeout(this._onTouchHold.bind(this), 1000);\n  };\n\n  /**\n   * Listen for the end of a touch to cancel the hold timer.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onTouchend = function _onTouchend(e) {\n\n    var target = e.target || e.srcElement;\n\n    if (!this._touchStartEl || target !== this._touchStartEl) {\n      return;\n    }\n\n    this._touchStartEl = null;\n    this._touchStartTime = null;\n    clearTimeout(this._touchStartTimer);\n  };\n\n  /**\n   * When the user has held on an input for the defined amount of time.\n   */\n\n\n  Table.prototype._onTouchHold = function _onTouchHold() {\n\n    this._activateInput(this._touchStartEl);\n\n    this._touchStartEl = null;\n    this._touchStartTime = null;\n    clearTimeout(this._touchStartTimer);\n  };\n\n  /**\n   * When the mouse is depressed.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onMouseDown = function _onMouseDown(e) {\n\n    var target = e.target || e.srcElement;\n\n    if (!this.isResizable || !(0, _matches2.default)(target, '.spark-table__resize')) {\n      return;\n    }\n\n    e.preventDefault();\n\n    this._lastScreenX = e.screenX;\n\n    this._sizeColumns('px', true);\n\n    this._resizingEl = target.parentNode;\n    var index = this._resizeEls.indexOf(this._resizingEl);\n\n    if ((0, _hasClass2.default)(target, 'spark-table__resize--left')) {\n      this._resizingEl = this._resizeEls[index - 1];\n    }\n\n    if (!this._resizingEl) {\n      return;\n    }\n\n    this._addResizeListeners();\n  };\n\n  /**\n   * When the mouse moves after being depressed, resize the columns.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onMouseMove = function _onMouseMove(e) {\n\n    var x = e.screenX;\n    var d = x - this._lastScreenX;\n\n    // No delta change\n    if (!d) {\n      return;\n    }\n\n    e.preventDefault();\n\n    var w = this._resizingEl.offsetWidth;\n    var tW = this.tableEl.offsetWidth;\n    var newW = w + d;\n    var newTW = tW + d;\n\n    this._resizingEl.style.width = newW + 'px';\n    this.tableEl.style.width = newTW + 'px';\n\n    // Size was not affected because we're too small\n    if (this._resizingEl.offsetWidth === w || this.tableEl.offsetWidth < this.tableEl.parentNode.offsetWidth) {\n      this._resizingEl.style.width = w + 'px';\n      this.tableEl.style.width = tW + 'px';\n    }\n\n    this._lastScreenX = x;\n  };\n\n  /**\n   * When the mouse is released, stop tracking mouse move events and\n   * convert table sizes to percentages.\n   * @param {Object} e\n   */\n\n\n  Table.prototype._onMouseUp = function _onMouseUp() {\n    this._sizeColumns('%', true);\n    this.tableEl.style.width = this.tableEl.offsetWidth / this.tableEl.parentNode.offsetWidth * 100 + '%';\n    this._removeResizeListeners();\n  };\n\n  return Table;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nTable.prototype._whitelistedParams = ['isSpreadsheet', 'isEditRows', 'isResizable', 'confirmDelete', 'onRowSave', 'onRowDelete'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nTable.prototype.defaults = {\n  el: null,\n  tableEl: null,\n  isSpreadsheet: null,\n  isEditRows: null,\n  isResizable: null,\n  onRowSave: null,\n  onRowDelete: null,\n  confirmDelete: null,\n  _expands: null,\n  _keyCodes: {\n    ENTER: 13,\n    UP: 38,\n    DOWN: 40,\n    LEFT: 37,\n    RIGHT: 39,\n    ESCAPE: 27\n  },\n  _editingCount: 0,\n  _lastClickTime: 0,\n  _lastClickEl: null,\n  _lastScreenX: 0,\n  _touchStartTime: 0,\n  _touchStartEl: null,\n  _resizeEls: null,\n  _resizingEl: null,\n  _sizeColumnsRun: false,\n  _onClickBound: null,\n  _onChangeBound: null,\n  _onFocusBound: null,\n  _onBlurBound: null,\n  _onKeydownBound: null,\n  _onTouchstartBound: null,\n  _onTouchendBound: null,\n  _onMouseDownBound: null,\n  _onMouseMoveBound: null,\n  _onMouseUpBound: null\n};\n\nexports.default = Table;\nmodule.exports = exports['default'];\n//# sourceMappingURL=table.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _outerHeight = require('../dom/outer-height');\n\nvar _outerHeight2 = _interopRequireDefault(_outerHeight);\n\nvar _addClass = require('../dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('../dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _hasClass = require('../dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _toggleClass = require('../dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar noop = function noop() {}; /**\n                                * # Animate Height\n                                * Animate the height of an element since we can't do this w/ pure CSS. Sigh.\n                                *\n                                * @example\n                                * animateHeight({\n                                *   el: ...,\n                                *   toggleEl: ...,\n                                *   // Optional params\n                                *   action: 'collapse'|'expand',\n                                *   heightAnimationClass: 'spark-animate-height',\n                                *   opacityAnimationClass: 'spark-animate-opacity',\n                                *   toggleProperty: 'display'|'overflow'|'visibility',\n                                *   toggleValue: 'block'|'none'|'visible'|'hidden',\n                                *   animationDuration: 250\n                                * });\n                                *\n                                * @module helpers/animation/height.js\n                                */\n\nvar runningAnimations = {\n  els: [],\n  completeCallbacks: []\n};\n\n/**\n * Get the inverse toggle value\n * @param  {String} property\n * @param  {String} originalValue\n * @return {String}\n */\nfunction getInverseToggleValue(el, property, originalValue) {\n\n  // Get the value to toggle to for the given property\n  switch (property) {\n    case 'overflow':\n    case 'visibility':\n      return originalValue === 'visible' ? 'hidden' : 'visible';\n    default:\n      return originalValue === 'block' || originalValue === 'inline-block' ? 'none' : 'block';\n  }\n}\n\n/**\n * When an animation is complete, clean up and run the callback.\n * @param  {Object} params\n */\nfunction onComplete(params) {\n\n  // Reset toggle el visibility\n  if (params.toggleClassName) {\n    (0, _toggleClass2.default)(params.el, params.toggleClassName, !params.collapse);\n  } else {\n    params.toggleEl.style[params.toggleProperty] = '';\n  }\n\n  // Remove the height property\n  params.el.style.height = '';\n  params.toggleEl.style.height = '';\n  params.toggleEl.style.marginBottom = '';\n  params.toggleEl.style.marginTop = '';\n\n  // Remove the spark-animate-height class so the transitions no longer apply\n  (0, _removeClass2.default)(params.el, params.heightAnimationClass);\n  (0, _removeClass2.default)(params.toggleEl, params.heightAnimationClass);\n\n  // Run the callback\n  params.onComplete();\n\n  // Remove the element and callback from their respective arrays\n  var runningIndex = runningAnimations.els.indexOf(params.el);\n  runningAnimations.els.splice(runningIndex, 1);\n  runningAnimations.completeCallbacks.splice(runningIndex, 1);\n}\n\n/**\n * @param {Object} params\n */\nfunction animateHeight(params) {\n\n  params = params || {};\n\n  var el = params.el;\n\n  if (!el) {\n    return;\n  }\n\n  var collapse = params.action && params.action === 'collapse';\n  var heightAnimationClass = params.heightAnimationClass || 'spark-animate-height';\n\n  // Allow for elements to be passed or selector strings\n  var toggleEl = typeof params.toggleEl === 'string' ? el.querySelector(params.toggleEl) : params.toggleEl;\n\n  // No element to be switching with toggling so we can't determine the desired height to animate to.\n  if (!toggleEl || (0, _hasClass2.default)(el, 'spark-no-animate')) {\n    return;\n  }\n\n  var toggleClassName = params.toggleClass;\n\n  // The style property to use when toggling visibility\n  var toggleProperty = params.toggleProperty || 'display';\n  var toggleStyles = window.getComputedStyle(toggleEl);\n  var originalToggleValue = toggleStyles[toggleProperty];\n  var toggleValue = params.toggleValue || getInverseToggleValue(toggleProperty, originalToggleValue);\n\n  // If we are already animating, stop now.\n  var runningIndex = runningAnimations.els.indexOf(el);\n  if (runningIndex !== -1) {\n\n    var completeCallback = runningAnimations.completeCallbacks[runningIndex];\n    if (completeCallback) {\n      clearTimeout(completeCallback);\n    }\n\n    onComplete({\n      el: el,\n      toggleEl: toggleEl,\n      onComplete: params.onComplete || noop,\n      collapse: collapse,\n      toggleProperty: toggleProperty,\n      toggleClassName: toggleClassName,\n      toggleValue: toggleValue,\n      heightAnimationClass: heightAnimationClass\n    });\n  }\n\n  // Store the current height\n  var originalHeight = (0, _outerHeight2.default)(el);\n\n  // Toggle the visible property\n  if (toggleClassName) {\n    (0, _toggleClass2.default)(el, toggleClassName, !collapse);\n  } else {\n    toggleEl.style[toggleProperty] = toggleValue;\n  }\n\n  // When measuring the size for a collapse, we have to wait a tic for it to be\n  // accurate. Not sure why. Ugh.\n  if (collapse) {\n    setTimeout(runAnimation, 0);\n  } else {\n    runAnimation();\n  }\n\n  function runAnimation() {\n\n    // Now that the toggle el is taking up space, get the new height which we will be animating to\n    var targetElHeight = (0, _outerHeight2.default)(el);\n\n    // We need to store the original and target toggle element heights. They differ depending on\n    // whether we are going to expand or collapse.\n    var targetToggleElHeight = void 0;\n    var originalToggleElHeight = void 0;\n\n    // If we are collapsing, reset the toggle style and set it when we're done. Set the height so\n    // that we can animate down to 0 or up to the target height.\n    if (collapse) {\n\n      if (toggleClassName) {\n        (0, _removeClass2.default)(el, toggleClassName);\n      } else {\n        toggleEl.style[toggleProperty] = originalToggleValue;\n      }\n\n      originalToggleElHeight = (0, _outerHeight2.default)(toggleEl, toggleStyles);\n      targetToggleElHeight = 0;\n    } else {\n      targetToggleElHeight = (0, _outerHeight2.default)(toggleEl, toggleStyles);\n      originalToggleElHeight = 0;\n    }\n\n    // Set the original height\n    el.style.height = originalHeight + 'px';\n    toggleEl.style.height = originalToggleElHeight + 'px';\n    toggleEl.style.marginBottom = '0px';\n    toggleEl.style.marginTop = '0px';\n\n    // Add the spark-animate-height class which will setup the transition-property and duration\n    (0, _addClass2.default)(el, heightAnimationClass);\n    (0, _addClass2.default)(toggleEl, heightAnimationClass);\n\n    runningAnimations.els.push(el);\n\n    // We need to wait a tick to toggle the height or else the animation class won't function\n    setTimeout(function () {\n\n      // Set the height to the target height\n      el.style.height = targetElHeight + 'px';\n      toggleEl.style.height = targetToggleElHeight + 'px';\n\n      // Remove inline styles after the animation is complete\n      runningAnimations.completeCallbacks.push(setTimeout(function () {\n        onComplete({\n          el: el,\n          toggleEl: toggleEl,\n          onComplete: params.onComplete || noop,\n          collapse: collapse,\n          toggleProperty: toggleProperty,\n          toggleClassName: toggleClassName,\n          toggleValue: toggleValue,\n          heightAnimationClass: heightAnimationClass\n        });\n      }, params.animationDuration !== undefined ? params.animationDuration : 201));\n    }, 0);\n  }\n}\n\nexports.default = animateHeight;\nmodule.exports = exports['default'];\n//# sourceMappingURL=height.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nvar _hasClass = require('./has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * # Add Class\n * Add a class on an element.\n *\n * @param {Element|Array} el An element or array of elements to update.\n * @param {String} name\n * @return {Element}\n *\n * @module helpers/dom/add-class.js\n */\n\nvar ws = /\\s+/;\nvar cleanup = /\\s{2,}/g;\n\nfunction addClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) {\n      el.classList.add(name[0]);\n    }\n    return el;\n  }\n\n  var toAdd = [];\n  var i = 0;\n  var l = name.length;\n  var item = void 0;\n  var clsName = typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '';\n\n  // see if we have anything to add\n  for (; i < l; i++) {\n    item = name[i];\n    if (item && !(0, _hasClass2.default)(clsName, item)) {\n      toAdd.push(item);\n    }\n  }\n\n  if (toAdd.length) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = addClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=add-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * # Has Class\n * See if an element has a class.\n *\n * @param {Element|String} el\n * @param {String} name\n * @return {Boolean}\n *\n * @module helpers/dom/has-class.js\n */\nfunction hasClass(el, name) {\n  var cName = ((typeof el === 'undefined' ? 'undefined' : _typeof(el)) === 'object' ? el.className || el.getAttribute && el.getAttribute('class') || '' : el || '').replace(/[\\t\\r\\n\\f]/g, ' ');\n  return (' ' + cName + ' ').indexOf(' ' + name + ' ') !== -1;\n}\n\nexports.default = hasClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=has-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar props = ['marginTop', 'marginBottom', 'borderTop', 'borderBottom']; /**\n                                                                         * # Outer Height\n                                                                         * Get the outer height of an element (including margin and border)\n                                                                         *\n                                                                         * @param {Element} el\n                                                                         * @param {Object} styles Optional Already have computed styles? Pass them in.\n                                                                         *\n                                                                         * @example\n                                                                         * outerHeight(el, computedStyles);\n                                                                         *\n                                                                         * @module helpers/outer-height.js\n                                                                         */\n\n\nfunction outerHeight(el, styles) {\n\n  styles = styles || window.getComputedStyle(el);\n\n  var height = el.clientHeight;\n\n  (0, _each2.default)(props, function (prop) {\n    height += parseInt(styles[prop] || 0, 10);\n  });\n\n  return height;\n}\n\nexports.default = outerHeight;\nmodule.exports = exports['default'];\n//# sourceMappingURL=outer-height.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ws = /\\s+/; /**\n                 * # Remove Class\n                 * Remove a class on an element.\n                 *\n                 * @param {Element|Array} el An element or array of elements to update.\n                 * @param {String} name\n                 * @return {Element}\n                 *\n                 * @module helpers/dom/remove-class.js\n                 */\n\nvar cleanup = /\\s{2,}/g;\n\nfunction removeClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) el.classList.remove(name[0]);\n    return el;\n  }\n\n  // store two copies\n  var clsName = ' ' + (typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '') + ' ';\n  var result = clsName;\n  var current = void 0;\n  var start = void 0;\n  for (var i = 0, l = name.length; i < l; i++) {\n    current = name[i];\n    start = current ? result.indexOf(' ' + current + ' ') : -1;\n    if (start !== -1) {\n      start += 1;\n      result = result.slice(0, start) + result.slice(start + current.length);\n    }\n  }\n\n  // only write if modified\n  if (clsName !== result) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)(result.replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)(result.replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = removeClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=remove-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _hasClass = require('./has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _addClass = require('./add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('./remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction toggleClass(el, name, enable) {\n\n  if (!el) {\n    return;\n  }\n\n  // If we're passed an array, toggle the class on each.\n  if (el instanceof NodeList || el instanceof Array) {\n\n    for (var i = 0, len = el.length; i < len; i++) {\n      toggleClass(el[i], name, enable);\n    }\n\n    return;\n  }\n\n  var action = void 0;\n  if (enable !== undefined) {\n    enable = typeof enable === 'function' ? enable.call(null, el) : enable;\n    action = enable ? 'add' : 'remove';\n  } else {\n    action = (0, _hasClass2.default)(el, name) ? 'remove' : 'add';\n  }\n\n  return (action === 'add' ? _addClass2.default : _removeClass2.default)(el, name);\n} /**\n   * # Toggle Class\n   * Toggle a class on an element given a condition.\n   *\n   * @param {Element|Array} el An element or array of elements to update.\n   * @param {String} name\n   * @param {Boolean} enable\n   * @return {Element}\n   *\n   * @module  helpers/dom/toggle-class.js\n   */\n\nexports.default = toggleClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=toggle-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.clear = exports.restore = exports.store = undefined;\n\nvar _each = require('../util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Find all the form elements inside a given element and run a callback on each.\n * @param  {Element} el\n * @param  {Function} cb\n */\nfunction findAll(el, cb) {\n  (0, _each2.default)(el.querySelectorAll('input, select, textarea'), function (i) {\n    cb(i);\n  });\n}\n\n/**\n * Find all the form elements inside a given element and store their current\n * value as a data attribute.\n * @param {Element} el\n */\n/**\n * # Form Data\n * Store and restore the data of form fields inline so it can be reverted.\n *\n * @example\n * formData.store(el);\n * formData.revert(el);\n *\n * @module helpers/form/form-data.js\n */\n\nfunction store(el) {\n\n  findAll(el, function (input) {\n\n    var name = input.nodeName.toLowerCase();\n    var value = void 0;\n\n    switch (name) {\n      case 'select':\n        value = input.selectedIndex;\n        break;\n      default:\n        value = encodeURI(input.value);\n        break;\n    }\n\n    input.setAttribute('data-stored-value', value);\n  });\n}\n\n/**\n * Revert all the form elements inside of a given element.\n * @param {Element} el\n */\nfunction restore(el) {\n\n  findAll(el, function (input) {\n\n    var name = input.nodeName.toLowerCase();\n    var value = input.getAttribute('data-stored-value');\n\n    // No stored value\n    if (!value && value !== '') {\n      return;\n    }\n\n    switch (name) {\n      case 'select':\n        input.options[value].selected = true;\n        break;\n      default:\n        input.value = decodeURI(value);\n        break;\n    }\n\n    input.removeAttribute('data-stored-value');\n  });\n}\n\n/**\n * Clear the stored data on all the form elements inside of a given element.\n * @param {Element} el\n */\nfunction clear(el) {\n  findAll(el, function (input) {\n    input.removeAttribute('data-stored-value');\n  });\n}\n\nexports.store = store;\nexports.restore = restore;\nexports.clear = clear;\n//# sourceMappingURL=form-data.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Set Caret\n * Set the caret position in an input.\n *\n * @param {Element} el\n * @param {Number} start\n * @param {Number} end\n *\n * @example\n * setCaret(el, -1);\n * setCaret(el, 2);\n *\n * @module helpers/form/set-caret.js\n */\nfunction setCaret(el, start, end) {\n\n  var originalActiveElement = document.activeElement;\n\n  start = start < 0 ? el.value.length + start + 1 : start;\n  end = end < 0 ? el.value.length + end + 1 : end;\n\n  // IE support\n  if (document.selection) {\n    el.focus();\n    var sel = document.selection.createRange();\n    sel.moveStart('character', -el.value.length);\n    sel.moveStart('character', start);\n    sel.moveEnd('character', end !== undefined ? end : start);\n    sel.select();\n  } else if (el.selectionStart || el.selectionStart === 0) {\n    el.selectionStart = start;\n    el.selectionEnd = end !== undefined ? end : start;\n  }\n\n  // If we didn't have focus, go back to focusing on the original\n  if (originalActiveElement !== el) {\n    el.blur();\n    originalActiveElement.focus();\n  }\n\n  return {\n    start: start,\n    end: end\n  };\n}\n\nexports.default = setCaret;\nmodule.exports = exports['default'];\n//# sourceMappingURL=set-caret.js.map\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Get Index\n * Get the index of an element in a nodelist.\n *\n * @param {NodeList} els\n * @param {Node} el\n * @return {Number}\n *\n * @module helpers/traversal/get-index.js\n */\nfunction getIndex(els, el) {\n  return Array.prototype.indexOf.call(els, el);\n}\n\nexports.default = getIndex;\nmodule.exports = exports[\"default\"];\n//# sourceMappingURL=get-index.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _matches = require('./matches');\n\nvar _matches2 = _interopRequireDefault(_matches);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getParent(parent, query, limitEl) {\n\n  limitEl = limitEl instanceof Array ? limitEl : [limitEl || document.body];\n\n  while (parent) {\n\n    if ((0, _matches2.default)(parent, query)) {\n      return parent;\n    }\n\n    if (limitEl.indexOf(parent) !== -1) {\n      return false;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return false;\n} /**\n   * # Get Parent\n   * See if an element has another element for a parent.\n   *\n   * @param {Element} parent\n   * @param {String} query\n   * @param {Array|Element} limitEl The last element we should check.\n   * @return {Boolean|Element}\n   *\n   * @module helpers/traversal/get-parent.js\n   */\n\nexports.default = getParent;\nmodule.exports = exports['default'];\n//# sourceMappingURL=get-parent.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _matches = require('./matches');\n\nvar _matches2 = _interopRequireDefault(_matches);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getSiblingAfter(el, query) {\n\n  while (el = el.nextElementSibling) {\n    if ((0, _matches2.default)(el, query)) {\n      return el;\n    }\n  }\n\n  return null;\n} /**\n   * # Get Sibling After\n   * Get a nearest sibling after the given element which matches\n   * the given query selector.\n   *\n   * @param {Element} el\n   * @param {String} query\n   * @return {Element|Null}\n   *\n   * @module helpers/traversal/get-sibling-after.js\n   */\n\nexports.default = getSiblingAfter;\nmodule.exports = exports['default'];\n//# sourceMappingURL=get-sibling-after.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _matches = require('./matches');\n\nvar _matches2 = _interopRequireDefault(_matches);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getSiblingBefore(el, query) {\n\n  while (el = el.previousElementSibling) {\n    if ((0, _matches2.default)(el, query)) {\n      return el;\n    }\n  }\n\n  return null;\n} /**\n   * # Get Sibling Before\n   * Get a nearest sibling before the given element which matches\n   * the given query selector.\n   *\n   * @param {Element} el\n   * @param {String} query\n   * @return {Element|Null}\n   *\n   * @module helpers/traversal/get-sibling-before.js\n   */\n\nexports.default = getSiblingBefore;\nmodule.exports = exports['default'];\n//# sourceMappingURL=get-sibling-before.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Matches\n * See if an element matches a query selector.\n *\n * @param {Element} el\n * @param {String} query\n * @return {Boolean}\n *\n * @module helpers/traversal/matches.js\n */\nvar vendorMatch = typeof Element !== 'undefined' && (Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector);\n\nfunction matches(el, query) {\n\n  if (vendorMatch) return vendorMatch.call(el, query);\n\n  var nodes = el.parentNode ? el.parentNode.querySelectorAll(query) : [];\n\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i] === el) return true;\n  }\n\n  return false;\n}\n\nexports.default = matches;\nmodule.exports = exports['default'];\n//# sourceMappingURL=matches.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Each\n * Apply a callback function to a list of any kind: Array, NodeList, HTMLCollection or Object.\n *\n * @param {Array|NodeList|HTMLCollection|Object} list\n * @param {Function} cb\n *\n * @example\n * each([], callback);\n * each(el.children, callback);\n * each(el.childNodes, callback);\n * each({}, callback);\n *\n * @module helpers/util/each.js\n */\nfunction each(list, cb) {\n\n  if (!list) {\n    return;\n  }\n\n  if (typeof cb !== 'function') {\n    throw new Error('Cannot invoke `each` without a callback!');\n  }\n\n  var i = 0;\n  var len = list.length;\n\n  // Object\n  if (len === undefined) {\n    for (i in list) {\n      if (i !== 'prototype' && list.hasOwnProperty(i)) {\n        cb(i, list[i]);\n      }\n    }\n  }\n  // Array-like\n  else {\n      for (; i < len; i++) {\n        cb(list[i]);\n      }\n    }\n}\n\nexports.default = each;\nmodule.exports = exports['default'];\n//# sourceMappingURL=each.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Trim\n * Trim whitespace on a string.\n *\n * @param {String} str\n *\n * @module helpers/util/trim.js\n */\n\nvar trimRE = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\nfunction trim(str) {\n  return str.replace(trimRE, '');\n}\n\nexports.default = trim;\nmodule.exports = exports['default'];\n//# sourceMappingURL=trim.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvYmFzZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy9leHBhbmQuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvdGFibGUuanMiLCJqcy9kaXN0L2hlbHBlcnMvYW5pbWF0aW9uL2hlaWdodC5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vYWRkLWNsYXNzLmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS9oYXMtY2xhc3MuanMiLCJqcy9kaXN0L2hlbHBlcnMvZG9tL291dGVyLWhlaWdodC5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vcmVtb3ZlLWNsYXNzLmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MuanMiLCJqcy9kaXN0L2hlbHBlcnMvZm9ybS9mb3JtLWRhdGEuanMiLCJqcy9kaXN0L2hlbHBlcnMvZm9ybS9zZXQtY2FyZXQuanMiLCJqcy9kaXN0L2hlbHBlcnMvdHJhdmVyc2FsL2dldC1pbmRleC5qcyIsImpzL2Rpc3QvaGVscGVycy90cmF2ZXJzYWwvZ2V0LXBhcmVudC5qcyIsImpzL2Rpc3QvaGVscGVycy90cmF2ZXJzYWwvZ2V0LXNpYmxpbmctYWZ0ZXIuanMiLCJqcy9kaXN0L2hlbHBlcnMvdHJhdmVyc2FsL2dldC1zaWJsaW5nLWJlZm9yZS5qcyIsImpzL2Rpc3QvaGVscGVycy90cmF2ZXJzYWwvbWF0Y2hlcy5qcyIsImpzL2Rpc3QvaGVscGVycy91dGlsL2VhY2guanMiLCJqcy9kaXN0L2hlbHBlcnMvdXRpbC90cmltLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlSQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDenpDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoUEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2VhY2ggPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQmFzZSBDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgYmFzZSBjbGFzcyBmb3IgU3BhcmsgSlMgY29tcG9uZW50cy4gVGhpcyBjbGFzcyBzaG91bGQgbmV2ZXIgYmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2Jhc2UuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBCYXNlID0gZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBTZXQgcGFyYW1ldGVycyBhbmQgY2FjaGUgZWxlbWVudHMuXG4gICAqL1xuICBmdW5jdGlvbiBCYXNlKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZSk7XG5cbiAgICBpZiAocGFyYW1zLmVsUmVxdWlyZWQgJiYgIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRQYXJhbXModGhpcy5kZWZhdWx0cyB8fCB7fSwgdHJ1ZSk7XG4gICAgdGhpcy5zZXRQYXJhbXMocGFyYW1zKTtcbiAgICAodGhpcy5fY2FjaGVFbGVtZW50cyB8fCBub29wKS5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTSBhbmQgcHJlcGFyZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGJ5IGRlcmVmZXJlbmNpbmcgdmFsdWVzLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGxlYXZlRWxlbWVudCBMZWF2ZSB0aGUgZWxlbWVudCBpbnRhY3QuXG4gICAqL1xuXG5cbiAgQmFzZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuXG4gICAgaWYgKHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIGlmICghbGVhdmVFbGVtZW50ICYmIHRoaXMuZWwgJiYgdGhpcy5lbC5wYXJlbnROb2RlKSB7XG4gICAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbCk7XG4gICAgfVxuXG4gICAgdGhpcy51bnNldFBhcmFtcyh0aGlzLmRlZmF1bHRzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBPcHRpb25hbFxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShlbCkge1xuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG5cbiAgICBpZiAodGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMuX2NhY2hlRWxlbWVudHMgfHwgbm9vcCkuY2FsbCh0aGlzLCBlbCB8fCB0aGlzLmVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgYSBoYXNoIG9mIHBhcmFtZXRlcnMgaWYgdGhleSdyZSB3aGl0ZWxpc3RlZCBvciB3ZSdyZSB0b2xkIHRvIGZvcmNlIHRoZSBzZXQuXG4gICAqIFRoaXMgaXMgdXNlZCB0byBzZXQgaW5pdGlhbCB2YWx1ZXMgYXMgd2VsbCBhcyBzZXQgcGFzc2VkIHBhcmFtZXRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSBzZXR0aW5nIGV2ZW4gaWYgdGhlIHBhcmFtIGlzIG5vdCB3aGl0ZWxpc3RlZC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS5zZXRQYXJhbXMgPSBmdW5jdGlvbiBzZXRQYXJhbXMocGFyYW1zLCBmb3JjZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHBhcmFtcywgZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgIGlmIChfdGhpcy5fd2hpdGVsaXN0ZWRQYXJhbXMuaW5kZXhPZihrKSAhPT0gLTEgfHwgZm9yY2UpIHtcbiAgICAgICAgX3RoaXNba10gPSB2O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuc2V0IGFsbCBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0ga2V5c1xuICAgKiBAcGFyYW0ge09iamVjdH0gc2NvcGUgVGhlIG9iamVjdCB0byB1bnNldCB0aGUgcGFyYW1zIGZyb20uIERlZmF1bHRzIHRvIGB0aGlzYC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS51bnNldFBhcmFtcyA9IGZ1bmN0aW9uIHVuc2V0UGFyYW1zKGtleXMsIHNjb3BlKSB7XG5cbiAgICBrZXlzID0ga2V5cyBpbnN0YW5jZW9mIEFycmF5ID8ga2V5cyA6IE9iamVjdC5rZXlzKGtleXMpO1xuICAgIHNjb3BlID0gc2NvcGUgfHwgdGhpcztcbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKGtleXMsIGZ1bmN0aW9uIChrKSB7XG4gICAgICBkZWxldGUgc2NvcGVba107XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICByZXR1cm4gQmFzZTtcbn0oKTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5cblxuQmFzZS5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gW107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkJhc2UucHJvdG90eXBlLmRlZmF1bHRzID0ge307XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJhc2U7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhc2UuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfaGVpZ2h0ID0gcmVxdWlyZSgnLi4vaGVscGVycy9hbmltYXRpb24vaGVpZ2h0Jyk7XG5cbnZhciBfaGVpZ2h0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlaWdodCk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MnKTtcblxudmFyIF90b2dnbGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90b2dnbGVDbGFzcyk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfZ2V0UGFyZW50ID0gcmVxdWlyZSgnLi4vaGVscGVycy90cmF2ZXJzYWwvZ2V0LXBhcmVudCcpO1xuXG52YXIgX2dldFBhcmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQYXJlbnQpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBFeHBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEV4cGFuZCBhbmQgY29sbGFwc2UgYW4gZWxlbWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbmV3IEV4cGFuZChlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2V4cGFuZC5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBFeHBhbmQgPSBmdW5jdGlvbiAoX0Jhc2VDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKEV4cGFuZCwgX0Jhc2VDb21wb25lbnQpO1xuXG4gIC8qKlxuICAgKiBFeHBhbmQgY29uc3RydWN0b3IuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKi9cbiAgZnVuY3Rpb24gRXhwYW5kKGVsKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhwYW5kKTtcblxuICAgIHBhcmFtcy5lbFJlcXVpcmVkID0gdHJ1ZTtcblxuICAgIGlmICghKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0Jhc2VDb21wb25lbnQuY2FsbCh0aGlzLCBlbCwgcGFyYW1zKSksIF90aGlzKSkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKTtcbiAgICBfdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cGFuZFxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuZXhwYW5kID0gZnVuY3Rpb24gZXhwYW5kKCkge1xuXG4gICAgKHRoaXMub25CZWZvcmVFeHBhbmQgfHwgbm9vcCkoKTtcblxuICAgICgwLCBfaGVpZ2h0Mi5kZWZhdWx0KSh7XG4gICAgICBlbDogdGhpcy5lbCxcbiAgICAgIHRvZ2dsZUNsYXNzOiAnZXhwYW5kZWQnLFxuICAgICAgdG9nZ2xlRWw6ICcuc3BhcmstZXhwYW5kX19jb250ZW50LCAuc3BhcmstcGFuZWxfX2NvbnRlbnQnXG4gICAgfSk7XG5cbiAgICB0aGlzLmlzRXhwYW5kZWQgPSB0cnVlO1xuICAgIHRoaXMuX3VwZGF0ZUNsYXNzZXMoKTtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuICAgIGUuaW5pdEV2ZW50KCdzcGFyay52aXNpYmxlLWNoaWxkcmVuJywgdHJ1ZSwgdHJ1ZSk7XG4gICAgdGhpcy5lbC5kaXNwYXRjaEV2ZW50KGUpO1xuXG4gICAgLy8gSWYgdGhlIGV4cGFuZCBlbGVtZW50IGhhdmUgaW5wdXQsIGZvY3VzIG9uIHRoZSBmaXJzdCBvbmUuXG4gICAgaWYgKHRoaXMuZWwucXVlcnlTZWxlY3RvcignaW5wdXQnKSkge1xuICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMub25BZnRlckV4cGFuZCB8fCBub29wKSgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbGxhcHNlXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS5jb2xsYXBzZSA9IGZ1bmN0aW9uIGNvbGxhcHNlKCkge1xuXG4gICAgKHRoaXMub25CZWZvcmVDb2xsYXBzZSB8fCBub29wKSgpO1xuXG4gICAgKDAsIF9oZWlnaHQyLmRlZmF1bHQpKHtcbiAgICAgIGVsOiB0aGlzLmVsLFxuICAgICAgdG9nZ2xlRWw6ICcuc3BhcmstZXhwYW5kX19jb250ZW50LCAuc3BhcmstcGFuZWxfX2NvbnRlbnQnLFxuICAgICAgdG9nZ2xlVmFsdWU6ICdub25lJyxcbiAgICAgIGFjdGlvbjogJ2NvbGxhcHNlJ1xuICAgIH0pO1xuXG4gICAgdGhpcy5pc0V4cGFuZGVkID0gZmFsc2U7XG4gICAgdGhpcy5fdXBkYXRlQ2xhc3NlcygpO1xuXG4gICAgKHRoaXMub25BZnRlckNvbGxhcHNlIHx8IG5vb3ApKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIHRoZSBleHBhbmQgc3RhdGUuXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7XG4gICAgcmV0dXJuIHRoaXNbdGhpcy5pc0V4cGFuZGVkID8gJ2NvbGxhcHNlJyA6ICdleHBhbmQnXSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZSBhIHJlZmVyZW5jZSB0byB0aGUgZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX2NhY2hlRWxlbWVudHMgPSBmdW5jdGlvbiBfY2FjaGVFbGVtZW50cyhlbCkge1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLmlzRXhwYW5kZWQgPSAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnZXhwYW5kZWQnKTtcblxuICAgIHRoaXMuYWNjb3JkaW9uSGVhZGluZyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignW3JvbGU9XCJoZWFkaW5nXCJdJyk7XG4gICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstcGFuZWxfX2NvbnRlbnQnKTtcblxuICAgIHRoaXMucGFuZWxDb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZXhwYW5kX19jb250ZW50Jyk7XG4gICAgdGhpcy5wYW5lbENvbGxhcHNlZEJ1dHRvbiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWV4cGFuZF9faGlkZS0tZXhwYW5kZWQnKTtcbiAgICB0aGlzLnBhbmVsRXhwYW5kZWRCdXR0b24gPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1leHBhbmRfX3Nob3ctLWV4cGFuZGVkJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjbGFzc2VzIGZvciB0aGUgZXhwYW5kIG9yIGNvbGxhcHNlIHN0YXRlLlxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX3VwZGF0ZUNsYXNzZXMgPSBmdW5jdGlvbiBfdXBkYXRlQ2xhc3NlcygpIHtcbiAgICAoMCwgX3RvZ2dsZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnZXhwYW5kZWQnLCB0aGlzLmlzRXhwYW5kZWQpO1xuICAgIHRoaXMuX3VwZGF0ZUFyaWFBdHRyaWJ1dGVzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhcmlhIGF0dHJpYnV0ZXMgZm9yIHRoZSBleHBhbmQgb3IgY29sbGFwc2Ugc3RhdGUuXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS5fdXBkYXRlQXJpYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiBfdXBkYXRlQXJpYUF0dHJpYnV0ZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNFeHBhbmRlZCkge1xuICAgICAgdGhpcy5hY2NvcmRpb25IZWFkaW5nID8gdGhpcy5hY2NvcmRpb25IZWFkaW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJykgOiBudWxsO1xuICAgICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID8gdGhpcy5hY2NvcmRpb25Db250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKSA6IG51bGw7XG5cbiAgICAgIHRoaXMucGFuZWxDb250ZW50ID8gdGhpcy5wYW5lbENvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpIDogbnVsbDtcbiAgICAgIHRoaXMucGFuZWxDb2xsYXBzZWRCdXR0b24gPyB0aGlzLnBhbmVsQ29sbGFwc2VkQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcbiAgICAgIHRoaXMucGFuZWxFeHBhbmRlZEJ1dHRvbiA/IHRoaXMucGFuZWxFeHBhbmRlZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFjY29yZGlvbkhlYWRpbmcgPyB0aGlzLmFjY29yZGlvbkhlYWRpbmcuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID8gdGhpcy5hY2NvcmRpb25Db250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcblxuICAgICAgdGhpcy5wYW5lbENvbnRlbnQgPyB0aGlzLnBhbmVsQ29udGVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKSA6IG51bGw7XG4gICAgICB0aGlzLnBhbmVsQ29sbGFwc2VkQnV0dG9uID8gdGhpcy5wYW5lbENvbGxhcHNlZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgICAgdGhpcy5wYW5lbEV4cGFuZGVkQnV0dG9uID8gdGhpcy5wYW5lbEV4cGFuZGVkQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIF9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpIHtcbiAgICB0aGlzLl9vbkNsaWNrQm91bmQgPSB0aGlzLl9vbkNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25LZXlkb3duQm91bmQgPSB0aGlzLl9vbktleWRvd24uYmluZCh0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgRE9NIGV2ZW50cy5cbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9hZGRFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGlja0JvdW5kKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleWRvd25Cb3VuZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBldmVudCBsaXN0ZW5lcnMgZm9yIERPTSBldmVudHMuLlxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX3JlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsaWNrQm91bmQpO1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5ZG93bkJvdW5kKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB3ZSBhcmUgY2xpY2tlZCwgdG9nZ2xlIHRoZSBleHBhbmRlZCBzdGF0ZS5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9vbkNsaWNrID0gZnVuY3Rpb24gX29uQ2xpY2soZSkge1xuXG4gICAgaWYgKCEoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkoZS50YXJnZXQsICcuc3BhcmstZXhwYW5kX190b2dnbGUsIFtkYXRhLXJvbGU9XCJ0b2dnbGVcIl0sIFtyb2xlPVwiaGVhZGluZ1wiXScsIHRoaXMuZWwpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMudG9nZ2xlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHNwYWNlIG9yIGVudGVyIGtleSBpcyBwcmVzc2VkIG9uIHRoZSB0b2dnbGUsIHRvZ2dsZSFcbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9vbktleWRvd24gPSBmdW5jdGlvbiBfb25LZXlkb3duKGUpIHtcblxuICAgIGlmICghKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKGUudGFyZ2V0LCAnLnNwYXJrLWV4cGFuZF9fdG9nZ2xlLCBbZGF0YS1yb2xlPVwidG9nZ2xlXCJdLCBbcm9sZT1cImhlYWRpbmdcIl0nLCB0aGlzLmVsKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBjb2RlID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICAvLyBTcGFjZSBvciBlbnRlclxuICAgIGlmIChjb2RlID09PSAzMiB8fCBjb2RlID09PSAxMykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEV4cGFuZDtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5FeHBhbmQucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsnb25CZWZvcmVFeHBhbmQnLCAnb25BZnRlckV4cGFuZCcsICdvbkJlZm9yZUNvbGxhcHNlJywgJ29uQWZ0ZXJDb2xsYXBzZSddO1xuXG4vKipcbiAqIERlZmF1bHQgdmFsdWVzIGZvciBpbnRlcm5hbCBwcm9wZXJ0aWVzIHdlIHdpbGwgYmUgc2V0dGluZy5cbiAqIFRoZXNlIGFyZSBzZXQgb24gZWFjaCBjb25zdHJ1Y3Rpb24gc28gd2UgZG9uJ3QgbGVhayBwcm9wZXJ0aWVzXG4gKiBpbnRvIHRoZSBwcm90b3R5cGUgY2hhaW4uXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5FeHBhbmQucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbCxcbiAgaXNFeHBhbmRlZDogZmFsc2UsXG4gIG9uQmVmb3JlRXhwYW5kOiBudWxsLFxuICBvbkFmdGVyRXhwYW5kOiBudWxsLFxuICBvbkJlZm9yZUNvbGxhcHNlOiBudWxsLFxuICBvbkFmdGVyQ29sbGFwc2U6IG51bGwsXG4gIF9vbkNsaWNrQm91bmQ6IG51bGwsXG4gIF9vbktleWRvd25Cb3VuZDogbnVsbFxufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRXhwYW5kO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1leHBhbmQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfZXhwYW5kID0gcmVxdWlyZSgnLi9leHBhbmQnKTtcblxudmFyIF9leHBhbmQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhwYW5kKTtcblxudmFyIF9zZXRDYXJldCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZm9ybS9zZXQtY2FyZXQnKTtcblxudmFyIF9zZXRDYXJldDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9zZXRDYXJldCk7XG5cbnZhciBfZm9ybURhdGEgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2Zvcm0vZm9ybS1kYXRhJyk7XG5cbnZhciBfZWFjaCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbC9lYWNoJyk7XG5cbnZhciBfZWFjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9lYWNoKTtcblxudmFyIF9oYXNDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL2hhcy1jbGFzcycpO1xuXG52YXIgX2hhc0NsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhc0NsYXNzKTtcblxudmFyIF90b2dnbGVDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL3RvZ2dsZS1jbGFzcycpO1xuXG52YXIgX3RvZ2dsZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RvZ2dsZUNsYXNzKTtcblxudmFyIF9hZGRDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL2FkZC1jbGFzcycpO1xuXG52YXIgX2FkZENsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FkZENsYXNzKTtcblxudmFyIF9yZW1vdmVDbGFzcyA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL3JlbW92ZS1jbGFzcycpO1xuXG52YXIgX3JlbW92ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbW92ZUNsYXNzKTtcblxudmFyIF9nZXRQYXJlbnQgPSByZXF1aXJlKCcuLi9oZWxwZXJzL3RyYXZlcnNhbC9nZXQtcGFyZW50Jyk7XG5cbnZhciBfZ2V0UGFyZW50MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2dldFBhcmVudCk7XG5cbnZhciBfZ2V0SW5kZXggPSByZXF1aXJlKCcuLi9oZWxwZXJzL3RyYXZlcnNhbC9nZXQtaW5kZXgnKTtcblxudmFyIF9nZXRJbmRleDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRJbmRleCk7XG5cbnZhciBfZ2V0U2libGluZ0JlZm9yZSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdHJhdmVyc2FsL2dldC1zaWJsaW5nLWJlZm9yZScpO1xuXG52YXIgX2dldFNpYmxpbmdCZWZvcmUyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0U2libGluZ0JlZm9yZSk7XG5cbnZhciBfZ2V0U2libGluZ0FmdGVyID0gcmVxdWlyZSgnLi4vaGVscGVycy90cmF2ZXJzYWwvZ2V0LXNpYmxpbmctYWZ0ZXInKTtcblxudmFyIF9nZXRTaWJsaW5nQWZ0ZXIyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0U2libGluZ0FmdGVyKTtcblxudmFyIF9tYXRjaGVzID0gcmVxdWlyZSgnLi4vaGVscGVycy90cmF2ZXJzYWwvbWF0Y2hlcycpO1xuXG52YXIgX21hdGNoZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWF0Y2hlcyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAjIFRhYmxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldyBUYWJsZShlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL3RhYmxlLmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxudmFyIFRhYmxlID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhUYWJsZSwgX0Jhc2VDb21wb25lbnQpO1xuXG4gIC8qKlxuICAgKiBUYWJsZSBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAqL1xuICBmdW5jdGlvbiBUYWJsZShlbCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRhYmxlKTtcblxuICAgIHBhcmFtcy5lbFJlcXVpcmVkID0gdHJ1ZTtcblxuICAgIGlmICghKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0Jhc2VDb21wb25lbnQuY2FsbCh0aGlzLCBlbCwgcGFyYW1zKSksIF90aGlzKSkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKTtcbiAgICBfdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIF90aGlzLl9pbml0Um93cygpO1xuXG4gICAgaWYgKF90aGlzLmlzU3ByZWFkc2hlZXQgfHwgX3RoaXMuaXNFZGl0Um93cykge1xuICAgICAgX3RoaXMuX2RlYWN0aXZhdGVBbGxJbnB1dHMoKTtcbiAgICB9XG5cbiAgICBpZiAoX3RoaXMuaXNSZXNpemFibGUpIHtcbiAgICAgIF90aGlzLl9pbml0UmVzaXplKCk7XG4gICAgfVxuXG4gICAgX3RoaXMuX2Rpc2FibGVSb3dzQ29sdW1uc0NlbGxzKCk7XG5cbiAgICBfdGhpcy5faW5pdEV4cGFuZHMoKTtcbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc2FibGUgdGhlIGZvcm0gZmllbGQgaW4gYSB0YWJsZSBjZWxsLlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLmRpc2FibGVDZWxsID0gZnVuY3Rpb24gZGlzYWJsZUNlbGwoZWwpIHtcbiAgICBlbC5kaXNhYmxlZCA9IHRydWU7XG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkoKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKGVsLCAndGQnKSwgJ3NwYXJrLXRhYmxlX19kaXNhYmxlZC1jZWxsJyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVuYWJsZSB0aGUgZm9ybSBmaWVsZCBpbiBhIHRhYmxlIGNlbGwuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuZW5hYmxlQ2VsbCA9IGZ1bmN0aW9uIGVuYWJsZUNlbGwoZWwpIHtcbiAgICBlbC5kaXNhYmxlZCA9IGZhbHNlO1xuICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKCgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KShlbCwgJ3RkJyksICdzcGFyay10YWJsZV9fZGlzYWJsZWQtY2VsbCcpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGEgcm93IGFuZCBhbGwgdGhlIGNlbGxzIGluc2lkZSBvZiBpdC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5kaXNhYmxlUm93ID0gZnVuY3Rpb24gZGlzYWJsZVJvdyhlbCkge1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKGVsLCAnc3BhcmstdGFibGVfX2Rpc2FibGVkLXJvdycpO1xuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkoZWwucXVlcnlTZWxlY3RvckFsbCgnaW5wdXQsIGJ1dHRvbiwgYScpLCBmdW5jdGlvbiAoaSkge1xuICAgICAgaS5kaXNhYmxlZCA9IHRydWU7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBhIHJvdyBhbmQgYWxsIHRoZSBjZWxscyBpbnNpZGUgb2YgaXQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuZW5hYmxlUm93ID0gZnVuY3Rpb24gZW5hYmxlUm93KGVsKSB7XG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkoZWwsICdzcGFyay10YWJsZV9fZGlzYWJsZWQtcm93Jyk7XG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KShlbC5xdWVyeVNlbGVjdG9yQWxsKCdpbnB1dCwgYnV0dG9uLCBhJyksIGZ1bmN0aW9uIChpKSB7XG4gICAgICBpLmRpc2FibGVkID0gZmFsc2U7XG4gICAgfSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIERpc2FibGUgYSBjb2x1bW4gYW5kIGFsbCB0aGUgY2VsbHMgaW5zaWRlIG9mIGl0LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLmRpc2FibGVDb2x1bW4gPSBmdW5jdGlvbiBkaXNhYmxlQ29sdW1uKGVsKSB7XG5cbiAgICB2YXIgaW5kZXggPSAoMCwgX2dldEluZGV4Mi5kZWZhdWx0KShlbC5wYXJlbnROb2RlLmNoaWxkcmVuLCBlbCk7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICB0aGlzLmRpc2FibGVDZWxsKHJvdy5jaGlsZHJlbltpbmRleF0ucXVlcnlTZWxlY3RvcignaW5wdXQnKSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKGVsLCAnc3BhcmstdGFibGVfX2Rpc2FibGVkLWNvbHVtbicpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBhIGNvbHVtbiBhbmQgYWxsIHRoZSBjZWxscyBpbnNpZGUgb2YgaXQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuZW5hYmxlQ29sdW1uID0gZnVuY3Rpb24gZW5hYmxlQ29sdW1uKGVsKSB7XG5cbiAgICB2YXIgaW5kZXggPSAoMCwgX2dldEluZGV4Mi5kZWZhdWx0KShlbC5wYXJlbnROb2RlLmNoaWxkcmVuLCBlbCk7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpLCBmdW5jdGlvbiAocm93KSB7XG4gICAgICB0aGlzLmVuYWJsZUNlbGwocm93LmNoaWxkcmVuW2luZGV4XS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpKTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkoZWwsICdzcGFyay10YWJsZV9fZGlzYWJsZWQtY29sdW1uJyk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSB0YWJsZSBhbmMgY2xlYW51cC5cbiAgICogQHBhcmFtIHtCb29sZWFufSBsZWF2ZUVsZW1lbnQgTGVhdmUgdGhlIGVsZW1lbnQgaW50YWN0LlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUobGVhdmVFbGVtZW50KSB7XG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KSh0aGlzLl9leHBhbmRzLCBmdW5jdGlvbiAoZSkge1xuICAgICAgZS5yZW1vdmUobGVhdmVFbGVtZW50KTtcbiAgICB9KTtcbiAgICByZXR1cm4gX0Jhc2VDb21wb25lbnQucHJvdG90eXBlLnJlbW92ZS5jYWxsKHRoaXMsIGxlYXZlRWxlbWVudCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFjdGl2YXRlIGEgcm93LlxuICAgKiBAcGFyYW0ge051bWJlcnxFbGVtZW50fSByb3dcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuYWN0aXZhdGVSb3cgPSBmdW5jdGlvbiBhY3RpdmF0ZVJvdyhyb3cpIHtcbiAgICByb3cgPSB0eXBlb2Ygcm93ID09PSAnbnVtYmVyJyA/IHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0cicpW3Jvd10gOiByb3c7XG4gICAgaWYgKHJvdykgdGhpcy5fbWFrZVJvd0FjdGl2ZShyb3cpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBY3RpdmF0ZSBtdWx0aXBsZSByb3dzLlxuICAgKiBAcGFyYW0ge0FycmF5fSByb3dzXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLmFjdGl2YXRlUm93cyA9IGZ1bmN0aW9uIGFjdGl2YXRlUm93cyhyb3dzKSB7XG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KShyb3dzLCB0aGlzLmFjdGl2YXRlUm93LmJpbmQodGhpcykpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWFjdGl2YXRlIGEgcm93LlxuICAgKiBAcGFyYW0ge051bWJlcnxFbGVtZW50fSByb3dcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuZGVhY3RpdmF0ZVJvdyA9IGZ1bmN0aW9uIGRlYWN0aXZhdGVSb3cocm93KSB7XG4gICAgcm93ID0gdHlwZW9mIHJvdyA9PT0gJ251bWJlcicgPyB0aGlzLnRhYmxlRWwucXVlcnlTZWxlY3RvckFsbCgndGJvZHkgdHInKVtyb3ddIDogcm93O1xuICAgIGlmIChyb3cpIHRoaXMuX21ha2VSb3dJbkFjdGl2ZShyb3cpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWFjdGl2YXRlIG11bHRpcGxlIHJvd3MuXG4gICAqIEBwYXJhbSB7QXJyYXl9IHJvd3NcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuZGVhY3RpdmF0ZVJvd3MgPSBmdW5jdGlvbiBkZWFjdGl2YXRlUm93cyhyb3dzKSB7XG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KShyb3dzLCB0aGlzLmRlYWN0aXZhdGVSb3cuYmluZCh0aGlzKSk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCBhbiBhcnJheSBvZiBjdXJyZW50bHkgYWN0aXZlIHJvd3MuXG4gICAqIEByZXR1cm4ge0FycmF5fVxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5nZXRBY3RpdmVSb3dzID0gZnVuY3Rpb24gZ2V0QWN0aXZlUm93cygpIHtcblxuICAgIHZhciBhcnIgPSBbXTtcblxuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCd0Ym9keSB0ci5hY3RpdmUnKSwgZnVuY3Rpb24gKHRyKSB7XG4gICAgICBhcnIucHVzaCh0cik7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYXJyO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKGVsKSB7XG5cbiAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuXG4gICAgdGhpcy5fY2FjaGVFbGVtZW50cyhlbCB8fCB0aGlzLmVsKTtcbiAgICB0aGlzLl9wYXJzZVBhcmFtcygpO1xuXG4gICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2luaXRSb3dzKCk7XG5cbiAgICBpZiAodGhpcy5pc1NwcmVhZHNoZWV0IHx8IHRoaXMuaXNFZGl0Um93cykge1xuICAgICAgdGhpcy5fZGVhY3RpdmF0ZUFsbElucHV0cygpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmlzUmVzaXphYmxlKSB7XG4gICAgICB0aGlzLl9pbml0UmVzaXplKCk7XG4gICAgfVxuXG4gICAgdGhpcy5fZGlzYWJsZVJvd3NDb2x1bW5zQ2VsbHMoKTtcblxuICAgIHRoaXMuX2luaXRFeHBhbmRzKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU3RvcmUgYSByZWZlcmVuY2UgdG8gdGhlIHRhYnMgbGlzdCwgZWFjaCB0YWIgYW5kIGVhY2ggcGFuZWwuXG4gICAqIFNldCB3aGljaCB0YWIgaXMgYWN0aXZlLCBvciB1c2UgdGhlIGZpcnN0LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9jYWNoZUVsZW1lbnRzID0gZnVuY3Rpb24gX2NhY2hlRWxlbWVudHMoZWwpIHtcbiAgICB0aGlzLmVsID0gZWw7XG4gICAgdGhpcy50YWJsZUVsID0gZWwucXVlcnlTZWxlY3RvcigndGFibGUnKTtcbiAgfTtcblxuICAvKipcbiAgICogUGFyc2UgcGFyYW1ldGVycyBmcm9tIHRoZSBlbGVtZW50cy5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX3BhcnNlUGFyYW1zID0gZnVuY3Rpb24gX3BhcnNlUGFyYW1zKCkge1xuXG4gICAgaWYgKCF0aGlzLnRhYmxlRWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLmlzU3ByZWFkc2hlZXQgPSB0aGlzLmlzU3ByZWFkc2hlZXQgIT09IG51bGwgPyB0aGlzLmlzU3ByZWFkc2hlZXQgOiAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnc3BhcmstdGFibGUtLXNwcmVhZHNoZWV0JykgPyB0cnVlIDogZmFsc2U7XG4gICAgdGhpcy5pc0VkaXRSb3dzID0gdGhpcy5pc0VkaXRSb3dzICE9PSBudWxsID8gdGhpcy5pc0VkaXRSb3dzIDogKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLXRhYmxlLS1lZGl0LXJvd3MnKSA/IHRydWUgOiBmYWxzZTtcbiAgICB0aGlzLmlzUmVzaXphYmxlID0gdGhpcy5pc1Jlc2l6YWJsZSAhPT0gbnVsbCA/IHRoaXMuaXNSZXNpemFibGUgOiAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnc3BhcmstdGFibGUtLXJlc2l6YWJsZScpID8gdHJ1ZSA6IGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYm91bmQgdmVyc2lvbnMgb2YgZXZlbnQgbGlzdGVuZXIgY2FsbGJhY2tzIGFuZCBzdG9yZSB0aGVtLlxuICAgKiBPdGhlcndpc2Ugd2UgY2FuJ3QgdW5iaW5kIGZyb20gdGhlc2UgZXZlbnRzIGxhdGVyIGJlY2F1c2UgdGhlXG4gICAqIGZ1bmN0aW9uIHNpZ25hdHVyZXMgd29uJ3QgbWF0Y2guXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIF9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpIHtcblxuICAgIHRoaXMuX29uQ2xpY2tCb3VuZCA9IHRoaXMuX29uQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkNoYW5nZUJvdW5kID0gdGhpcy5fb25DaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkZvY3VzQm91bmQgPSB0aGlzLl9vbkZvY3VzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25CbHVyQm91bmQgPSB0aGlzLl9vbkJsdXIuYmluZCh0aGlzKTtcblxuICAgIHRoaXMuX29uVG91Y2hzdGFydEJvdW5kID0gdGhpcy5fb25Ub3VjaHN0YXJ0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25Ub3VjaGVuZEJvdW5kID0gdGhpcy5fb25Ub3VjaGVuZC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uS2V5ZG93bkJvdW5kID0gdGhpcy5fb25LZXlkb3duLmJpbmQodGhpcyk7XG5cbiAgICB0aGlzLl9vbk1vdXNlRG93bkJvdW5kID0gdGhpcy5fb25Nb3VzZURvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbk1vdXNlTW92ZUJvdW5kID0gdGhpcy5fb25Nb3VzZU1vdmUuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbk1vdXNlVXBCb3VuZCA9IHRoaXMuX29uTW91c2VVcC5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBET00gZXZlbnRzLlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG5cbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGlja0JvdW5kLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9vbkNoYW5nZUJvdW5kLCBmYWxzZSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsIHRoaXMuX29uRm9jdXNCb3VuZCwgdHJ1ZSk7XG4gICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQsIHRydWUpO1xuXG4gICAgaWYgKHRoaXMuaXNTcHJlYWRzaGVldCkge1xuICAgICAgdGhpcy5lbC5hZGRFdmVudExpc3RlbmVyKCd0b3VjaHN0YXJ0JywgdGhpcy5fb25Ub3VjaHN0YXJ0Qm91bmQsIGZhbHNlKTtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2hlbmQnLCB0aGlzLl9vblRvdWNoZW5kQm91bmQsIGZhbHNlKTtcbiAgICAgIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5ZG93bkJvdW5kLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNSZXNpemFibGUpIHtcbiAgICAgIHRoaXMudGFibGVFbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCB0aGlzLl9vbk1vdXNlRG93bkJvdW5kLCBmYWxzZSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZvciBET00gZXZlbnRzLi5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX3JlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuXG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uQ2xpY2tCb3VuZCk7XG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLl9vbkNoYW5nZUJvdW5kKTtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgdGhpcy5fb25Gb2N1c0JvdW5kKTtcbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG5cbiAgICB0aGlzLmVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCB0aGlzLl9vblRvdWNoc3RhcnRCb3VuZCk7XG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaGVuZCcsIHRoaXMuX29uVG91Y2hlbmRCb3VuZCk7XG4gICAgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fb25LZXlkb3duQm91bmQpO1xuXG4gICAgdGhpcy50YWJsZUVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ21vdXNlZG93bicsIHRoaXMuX29uTW91c2VEb3duQm91bmQpO1xuXG4gICAgdGhpcy5fcmVtb3ZlUmVzaXplTGlzdGVuZXJzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBsaXN0ZW5lcnMgZm9yIG1vdXNlbW92ZSBhbmQgbW91c2V1cCBldmVudHMuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9hZGRSZXNpemVMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkUmVzaXplTGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9vbk1vdXNlTW92ZUJvdW5kLCBmYWxzZSk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCB0aGlzLl9vbk1vdXNlVXBCb3VuZCwgZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgbGlzdGVuZXJzIGZvciBtb3N1ZW1vdmUgYW5kIG1vdXNldXAuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9yZW1vdmVSZXNpemVMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfcmVtb3ZlUmVzaXplTGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdtb3VzZW1vdmUnLCB0aGlzLl9vbk1vdXNlTW92ZUJvdW5kKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2V1cCcsIHRoaXMuX29uTW91c2VVcEJvdW5kKTtcbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIHRoZSBhY3RpdmUgc3RhdGUgb24gYSByb3cuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSByb3dcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX3RvZ2dsZVJvd0FjdGl2ZSA9IGZ1bmN0aW9uIF90b2dnbGVSb3dBY3RpdmUocm93KSB7XG5cbiAgICBpZiAoKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkocm93LCAnYWN0aXZlJykpIHtcbiAgICAgIHRoaXMuX21ha2VSb3dJbkFjdGl2ZShyb3cpO1xuICAgICAgdGhpcy5fdW5jaGVja1NlbGVjdEFsbCgpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9tYWtlUm93QWN0aXZlKHJvdyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBNYWtlIGEgcm93IGFjdGl2ZVxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHJvd1xuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fbWFrZVJvd0FjdGl2ZSA9IGZ1bmN0aW9uIF9tYWtlUm93QWN0aXZlKHJvdykge1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHJvdywgJ2FjdGl2ZScpO1xuICAgIChyb3cucXVlcnlTZWxlY3RvcignLnNwYXJrLXRhYmxlX19jaGVja2JveCBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl06bm90KFtkaXNhYmxlZF0pJykgfHwge30pLmNoZWNrZWQgPSB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNYWtlIGEgcm93IGFjdGl2ZVxuICAgKiBAcGFyYW0gIHtFbGVtZW50fSByb3dcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX21ha2VSb3dJbkFjdGl2ZSA9IGZ1bmN0aW9uIF9tYWtlUm93SW5BY3RpdmUocm93KSB7XG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkocm93LCAnYWN0aXZlJyk7XG4gICAgKHJvdy5xdWVyeVNlbGVjdG9yKCcuc3BhcmstdGFibGVfX2NoZWNrYm94IGlucHV0W3R5cGU9XCJjaGVja2JveFwiXTpub3QoW2Rpc2FibGVkXSknKSB8fCB7fSkuY2hlY2tlZCA9IGZhbHNlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgYWN0aXZlIG9uIGVhY2ggcm93LlxuICAgKiBAcGFyYW0ge05vZGVMaXN0fSByb3dzXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gYWN0aXZlXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl90b2dnbGVSb3dzQWN0aXZlID0gZnVuY3Rpb24gX3RvZ2dsZVJvd3NBY3RpdmUocm93cywgYWN0aXZlKSB7XG5cbiAgICB2YXIgZnVuYyA9IGFjdGl2ZSA/ICdfbWFrZVJvd0FjdGl2ZScgOiAnX21ha2VSb3dJbkFjdGl2ZSc7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBsZW4gPSByb3dzLmxlbmd0aDtcblxuICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHRoaXNbZnVuY10ocm93c1tpXSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBUb2dnbGUgd2hldGhlciBldmVyeXRoaW5nIHNob3VsZCBiZSBzZWxlY3RlZC4gRmluZCB0aGUgY2hlY2tib3ggaW5wdXQgaW5zaWRlIG9mIHRoZVxuICAgKiBnaXZlbiBlbGVtZW50IGFuZCBpbnZlcnQgaXRzIHN0YXRlLlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl90b2dnbGVTZWxlY3RBbGwgPSBmdW5jdGlvbiBfdG9nZ2xlU2VsZWN0QWxsKGVsKSB7XG5cbiAgICB2YXIgY2hlY2tib3ggPSBlbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstdGFibGVfX3NlbGVjdC1hbGwgaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJyk7XG5cbiAgICBpZiAoIWNoZWNrYm94KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fdG9nZ2xlUm93c0FjdGl2ZSh0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ3Rib2R5IHRyJyksICFjaGVja2JveC5jaGVja2VkKTtcblxuICAgIGNoZWNrYm94LmNoZWNrZWQgPSAhY2hlY2tib3guY2hlY2tlZDtcbiAgfTtcblxuICAvKipcbiAgICogVW5jaGVjayB0aGUgc2VsZWN0IGFsbCBjaGVja2JveGVzLlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fdW5jaGVja1NlbGVjdEFsbCA9IGZ1bmN0aW9uIF91bmNoZWNrU2VsZWN0QWxsKCkge1xuXG4gICAgdmFyIGNoZWNrYm94ZXMgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zcGFyay10YWJsZV9fc2VsZWN0LWFsbCBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0nKTtcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGxlbiA9IGNoZWNrYm94ZXMubGVuZ3RoO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgY2hlY2tib3hlc1tpXS5jaGVja2VkID0gZmFsc2U7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBEZWFjdGl2YXRlIGVkaXRpbmcgaW4gYWxsIGlucHV0IGZpZWxkcy5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2RlYWN0aXZhdGVBbGxJbnB1dHMgPSBmdW5jdGlvbiBfZGVhY3RpdmF0ZUFsbElucHV0cygpIHtcblxuICAgIGlmICghdGhpcy50YWJsZUVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fZGVhY3RpdmF0ZUlucHV0cyh0aGlzLnRhYmxlRWwpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEZWFjdGl2YXRlIGFsbCB0aGUgaW5wdXRzIGluc2lkZSBhbiBlbGVtZW50XG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2RlYWN0aXZhdGVJbnB1dHMgPSBmdW5jdGlvbiBfZGVhY3RpdmF0ZUlucHV0cyhlbCkge1xuXG4gICAgdmFyIGlucHV0cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Om5vdChbdHlwZT1cImNoZWNrYm94XCJdKScpO1xuICAgIHZhciBpID0gMDtcblxuICAgIHZhciBsZW4gPSBpbnB1dHMubGVuZ3RoO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgdGhpcy5fZGVhY3RpdmF0ZUlucHV0KGlucHV0c1tpXSk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBNYWtlIGFuIGlucHV0IGZpZWxkIHJlYWRvbmx5LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGlucHV0XG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9kZWFjdGl2YXRlSW5wdXQgPSBmdW5jdGlvbiBfZGVhY3RpdmF0ZUlucHV0KGlucHV0KSB7XG4gICAgaW5wdXQuc2V0QXR0cmlidXRlKCdyZWFkb25seScsICcnKTtcbiAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShpbnB1dC5wYXJlbnROb2RlLCAnZWRpdGluZycpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBY3RpdmF0ZSBhbGwgdGhlIGlucHV0cyBpbnNpZGUgYW4gZWxlbWVudFxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9hY3RpdmF0ZUlucHV0cyA9IGZ1bmN0aW9uIF9hY3RpdmF0ZUlucHV0cyhlbCkge1xuXG4gICAgdmFyIGlucHV0cyA9IGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0Om5vdChbdHlwZT1cImNoZWNrYm94XCJdKScpO1xuICAgIHZhciBpID0gMDtcblxuICAgIHZhciBsZW4gPSBpbnB1dHMubGVuZ3RoO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgdGhpcy5fYWN0aXZhdGVJbnB1dChpbnB1dHNbaV0pO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogTWFrZSBhbiBpbnB1dCBmaWVsZCByZWFkYWJsZS5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dFxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fYWN0aXZhdGVJbnB1dCA9IGZ1bmN0aW9uIF9hY3RpdmF0ZUlucHV0KGlucHV0KSB7XG4gICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdyZWFkb25seScpO1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKGlucHV0LnBhcmVudE5vZGUsICdlZGl0aW5nJyk7XG4gICAgaWYgKGlucHV0LnR5cGUgIT09ICdjaGVja2JveCcgJiYgaW5wdXQudHlwZSAhPT0gJ3JhZGlvJykge1xuICAgICAgKDAsIF9zZXRDYXJldDIuZGVmYXVsdCkoaW5wdXQsIC0xKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEFjdGl2YXRlIGFuIGlucHV0LCB1bmxlc3MgaXQncyBhbHJlYWR5IGVuYWJsZWQgaW4gd2hpY2ggY2FzZVxuICAgKiB0aGUgZm9jdXMgc2hvdWxkIG1vdmUgZG93biBhIHJvdy5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dFxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fYWN0aXZhdGVJbnB1dE9yRm9jdXNEb3duID0gZnVuY3Rpb24gX2FjdGl2YXRlSW5wdXRPckZvY3VzRG93bihpbnB1dCkge1xuXG4gICAgLy8gQ3VycmVudGx5IHJlYWRvbmx5XG4gICAgaWYgKGlucHV0LmdldEF0dHJpYnV0ZSgncmVhZG9ubHknKSA9PT0gJycpIHtcbiAgICAgIHRoaXMuX2FjdGl2YXRlSW5wdXQoaW5wdXQpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2ZvY3VzRG93bihpbnB1dCwgdHJ1ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZpbmQgYWxsIHRoZSByb3dzLCBjb2x1bW5zIGFuZCBjZWxscyB0aGF0IHNob3VsZCBiZSBkaXNhYmxlZC5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2Rpc2FibGVSb3dzQ29sdW1uc0NlbGxzID0gZnVuY3Rpb24gX2Rpc2FibGVSb3dzQ29sdW1uc0NlbGxzKCkge1xuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkodGhpcy50YWJsZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkIGlucHV0W2Rpc2FibGVkXScpLCB0aGlzLmRpc2FibGVDZWxsLmJpbmQodGhpcykpO1xuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkodGhpcy50YWJsZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJy5zcGFyay10YWJsZV9fZGlzYWJsZWQtcm93JyksIHRoaXMuZGlzYWJsZVJvdy5iaW5kKHRoaXMpKTtcbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstdGFibGVfX2Rpc2FibGVkLWNvbHVtbicpLCB0aGlzLmRpc2FibGVDb2x1bW4uYmluZCh0aGlzKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdmUgb3VyIGZvY3VzIHVwIGEgcm93IGZyb20gdGhlIGdpdmVuIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gaW5wdXRcbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSB0aGUgbW92ZSBldmVuIGlmIHRoZSBlbGVtZW50IGlzIGFjdGl2ZS5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2ZvY3VzVXAgPSBmdW5jdGlvbiBfZm9jdXNVcChpbnB1dCwgZm9yY2UpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9jdXNVcERvd24oaW5wdXQsICd1cCcsIGZvcmNlKTtcbiAgfTtcblxuICAvKipcbiAgICogTW92ZSBvdXIgZm9jdXMgZG93biBhIHJvdyBmcm9tIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGlucHV0XG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2UgRm9yY2UgdGhlIG1vdmUgZXZlbiBpZiB0aGUgZWxlbWVudCBpcyBhY3RpdmUuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9mb2N1c0Rvd24gPSBmdW5jdGlvbiBfZm9jdXNEb3duKGlucHV0LCBmb3JjZSkge1xuICAgIHJldHVybiB0aGlzLl9mb2N1c1VwRG93bihpbnB1dCwgJ2Rvd24nLCBmb3JjZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZvY3VzIG9uIGEgcm93IHVwIG9yIGRvd24gZnJvbSB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dFxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGlyZWN0aW9uIHVwfGRvd25cbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSB0aGUgbW92ZSBldmVuIGlmIHRoZSBlbGVtZW50IGlzIGFjdGl2ZS5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2ZvY3VzVXBEb3duID0gZnVuY3Rpb24gX2ZvY3VzVXBEb3duKGlucHV0LCBkaXJlY3Rpb24sIGZvcmNlKSB7XG5cbiAgICAvLyBJZiB3ZSdyZSBub3QgYmVpbmcgdG9sZCB0byBmb3JjZSBhbmQgdGhlIGl0ZW0gaXMgbm90IHJlYWQgb25seVxuICAgIGlmICghZm9yY2UgJiYgaW5wdXQuZ2V0QXR0cmlidXRlKCdyZWFkb25seScpID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fZGVhY3RpdmF0ZUlucHV0KGlucHV0KTtcbiAgICB2YXIgdGQgPSAoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkoaW5wdXQsICd0ZCcsIHRoaXMuZWwpO1xuXG4gICAgaWYgKCF0ZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBpbmRleCA9ICgwLCBfZ2V0SW5kZXgyLmRlZmF1bHQpKHRkLnBhcmVudE5vZGUuY2hpbGRyZW4sIHRkKTtcbiAgICB2YXIgbmV4dFJvdyA9IChkaXJlY3Rpb24gPT09ICd1cCcgPyBfZ2V0U2libGluZ0JlZm9yZTIuZGVmYXVsdCA6IF9nZXRTaWJsaW5nQWZ0ZXIyLmRlZmF1bHQpKHRkLnBhcmVudE5vZGUsICd0cicpO1xuXG4gICAgaWYgKCFuZXh0Um93KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG5ld1RkID0gbmV4dFJvdy5jaGlsZHJlbltpbmRleF07XG5cbiAgICBpZiAoIW5ld1RkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG5ld0lucHV0ID0gbmV3VGQucXVlcnlTZWxlY3RvcignaW5wdXQ6bm90KFt0eXBlPVwiY2hlY2tib3hcIl0pLCBzZWxlY3QnKTtcblxuICAgIGlmIChuZXdJbnB1dCkge1xuICAgICAgaWYgKG5ld0lucHV0LmRpc2FibGVkKSB7XG4gICAgICAgIHRoaXMuX2ZvY3VzVXBEb3duKG5ld0lucHV0LCBkaXJlY3Rpb24sIGZvcmNlKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG5ld0lucHV0LmZvY3VzKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIG91ciBmb2N1cyBsZWZ0IGEgY2VsbCBmcm9tIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGlucHV0XG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2UgRm9yY2UgdGhlIG1vdmUgZXZlbiBpZiB0aGUgZWxlbWVudCBpcyBhY3RpdmUuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9mb2N1c0xlZnQgPSBmdW5jdGlvbiBfZm9jdXNMZWZ0KGlucHV0LCBmb3JjZSkge1xuICAgIHJldHVybiB0aGlzLl9mb2N1c0xlZnRSaWdodChpbnB1dCwgJ2xlZnQnLCBmb3JjZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIE1vdmUgb3VyIGZvY3VzIHJpZ2h0IGEgY2VsbCBmcm9tIHRoZSBnaXZlbiBlbGVtZW50LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGlucHV0XG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2UgRm9yY2UgdGhlIG1vdmUgZXZlbiBpZiB0aGUgZWxlbWVudCBpcyBhY3RpdmUuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9mb2N1c1JpZ2h0ID0gZnVuY3Rpb24gX2ZvY3VzUmlnaHQoaW5wdXQsIGZvcmNlKSB7XG4gICAgcmV0dXJuIHRoaXMuX2ZvY3VzTGVmdFJpZ2h0KGlucHV0LCAncmlnaHQnLCBmb3JjZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEZvY3VzIG9uIGEgY2VsbCBsZWZ0IG9yIGRvd24gZnJvbSB0aGUgZ2l2ZW4gZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBpbnB1dFxuICAgKiBAcGFyYW0ge1N0cmluZ30gZGlyZWN0aW9uIHVwfGRvd25cbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSB0aGUgbW92ZSBldmVuIGlmIHRoZSBlbGVtZW50IGlzIGFjdGl2ZS5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2ZvY3VzTGVmdFJpZ2h0ID0gZnVuY3Rpb24gX2ZvY3VzTGVmdFJpZ2h0KGlucHV0LCBkaXJlY3Rpb24sIGZvcmNlKSB7XG5cbiAgICAvLyBJZiB3ZSdyZSBub3QgYmVpbmcgdG9sZCB0byBmb3JjZSBhbmQgdGhlIGl0ZW0gaXMgbm90IHJlYWQgb25seVxuICAgIGlmICghZm9yY2UgJiYgaW5wdXQuZ2V0QXR0cmlidXRlKCdyZWFkb25seScpID09PSBudWxsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fZGVhY3RpdmF0ZUlucHV0KGlucHV0KTtcbiAgICB2YXIgdGQgPSAoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkoaW5wdXQsICd0ZCcsIHRoaXMuZWwpO1xuXG4gICAgaWYgKCF0ZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBuZXdUZCA9IChkaXJlY3Rpb24gPT09ICdsZWZ0JyA/IF9nZXRTaWJsaW5nQmVmb3JlMi5kZWZhdWx0IDogX2dldFNpYmxpbmdBZnRlcjIuZGVmYXVsdCkodGQsICd0ZCcpO1xuXG4gICAgaWYgKCFuZXdUZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBuZXdJbnB1dCA9IG5ld1RkLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Om5vdChbdHlwZT1cImNoZWNrYm94XCJdKSwgc2VsZWN0Jyk7XG5cbiAgICBpZiAobmV3SW5wdXQpIHtcbiAgICAgIGlmIChuZXdJbnB1dC5kaXNhYmxlZCkge1xuICAgICAgICB0aGlzLl9mb2N1c0xlZnRSaWdodChuZXdJbnB1dCwgZGlyZWN0aW9uLCBmb3JjZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBuZXdJbnB1dC5mb2N1cygpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hlY2sgZm9yIHR3byBjbGljayBldmVudHMgb24gdGhlIHNhbWUgZWxlbWVudCBpbiBzaG9ydCBzdWNjZXNzaW9uLlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9jaGVja0RvdWJsZUNsaWNrID0gZnVuY3Rpb24gX2NoZWNrRG91YmxlQ2xpY2soZWwpIHtcblxuICAgIHZhciBub3cgPSBEYXRlLm5vdygpO1xuICAgIHZhciBsYXN0VGltZSA9IHRoaXMuX2xhc3RDbGlja1RpbWU7XG4gICAgdmFyIGxhc3RFbCA9IHRoaXMuX2xhc3RDbGlja0VsO1xuXG4gICAgdGhpcy5fbGFzdENsaWNrVGltZSA9IG5vdztcbiAgICB0aGlzLl9sYXN0Q2xpY2tFbCA9IGVsO1xuXG4gICAgaWYgKGVsID09PSBsYXN0RWwgJiYgbm93IC0gNTAwIDwgbGFzdFRpbWUpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICAvKipcbiAgICogVW5zZXQgdGhlIGxhc3QgY2xpY2tlZCBlbGVtZW50LlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fY2xlYXJDbGlja2VkID0gZnVuY3Rpb24gX2NsZWFyQ2xpY2tlZCgpIHtcbiAgICB0aGlzLl9sYXN0Q2xpY2tFbCA9IG51bGw7XG4gIH07XG5cbiAgLyoqXG4gICAqIEVuYWJsZSBlZGl0aW5nIG9uIGEgcm93LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHJvd1xuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fZWRpdFJvdyA9IGZ1bmN0aW9uIF9lZGl0Um93KHJvdykge1xuXG4gICAgaWYgKCFyb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9lZGl0aW5nQ291bnQrKztcblxuICAgIHRoaXMuX2FjdGl2YXRlSW5wdXRzKHJvdyk7XG4gICAgKDAsIF9mb3JtRGF0YS5zdG9yZSkocm93KTtcbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KShyb3csICdlZGl0aW5nJyk7XG4gICAgdGhpcy5fdXBkYXRlQmluZGluZ3MoKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2FuY2VsIGVkaXRpbmcgYSByb3cuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gcm93XG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9jYW5jZWxSb3cgPSBmdW5jdGlvbiBfY2FuY2VsUm93KHJvdykge1xuXG4gICAgaWYgKCFyb3cpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9lZGl0aW5nQ291bnQtLTtcblxuICAgIHRoaXMuX2RlYWN0aXZhdGVJbnB1dHMocm93KTtcbiAgICAoMCwgX2Zvcm1EYXRhLnJlc3RvcmUpKHJvdyk7XG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkocm93LCAnZWRpdGluZycpO1xuICAgIHRoaXMuX3VwZGF0ZUJpbmRpbmdzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNhdmUgYSByb3cuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gcm93XG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9zYXZlUm93ID0gZnVuY3Rpb24gX3NhdmVSb3cocm93KSB7XG5cbiAgICBpZiAoIXJvdykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRoaXMuX2VkaXRpbmdDb3VudC0tO1xuXG4gICAgdGhpcy5fZGVhY3RpdmF0ZUlucHV0cyhyb3cpO1xuICAgICgwLCBfZm9ybURhdGEuY2xlYXIpKHJvdyk7XG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkocm93LCAnZWRpdGluZycpO1xuICAgIHRoaXMuX3VwZGF0ZUJpbmRpbmdzKCk7XG5cbiAgICAodGhpcy5vblJvd1NhdmUgfHwgbm9vcCkoKDAsIF9nZXRJbmRleDIuZGVmYXVsdCkocm93LnBhcmVudE5vZGUuY2hpbGRyZW4sIHJvdyksIHJvdyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIERlbGV0ZSBhIHJvdy5cbiAgICogQHBhcmFtIHtFbGVtZW50fSByb3dcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2RlbGV0ZVJvdyA9IGZ1bmN0aW9uIF9kZWxldGVSb3cocm93KSB7XG5cbiAgICBpZiAoIXJvdykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgICh0aGlzLm9uUm93RGVsZXRlIHx8IG5vb3ApKCgwLCBfZ2V0SW5kZXgyLmRlZmF1bHQpKHJvdy5wYXJlbnROb2RlLmNoaWxkcmVuLCByb3cpLCByb3cpO1xuICAgIHJvdy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJvdyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbmZpcm0gdGhlIGRlbGV0aW9uIG9mIGEgcm93LlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHJvd1xuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fY29uZmlybURlbGV0ZSA9IGZ1bmN0aW9uIF9jb25maXJtRGVsZXRlKHJvdykge1xuXG4gICAgaWYgKCF0aGlzLmNvbmZpcm1EZWxldGUgfHwgdHlwZW9mIHRoaXMuY29uZmlybURlbGV0ZSAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgdGhpcy5fZGVsZXRlUm93KHJvdyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuY29uZmlybURlbGV0ZShyb3csIHRoaXMuX2RlbGV0ZVJvdyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgZGF0YSBiaW5kaW5ncy5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX3VwZGF0ZUJpbmRpbmdzID0gZnVuY3Rpb24gX3VwZGF0ZUJpbmRpbmdzKCkge1xuICAgICgwLCBfdG9nZ2xlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdlZGl0aW5nJywgdGhpcy5fZWRpdGluZ0NvdW50KTtcbiAgfTtcblxuICAvKipcbiAgICogQWRkIGhhbmRsZXMgdG8gdGhlIGhlYWRlciB0aGF0IGNhbiBiZSBncmFiYmVkIGZvciByZXNpemluZy5cbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX2luaXRSZXNpemUgPSBmdW5jdGlvbiBfaW5pdFJlc2l6ZSgpIHtcblxuICAgIHRoaXMuX3Jlc2l6ZUVscyA9IFtdO1xuXG4gICAgdmFyIHRocyA9IHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCd0aGVhZCB0aCcpO1xuXG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KSh0aHMsIGZ1bmN0aW9uICh0aCkge1xuICAgICAgdGguaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPVwic3BhcmstdGFibGVfX3Jlc2l6ZSBzcGFyay10YWJsZV9fcmVzaXplLS1sZWZ0XCI+PC9zcGFuPicgKyB0aC5pbm5lckhUTUwgKyAnPHNwYW4gY2xhc3M9XCJzcGFyay10YWJsZV9fcmVzaXplIHNwYXJrLXRhYmxlX19yZXNpemUtLXJpZ2h0XCI+PC9zcGFuPic7XG4gICAgICB0aGlzLl9yZXNpemVFbHMucHVzaCh0aCk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfTtcblxuICAvKipcbiAgICogSW5pdGlhbGl6ZSByb3dzIGFjdGl2ZSBzdGF0ZXMuXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9pbml0Um93cyA9IGZ1bmN0aW9uIF9pbml0Um93cygpIHtcblxuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkodGhpcy50YWJsZUVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ3RkLnNwYXJrLXRhYmxlX19jaGVja2JveCBpbnB1dDpjaGVja2VkJyksIGZ1bmN0aW9uIChjKSB7XG4gICAgICB0aGlzLl9tYWtlUm93QWN0aXZlKCgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KShjLCAndHInKSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgfTtcblxuICAvKipcbiAgICogU2V0IHRoZSBzaXplIG9mIGVhY2ggY29sdW1uIGFzIGEgcGVyY2VudGFnZSBzbyBpdCBjYW4gYmUgYWRqdXN0ZWRcbiAgICogd2hpbGUgY2VsbHMgYXJlIHJlc2l6ZWQuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB1bml0IE9wdGlvbmFsXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gZm9yY2UgT3B0aW9uYWxcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX3NpemVDb2x1bW5zID0gZnVuY3Rpb24gX3NpemVDb2x1bW5zKHVuaXQsIGZvcmNlKSB7XG5cbiAgICB1bml0ID0gdW5pdCB8fCAnJSc7XG5cbiAgICBpZiAodGhpcy5fc2l6ZUNvbHVtbnNSdW4gJiYgIWZvcmNlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIHdpZHRoID0gdGhpcy50YWJsZUVsLm9mZnNldFdpZHRoO1xuXG4gICAgKDAsIF9lYWNoMi5kZWZhdWx0KSh0aGlzLnRhYmxlRWwucXVlcnlTZWxlY3RvckFsbCgndGhlYWQgdGgnKSwgZnVuY3Rpb24gKHRoKSB7XG4gICAgICBpZiAodW5pdCA9PT0gJyUnKSB0aC5zdHlsZS53aWR0aCA9IE1hdGgucm91bmQodGgub2Zmc2V0V2lkdGggLyB3aWR0aCAqIDEwMDAwMCkgLyAxMDAwMDAgKiAxMDAgKyAnJSc7ZWxzZSB0aC5zdHlsZS53aWR0aCA9IHRoLm9mZnNldFdpZHRoICsgJ3B4JztcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgdGhpcy5fc2l6ZUNvbHVtbnNSdW4gPSB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGV4cGFuZC9jb2xsYXBzZSByb3dzLlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5faW5pdEV4cGFuZHMgPSBmdW5jdGlvbiBfaW5pdEV4cGFuZHMoKSB7XG5cbiAgICB2YXIgZXhwYW5kcyA9IHRoaXMudGFibGVFbC5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstdGFibGUtZXhwYW5kJyk7XG5cbiAgICB0aGlzLl9leHBhbmRzID0gW107XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKGV4cGFuZHMsIGZ1bmN0aW9uIChlKSB7XG4gICAgICB0aGlzLl9leHBhbmRzLnB1c2gobmV3IF9leHBhbmQyLmRlZmF1bHQoZSwge1xuICAgICAgICBvbkJlZm9yZUV4cGFuZDogdGhpcy5fb25CZWZvcmVFeHBhbmQuYmluZCh0aGlzKVxuICAgICAgfSkpO1xuICAgIH0uYmluZCh0aGlzKSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEJlZm9yZSBhbiBleHBhbmQgaXMgY2FsbGVkLCBzaXplIGFsbCB0aGUgY29sdW1ucyBzbyB0aGF0XG4gICAqIHRoZSBleHBhbmQgZG9lcyBjYXVzZSB3aWR0aCBjaGFuZ2VzLlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fb25CZWZvcmVFeHBhbmQgPSBmdW5jdGlvbiBfb25CZWZvcmVFeHBhbmQoKSB7XG4gICAgdGhpcy5fc2l6ZUNvbHVtbnMoKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB3ZSBhcmUgY2xpY2tlZCBkZXRlcm1pbmUgdGhlIHByb3BlciBhY3Rpb24gdG8gdGFrZS5cbiAgICogQHBhcmFtICB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9vbkNsaWNrID0gZnVuY3Rpb24gX29uQ2xpY2soZSkge1xuXG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICB2YXIgcm93O1xuICAgIHZhciBzZWxlY3RBbGw7XG4gICAgdmFyIGFjdGlvblRha2VuID0gZmFsc2U7XG4gICAgdmFyIGNsZWFyQ2xpY2tlZCA9IHRydWU7XG5cbiAgICAvLyBTZWxlY3QgYWxsIHJvd3MgY2hlY2tib3hcbiAgICBpZiAoKHNlbGVjdEFsbCA9ICgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICcuc3BhcmstdGFibGVfX3NlbGVjdC1hbGwnLCB0aGlzLmVsKSkgJiYgISgwLCBfbWF0Y2hlczIuZGVmYXVsdCkodGFyZ2V0LCAnaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykpIHtcbiAgICAgIHRoaXMuX3RvZ2dsZVNlbGVjdEFsbChzZWxlY3RBbGwpO1xuICAgICAgYWN0aW9uVGFrZW4gPSB0cnVlO1xuICAgIH1cbiAgICAvLyBFZGl0YWJsZSBmaWVsZFxuICAgIGVsc2UgaWYgKCgwLCBfbWF0Y2hlczIuZGVmYXVsdCkodGFyZ2V0LCAnaW5wdXQ6bm90KFt0eXBlPVwiY2hlY2tib3hcIl0pOm5vdChbdHlwZT1cImZpbGVcIl0pLCBzZWxlY3QnKSkge1xuXG4gICAgICAgIGlmICghdGFyZ2V0LmRpc2FibGVkKSB7XG5cbiAgICAgICAgICAvLyBMaXN0ZW4gZm9yIGRvdWJsZSBjbGlja3Mgb24gYSBzcHJlYWRzaGVldFxuICAgICAgICAgIGlmICh0aGlzLmlzU3ByZWFkc2hlZXQpIHtcbiAgICAgICAgICAgIGNsZWFyQ2xpY2tlZCA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKHRoaXMuX2NoZWNrRG91YmxlQ2xpY2sodGFyZ2V0KSkge1xuICAgICAgICAgICAgICBjbGVhckNsaWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICB0aGlzLl9hY3RpdmF0ZUlucHV0KHRhcmdldCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYWN0aW9uVGFrZW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICAvLyBFZGl0IGJ1dHRvblxuICAgICAgZWxzZSBpZiAoKDAsIF9tYXRjaGVzMi5kZWZhdWx0KSh0YXJnZXQsICcuc3BhcmstdGFibGVfX2VkaXQtcm93JykpIHtcbiAgICAgICAgICB0aGlzLl9lZGl0Um93KCgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICd0cicsIHRoaXMuZWwpKTtcbiAgICAgICAgICBhY3Rpb25UYWtlbiA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgLy8gRGVsZXRlIGJ1dHRvblxuICAgICAgICBlbHNlIGlmICgoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHRhcmdldCwgJy5zcGFyay10YWJsZV9fZGVsZXRlLXJvdycpKSB7XG4gICAgICAgICAgICB0aGlzLl9jb25maXJtRGVsZXRlKCgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICd0cicsIHRoaXMuZWwpKTtcbiAgICAgICAgICAgIGFjdGlvblRha2VuID0gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgLy8gU2F2ZSBidXR0b25cbiAgICAgICAgICBlbHNlIGlmICgoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHRhcmdldCwgJy5zcGFyay10YWJsZV9fZWRpdC1yb3ctc2F2ZScpKSB7XG4gICAgICAgICAgICAgIHRoaXMuX3NhdmVSb3coKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKHRhcmdldCwgJ3RyJywgdGhpcy5lbCkpO1xuICAgICAgICAgICAgICBhY3Rpb25UYWtlbiA9IHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBDYW5jZWwgYnV0dG9uXG4gICAgICAgICAgICBlbHNlIGlmICgoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHRhcmdldCwgJy5zcGFyay10YWJsZV9fZWRpdC1yb3ctY2FuY2VsJykpIHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jYW5jZWxSb3coKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKHRhcmdldCwgJ3RyJywgdGhpcy5lbCkpO1xuICAgICAgICAgICAgICAgIGFjdGlvblRha2VuID0gdHJ1ZTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAvLyBTZWxlY3QgYSByb3dcbiAgICAgICAgICAgICAgZWxzZSBpZiAoISgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICdidXR0b24sIGEsIC5zcGFyay10b2dnbGUtc3dpdGNoJywgdGhpcy5lbCkgJiYgISgwLCBfbWF0Y2hlczIuZGVmYXVsdCkodGFyZ2V0LCAnLnNwYXJrLXRhYmxlX19jaGVja2JveCBpbnB1dFt0eXBlPVwiY2hlY2tib3hcIl0sIHNlbGVjdCcpICYmIChyb3cgPSAoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkodGFyZ2V0LCAndGJvZHkgdHInLCB0aGlzLmVsKSkpIHtcbiAgICAgICAgICAgICAgICAgIGlmICghKHJvdy5xdWVyeVNlbGVjdG9yKCcuc3BhcmstdGFibGVfX2NoZWNrYm94IGlucHV0W3R5cGU9XCJjaGVja2JveFwiXScpIHx8IHt9KS5kaXNhYmxlZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLl90b2dnbGVSb3dBY3RpdmUocm93KTtcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uVGFrZW4gPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgIGlmIChjbGVhckNsaWNrZWQpIHtcbiAgICAgIHRoaXMuX2NsZWFyQ2xpY2tlZCgpO1xuICAgIH1cblxuICAgIGlmIChhY3Rpb25UYWtlbikge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgY2hhbmdlIGV2ZW50IGZpcmVzIG9uIG91ciBlbGVtZW50LlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fb25DaGFuZ2UgPSBmdW5jdGlvbiBfb25DaGFuZ2UoZSkge1xuXG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcbiAgICB2YXIgcm93O1xuICAgIHZhciBzZWxlY3RBbGw7XG5cbiAgICAvLyBTZWxlY3QgYWxsIHJvd3MgY2hlY2tib3guIFdlIGhhdmUgdG8gaW52ZXJ0IHRoZSBjaGVja2VkIHZhbHVlIGhlcmUgYmVjYXVzZSBpdFxuICAgIC8vIGdldCB0b2dnbGVkIGJhY2sgaW4gdGhlIHNlbGVjdCBhbGwgY2FsbC5cbiAgICBpZiAoc2VsZWN0QWxsID0gKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKHRhcmdldCwgJy5zcGFyay10YWJsZV9fc2VsZWN0LWFsbCcsIHRoaXMuZWwpKSB7XG4gICAgICB0YXJnZXQuY2hlY2tlZCA9ICF0YXJnZXQuY2hlY2tlZDtcbiAgICAgIHRoaXMuX3RvZ2dsZVNlbGVjdEFsbChzZWxlY3RBbGwpO1xuICAgIH1cbiAgICAvLyBDaGVja2JveCBmb3IgYSByb3dcbiAgICBlbHNlIGlmICgoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHRhcmdldCwgJy5zcGFyay10YWJsZV9fY2hlY2tib3ggaW5wdXRbdHlwZT1cImNoZWNrYm94XCJdJykgJiYgKHJvdyA9ICgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICd0Ym9keSB0cicsIHRoaXMuZWwpKSkge1xuICAgICAgICB0aGlzLl90b2dnbGVSb3dBY3RpdmUocm93KTtcbiAgICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogSWYgdGhpcyBpcyBhIHNwcmVhZHNoZWV0LCB3aGVuZXZlciBhIGZpZWxkIGdhaW5zIGZvY3VzLCBoaWdobGlnaHQgaXRzIHBhcmVudC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX29uRm9jdXMgPSBmdW5jdGlvbiBfb25Gb2N1cyhlKSB7XG5cbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuXG4gICAgaWYgKCF0aGlzLmlzU3ByZWFkc2hlZXQgfHwgISgwLCBfbWF0Y2hlczIuZGVmYXVsdCkodGFyZ2V0LCAnaW5wdXQ6bm90KFt0eXBlPVwiY2hlY2tib3hcIl0pLCBzZWxlY3QnKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciB0ZCA9ICgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICd0ZCcsIHRoaXMuZWwpO1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRkLCAnZm9jdXMnKTtcbiAgfTtcblxuICAvKipcbiAgICogSWYgdGhpcyBpcyBhIHNwcmVhZHNoZWV0LCB3aGVuZXZlciBhIGZpZWxkIGdhaW5zIGZvY3VzLCBoaWdobGlnaHQgaXRzIHBhcmVudC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX29uQmx1ciA9IGZ1bmN0aW9uIF9vbkJsdXIoZSkge1xuXG4gICAgaWYgKCF0aGlzLmlzU3ByZWFkc2hlZXQpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuICAgIHZhciB0ZCA9ICgwLCBfZ2V0UGFyZW50Mi5kZWZhdWx0KSh0YXJnZXQsICd0ZCcsIHRoaXMuZWwpO1xuICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRkLCAnZm9jdXMnKTtcbiAgICB0aGlzLl9kZWFjdGl2YXRlSW5wdXQodGFyZ2V0KTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiBhIGtleSBpcyBwcmVzc2VkLCBpZiB0aGlzIGlzIGEgc3ByZWFkc2hlZXQgdGhlbiB3ZSBzaG91bGQgZGV0ZWN0XG4gICAqIGVudGVyIG9yIGFycm93IGtleXMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9vbktleWRvd24gPSBmdW5jdGlvbiBfb25LZXlkb3duKGUpIHtcblxuICAgIHZhciB0YXJnZXQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7XG5cbiAgICBpZiAoIXRoaXMuaXNTcHJlYWRzaGVldCB8fCAhKDAsIF9tYXRjaGVzMi5kZWZhdWx0KSh0YXJnZXQsICdpbnB1dDpub3QoW3R5cGU9XCJjaGVja2JveFwiXSksIHNlbGVjdCcpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIGNvZGUgPSBlLmtleUNvZGUgfHwgZS53aGljaDtcblxuICAgIHN3aXRjaCAoY29kZSkge1xuICAgICAgY2FzZSB0aGlzLl9rZXlDb2Rlcy5FTlRFUjpcbiAgICAgICAgdGhpcy5fYWN0aXZhdGVJbnB1dE9yRm9jdXNEb3duKHRhcmdldCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSB0aGlzLl9rZXlDb2Rlcy5FU0NBUEU6XG4gICAgICAgIHRoaXMuX2RlYWN0aXZhdGVJbnB1dCh0YXJnZXQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgdGhpcy5fa2V5Q29kZXMuRE9XTjpcbiAgICAgICAgdGhpcy5fZm9jdXNEb3duKHRhcmdldCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSB0aGlzLl9rZXlDb2Rlcy5VUDpcbiAgICAgICAgdGhpcy5fZm9jdXNVcCh0YXJnZXQpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgdGhpcy5fa2V5Q29kZXMuTEVGVDpcbiAgICAgICAgdGhpcy5fZm9jdXNMZWZ0KHRhcmdldCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSB0aGlzLl9rZXlDb2Rlcy5SSUdIVDpcbiAgICAgICAgdGhpcy5fZm9jdXNSaWdodCh0YXJnZXQpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgYSB0b3VjaCBhbmQgaG9sZCBvbiBhbiBpbnB1dC5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUYWJsZS5wcm90b3R5cGUuX29uVG91Y2hzdGFydCA9IGZ1bmN0aW9uIF9vblRvdWNoc3RhcnQoZSkge1xuXG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblxuICAgIGlmICghdGhpcy5pc1NwcmVhZHNoZWV0IHx8ICEoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHRhcmdldCwgJ2lucHV0Om5vdChbdHlwZT1cImNoZWNrYm94XCJdKScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fdG91Y2hTdGFydEVsID0gdGFyZ2V0O1xuICAgIHRoaXMuX3RvdWNoU3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcbiAgICB0aGlzLl90b3VjaFN0YXJ0VGltZXIgPSBzZXRUaW1lb3V0KHRoaXMuX29uVG91Y2hIb2xkLmJpbmQodGhpcyksIDEwMDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBMaXN0ZW4gZm9yIHRoZSBlbmQgb2YgYSB0b3VjaCB0byBjYW5jZWwgdGhlIGhvbGQgdGltZXIuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9vblRvdWNoZW5kID0gZnVuY3Rpb24gX29uVG91Y2hlbmQoZSkge1xuXG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblxuICAgIGlmICghdGhpcy5fdG91Y2hTdGFydEVsIHx8IHRhcmdldCAhPT0gdGhpcy5fdG91Y2hTdGFydEVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5fdG91Y2hTdGFydEVsID0gbnVsbDtcbiAgICB0aGlzLl90b3VjaFN0YXJ0VGltZSA9IG51bGw7XG4gICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RvdWNoU3RhcnRUaW1lcik7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHVzZXIgaGFzIGhlbGQgb24gYW4gaW5wdXQgZm9yIHRoZSBkZWZpbmVkIGFtb3VudCBvZiB0aW1lLlxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fb25Ub3VjaEhvbGQgPSBmdW5jdGlvbiBfb25Ub3VjaEhvbGQoKSB7XG5cbiAgICB0aGlzLl9hY3RpdmF0ZUlucHV0KHRoaXMuX3RvdWNoU3RhcnRFbCk7XG5cbiAgICB0aGlzLl90b3VjaFN0YXJ0RWwgPSBudWxsO1xuICAgIHRoaXMuX3RvdWNoU3RhcnRUaW1lID0gbnVsbDtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5fdG91Y2hTdGFydFRpbWVyKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgbW91c2UgaXMgZGVwcmVzc2VkLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fb25Nb3VzZURvd24gPSBmdW5jdGlvbiBfb25Nb3VzZURvd24oZSkge1xuXG4gICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0IHx8IGUuc3JjRWxlbWVudDtcblxuICAgIGlmICghdGhpcy5pc1Jlc2l6YWJsZSB8fCAhKDAsIF9tYXRjaGVzMi5kZWZhdWx0KSh0YXJnZXQsICcuc3BhcmstdGFibGVfX3Jlc2l6ZScpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdGhpcy5fbGFzdFNjcmVlblggPSBlLnNjcmVlblg7XG5cbiAgICB0aGlzLl9zaXplQ29sdW1ucygncHgnLCB0cnVlKTtcblxuICAgIHRoaXMuX3Jlc2l6aW5nRWwgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICB2YXIgaW5kZXggPSB0aGlzLl9yZXNpemVFbHMuaW5kZXhPZih0aGlzLl9yZXNpemluZ0VsKTtcblxuICAgIGlmICgoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0YXJnZXQsICdzcGFyay10YWJsZV9fcmVzaXplLS1sZWZ0JykpIHtcbiAgICAgIHRoaXMuX3Jlc2l6aW5nRWwgPSB0aGlzLl9yZXNpemVFbHNbaW5kZXggLSAxXTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuX3Jlc2l6aW5nRWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLl9hZGRSZXNpemVMaXN0ZW5lcnMoKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgbW91c2UgbW92ZXMgYWZ0ZXIgYmVpbmcgZGVwcmVzc2VkLCByZXNpemUgdGhlIGNvbHVtbnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVGFibGUucHJvdG90eXBlLl9vbk1vdXNlTW92ZSA9IGZ1bmN0aW9uIF9vbk1vdXNlTW92ZShlKSB7XG5cbiAgICB2YXIgeCA9IGUuc2NyZWVuWDtcbiAgICB2YXIgZCA9IHggLSB0aGlzLl9sYXN0U2NyZWVuWDtcblxuICAgIC8vIE5vIGRlbHRhIGNoYW5nZVxuICAgIGlmICghZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIHZhciB3ID0gdGhpcy5fcmVzaXppbmdFbC5vZmZzZXRXaWR0aDtcbiAgICB2YXIgdFcgPSB0aGlzLnRhYmxlRWwub2Zmc2V0V2lkdGg7XG4gICAgdmFyIG5ld1cgPSB3ICsgZDtcbiAgICB2YXIgbmV3VFcgPSB0VyArIGQ7XG5cbiAgICB0aGlzLl9yZXNpemluZ0VsLnN0eWxlLndpZHRoID0gbmV3VyArICdweCc7XG4gICAgdGhpcy50YWJsZUVsLnN0eWxlLndpZHRoID0gbmV3VFcgKyAncHgnO1xuXG4gICAgLy8gU2l6ZSB3YXMgbm90IGFmZmVjdGVkIGJlY2F1c2Ugd2UncmUgdG9vIHNtYWxsXG4gICAgaWYgKHRoaXMuX3Jlc2l6aW5nRWwub2Zmc2V0V2lkdGggPT09IHcgfHwgdGhpcy50YWJsZUVsLm9mZnNldFdpZHRoIDwgdGhpcy50YWJsZUVsLnBhcmVudE5vZGUub2Zmc2V0V2lkdGgpIHtcbiAgICAgIHRoaXMuX3Jlc2l6aW5nRWwuc3R5bGUud2lkdGggPSB3ICsgJ3B4JztcbiAgICAgIHRoaXMudGFibGVFbC5zdHlsZS53aWR0aCA9IHRXICsgJ3B4JztcbiAgICB9XG5cbiAgICB0aGlzLl9sYXN0U2NyZWVuWCA9IHg7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIG1vdXNlIGlzIHJlbGVhc2VkLCBzdG9wIHRyYWNraW5nIG1vdXNlIG1vdmUgZXZlbnRzIGFuZFxuICAgKiBjb252ZXJ0IHRhYmxlIHNpemVzIHRvIHBlcmNlbnRhZ2VzLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFRhYmxlLnByb3RvdHlwZS5fb25Nb3VzZVVwID0gZnVuY3Rpb24gX29uTW91c2VVcCgpIHtcbiAgICB0aGlzLl9zaXplQ29sdW1ucygnJScsIHRydWUpO1xuICAgIHRoaXMudGFibGVFbC5zdHlsZS53aWR0aCA9IHRoaXMudGFibGVFbC5vZmZzZXRXaWR0aCAvIHRoaXMudGFibGVFbC5wYXJlbnROb2RlLm9mZnNldFdpZHRoICogMTAwICsgJyUnO1xuICAgIHRoaXMuX3JlbW92ZVJlc2l6ZUxpc3RlbmVycygpO1xuICB9O1xuXG4gIHJldHVybiBUYWJsZTtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5UYWJsZS5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gWydpc1NwcmVhZHNoZWV0JywgJ2lzRWRpdFJvd3MnLCAnaXNSZXNpemFibGUnLCAnY29uZmlybURlbGV0ZScsICdvblJvd1NhdmUnLCAnb25Sb3dEZWxldGUnXTtcblxuLyoqXG4gKiBEZWZhdWx0IHZhbHVlcyBmb3IgaW50ZXJuYWwgcHJvcGVydGllcyB3ZSB3aWxsIGJlIHNldHRpbmcuXG4gKiBUaGVzZSBhcmUgc2V0IG9uIGVhY2ggY29uc3RydWN0aW9uIHNvIHdlIGRvbid0IGxlYWsgcHJvcGVydGllc1xuICogaW50byB0aGUgcHJvdG90eXBlIGNoYWluLlxuICogQHR5cGUge09iamVjdH1cbiAqL1xuVGFibGUucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbCxcbiAgdGFibGVFbDogbnVsbCxcbiAgaXNTcHJlYWRzaGVldDogbnVsbCxcbiAgaXNFZGl0Um93czogbnVsbCxcbiAgaXNSZXNpemFibGU6IG51bGwsXG4gIG9uUm93U2F2ZTogbnVsbCxcbiAgb25Sb3dEZWxldGU6IG51bGwsXG4gIGNvbmZpcm1EZWxldGU6IG51bGwsXG4gIF9leHBhbmRzOiBudWxsLFxuICBfa2V5Q29kZXM6IHtcbiAgICBFTlRFUjogMTMsXG4gICAgVVA6IDM4LFxuICAgIERPV046IDQwLFxuICAgIExFRlQ6IDM3LFxuICAgIFJJR0hUOiAzOSxcbiAgICBFU0NBUEU6IDI3XG4gIH0sXG4gIF9lZGl0aW5nQ291bnQ6IDAsXG4gIF9sYXN0Q2xpY2tUaW1lOiAwLFxuICBfbGFzdENsaWNrRWw6IG51bGwsXG4gIF9sYXN0U2NyZWVuWDogMCxcbiAgX3RvdWNoU3RhcnRUaW1lOiAwLFxuICBfdG91Y2hTdGFydEVsOiBudWxsLFxuICBfcmVzaXplRWxzOiBudWxsLFxuICBfcmVzaXppbmdFbDogbnVsbCxcbiAgX3NpemVDb2x1bW5zUnVuOiBmYWxzZSxcbiAgX29uQ2xpY2tCb3VuZDogbnVsbCxcbiAgX29uQ2hhbmdlQm91bmQ6IG51bGwsXG4gIF9vbkZvY3VzQm91bmQ6IG51bGwsXG4gIF9vbkJsdXJCb3VuZDogbnVsbCxcbiAgX29uS2V5ZG93bkJvdW5kOiBudWxsLFxuICBfb25Ub3VjaHN0YXJ0Qm91bmQ6IG51bGwsXG4gIF9vblRvdWNoZW5kQm91bmQ6IG51bGwsXG4gIF9vbk1vdXNlRG93bkJvdW5kOiBudWxsLFxuICBfb25Nb3VzZU1vdmVCb3VuZDogbnVsbCxcbiAgX29uTW91c2VVcEJvdW5kOiBudWxsXG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBUYWJsZTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGFibGUuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfb3V0ZXJIZWlnaHQgPSByZXF1aXJlKCcuLi9kb20vb3V0ZXItaGVpZ2h0Jyk7XG5cbnZhciBfb3V0ZXJIZWlnaHQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfb3V0ZXJIZWlnaHQpO1xuXG52YXIgX2FkZENsYXNzID0gcmVxdWlyZSgnLi4vZG9tL2FkZC1jbGFzcycpO1xuXG52YXIgX2FkZENsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FkZENsYXNzKTtcblxudmFyIF9yZW1vdmVDbGFzcyA9IHJlcXVpcmUoJy4uL2RvbS9yZW1vdmUtY2xhc3MnKTtcblxudmFyIF9yZW1vdmVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1vdmVDbGFzcyk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuLi9kb20vaGFzLWNsYXNzJyk7XG5cbnZhciBfaGFzQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFzQ2xhc3MpO1xuXG52YXIgX3RvZ2dsZUNsYXNzID0gcmVxdWlyZSgnLi4vZG9tL3RvZ2dsZS1jbGFzcycpO1xuXG52YXIgX3RvZ2dsZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3RvZ2dsZUNsYXNzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQW5pbWF0ZSBIZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBBbmltYXRlIHRoZSBoZWlnaHQgb2YgYW4gZWxlbWVudCBzaW5jZSB3ZSBjYW4ndCBkbyB0aGlzIHcvIHB1cmUgQ1NTLiBTaWdoLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBhbmltYXRlSGVpZ2h0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGVsOiAuLi4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICB0b2dnbGVFbDogLi4uLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgLy8gT3B0aW9uYWwgcGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBhY3Rpb246ICdjb2xsYXBzZSd8J2V4cGFuZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICBoZWlnaHRBbmltYXRpb25DbGFzczogJ3NwYXJrLWFuaW1hdGUtaGVpZ2h0JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIG9wYWNpdHlBbmltYXRpb25DbGFzczogJ3NwYXJrLWFuaW1hdGUtb3BhY2l0eScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICB0b2dnbGVQcm9wZXJ0eTogJ2Rpc3BsYXknfCdvdmVyZmxvdyd8J3Zpc2liaWxpdHknLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgdG9nZ2xlVmFsdWU6ICdibG9jayd8J25vbmUnfCd2aXNpYmxlJ3wnaGlkZGVuJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGFuaW1hdGlvbkR1cmF0aW9uOiAyNTBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBtb2R1bGUgaGVscGVycy9hbmltYXRpb24vaGVpZ2h0LmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cbnZhciBydW5uaW5nQW5pbWF0aW9ucyA9IHtcbiAgZWxzOiBbXSxcbiAgY29tcGxldGVDYWxsYmFja3M6IFtdXG59O1xuXG4vKipcbiAqIEdldCB0aGUgaW52ZXJzZSB0b2dnbGUgdmFsdWVcbiAqIEBwYXJhbSAge1N0cmluZ30gcHJvcGVydHlcbiAqIEBwYXJhbSAge1N0cmluZ30gb3JpZ2luYWxWYWx1ZVxuICogQHJldHVybiB7U3RyaW5nfVxuICovXG5mdW5jdGlvbiBnZXRJbnZlcnNlVG9nZ2xlVmFsdWUoZWwsIHByb3BlcnR5LCBvcmlnaW5hbFZhbHVlKSB7XG5cbiAgLy8gR2V0IHRoZSB2YWx1ZSB0byB0b2dnbGUgdG8gZm9yIHRoZSBnaXZlbiBwcm9wZXJ0eVxuICBzd2l0Y2ggKHByb3BlcnR5KSB7XG4gICAgY2FzZSAnb3ZlcmZsb3cnOlxuICAgIGNhc2UgJ3Zpc2liaWxpdHknOlxuICAgICAgcmV0dXJuIG9yaWdpbmFsVmFsdWUgPT09ICd2aXNpYmxlJyA/ICdoaWRkZW4nIDogJ3Zpc2libGUnO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gb3JpZ2luYWxWYWx1ZSA9PT0gJ2Jsb2NrJyB8fCBvcmlnaW5hbFZhbHVlID09PSAnaW5saW5lLWJsb2NrJyA/ICdub25lJyA6ICdibG9jayc7XG4gIH1cbn1cblxuLyoqXG4gKiBXaGVuIGFuIGFuaW1hdGlvbiBpcyBjb21wbGV0ZSwgY2xlYW4gdXAgYW5kIHJ1biB0aGUgY2FsbGJhY2suXG4gKiBAcGFyYW0gIHtPYmplY3R9IHBhcmFtc1xuICovXG5mdW5jdGlvbiBvbkNvbXBsZXRlKHBhcmFtcykge1xuXG4gIC8vIFJlc2V0IHRvZ2dsZSBlbCB2aXNpYmlsaXR5XG4gIGlmIChwYXJhbXMudG9nZ2xlQ2xhc3NOYW1lKSB7XG4gICAgKDAsIF90b2dnbGVDbGFzczIuZGVmYXVsdCkocGFyYW1zLmVsLCBwYXJhbXMudG9nZ2xlQ2xhc3NOYW1lLCAhcGFyYW1zLmNvbGxhcHNlKTtcbiAgfSBlbHNlIHtcbiAgICBwYXJhbXMudG9nZ2xlRWwuc3R5bGVbcGFyYW1zLnRvZ2dsZVByb3BlcnR5XSA9ICcnO1xuICB9XG5cbiAgLy8gUmVtb3ZlIHRoZSBoZWlnaHQgcHJvcGVydHlcbiAgcGFyYW1zLmVsLnN0eWxlLmhlaWdodCA9ICcnO1xuICBwYXJhbXMudG9nZ2xlRWwuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gIHBhcmFtcy50b2dnbGVFbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnJztcbiAgcGFyYW1zLnRvZ2dsZUVsLnN0eWxlLm1hcmdpblRvcCA9ICcnO1xuXG4gIC8vIFJlbW92ZSB0aGUgc3BhcmstYW5pbWF0ZS1oZWlnaHQgY2xhc3Mgc28gdGhlIHRyYW5zaXRpb25zIG5vIGxvbmdlciBhcHBseVxuICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShwYXJhbXMuZWwsIHBhcmFtcy5oZWlnaHRBbmltYXRpb25DbGFzcyk7XG4gICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHBhcmFtcy50b2dnbGVFbCwgcGFyYW1zLmhlaWdodEFuaW1hdGlvbkNsYXNzKTtcblxuICAvLyBSdW4gdGhlIGNhbGxiYWNrXG4gIHBhcmFtcy5vbkNvbXBsZXRlKCk7XG5cbiAgLy8gUmVtb3ZlIHRoZSBlbGVtZW50IGFuZCBjYWxsYmFjayBmcm9tIHRoZWlyIHJlc3BlY3RpdmUgYXJyYXlzXG4gIHZhciBydW5uaW5nSW5kZXggPSBydW5uaW5nQW5pbWF0aW9ucy5lbHMuaW5kZXhPZihwYXJhbXMuZWwpO1xuICBydW5uaW5nQW5pbWF0aW9ucy5lbHMuc3BsaWNlKHJ1bm5pbmdJbmRleCwgMSk7XG4gIHJ1bm5pbmdBbmltYXRpb25zLmNvbXBsZXRlQ2FsbGJhY2tzLnNwbGljZShydW5uaW5nSW5kZXgsIDEpO1xufVxuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAqL1xuZnVuY3Rpb24gYW5pbWF0ZUhlaWdodChwYXJhbXMpIHtcblxuICBwYXJhbXMgPSBwYXJhbXMgfHwge307XG5cbiAgdmFyIGVsID0gcGFyYW1zLmVsO1xuXG4gIGlmICghZWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY29sbGFwc2UgPSBwYXJhbXMuYWN0aW9uICYmIHBhcmFtcy5hY3Rpb24gPT09ICdjb2xsYXBzZSc7XG4gIHZhciBoZWlnaHRBbmltYXRpb25DbGFzcyA9IHBhcmFtcy5oZWlnaHRBbmltYXRpb25DbGFzcyB8fCAnc3BhcmstYW5pbWF0ZS1oZWlnaHQnO1xuXG4gIC8vIEFsbG93IGZvciBlbGVtZW50cyB0byBiZSBwYXNzZWQgb3Igc2VsZWN0b3Igc3RyaW5nc1xuICB2YXIgdG9nZ2xlRWwgPSB0eXBlb2YgcGFyYW1zLnRvZ2dsZUVsID09PSAnc3RyaW5nJyA/IGVsLnF1ZXJ5U2VsZWN0b3IocGFyYW1zLnRvZ2dsZUVsKSA6IHBhcmFtcy50b2dnbGVFbDtcblxuICAvLyBObyBlbGVtZW50IHRvIGJlIHN3aXRjaGluZyB3aXRoIHRvZ2dsaW5nIHNvIHdlIGNhbid0IGRldGVybWluZSB0aGUgZGVzaXJlZCBoZWlnaHQgdG8gYW5pbWF0ZSB0by5cbiAgaWYgKCF0b2dnbGVFbCB8fCAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KShlbCwgJ3NwYXJrLW5vLWFuaW1hdGUnKSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB0b2dnbGVDbGFzc05hbWUgPSBwYXJhbXMudG9nZ2xlQ2xhc3M7XG5cbiAgLy8gVGhlIHN0eWxlIHByb3BlcnR5IHRvIHVzZSB3aGVuIHRvZ2dsaW5nIHZpc2liaWxpdHlcbiAgdmFyIHRvZ2dsZVByb3BlcnR5ID0gcGFyYW1zLnRvZ2dsZVByb3BlcnR5IHx8ICdkaXNwbGF5JztcbiAgdmFyIHRvZ2dsZVN0eWxlcyA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKHRvZ2dsZUVsKTtcbiAgdmFyIG9yaWdpbmFsVG9nZ2xlVmFsdWUgPSB0b2dnbGVTdHlsZXNbdG9nZ2xlUHJvcGVydHldO1xuICB2YXIgdG9nZ2xlVmFsdWUgPSBwYXJhbXMudG9nZ2xlVmFsdWUgfHwgZ2V0SW52ZXJzZVRvZ2dsZVZhbHVlKHRvZ2dsZVByb3BlcnR5LCBvcmlnaW5hbFRvZ2dsZVZhbHVlKTtcblxuICAvLyBJZiB3ZSBhcmUgYWxyZWFkeSBhbmltYXRpbmcsIHN0b3Agbm93LlxuICB2YXIgcnVubmluZ0luZGV4ID0gcnVubmluZ0FuaW1hdGlvbnMuZWxzLmluZGV4T2YoZWwpO1xuICBpZiAocnVubmluZ0luZGV4ICE9PSAtMSkge1xuXG4gICAgdmFyIGNvbXBsZXRlQ2FsbGJhY2sgPSBydW5uaW5nQW5pbWF0aW9ucy5jb21wbGV0ZUNhbGxiYWNrc1tydW5uaW5nSW5kZXhdO1xuICAgIGlmIChjb21wbGV0ZUNhbGxiYWNrKSB7XG4gICAgICBjbGVhclRpbWVvdXQoY29tcGxldGVDYWxsYmFjayk7XG4gICAgfVxuXG4gICAgb25Db21wbGV0ZSh7XG4gICAgICBlbDogZWwsXG4gICAgICB0b2dnbGVFbDogdG9nZ2xlRWwsXG4gICAgICBvbkNvbXBsZXRlOiBwYXJhbXMub25Db21wbGV0ZSB8fCBub29wLFxuICAgICAgY29sbGFwc2U6IGNvbGxhcHNlLFxuICAgICAgdG9nZ2xlUHJvcGVydHk6IHRvZ2dsZVByb3BlcnR5LFxuICAgICAgdG9nZ2xlQ2xhc3NOYW1lOiB0b2dnbGVDbGFzc05hbWUsXG4gICAgICB0b2dnbGVWYWx1ZTogdG9nZ2xlVmFsdWUsXG4gICAgICBoZWlnaHRBbmltYXRpb25DbGFzczogaGVpZ2h0QW5pbWF0aW9uQ2xhc3NcbiAgICB9KTtcbiAgfVxuXG4gIC8vIFN0b3JlIHRoZSBjdXJyZW50IGhlaWdodFxuICB2YXIgb3JpZ2luYWxIZWlnaHQgPSAoMCwgX291dGVySGVpZ2h0Mi5kZWZhdWx0KShlbCk7XG5cbiAgLy8gVG9nZ2xlIHRoZSB2aXNpYmxlIHByb3BlcnR5XG4gIGlmICh0b2dnbGVDbGFzc05hbWUpIHtcbiAgICAoMCwgX3RvZ2dsZUNsYXNzMi5kZWZhdWx0KShlbCwgdG9nZ2xlQ2xhc3NOYW1lLCAhY29sbGFwc2UpO1xuICB9IGVsc2Uge1xuICAgIHRvZ2dsZUVsLnN0eWxlW3RvZ2dsZVByb3BlcnR5XSA9IHRvZ2dsZVZhbHVlO1xuICB9XG5cbiAgLy8gV2hlbiBtZWFzdXJpbmcgdGhlIHNpemUgZm9yIGEgY29sbGFwc2UsIHdlIGhhdmUgdG8gd2FpdCBhIHRpYyBmb3IgaXQgdG8gYmVcbiAgLy8gYWNjdXJhdGUuIE5vdCBzdXJlIHdoeS4gVWdoLlxuICBpZiAoY29sbGFwc2UpIHtcbiAgICBzZXRUaW1lb3V0KHJ1bkFuaW1hdGlvbiwgMCk7XG4gIH0gZWxzZSB7XG4gICAgcnVuQW5pbWF0aW9uKCk7XG4gIH1cblxuICBmdW5jdGlvbiBydW5BbmltYXRpb24oKSB7XG5cbiAgICAvLyBOb3cgdGhhdCB0aGUgdG9nZ2xlIGVsIGlzIHRha2luZyB1cCBzcGFjZSwgZ2V0IHRoZSBuZXcgaGVpZ2h0IHdoaWNoIHdlIHdpbGwgYmUgYW5pbWF0aW5nIHRvXG4gICAgdmFyIHRhcmdldEVsSGVpZ2h0ID0gKDAsIF9vdXRlckhlaWdodDIuZGVmYXVsdCkoZWwpO1xuXG4gICAgLy8gV2UgbmVlZCB0byBzdG9yZSB0aGUgb3JpZ2luYWwgYW5kIHRhcmdldCB0b2dnbGUgZWxlbWVudCBoZWlnaHRzLiBUaGV5IGRpZmZlciBkZXBlbmRpbmcgb25cbiAgICAvLyB3aGV0aGVyIHdlIGFyZSBnb2luZyB0byBleHBhbmQgb3IgY29sbGFwc2UuXG4gICAgdmFyIHRhcmdldFRvZ2dsZUVsSGVpZ2h0ID0gdm9pZCAwO1xuICAgIHZhciBvcmlnaW5hbFRvZ2dsZUVsSGVpZ2h0ID0gdm9pZCAwO1xuXG4gICAgLy8gSWYgd2UgYXJlIGNvbGxhcHNpbmcsIHJlc2V0IHRoZSB0b2dnbGUgc3R5bGUgYW5kIHNldCBpdCB3aGVuIHdlJ3JlIGRvbmUuIFNldCB0aGUgaGVpZ2h0IHNvXG4gICAgLy8gdGhhdCB3ZSBjYW4gYW5pbWF0ZSBkb3duIHRvIDAgb3IgdXAgdG8gdGhlIHRhcmdldCBoZWlnaHQuXG4gICAgaWYgKGNvbGxhcHNlKSB7XG5cbiAgICAgIGlmICh0b2dnbGVDbGFzc05hbWUpIHtcbiAgICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkoZWwsIHRvZ2dsZUNsYXNzTmFtZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b2dnbGVFbC5zdHlsZVt0b2dnbGVQcm9wZXJ0eV0gPSBvcmlnaW5hbFRvZ2dsZVZhbHVlO1xuICAgICAgfVxuXG4gICAgICBvcmlnaW5hbFRvZ2dsZUVsSGVpZ2h0ID0gKDAsIF9vdXRlckhlaWdodDIuZGVmYXVsdCkodG9nZ2xlRWwsIHRvZ2dsZVN0eWxlcyk7XG4gICAgICB0YXJnZXRUb2dnbGVFbEhlaWdodCA9IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRhcmdldFRvZ2dsZUVsSGVpZ2h0ID0gKDAsIF9vdXRlckhlaWdodDIuZGVmYXVsdCkodG9nZ2xlRWwsIHRvZ2dsZVN0eWxlcyk7XG4gICAgICBvcmlnaW5hbFRvZ2dsZUVsSGVpZ2h0ID0gMDtcbiAgICB9XG5cbiAgICAvLyBTZXQgdGhlIG9yaWdpbmFsIGhlaWdodFxuICAgIGVsLnN0eWxlLmhlaWdodCA9IG9yaWdpbmFsSGVpZ2h0ICsgJ3B4JztcbiAgICB0b2dnbGVFbC5zdHlsZS5oZWlnaHQgPSBvcmlnaW5hbFRvZ2dsZUVsSGVpZ2h0ICsgJ3B4JztcbiAgICB0b2dnbGVFbC5zdHlsZS5tYXJnaW5Cb3R0b20gPSAnMHB4JztcbiAgICB0b2dnbGVFbC5zdHlsZS5tYXJnaW5Ub3AgPSAnMHB4JztcblxuICAgIC8vIEFkZCB0aGUgc3BhcmstYW5pbWF0ZS1oZWlnaHQgY2xhc3Mgd2hpY2ggd2lsbCBzZXR1cCB0aGUgdHJhbnNpdGlvbi1wcm9wZXJ0eSBhbmQgZHVyYXRpb25cbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KShlbCwgaGVpZ2h0QW5pbWF0aW9uQ2xhc3MpO1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRvZ2dsZUVsLCBoZWlnaHRBbmltYXRpb25DbGFzcyk7XG5cbiAgICBydW5uaW5nQW5pbWF0aW9ucy5lbHMucHVzaChlbCk7XG5cbiAgICAvLyBXZSBuZWVkIHRvIHdhaXQgYSB0aWNrIHRvIHRvZ2dsZSB0aGUgaGVpZ2h0IG9yIGVsc2UgdGhlIGFuaW1hdGlvbiBjbGFzcyB3b24ndCBmdW5jdGlvblxuICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuXG4gICAgICAvLyBTZXQgdGhlIGhlaWdodCB0byB0aGUgdGFyZ2V0IGhlaWdodFxuICAgICAgZWwuc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0RWxIZWlnaHQgKyAncHgnO1xuICAgICAgdG9nZ2xlRWwuc3R5bGUuaGVpZ2h0ID0gdGFyZ2V0VG9nZ2xlRWxIZWlnaHQgKyAncHgnO1xuXG4gICAgICAvLyBSZW1vdmUgaW5saW5lIHN0eWxlcyBhZnRlciB0aGUgYW5pbWF0aW9uIGlzIGNvbXBsZXRlXG4gICAgICBydW5uaW5nQW5pbWF0aW9ucy5jb21wbGV0ZUNhbGxiYWNrcy5wdXNoKHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICBvbkNvbXBsZXRlKHtcbiAgICAgICAgICBlbDogZWwsXG4gICAgICAgICAgdG9nZ2xlRWw6IHRvZ2dsZUVsLFxuICAgICAgICAgIG9uQ29tcGxldGU6IHBhcmFtcy5vbkNvbXBsZXRlIHx8IG5vb3AsXG4gICAgICAgICAgY29sbGFwc2U6IGNvbGxhcHNlLFxuICAgICAgICAgIHRvZ2dsZVByb3BlcnR5OiB0b2dnbGVQcm9wZXJ0eSxcbiAgICAgICAgICB0b2dnbGVDbGFzc05hbWU6IHRvZ2dsZUNsYXNzTmFtZSxcbiAgICAgICAgICB0b2dnbGVWYWx1ZTogdG9nZ2xlVmFsdWUsXG4gICAgICAgICAgaGVpZ2h0QW5pbWF0aW9uQ2xhc3M6IGhlaWdodEFuaW1hdGlvbkNsYXNzXG4gICAgICAgIH0pO1xuICAgICAgfSwgcGFyYW1zLmFuaW1hdGlvbkR1cmF0aW9uICE9PSB1bmRlZmluZWQgPyBwYXJhbXMuYW5pbWF0aW9uRHVyYXRpb24gOiAyMDEpKTtcbiAgICB9LCAwKTtcbiAgfVxufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBhbmltYXRlSGVpZ2h0O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oZWlnaHQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHJpbSA9IHJlcXVpcmUoJy4uL3V0aWwvdHJpbScpO1xuXG52YXIgX3RyaW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJpbSk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuL2hhcy1jbGFzcycpO1xuXG52YXIgX2hhc0NsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhc0NsYXNzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqXG4gKiAjIEFkZCBDbGFzc1xuICogQWRkIGEgY2xhc3Mgb24gYW4gZWxlbWVudC5cbiAqXG4gKiBAcGFyYW0ge0VsZW1lbnR8QXJyYXl9IGVsIEFuIGVsZW1lbnQgb3IgYXJyYXkgb2YgZWxlbWVudHMgdG8gdXBkYXRlLlxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4ge0VsZW1lbnR9XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2RvbS9hZGQtY2xhc3MuanNcbiAqL1xuXG52YXIgd3MgPSAvXFxzKy87XG52YXIgY2xlYW51cCA9IC9cXHN7Mix9L2c7XG5cbmZ1bmN0aW9uIGFkZENsYXNzKGVsLCBuYW1lKSB7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZSA9ICgwLCBfdHJpbTIuZGVmYXVsdCkobmFtZSkuc3BsaXQod3MpO1xuICB9IGVsc2Uge1xuICAgIG5hbWUgPSBuYW1lIGluc3RhbmNlb2YgQXJyYXkgPyBuYW1lIDogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgfVxuXG4gIC8vIG9wdGltaXplIGZvciBiZXN0LCBtb3N0IGNvbW1vbiBjYXNlXG4gIGlmIChuYW1lLmxlbmd0aCA9PT0gMSAmJiBlbC5jbGFzc0xpc3QpIHtcbiAgICBpZiAobmFtZVswXSkge1xuICAgICAgZWwuY2xhc3NMaXN0LmFkZChuYW1lWzBdKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsO1xuICB9XG5cbiAgdmFyIHRvQWRkID0gW107XG4gIHZhciBpID0gMDtcbiAgdmFyIGwgPSBuYW1lLmxlbmd0aDtcbiAgdmFyIGl0ZW0gPSB2b2lkIDA7XG4gIHZhciBjbHNOYW1lID0gdHlwZW9mIGVsLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycgPyBlbC5jbGFzc05hbWUgOiBlbC5nZXRBdHRyaWJ1dGUgPyBlbC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgOiAnJztcblxuICAvLyBzZWUgaWYgd2UgaGF2ZSBhbnl0aGluZyB0byBhZGRcbiAgZm9yICg7IGkgPCBsOyBpKyspIHtcbiAgICBpdGVtID0gbmFtZVtpXTtcbiAgICBpZiAoaXRlbSAmJiAhKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkoY2xzTmFtZSwgaXRlbSkpIHtcbiAgICAgIHRvQWRkLnB1c2goaXRlbSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKHRvQWRkLmxlbmd0aCkge1xuICAgIGlmICh0eXBlb2YgZWwuY2xhc3NOYW1lID09PSAnc3RyaW5nJykge1xuICAgICAgZWwuY2xhc3NOYW1lID0gKDAsIF90cmltMi5kZWZhdWx0KSgoY2xzTmFtZSArICcgJyArIHRvQWRkLmpvaW4oJyAnKSkucmVwbGFjZShjbGVhbnVwLCAnICcpKTtcbiAgICB9IGVsc2UgaWYgKGVsLnNldEF0dHJpYnV0ZSkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdjbGFzcycsICgwLCBfdHJpbTIuZGVmYXVsdCkoKGNsc05hbWUgKyAnICcgKyB0b0FkZC5qb2luKCcgJykpLnJlcGxhY2UoY2xlYW51cCwgJyAnKSkpO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiBlbDtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gYWRkQ2xhc3M7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFkZC1jbGFzcy5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90eXBlb2YgPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIiA/IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIHR5cGVvZiBvYmo7IH0gOiBmdW5jdGlvbiAob2JqKSB7IHJldHVybiBvYmogJiYgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9iai5jb25zdHJ1Y3RvciA9PT0gU3ltYm9sICYmIG9iaiAhPT0gU3ltYm9sLnByb3RvdHlwZSA/IFwic3ltYm9sXCIgOiB0eXBlb2Ygb2JqOyB9O1xuXG4vKipcbiAqICMgSGFzIENsYXNzXG4gKiBTZWUgaWYgYW4gZWxlbWVudCBoYXMgYSBjbGFzcy5cbiAqXG4gKiBAcGFyYW0ge0VsZW1lbnR8U3RyaW5nfSBlbFxuICogQHBhcmFtIHtTdHJpbmd9IG5hbWVcbiAqIEByZXR1cm4ge0Jvb2xlYW59XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2RvbS9oYXMtY2xhc3MuanNcbiAqL1xuZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIG5hbWUpIHtcbiAgdmFyIGNOYW1lID0gKCh0eXBlb2YgZWwgPT09ICd1bmRlZmluZWQnID8gJ3VuZGVmaW5lZCcgOiBfdHlwZW9mKGVsKSkgPT09ICdvYmplY3QnID8gZWwuY2xhc3NOYW1lIHx8IGVsLmdldEF0dHJpYnV0ZSAmJiBlbC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgfHwgJycgOiBlbCB8fCAnJykucmVwbGFjZSgvW1xcdFxcclxcblxcZl0vZywgJyAnKTtcbiAgcmV0dXJuICgnICcgKyBjTmFtZSArICcgJykuaW5kZXhPZignICcgKyBuYW1lICsgJyAnKSAhPT0gLTE7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGhhc0NsYXNzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1oYXMtY2xhc3MuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZWFjaCA9IHJlcXVpcmUoJy4uL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBwcm9wcyA9IFsnbWFyZ2luVG9wJywgJ21hcmdpbkJvdHRvbScsICdib3JkZXJUb3AnLCAnYm9yZGVyQm90dG9tJ107IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBPdXRlciBIZWlnaHRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEdldCB0aGUgb3V0ZXIgaGVpZ2h0IG9mIGFuIGVsZW1lbnQgKGluY2x1ZGluZyBtYXJnaW4gYW5kIGJvcmRlcilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gc3R5bGVzIE9wdGlvbmFsIEFscmVhZHkgaGF2ZSBjb21wdXRlZCBzdHlsZXM/IFBhc3MgdGhlbSBpbi5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogb3V0ZXJIZWlnaHQoZWwsIGNvbXB1dGVkU3R5bGVzKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGhlbHBlcnMvb3V0ZXItaGVpZ2h0LmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuXG5mdW5jdGlvbiBvdXRlckhlaWdodChlbCwgc3R5bGVzKSB7XG5cbiAgc3R5bGVzID0gc3R5bGVzIHx8IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKTtcblxuICB2YXIgaGVpZ2h0ID0gZWwuY2xpZW50SGVpZ2h0O1xuXG4gICgwLCBfZWFjaDIuZGVmYXVsdCkocHJvcHMsIGZ1bmN0aW9uIChwcm9wKSB7XG4gICAgaGVpZ2h0ICs9IHBhcnNlSW50KHN0eWxlc1twcm9wXSB8fCAwLCAxMCk7XG4gIH0pO1xuXG4gIHJldHVybiBoZWlnaHQ7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IG91dGVySGVpZ2h0O1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1vdXRlci1oZWlnaHQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfdHJpbSA9IHJlcXVpcmUoJy4uL3V0aWwvdHJpbScpO1xuXG52YXIgX3RyaW0yID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJpbSk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciB3cyA9IC9cXHMrLzsgLyoqXG4gICAgICAgICAgICAgICAgICogIyBSZW1vdmUgQ2xhc3NcbiAgICAgICAgICAgICAgICAgKiBSZW1vdmUgYSBjbGFzcyBvbiBhbiBlbGVtZW50LlxuICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICogQHBhcmFtIHtFbGVtZW50fEFycmF5fSBlbCBBbiBlbGVtZW50IG9yIGFycmF5IG9mIGVsZW1lbnRzIHRvIHVwZGF0ZS5cbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgICAgICAgICAgICAgICAqIEByZXR1cm4ge0VsZW1lbnR9XG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGhlbHBlcnMvZG9tL3JlbW92ZS1jbGFzcy5qc1xuICAgICAgICAgICAgICAgICAqL1xuXG52YXIgY2xlYW51cCA9IC9cXHN7Mix9L2c7XG5cbmZ1bmN0aW9uIHJlbW92ZUNsYXNzKGVsLCBuYW1lKSB7XG5cbiAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDIgJiYgdHlwZW9mIG5hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgbmFtZSA9ICgwLCBfdHJpbTIuZGVmYXVsdCkobmFtZSkuc3BsaXQod3MpO1xuICB9IGVsc2Uge1xuICAgIG5hbWUgPSBuYW1lIGluc3RhbmNlb2YgQXJyYXkgPyBuYW1lIDogQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoYXJndW1lbnRzLCAxKTtcbiAgfVxuXG4gIC8vIG9wdGltaXplIGZvciBiZXN0LCBtb3N0IGNvbW1vbiBjYXNlXG4gIGlmIChuYW1lLmxlbmd0aCA9PT0gMSAmJiBlbC5jbGFzc0xpc3QpIHtcbiAgICBpZiAobmFtZVswXSkgZWwuY2xhc3NMaXN0LnJlbW92ZShuYW1lWzBdKTtcbiAgICByZXR1cm4gZWw7XG4gIH1cblxuICAvLyBzdG9yZSB0d28gY29waWVzXG4gIHZhciBjbHNOYW1lID0gJyAnICsgKHR5cGVvZiBlbC5jbGFzc05hbWUgPT09ICdzdHJpbmcnID8gZWwuY2xhc3NOYW1lIDogZWwuZ2V0QXR0cmlidXRlID8gZWwuZ2V0QXR0cmlidXRlKCdjbGFzcycpIDogJycpICsgJyAnO1xuICB2YXIgcmVzdWx0ID0gY2xzTmFtZTtcbiAgdmFyIGN1cnJlbnQgPSB2b2lkIDA7XG4gIHZhciBzdGFydCA9IHZvaWQgMDtcbiAgZm9yICh2YXIgaSA9IDAsIGwgPSBuYW1lLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgIGN1cnJlbnQgPSBuYW1lW2ldO1xuICAgIHN0YXJ0ID0gY3VycmVudCA/IHJlc3VsdC5pbmRleE9mKCcgJyArIGN1cnJlbnQgKyAnICcpIDogLTE7XG4gICAgaWYgKHN0YXJ0ICE9PSAtMSkge1xuICAgICAgc3RhcnQgKz0gMTtcbiAgICAgIHJlc3VsdCA9IHJlc3VsdC5zbGljZSgwLCBzdGFydCkgKyByZXN1bHQuc2xpY2Uoc3RhcnQgKyBjdXJyZW50Lmxlbmd0aCk7XG4gICAgfVxuICB9XG5cbiAgLy8gb25seSB3cml0ZSBpZiBtb2RpZmllZFxuICBpZiAoY2xzTmFtZSAhPT0gcmVzdWx0KSB7XG4gICAgaWYgKHR5cGVvZiBlbC5jbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbC5jbGFzc05hbWUgPSAoMCwgX3RyaW0yLmRlZmF1bHQpKHJlc3VsdC5yZXBsYWNlKGNsZWFudXAsICcgJykpO1xuICAgIH0gZWxzZSBpZiAoZWwuc2V0QXR0cmlidXRlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgKDAsIF90cmltMi5kZWZhdWx0KShyZXN1bHQucmVwbGFjZShjbGVhbnVwLCAnICcpKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGVsO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSByZW1vdmVDbGFzcztcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cmVtb3ZlLWNsYXNzLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2hhc0NsYXNzID0gcmVxdWlyZSgnLi9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfYWRkQ2xhc3MgPSByZXF1aXJlKCcuL2FkZC1jbGFzcycpO1xuXG52YXIgX2FkZENsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2FkZENsYXNzKTtcblxudmFyIF9yZW1vdmVDbGFzcyA9IHJlcXVpcmUoJy4vcmVtb3ZlLWNsYXNzJyk7XG5cbnZhciBfcmVtb3ZlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtb3ZlQ2xhc3MpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiB0b2dnbGVDbGFzcyhlbCwgbmFtZSwgZW5hYmxlKSB7XG5cbiAgaWYgKCFlbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIElmIHdlJ3JlIHBhc3NlZCBhbiBhcnJheSwgdG9nZ2xlIHRoZSBjbGFzcyBvbiBlYWNoLlxuICBpZiAoZWwgaW5zdGFuY2VvZiBOb2RlTGlzdCB8fCBlbCBpbnN0YW5jZW9mIEFycmF5KSB7XG5cbiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gZWwubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIHRvZ2dsZUNsYXNzKGVsW2ldLCBuYW1lLCBlbmFibGUpO1xuICAgIH1cblxuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBhY3Rpb24gPSB2b2lkIDA7XG4gIGlmIChlbmFibGUgIT09IHVuZGVmaW5lZCkge1xuICAgIGVuYWJsZSA9IHR5cGVvZiBlbmFibGUgPT09ICdmdW5jdGlvbicgPyBlbmFibGUuY2FsbChudWxsLCBlbCkgOiBlbmFibGU7XG4gICAgYWN0aW9uID0gZW5hYmxlID8gJ2FkZCcgOiAncmVtb3ZlJztcbiAgfSBlbHNlIHtcbiAgICBhY3Rpb24gPSAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KShlbCwgbmFtZSkgPyAncmVtb3ZlJyA6ICdhZGQnO1xuICB9XG5cbiAgcmV0dXJuIChhY3Rpb24gPT09ICdhZGQnID8gX2FkZENsYXNzMi5kZWZhdWx0IDogX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShlbCwgbmFtZSk7XG59IC8qKlxuICAgKiAjIFRvZ2dsZSBDbGFzc1xuICAgKiBUb2dnbGUgYSBjbGFzcyBvbiBhbiBlbGVtZW50IGdpdmVuIGEgY29uZGl0aW9uLlxuICAgKlxuICAgKiBAcGFyYW0ge0VsZW1lbnR8QXJyYXl9IGVsIEFuIGVsZW1lbnQgb3IgYXJyYXkgb2YgZWxlbWVudHMgdG8gdXBkYXRlLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVuYWJsZVxuICAgKiBAcmV0dXJuIHtFbGVtZW50fVxuICAgKlxuICAgKiBAbW9kdWxlICBoZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MuanNcbiAgICovXG5cbmV4cG9ydHMuZGVmYXVsdCA9IHRvZ2dsZUNsYXNzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD10b2dnbGUtY2xhc3MuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5leHBvcnRzLmNsZWFyID0gZXhwb3J0cy5yZXN0b3JlID0gZXhwb3J0cy5zdG9yZSA9IHVuZGVmaW5lZDtcblxudmFyIF9lYWNoID0gcmVxdWlyZSgnLi4vdXRpbC9lYWNoJyk7XG5cbnZhciBfZWFjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9lYWNoKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuLyoqXG4gKiBGaW5kIGFsbCB0aGUgZm9ybSBlbGVtZW50cyBpbnNpZGUgYSBnaXZlbiBlbGVtZW50IGFuZCBydW4gYSBjYWxsYmFjayBvbiBlYWNoLlxuICogQHBhcmFtICB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSAge0Z1bmN0aW9ufSBjYlxuICovXG5mdW5jdGlvbiBmaW5kQWxsKGVsLCBjYikge1xuICAoMCwgX2VhY2gyLmRlZmF1bHQpKGVsLnF1ZXJ5U2VsZWN0b3JBbGwoJ2lucHV0LCBzZWxlY3QsIHRleHRhcmVhJyksIGZ1bmN0aW9uIChpKSB7XG4gICAgY2IoaSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIEZpbmQgYWxsIHRoZSBmb3JtIGVsZW1lbnRzIGluc2lkZSBhIGdpdmVuIGVsZW1lbnQgYW5kIHN0b3JlIHRoZWlyIGN1cnJlbnRcbiAqIHZhbHVlIGFzIGEgZGF0YSBhdHRyaWJ1dGUuXG4gKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gKi9cbi8qKlxuICogIyBGb3JtIERhdGFcbiAqIFN0b3JlIGFuZCByZXN0b3JlIHRoZSBkYXRhIG9mIGZvcm0gZmllbGRzIGlubGluZSBzbyBpdCBjYW4gYmUgcmV2ZXJ0ZWQuXG4gKlxuICogQGV4YW1wbGVcbiAqIGZvcm1EYXRhLnN0b3JlKGVsKTtcbiAqIGZvcm1EYXRhLnJldmVydChlbCk7XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2Zvcm0vZm9ybS1kYXRhLmpzXG4gKi9cblxuZnVuY3Rpb24gc3RvcmUoZWwpIHtcblxuICBmaW5kQWxsKGVsLCBmdW5jdGlvbiAoaW5wdXQpIHtcblxuICAgIHZhciBuYW1lID0gaW5wdXQubm9kZU5hbWUudG9Mb3dlckNhc2UoKTtcbiAgICB2YXIgdmFsdWUgPSB2b2lkIDA7XG5cbiAgICBzd2l0Y2ggKG5hbWUpIHtcbiAgICAgIGNhc2UgJ3NlbGVjdCc6XG4gICAgICAgIHZhbHVlID0gaW5wdXQuc2VsZWN0ZWRJbmRleDtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB2YWx1ZSA9IGVuY29kZVVSSShpbnB1dC52YWx1ZSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cblxuICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnZGF0YS1zdG9yZWQtdmFsdWUnLCB2YWx1ZSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFJldmVydCBhbGwgdGhlIGZvcm0gZWxlbWVudHMgaW5zaWRlIG9mIGEgZ2l2ZW4gZWxlbWVudC5cbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAqL1xuZnVuY3Rpb24gcmVzdG9yZShlbCkge1xuXG4gIGZpbmRBbGwoZWwsIGZ1bmN0aW9uIChpbnB1dCkge1xuXG4gICAgdmFyIG5hbWUgPSBpbnB1dC5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhciB2YWx1ZSA9IGlucHV0LmdldEF0dHJpYnV0ZSgnZGF0YS1zdG9yZWQtdmFsdWUnKTtcblxuICAgIC8vIE5vIHN0b3JlZCB2YWx1ZVxuICAgIGlmICghdmFsdWUgJiYgdmFsdWUgIT09ICcnKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3dpdGNoIChuYW1lKSB7XG4gICAgICBjYXNlICdzZWxlY3QnOlxuICAgICAgICBpbnB1dC5vcHRpb25zW3ZhbHVlXS5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgaW5wdXQudmFsdWUgPSBkZWNvZGVVUkkodmFsdWUpO1xuICAgICAgICBicmVhaztcbiAgICB9XG5cbiAgICBpbnB1dC5yZW1vdmVBdHRyaWJ1dGUoJ2RhdGEtc3RvcmVkLXZhbHVlJyk7XG4gIH0pO1xufVxuXG4vKipcbiAqIENsZWFyIHRoZSBzdG9yZWQgZGF0YSBvbiBhbGwgdGhlIGZvcm0gZWxlbWVudHMgaW5zaWRlIG9mIGEgZ2l2ZW4gZWxlbWVudC5cbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAqL1xuZnVuY3Rpb24gY2xlYXIoZWwpIHtcbiAgZmluZEFsbChlbCwgZnVuY3Rpb24gKGlucHV0KSB7XG4gICAgaW5wdXQucmVtb3ZlQXR0cmlidXRlKCdkYXRhLXN0b3JlZC12YWx1ZScpO1xuICB9KTtcbn1cblxuZXhwb3J0cy5zdG9yZSA9IHN0b3JlO1xuZXhwb3J0cy5yZXN0b3JlID0gcmVzdG9yZTtcbmV4cG9ydHMuY2xlYXIgPSBjbGVhcjtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZvcm0tZGF0YS5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBTZXQgQ2FyZXRcbiAqIFNldCB0aGUgY2FyZXQgcG9zaXRpb24gaW4gYW4gaW5wdXQuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICogQHBhcmFtIHtOdW1iZXJ9IHN0YXJ0XG4gKiBAcGFyYW0ge051bWJlcn0gZW5kXG4gKlxuICogQGV4YW1wbGVcbiAqIHNldENhcmV0KGVsLCAtMSk7XG4gKiBzZXRDYXJldChlbCwgMik7XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2Zvcm0vc2V0LWNhcmV0LmpzXG4gKi9cbmZ1bmN0aW9uIHNldENhcmV0KGVsLCBzdGFydCwgZW5kKSB7XG5cbiAgdmFyIG9yaWdpbmFsQWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cbiAgc3RhcnQgPSBzdGFydCA8IDAgPyBlbC52YWx1ZS5sZW5ndGggKyBzdGFydCArIDEgOiBzdGFydDtcbiAgZW5kID0gZW5kIDwgMCA/IGVsLnZhbHVlLmxlbmd0aCArIGVuZCArIDEgOiBlbmQ7XG5cbiAgLy8gSUUgc3VwcG9ydFxuICBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7XG4gICAgZWwuZm9jdXMoKTtcbiAgICB2YXIgc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgc2VsLm1vdmVTdGFydCgnY2hhcmFjdGVyJywgLWVsLnZhbHVlLmxlbmd0aCk7XG4gICAgc2VsLm1vdmVTdGFydCgnY2hhcmFjdGVyJywgc3RhcnQpO1xuICAgIHNlbC5tb3ZlRW5kKCdjaGFyYWN0ZXInLCBlbmQgIT09IHVuZGVmaW5lZCA/IGVuZCA6IHN0YXJ0KTtcbiAgICBzZWwuc2VsZWN0KCk7XG4gIH0gZWxzZSBpZiAoZWwuc2VsZWN0aW9uU3RhcnQgfHwgZWwuc2VsZWN0aW9uU3RhcnQgPT09IDApIHtcbiAgICBlbC5zZWxlY3Rpb25TdGFydCA9IHN0YXJ0O1xuICAgIGVsLnNlbGVjdGlvbkVuZCA9IGVuZCAhPT0gdW5kZWZpbmVkID8gZW5kIDogc3RhcnQ7XG4gIH1cblxuICAvLyBJZiB3ZSBkaWRuJ3QgaGF2ZSBmb2N1cywgZ28gYmFjayB0byBmb2N1c2luZyBvbiB0aGUgb3JpZ2luYWxcbiAgaWYgKG9yaWdpbmFsQWN0aXZlRWxlbWVudCAhPT0gZWwpIHtcbiAgICBlbC5ibHVyKCk7XG4gICAgb3JpZ2luYWxBY3RpdmVFbGVtZW50LmZvY3VzKCk7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHN0YXJ0OiBzdGFydCxcbiAgICBlbmQ6IGVuZFxuICB9O1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBzZXRDYXJldDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9c2V0LWNhcmV0LmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKipcbiAqICMgR2V0IEluZGV4XG4gKiBHZXQgdGhlIGluZGV4IG9mIGFuIGVsZW1lbnQgaW4gYSBub2RlbGlzdC5cbiAqXG4gKiBAcGFyYW0ge05vZGVMaXN0fSBlbHNcbiAqIEBwYXJhbSB7Tm9kZX0gZWxcbiAqIEByZXR1cm4ge051bWJlcn1cbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvdHJhdmVyc2FsL2dldC1pbmRleC5qc1xuICovXG5mdW5jdGlvbiBnZXRJbmRleChlbHMsIGVsKSB7XG4gIHJldHVybiBBcnJheS5wcm90b3R5cGUuaW5kZXhPZi5jYWxsKGVscywgZWwpO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBnZXRJbmRleDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1tcImRlZmF1bHRcIl07XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXQtaW5kZXguanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfbWF0Y2hlcyA9IHJlcXVpcmUoJy4vbWF0Y2hlcycpO1xuXG52YXIgX21hdGNoZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWF0Y2hlcyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIGdldFBhcmVudChwYXJlbnQsIHF1ZXJ5LCBsaW1pdEVsKSB7XG5cbiAgbGltaXRFbCA9IGxpbWl0RWwgaW5zdGFuY2VvZiBBcnJheSA/IGxpbWl0RWwgOiBbbGltaXRFbCB8fCBkb2N1bWVudC5ib2R5XTtcblxuICB3aGlsZSAocGFyZW50KSB7XG5cbiAgICBpZiAoKDAsIF9tYXRjaGVzMi5kZWZhdWx0KShwYXJlbnQsIHF1ZXJ5KSkge1xuICAgICAgcmV0dXJuIHBhcmVudDtcbiAgICB9XG5cbiAgICBpZiAobGltaXRFbC5pbmRleE9mKHBhcmVudCkgIT09IC0xKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XG4gIH1cblxuICByZXR1cm4gZmFsc2U7XG59IC8qKlxuICAgKiAjIEdldCBQYXJlbnRcbiAgICogU2VlIGlmIGFuIGVsZW1lbnQgaGFzIGFub3RoZXIgZWxlbWVudCBmb3IgYSBwYXJlbnQuXG4gICAqXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gcGFyZW50XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBxdWVyeVxuICAgKiBAcGFyYW0ge0FycmF5fEVsZW1lbnR9IGxpbWl0RWwgVGhlIGxhc3QgZWxlbWVudCB3ZSBzaG91bGQgY2hlY2suXG4gICAqIEByZXR1cm4ge0Jvb2xlYW58RWxlbWVudH1cbiAgICpcbiAgICogQG1vZHVsZSBoZWxwZXJzL3RyYXZlcnNhbC9nZXQtcGFyZW50LmpzXG4gICAqL1xuXG5leHBvcnRzLmRlZmF1bHQgPSBnZXRQYXJlbnQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdldC1wYXJlbnQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfbWF0Y2hlcyA9IHJlcXVpcmUoJy4vbWF0Y2hlcycpO1xuXG52YXIgX21hdGNoZXMyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfbWF0Y2hlcyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIGdldFNpYmxpbmdBZnRlcihlbCwgcXVlcnkpIHtcblxuICB3aGlsZSAoZWwgPSBlbC5uZXh0RWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoKDAsIF9tYXRjaGVzMi5kZWZhdWx0KShlbCwgcXVlcnkpKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59IC8qKlxuICAgKiAjIEdldCBTaWJsaW5nIEFmdGVyXG4gICAqIEdldCBhIG5lYXJlc3Qgc2libGluZyBhZnRlciB0aGUgZ2l2ZW4gZWxlbWVudCB3aGljaCBtYXRjaGVzXG4gICAqIHRoZSBnaXZlbiBxdWVyeSBzZWxlY3Rvci5cbiAgICpcbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge1N0cmluZ30gcXVlcnlcbiAgICogQHJldHVybiB7RWxlbWVudHxOdWxsfVxuICAgKlxuICAgKiBAbW9kdWxlIGhlbHBlcnMvdHJhdmVyc2FsL2dldC1zaWJsaW5nLWFmdGVyLmpzXG4gICAqL1xuXG5leHBvcnRzLmRlZmF1bHQgPSBnZXRTaWJsaW5nQWZ0ZXI7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWdldC1zaWJsaW5nLWFmdGVyLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX21hdGNoZXMgPSByZXF1aXJlKCcuL21hdGNoZXMnKTtcblxudmFyIF9tYXRjaGVzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX21hdGNoZXMpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBnZXRTaWJsaW5nQmVmb3JlKGVsLCBxdWVyeSkge1xuXG4gIHdoaWxlIChlbCA9IGVsLnByZXZpb3VzRWxlbWVudFNpYmxpbmcpIHtcbiAgICBpZiAoKDAsIF9tYXRjaGVzMi5kZWZhdWx0KShlbCwgcXVlcnkpKSB7XG4gICAgICByZXR1cm4gZWw7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIG51bGw7XG59IC8qKlxuICAgKiAjIEdldCBTaWJsaW5nIEJlZm9yZVxuICAgKiBHZXQgYSBuZWFyZXN0IHNpYmxpbmcgYmVmb3JlIHRoZSBnaXZlbiBlbGVtZW50IHdoaWNoIG1hdGNoZXNcbiAgICogdGhlIGdpdmVuIHF1ZXJ5IHNlbGVjdG9yLlxuICAgKlxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBxdWVyeVxuICAgKiBAcmV0dXJuIHtFbGVtZW50fE51bGx9XG4gICAqXG4gICAqIEBtb2R1bGUgaGVscGVycy90cmF2ZXJzYWwvZ2V0LXNpYmxpbmctYmVmb3JlLmpzXG4gICAqL1xuXG5leHBvcnRzLmRlZmF1bHQgPSBnZXRTaWJsaW5nQmVmb3JlO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1nZXQtc2libGluZy1iZWZvcmUuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKipcbiAqICMgTWF0Y2hlc1xuICogU2VlIGlmIGFuIGVsZW1lbnQgbWF0Y2hlcyBhIHF1ZXJ5IHNlbGVjdG9yLlxuICpcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSB7U3RyaW5nfSBxdWVyeVxuICogQHJldHVybiB7Qm9vbGVhbn1cbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvdHJhdmVyc2FsL21hdGNoZXMuanNcbiAqL1xudmFyIHZlbmRvck1hdGNoID0gdHlwZW9mIEVsZW1lbnQgIT09ICd1bmRlZmluZWQnICYmIChFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzIHx8IEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUubW96TWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm1zTWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLm9NYXRjaGVzU2VsZWN0b3IpO1xuXG5mdW5jdGlvbiBtYXRjaGVzKGVsLCBxdWVyeSkge1xuXG4gIGlmICh2ZW5kb3JNYXRjaCkgcmV0dXJuIHZlbmRvck1hdGNoLmNhbGwoZWwsIHF1ZXJ5KTtcblxuICB2YXIgbm9kZXMgPSBlbC5wYXJlbnROb2RlID8gZWwucGFyZW50Tm9kZS5xdWVyeVNlbGVjdG9yQWxsKHF1ZXJ5KSA6IFtdO1xuXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICBpZiAobm9kZXNbaV0gPT09IGVsKSByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gbWF0Y2hlcztcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWF0Y2hlcy5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBFYWNoXG4gKiBBcHBseSBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGEgbGlzdCBvZiBhbnkga2luZDogQXJyYXksIE5vZGVMaXN0LCBIVE1MQ29sbGVjdGlvbiBvciBPYmplY3QuXG4gKlxuICogQHBhcmFtIHtBcnJheXxOb2RlTGlzdHxIVE1MQ29sbGVjdGlvbnxPYmplY3R9IGxpc3RcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNiXG4gKlxuICogQGV4YW1wbGVcbiAqIGVhY2goW10sIGNhbGxiYWNrKTtcbiAqIGVhY2goZWwuY2hpbGRyZW4sIGNhbGxiYWNrKTtcbiAqIGVhY2goZWwuY2hpbGROb2RlcywgY2FsbGJhY2spO1xuICogZWFjaCh7fSwgY2FsbGJhY2spO1xuICpcbiAqIEBtb2R1bGUgaGVscGVycy91dGlsL2VhY2guanNcbiAqL1xuZnVuY3Rpb24gZWFjaChsaXN0LCBjYikge1xuXG4gIGlmICghbGlzdCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbnZva2UgYGVhY2hgIHdpdGhvdXQgYSBjYWxsYmFjayEnKTtcbiAgfVxuXG4gIHZhciBpID0gMDtcbiAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuXG4gIC8vIE9iamVjdFxuICBpZiAobGVuID09PSB1bmRlZmluZWQpIHtcbiAgICBmb3IgKGkgaW4gbGlzdCkge1xuICAgICAgaWYgKGkgIT09ICdwcm90b3R5cGUnICYmIGxpc3QuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgY2IoaSwgbGlzdFtpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIEFycmF5LWxpa2VcbiAgZWxzZSB7XG4gICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNiKGxpc3RbaV0pO1xuICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZWFjaDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZWFjaC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBUcmltXG4gKiBUcmltIHdoaXRlc3BhY2Ugb24gYSBzdHJpbmcuXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0clxuICpcbiAqIEBtb2R1bGUgaGVscGVycy91dGlsL3RyaW0uanNcbiAqL1xuXG52YXIgdHJpbVJFID0gL15bXFxzXFx1RkVGRlxceEEwXSt8W1xcc1xcdUZFRkZcXHhBMF0rJC9nO1xuXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UodHJpbVJFLCAnJyk7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHRyaW07XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRyaW0uanMubWFwXG4iXX0="}