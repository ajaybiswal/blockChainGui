{"version":3,"sources":["js/dist/components/node_modules/browser-pack/_prelude.js","js/dist/components/js/dist/components/base.js","js/dist/components/js/dist/components/date-typeahead.js","js/dist/components/js/dist/components/typeahead.js","js/dist/components/js/dist/helpers/dom/parse-attribute.js","js/dist/components/js/dist/helpers/dom/trigger-event.js","js/dist/components/js/dist/helpers/util/each.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1jCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"date-typeahead.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n                                                                                                                                                           * # Base Component\n                                                                                                                                                           * The base class for Spark JS components. This class should never be\n                                                                                                                                                           * instantiated directly.\n                                                                                                                                                           *\n                                                                                                                                                           * @param {Element} el\n                                                                                                                                                           * @param {Object} params\n                                                                                                                                                           *\n                                                                                                                                                           * @module components/base.js\n                                                                                                                                                           */\n\nvar noop = function noop() {};\n\nvar Base = function () {\n\n  /**\n   * Set parameters and cache elements.\n   */\n  function Base(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Base);\n\n    if (params.elRequired && !el) {\n      return;\n    }\n\n    this.setParams(this.defaults || {}, true);\n    this.setParams(params);\n    (this._cacheElements || noop).call(this, el, params);\n    (this._parseParams || noop).call(this);\n  }\n\n  /**\n   * Remove the component from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Base.prototype.remove = function remove(leaveElement) {\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    if (!leaveElement && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n\n    this.unsetParams(this.defaults);\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n\n\n  Base.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    (this._cacheElements || noop).call(this, el || this.el, params);\n    (this._parseParams || noop).call(this);\n\n    if (this._addEventListeners) {\n      this._addEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Set a hash of parameters if they're whitelisted or we're told to force the set.\n   * This is used to set initial values as well as set passed parameters.\n   * @param {Object} params\n   * @param {Boolean} force Force setting even if the param is not whitelisted.\n   */\n\n\n  Base.prototype.setParams = function setParams(params, force) {\n    var _this = this;\n\n    (0, _each2.default)(params, function (k, v) {\n      if (_this._whitelistedParams.indexOf(k) !== -1 || force) {\n        _this[k] = v;\n      }\n    });\n\n    return this;\n  };\n\n  /**\n   * Unset all parameters.\n   * @param {Array|Object} keys\n   * @param {Object} scope The object to unset the params from. Defaults to `this`.\n   */\n\n\n  Base.prototype.unsetParams = function unsetParams(keys, scope) {\n\n    keys = keys instanceof Array ? keys : Object.keys(keys);\n    scope = scope || this;\n    (0, _each2.default)(keys, function (k) {\n      delete scope[k];\n    });\n\n    return this;\n  };\n\n  return Base;\n}();\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nBase.prototype._whitelistedParams = [];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nBase.prototype.defaults = {};\n\nexports.default = Base;\nmodule.exports = exports['default'];\n//# sourceMappingURL=base.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _typeahead = require('./typeahead');\n\nvar _typeahead2 = _interopRequireDefault(_typeahead);\n\nvar _parseAttribute = require('../helpers/dom/parse-attribute');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # DateTypeahead\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Listen to an input element and format it as the user types.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new DateTypeahead(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/date-typeahead.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nfunction createDefaultElement() {\n  var el = document.createElement('span');\n  el.className = 'spark-input';\n  return el;\n}\n\nvar DateTypeahead = function (_BaseComponent) {\n  _inherits(DateTypeahead, _BaseComponent);\n\n  /**\n   * DateTypeahead constructor\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n  function DateTypeahead(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, DateTypeahead);\n\n    // If only one arg passed, assume it was a parameters\n    // object since the user MUST provide those but the element\n    // is optional. Doing it this way to keep the arity the same\n    // as other components.\n    if (arguments.length < 2) {\n      params = el || {};\n      el = createDefaultElement();\n    }\n\n    var _this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params));\n\n    _this._bindEventListenerCallbacks();\n    _this._createTypeahead(el, params);\n    return _this;\n  }\n\n  /**\n   * Get the value.\n   * @param {Boolean} asInt Get the value as a parsed integer.\n   * @return {Mixed}\n   */\n\n\n  DateTypeahead.prototype.getValue = function getValue(asInt) {\n    return this.typeahead.getValue(asInt);\n  };\n\n  /**\n   * Set the value.\n   * @param {Mixed} val\n   */\n\n\n  DateTypeahead.prototype.setValue = function setValue(val) {\n    return this.typeahead.setValue(val);\n  };\n\n  /**\n   * Clear the value.\n   */\n\n\n  DateTypeahead.prototype.clearValue = function clearValue() {\n    return this.typeahead.clearValue();\n  };\n\n  /**\n   * Enable the input.\n   */\n\n\n  DateTypeahead.prototype.enable = function enable() {\n    return this.typeahead.enable();\n  };\n\n  /**\n   * Disable the input.\n   */\n\n\n  DateTypeahead.prototype.disable = function disable() {\n    return this.typeahead.disable();\n  };\n\n  /**\n   * Run the typeahead calculations.\n   */\n\n\n  DateTypeahead.prototype.run = function run() {\n    return this.typeahead.run();\n  };\n\n  /**\n   * Pause the typeahead events.\n   */\n\n\n  DateTypeahead.prototype.pause = function pause() {\n    return this.typeahead.pause();\n  };\n\n  /**\n   * Reseume typeahead events.\n   */\n\n\n  DateTypeahead.prototype.resume = function resume() {\n    return this.typeahead.resume();\n  };\n\n  /**\n   * Augment default remove call w/ helper cleanup.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  DateTypeahead.prototype.remove = function remove(leaveElement) {\n    this.typeahead.remove(leaveElement);\n    _BaseComponent.prototype.remove.call(this, leaveElement);\n    return this;\n  };\n\n  /**\n   * Cache elements.\n   * @param {Element} el\n   */\n\n\n  DateTypeahead.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n  };\n\n  /**\n   * Parse parameters from the elements.\n   */\n\n\n  DateTypeahead.prototype._parseParams = function _parseParams() {\n\n    this.type = this.type !== null ? this.type : (0, _parseAttribute.string)(this.el, 'data-type', 'day');\n    this.format = this.format !== null ? this.format : (0, _parseAttribute.string)(this.el, 'data-format', null);\n    this.placeholder = this.placeholder !== null ? this.placeholder : (0, _parseAttribute.string)(this.el, 'data-placeholder', null);\n    this.len = this.len !== null ? this.len : (0, _parseAttribute.number)(this.el, 'length', null);\n    this.ariaLabelPrefix = this.ariaLabelPrefix !== null ? this.ariaLabelPrefix : null;\n\n    if (!this.placeholder) {\n      throw new Error('You must provide a placeholder value for a DateTypeahead.');\n    }\n\n    if (this.len !== null) {\n      this.format = this._lengthToFormat(this.len);\n    }\n\n    if (!this.format) {\n      throw new Error('You must provide a format value for a DateTypeahead.');\n    }\n  };\n\n  /**\n   * Create a typeahead with the given format.\n   * @param {Object} el\n   */\n\n\n  DateTypeahead.prototype._createTypeahead = function _createTypeahead(el) {\n\n    this.typeahead = new _typeahead2.default(el, {\n      placeholder: this.placeholder,\n      format: this.format,\n      matchPlaceholderSize: true,\n      onChange: this._onTypeaheadChangeBound,\n      onInput: this._onTypeaheadInputBound,\n      onFocus: this._onTypeaheadFocusBound,\n      onBlur: this._onTypeaheadBlurBound,\n      onBackspace: this._onTypeaheadBackspaceBound,\n      onEnd: this._onTypeaheadEndBound\n    });\n\n    // Ensure we have an ARIA label\n    var input = el.querySelector('input');\n    if (input && !input.getAttribute('aria-label')) {\n      input.setAttribute('aria-label', this.ariaLabelPrefix + ' ' + this.type);\n    }\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  DateTypeahead.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onTypeaheadChangeBound = this._onTypeaheadChange.bind(this);\n    this._onTypeaheadInputBound = this._onTypeaheadInput.bind(this);\n    this._onTypeaheadFocusBound = this._onTypeaheadFocus.bind(this);\n    this._onTypeaheadBlurBound = this._onTypeaheadBlur.bind(this);\n    this._onTypeaheadBackspaceBound = this._onTypeaheadBackspace.bind(this);\n    this._onTypeaheadEndBound = this._onTypeaheadEnd.bind(this);\n  };\n\n  /**\n   * Take a length and return a format string with that many digits.\n   * @param {Number} length\n   * @return {String}\n   */\n\n\n  DateTypeahead.prototype._lengthToFormat = function _lengthToFormat(length) {\n\n    var i = 0;\n    var ret = '';\n\n    for (; i < length; i++) {\n      ret += '\\\\d';\n    }\n\n    return ret;\n  };\n\n  /**\n   * Check to see if an input value is valid.\n   * @param {Mixed} val\n   * @param {Boolean} allowEmpty All the value to be empty instead of 0.\n   */\n\n\n  DateTypeahead.prototype._checkValidity = function _checkValidity(val, allowEmpty) {\n\n    val = parseInt(val, 10);\n\n    var origVal = val;\n    var isNumber = !isNaN(val);\n\n    // If we were passed an empty string or something, don't try to validate.\n    // Treat zeros as a non-entry for days and months.\n    if (isNumber) {\n\n      if (this.type === 'year') {\n        val = val === 0 ? allowEmpty ? '' : 0 : Math.max(val, 0);\n      } else if (this.type === 'month') {\n        val = val ? Math.min(Math.max(val, 1), 12) : allowEmpty ? '' : 0;\n      } else {\n        val = val ? Math.min(Math.max(val, 1), 31) : allowEmpty ? '' : 0;\n      }\n    }\n\n    // Need to make sure we aren't looping forever on these updates.\n    if (isNumber && val !== origVal) {\n      this.typeahead.setValue(val + '');\n      return false;\n    }\n\n    return true;\n  };\n\n  /**\n   * When the typeahead changes, make sure the value is valid. This\n   * is very basic validation. More complex validation like the number\n   * of days in a specific month should be handled by the callback.\n   * And run our callback.\n   * @param {String} val The value of the input\n   * @param {String} oldVal The previous value\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadChange = function _onTypeaheadChange(val) {\n    if (this._checkValidity(val)) {\n      (this.onChange || noop)(val, this);\n    }\n  };\n\n  /**\n   * Callback for `input` event\n   * @param {String} val The value of the input\n   * @param {String} oldVal The previous value\n   *\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadInput = function _onTypeaheadInput(val) {\n    (this.onInput || noop)(val, this);\n  };\n\n  /**\n   * When the typeahead gains focus, let anyone who is interested know.\n   * @param {String} val\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadFocus = function _onTypeaheadFocus(val) {\n    (this.onFocus || noop)(val, this);\n  };\n\n  /**\n   * When the typeahead loses focus, let anyone who is interested know.\n   * @param {String} val\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadBlur = function _onTypeaheadBlur(val) {\n    this._checkValidity(val, true);\n    (this.onBlur || noop)(val, this);\n  };\n\n  /**\n   * When the typeahead fires a backspace event because it's empty and\n   * the user is hitting backspace, let anyone who is interested know.\n   * @param {String} val\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadBackspace = function _onTypeaheadBackspace(val) {\n    (this.onBackspace || noop)(val, this);\n  };\n\n  /**\n   * When the typeahead is full and at its end, let anyone who is interested know.\n   * @param {Object} typeahead\n   * @param {String} character Optional The character to pass to the next input.\n   */\n\n\n  DateTypeahead.prototype._onTypeaheadEnd = function _onTypeaheadEnd(typeahead, character) {\n    (this.onEnd || noop)(this, character);\n  };\n\n  return DateTypeahead;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nDateTypeahead.prototype._whitelistedParams = ['type', 'format', 'ariaLabelPrefix', 'placeholder', 'len', 'onChange', 'onInput', 'onFocus', 'onBlur', 'onBackspace', 'onEnd'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nDateTypeahead.prototype.defaults = {\n  el: null,\n  type: null,\n  ariaLabelPrefix: null,\n  typeahead: null,\n  format: null,\n  placeholder: null,\n  len: null,\n  onChange: null,\n  onInput: null,\n  onFocus: null,\n  onBlur: null,\n  onBackspace: null,\n  onEnd: null,\n  _onTypeaheadChangeBound: null,\n  _onTypeaheadInputBound: null,\n  _onTypeaheadFocusBound: null,\n  _onTypeaheadBlurBound: null,\n  _onTypeaheadBackspaceBound: null,\n  _onTypeaheadEndBound: null\n};\n\nexports.default = DateTypeahead;\nmodule.exports = exports['default'];\n//# sourceMappingURL=date-typeahead.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _triggerEvent = require('../helpers/dom/trigger-event');\n\nvar _triggerEvent2 = _interopRequireDefault(_triggerEvent);\n\nvar _parseAttribute = require('../helpers/dom/parse-attribute');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Typeahead\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Listen to an input element and format it as the user types.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Typeahead(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/typeahead.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\nvar noop = function noop() {};\n\nvar Typeahead = function (_BaseComponent) {\n  _inherits(Typeahead, _BaseComponent);\n\n  /**\n   * Typeahead constructor\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Typeahead(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Typeahead);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._maintainFocus(function () {\n      this._parseParams();\n      this._bindEventListenerCallbacks();\n      this._addEventListeners();\n    });\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Run the formatting.\n   * @param {Number} cursorIndex\n   */\n\n\n  Typeahead.prototype.run = function run(cursorIndex) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this.isRunning) return this;\n\n    this.isRunning = true;\n\n    var oldVal = this.inputEl.value;\n    var val = '';\n    var placeholder = '';\n    var i = 0;\n    var len = this.format.length;\n    var skipCount = 0;\n    var valDone = false;\n\n    for (; i < len; i++) {\n\n      // Add numbers\n      if (this.format[i] === '\\\\d') {\n\n        if (this.characters[i - skipCount]) {\n          val += this.characters[i - skipCount];\n        } else {\n          valDone = true;\n        }\n\n        placeholder += valDone ? this.placeholder[i] : '&nbsp;';\n      }\n      // Placeholder characters\n      else {\n\n          if (!valDone) {\n            val += this.format[i];\n          }\n\n          placeholder += this.format[i];\n\n          skipCount++;\n        }\n    }\n\n    if (this.isFocused) {\n      cursorIndex = cursorIndex === undefined ? this._getCaretEnd() : cursorIndex;\n    }\n\n    // If there are no characters, set the cursorIndex to be the last placeholder entry.\n    if (this.isFocused && !this.characters.length) {\n      cursorIndex = val.length;\n    }\n\n    // No characters and we shouldn't use just placeholder values\n    if (!this.characters.length && params.notOnlyPlaceholders) {\n      val = '';\n    }\n\n    this.inputEl.value = val;\n    this.placeholderEl.innerHTML = placeholder;\n\n    this._updateWidth();\n\n    if (this.isFocused) {\n      this._setCaretPositionTranslated(cursorIndex);\n    }\n\n    if (val !== oldVal) {\n      (0, _triggerEvent2.default)(this.inputEl, 'input');\n    }\n\n    this.isRunning = false;\n\n    if (val !== oldVal) {\n      (this.onChange || noop)(val, oldVal, this);\n    }\n\n    if (!this._atEnd && this.isFocused && this.characters.length === this.maxLength && this._caretIsAtEnd()) {\n      this._atEnd = true;\n      (this.onEnd || noop)(this);\n    } else {\n      this._atEnd = false;\n    }\n\n    return this;\n  };\n\n  /**\n   * Add a character to the characters array at a given index.\n   * @param {String} character\n   * @param {Number} start\n   * @param {Number} end\n   * @param {Boolean} skipCheck\n   */\n\n\n  Typeahead.prototype.addCharacterAtIndex = function addCharacterAtIndex(character, start, end, skipCheck) {\n\n    // Don't add at an index beyond what we can support.\n    if (this.maxLength && start >= this.maxLength) {\n      return this;\n    }\n\n    if (!skipCheck) {\n\n      var re;\n\n      // Try to build a regex for this format character.\n      try {\n        re = new RegExp(this.format[start]);\n      } catch (e) {\n        //\n      }\n\n      if (!re || !re.exec(character)) {\n        return this;\n      }\n    }\n\n    this.characters.splice(start, end - start, character);\n\n    // If we've added at an index that pushes the length beyond what we support,\n    // remove the trailing characters.\n    if (this.maxLength && this.characters.length > this.maxLength) {\n      this.characters.splice(this.maxLength, this.characters.length);\n    }\n\n    this.run(start + 1);\n\n    return this;\n  };\n\n  /**\n   * Add a character at the position of the caret.\n   * @param {String} character\n   */\n\n\n  Typeahead.prototype.addCharacterAtCaret = function addCharacterAtCaret(character) {\n\n    var pos = this._getCaretStart();\n    var re;\n\n    // If we're beyond the bounds of the format, stop.\n    if (this.format[pos] === undefined) {\n      (this.onEnd || noop)(this, character);\n      return this;\n    }\n\n    // Try to build a regex for this format character.\n    try {\n      re = new RegExp(this.format[pos]);\n    } catch (e) {}\n    //\n\n\n    // We couldn't build a regex (so it's invalid) or the regex failed (so it's invalid)\n    if (!re || !re.exec(character)) {\n      if (this._moveCaret('right')) {\n        this.addCharacterAtCaret(character);\n      }\n      return this;\n    }\n\n    this.addCharacterAtIndex(character, this._getCaretStartTranslated(), this._getCaretEndTranslated(), true);\n\n    return this;\n  };\n\n  /**\n   * Remove a character from the character array by index.\n   * @param {Number} index\n   * @param {Number} length Optional\n   * @param {Number} offset Optional\n   */\n\n\n  Typeahead.prototype.removeCharacterAtIndex = function removeCharacterAtIndex(index, length, offset) {\n\n    // Don't want a negative splice length or else we start\n    // removing characters from the end.\n    if (index + offset < 0) {\n      return this;\n    }\n\n    length = length !== undefined ? length : 1;\n    this.characters.splice(index + offset, length);\n    this.run(index + (offset || 1));\n\n    return this;\n  };\n\n  /**\n   * Remove the character at the caret.\n   * @param {Number} offset Optional An offset from the current position.\n   */\n\n\n  Typeahead.prototype.removeCharacterAtCaret = function removeCharacterAtCaret(offset) {\n\n    var start = this._getCaretStartTranslated();\n    var end = this._getCaretEndTranslated();\n    var length = 1;\n    var tmp;\n\n    if (start !== end) {\n\n      // If the end is less than the start, the user dragged from right to left.\n      // Just swap them to make it easier to handle.\n      if (end < start) {\n        tmp = start;\n        start = end;\n        end = tmp;\n      }\n\n      // The length of characters removed\n      length = end - start;\n\n      // Bump the start position @todo: haven't thought through why this is, but it's needed.\n      start++;\n    }\n\n    this.removeCharacterAtIndex(start, length, offset);\n\n    return this;\n  };\n\n  /**\n   * Remove the character in the current range.\n   */\n\n\n  Typeahead.prototype.removeCharactersInRange = function removeCharactersInRange() {\n    this.removeCharacterAtIndex(this._getCaretStartTranslated(), this._getCaretEndTranslated());\n    return this;\n  };\n\n  /**\n   * Set the value of the typeahead. Maintain the position of the caret.\n   * @param {String} value\n   */\n\n\n  Typeahead.prototype.setValue = function setValue(value) {\n\n    this.settingValue = true;\n    this.pause();\n\n    this.characters = (value + '').split('');\n    this.run();\n\n    if (this.isFocused) this._setCaretPosition(this._getCaretStart());\n\n    this.resume();\n    this.settingValue = false;\n\n    return this;\n  };\n\n  /**\n   * Get the value of the typeahead.\n   * @param {Boolean} asInt Get the value as a parsed integer.\n   * @return {String|Number}\n   */\n\n\n  Typeahead.prototype.getValue = function getValue(asInt) {\n    return asInt && this.inputEl.value ? parseInt(this.inputEl.value, 10) : this.inputEl.value;\n  };\n\n  /**\n   * Clear the selected value.\n   */\n\n\n  Typeahead.prototype.clearValue = function clearValue() {\n    this.pause();\n    this.characters = [];\n    this.run(0, { notOnlyPlaceholders: true });\n    return this.resume();\n  };\n\n  /**\n   * Take the date values from the inputs and set them as dates on the calendar.\n   */\n\n\n  Typeahead.prototype.updateValue = function updateValue() {\n    return this.setValue(this.inputEl.value);\n  };\n\n  /**\n   * Move the caret position.\n   * @param {Number} pos\n   */\n\n\n  Typeahead.prototype.moveCaret = function moveCaret(pos) {\n    this._setCaretPositionTranslated(pos);\n    return this;\n  };\n\n  /**\n   * Move the caret to the end of the input.\n   */\n\n\n  Typeahead.prototype.moveCaretToEnd = function moveCaretToEnd() {\n    return this.moveCaret(this.characters.length);\n  };\n\n  /**\n   * Move the caret to the start of the input.\n   */\n\n\n  Typeahead.prototype.moveCaretToStart = function moveCaretToStart() {\n    return this.moveCaret(0);\n  };\n\n  /**\n   * Pause events.\n   */\n\n\n  Typeahead.prototype.pause = function pause() {\n    this.pauseBlurFocus++;\n    return this;\n  };\n\n  /**\n   * Resume events.\n   */\n\n\n  Typeahead.prototype.resume = function resume() {\n    this.pauseBlurFocus--;\n    return this;\n  };\n\n  /**\n   * Disable entry into the input.\n   */\n\n\n  Typeahead.prototype.disable = function disable() {\n    this.inputEl.setAttribute('disabled', '');\n    return this;\n  };\n\n  /**\n   * Enable entry into the input.\n   */\n\n\n  Typeahead.prototype.enable = function enable() {\n    this.inputEl.removeAttribute('disabled');\n    return this;\n  };\n\n  /**\n   * Clear the value.\n   * Changed to clearValue in v2.0.0.\n   */\n\n\n  Typeahead.prototype.clear = function clear() {\n    return this.clearValue();\n  };\n\n  /**\n   * Augment default remove call w/ helper cleanup.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Typeahead.prototype.remove = function remove(leaveElement) {\n    _BaseComponent.prototype.remove.call(this, leaveElement);\n    return this;\n  };\n\n  /**\n   * Store a reference to the needed elements.\n   * @param {Object} el\n   */\n\n\n  Typeahead.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.inputEl = this.el.querySelector('[type=\"text\"], [type=\"email\"], [type=\"phone\"], textarea') || this._createDefaultInputElement();\n    this.placeholderEl = this.el.querySelector('.spark-input__placeholder') || this._createDefaultPlaceholderElement();\n  };\n\n  /**\n   * Parse parameters from the elements.\n   */\n\n\n  Typeahead.prototype._parseParams = function _parseParams() {\n\n    // Store the value characters\n    this.characters = this._parseCharacters(this.inputEl.value);\n\n    // Store format\n    this.format = this._parseFormat(this.format ? this.format : this.inputEl.getAttribute('data-typeahead-format'));\n\n    // Store the original placeholder\n    this.placeholder = this.placeholder ? this.placeholder : this.inputEl.getAttribute('placeholder').split('');\n\n    // Get the total number of characters we can have\n    this.maxLength = this._getCharactersAllowedCount(this.format);\n\n    this.matchPlaceholderSize = this.matchPlaceholderSize !== null ? this.matchPlaceholderSize : (0, _parseAttribute.boolean)(this.inputEl, 'data-match-placeholder-size', false);\n  };\n\n  /**\n   * Parse the format string into an array.\n   * @param  {String} format\n   * @return {Array}\n   */\n\n\n  Typeahead.prototype._parseFormat = function _parseFormat(format) {\n\n    var i = 0;\n    var len = format.length;\n    var arr = [];\n    var lastWasEscape = false;\n\n    for (; i < len; i++) {\n      if (format[i] === '\\\\' && !lastWasEscape) {\n        lastWasEscape = true;\n      } else {\n        arr.push((lastWasEscape ? '\\\\' : '') + format[i]);\n        lastWasEscape = false;\n      }\n    }\n\n    return arr;\n  };\n\n  /**\n   * Parse the characters string into an array, ignoring characters which don't\n   * match the format requirements.\n   * @param {String} characters\n   * @return {Array}\n   */\n\n\n  Typeahead.prototype._parseCharacters = function _parseCharacters(characters) {\n\n    var chars = characters.split('');\n    var i = 0;\n    var len = characters.length;\n    var regexes = [];\n    var arr = [];\n\n    for (; i < len; i++) {\n\n      // Try to build a regex for this format character.\n      try {\n        // Make sure this format starts with an escape character.\n        regexes[i] = this.format[i][0] === '\\\\' ? new RegExp(this.format[i]) : null;\n      } catch (e) {}\n      //\n\n\n      // If we were able to create a regex and our char passes, add it to the array\n      // of characters to return.\n      if (regexes[i] && regexes[i].exec(chars[i])) {\n        arr.push(chars[i]);\n      }\n    }\n\n    return arr;\n  };\n\n  /**\n   * Create the default input element.\n   * @return {Element}\n   */\n\n\n  Typeahead.prototype._createDefaultInputElement = function _createDefaultInputElement() {\n\n    var el = document.createElement('input');\n    el.className = 'spark-input__field';\n    el.setAttribute('data-typeahead', '');\n    el.setAttribute('type', 'tel');\n\n    this.el.appendChild(el);\n\n    return el;\n  };\n\n  /**\n   * Create the default input element.\n   * @return {Element}\n   */\n\n\n  Typeahead.prototype._createDefaultPlaceholderElement = function _createDefaultPlaceholderElement() {\n    var el = document.createElement('span');\n    el.className = 'spark-input__placeholder';\n    this.el.appendChild(el);\n    return el;\n  };\n\n  /**\n   * Get the maximum number of characters allowed.\n   * @param {Array} format\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCharactersAllowedCount = function _getCharactersAllowedCount(format) {\n\n    var i = 0;\n    var len = format.length;\n    var allowed = 0;\n\n    for (; i < len; i++) {\n      if (format[i] === '\\\\d') {\n        allowed++;\n      }\n    }\n\n    return allowed;\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Typeahead.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onKeydownBound = this._onKeydown.bind(this);\n    this._onKeypressBound = this._onKeypress.bind(this);\n    this._onFocusBound = this._onFocus.bind(this);\n    this._onBlurBound = this._onBlur.bind(this);\n    this._onPlaceholderClickBound = this._onPlaceholderClick.bind(this);\n  };\n\n  /**\n   * Add event listeners to keypress and keydown.\n   */\n\n\n  Typeahead.prototype._addEventListeners = function _addEventListeners() {\n    this.inputEl.addEventListener('keydown', this._onKeydownBound, false);\n    this.inputEl.addEventListener('keypress', this._onKeypressBound, false);\n    this.inputEl.addEventListener('focus', this._onFocusBound, false);\n    this.placeholderEl.addEventListener('click', this._onPlaceholderClickBound, false);\n  };\n\n  /**\n   * Add event listeners to keypress and keydown.\n   */\n\n\n  Typeahead.prototype._removeEventListeners = function _removeEventListeners() {\n\n    this.inputEl.removeEventListener('keydown', this._onKeydownBound);\n    this.inputEl.removeEventListener('keypress', this._onKeypressBound);\n    this.inputEl.removeEventListener('focus', this._onFocusBound);\n    this.placeholderEl.removeEventListener('click', this._onPlaceholderClickBound);\n\n    window.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n  };\n\n  /**\n   * Get the position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._getCaretStart = function _getCaretStart() {\n\n    return this._maintainFocus(function () {\n\n      var caretPosition;\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        caretPosition = sel.text.length;\n      } else if (this.inputEl.selectionStart || this.inputEl.selectionStart === 0) {\n        caretPosition = this.inputEl.selectionStart;\n      }\n\n      return caretPosition;\n    });\n  };\n\n  /**\n   * Get the end position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._getCaretEnd = function _getCaretEnd() {\n\n    return this._maintainFocus(function () {\n\n      var caretPosition;\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        caretPosition = sel.text.length;\n      } else if (this.inputEl.selectionEnd || this.inputEl.selectionEnd === 0) {\n        caretPosition = this.inputEl.selectionEnd;\n      }\n\n      return caretPosition;\n    });\n  };\n\n  /**\n   * Is the caret at the end of the input?\n   * @return {Boolean}\n   */\n\n\n  Typeahead.prototype._caretIsAtEnd = function _caretIsAtEnd() {\n    return this._getCaretStart() === this.maxLength;\n  };\n\n  /**\n   * Set the position of the caret in the element.\n   * @return {Number} The index\n   */\n\n\n  Typeahead.prototype._setCaretPosition = function _setCaretPosition(pos) {\n\n    return this._maintainFocus(function () {\n\n      // IE support\n      if (document.selection) {\n        this.inputEl.focus();\n        var sel = document.selection.createRange();\n        sel.moveStart('character', -this.inputEl.value.length);\n        sel.moveStart('character', pos);\n        sel.moveEnd('character', 0);\n        sel.select();\n      } else if (this.inputEl.selectionStart || this.inputEl.selectionStart === 0) {\n        this.inputEl.selectionStart = pos;\n        this.inputEl.selectionEnd = pos;\n      }\n    });\n  };\n\n  /**\n   * Get the position of the caret translated to the corresponding index in the\n   * characters array. This means ignoring format characters.\n   * @param {Number} pos\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretPositionTranslated = function _getCaretPositionTranslated(pos) {\n\n    var i = 0;\n    var skipCount = 0;\n\n    for (; i < pos; i++) {\n\n      // Count non-numbers as a skip.\n      // @todo: this needs to work with more than numbers.\n      if (this.format[i] !== '\\\\d') {\n        skipCount++;\n      }\n    }\n\n    return pos - skipCount;\n  };\n\n  /**\n   * Get the starting position of the caret translated.\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretStartTranslated = function _getCaretStartTranslated() {\n    return this._getCaretPositionTranslated(this._getCaretStart());\n  };\n\n  /**\n   * Get the ending position of the caret translated.\n   * @return {Number}\n   */\n\n\n  Typeahead.prototype._getCaretEndTranslated = function _getCaretEndTranslated() {\n    return this._getCaretPositionTranslated(this._getCaretEnd());\n  };\n\n  /**\n   * Set the position of the caret translated to the corresponding index in the\n   * characters array. This means ignoring format characters.\n   * @param {Number} pos\n   */\n\n\n  Typeahead.prototype._setCaretPositionTranslated = function _setCaretPositionTranslated(pos) {\n\n    var i = 0;\n    var skipCount = 0;\n\n    for (; i < pos + skipCount; i++) {\n\n      // Count non-numbers as a skip.\n      // @todo: this needs to work with more than numbers.\n      if (this.format[i] !== undefined && this.format[i] !== '\\\\d') {\n        skipCount++;\n      }\n    }\n\n    this._setCaretPosition(pos + skipCount);\n  };\n\n  /**\n   * Move the caret position\n   * @param  {String} direction The direction of the movement\n   * @return {Boolean}           Was the caret actually moved?\n   */\n\n\n  Typeahead.prototype._moveCaret = function _moveCaret(direction) {\n\n    var curPos = this._getCaretStart();\n\n    if (direction === 'left') {\n      this._setCaretPosition(curPos - 1);\n    } else if (direction === 'right') {\n      this._setCaretPosition(curPos + 1);\n    }\n\n    return curPos !== this._getCaretStart();\n  };\n\n  /**\n   * Empty the input when we only have placeholders.\n   */\n\n\n  Typeahead.prototype._emptyWhenOnlyPlaceholders = function _emptyWhenOnlyPlaceholders() {\n    if (!this.characters.length) {\n      this.clear();\n    }\n  };\n\n  /**\n   * Run a callback function that may change the focus of the document, but\n   * make sure focus goes back to where it needs to be. Also, set the state\n   * so that blur/focus events don't fire from this instance.\n   * @param {Function} callback\n   */\n\n\n  Typeahead.prototype._maintainFocus = function _maintainFocus(callback) {\n\n    this.pause();\n\n    var originalActiveElement = document.activeElement;\n\n    //For IE\n    if (!originalActiveElement) {\n      originalActiveElement = document.body;\n    }\n\n    var output = (callback || noop).call(this);\n\n    // If we didn't have focus, go back to focusing on the original\n    if (originalActiveElement !== this.inputEl) {\n      this.inputEl.blur();\n      originalActiveElement ? originalActiveElement.focus() : null;\n    }\n\n    this.resume();\n\n    return output;\n  };\n\n  /**\n   * Update the width of the typeahead. If we should be matching the width\n   * of the placeholder, do so. Otherwise, take no action.\n   */\n\n\n  Typeahead.prototype._updateWidth = function _updateWidth() {\n\n    if (this.matchPlaceholderSize) {\n      this.placeholderEl.style.width = 'auto';\n      // Add 2px to account for caret width in IE...\n      this.inputEl.style.width = 'auto';\n      this.inputEl.style.width = this.placeholderEl.offsetWidth + 2 + 'px';\n      this.placeholderEl.style.width = '';\n    }\n  };\n\n  /**\n   * Listen for delete and arrows.\n   * @param  {Object} e\n   */\n\n\n  Typeahead.prototype._onKeydown = function _onKeydown(e) {\n\n    var code = e.keyCode || e.which;\n\n    if (code === this.pasteCode && (e.metaKey || e.ctrlKey)) {\n      return;\n    }\n\n    if (code === this.actionCodes.BACKSPACE) {\n      this.removeCharacterAtCaret(-1);\n      this._onBackspace();\n      e.preventDefault();\n    } else if (code === this.actionCodes.DELETE) {\n      this.removeCharacterAtCaret(0);\n      e.preventDefault();\n    } else if (code === this.actionCodes.LEFT) {\n      if (!this._getCaretStart()) {\n        (this.onBackspace || noop)();\n      }\n    } else if (code === this.actionCodes.RIGHT) {\n      if (this._getCaretStart() === this.characters.length) {\n        (this.onEnd || noop)();\n      }\n    } else {\n      if (this.ignoreCodes.indexOf(code) === -1) {\n        e.preventDefault();\n\n        // Account for Numpad keys\n        if (code >= 96 && code <= 105) {\n          code -= 48;\n        }\n\n        this.addCharacterAtCaret(String.fromCharCode(code));\n      }\n    }\n  };\n\n  /**\n   * When the keypress event fires, validate.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onKeypress = function _onKeypress(e) {\n    var code = e.keyCode || e.which;\n\n    if (this.ignoreCodes.indexOf(code) === -1) {\n      e.preventDefault();\n      this.characters = this._parseCharacters(this.inputEl.value);\n      this.run();\n      (this.onChange || noop)(this.getValue(), this);\n    }\n  };\n\n  /**\n   * When the input event fires, validate. This happens\n   * with a copy+paste.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onInput = function _onInput(e) {\n    e.preventDefault();\n    this.characters = this._parseCharacters(this.inputEl.value);\n    this.run();\n    (this.onInput || noop)(this.getValue(), this);\n  };\n\n  /**\n   * When we focus, run the formatting.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onFocus = function _onFocus() {\n\n    window.removeEventListener('blur', this._onBlurBound);\n    window.addEventListener('blur', this._onBlurBound, false);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.addEventListener('blur', this._onBlurBound, false);\n\n    if (this.isFocused || this.pauseBlurFocus || this.isRunning) return;\n\n    this.run();\n    (this.onFocus || noop)(this.getValue(), this);\n    this.isFocused = true;\n    this._oldVal = this.inputEl.value;\n  };\n\n  /**\n   * When we blur, if we have no characters, remove the placeholders.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onBlur = function _onBlur() {\n\n    window.removeEventListener('blur', this._onBlurBound);\n    this.inputEl.removeEventListener('blur', this._onBlurBound);\n\n    this.isFocused = false;\n\n    if (this.pauseBlurFocus || this.isRunning) return;\n\n    this._emptyWhenOnlyPlaceholders();\n\n    if (this._oldVal !== this.inputEl.value) {\n      (0, _triggerEvent2.default)(this.inputEl, 'change');\n    }\n\n    (this.onBlur || noop)(this.getValue(), this);\n  };\n\n  /**\n   * When the placeholder receives a click event, focus on the input. This happens in IE10 for some\n   * reason that I cannot fully fathom, but it has something to do with the explicit width being\n   * set on an empty element.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onPlaceholderClick = function _onPlaceholderClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n    this.inputEl.focus();\n  };\n\n  /**\n   * When we backspace, if we have no characters left let listeners know.\n   * @param {Object} e\n   */\n\n\n  Typeahead.prototype._onBackspace = function _onBackspace() {\n    if (!this._getCaretStart()) (this.onBackspace || noop)();\n  };\n\n  return Typeahead;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nTypeahead.prototype._whitelistedParams = ['format', 'placeholder', 'matchPlaceholderSize', 'onChange', 'onFocus', 'onBlur', 'onInput', 'onBackspace', 'onEnd'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nTypeahead.prototype.defaults = {\n  el: null,\n  inputEl: null,\n  placeholderEl: null,\n  placeholder: null,\n  characters: null,\n  format: null,\n  ignoreCodes: [9, // Tab\n  16, // Shift\n  17, // Ctrl\n  18, // Alt\n  20, // CAPS\n  91, // Meta\n  93, // Alt\n  112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123 // F1-F12\n  ],\n  actionCodes: {\n    BACKSPACE: 8,\n    DELETE: 46,\n    LEFT: 37,\n    RIGHT: 39\n  },\n  pasteCode: 86, // v\n  pauseBlurFocus: 0,\n  matchPlaceholderSize: null,\n  maxLength: null,\n  isFocused: false,\n  isRunning: false,\n  onChange: null,\n  onFocus: null,\n  onBlur: null,\n  onInput: null,\n  onBackspace: null,\n  onEnd: null,\n  _atEnd: false,\n  _oldVal: null,\n  _onKeydownBound: null,\n  _onKeypressBound: null,\n  _onFocusBound: null,\n  _onBlurBound: null,\n  _onPlaceholderClickBound: null\n};\n\nexports.default = Typeahead;\nmodule.exports = exports['default'];\n//# sourceMappingURL=typeahead.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Parse DOM attributes\n * Given an element and an attribute name, parse that attribute\n * if it exists or return a default.\n *\n * @module helpers/dom/parse-attribute.js\n */\n\n/**\n * Get the boolean value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction boolean(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return val === 'true' || val === '' ? true : false;\n}\n\n/**\n * Get the numeric value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction number(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return parseInt(val, 10);\n}\n\n/**\n * Get the boolean value of an attribute on an element,\n * falling back to the default value.\n * @param  {Element} el\n * @param  {String} name\n * @param  {Boolean} def\n * @return {Boolean}\n */\nfunction string(el, name, def) {\n  var val = el.getAttribute(name);\n  if (val === null) return def;\n  return val;\n}\n\nexports.boolean = boolean;\nexports.number = number;\nexports.string = string;\n//# sourceMappingURL=parse-attribute.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Trigger Event\n * Trigger a DOM event on an element.\n *\n * @param {Element} el\n * @param {String} name\n *\n * @module helpers/dom/trigger-event.js\n */\nfunction triggerEvent(el, name) {\n\n  var event = void 0;\n\n  if (document.createEvent) {\n    event = document.createEvent('HTMLEvents');\n    event.initEvent(name, true, true);\n    event.eventName = name;\n    el.dispatchEvent(event);\n  } else {\n    event = document.createEventObject();\n    event.eventType = name;\n    event.eventName = name;\n    el.fireEvent('on' + event.eventType, event);\n  }\n}\n\nexports.default = triggerEvent;\nmodule.exports = exports['default'];\n//# sourceMappingURL=trigger-event.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Each\n * Apply a callback function to a list of any kind: Array, NodeList, HTMLCollection or Object.\n *\n * @param {Array|NodeList|HTMLCollection|Object} list\n * @param {Function} cb\n *\n * @example\n * each([], callback);\n * each(el.children, callback);\n * each(el.childNodes, callback);\n * each({}, callback);\n *\n * @module helpers/util/each.js\n */\nfunction each(list, cb) {\n\n  if (!list) {\n    return;\n  }\n\n  if (typeof cb !== 'function') {\n    throw new Error('Cannot invoke `each` without a callback!');\n  }\n\n  var i = 0;\n  var len = list.length;\n\n  // Object\n  if (len === undefined) {\n    for (i in list) {\n      if (i !== 'prototype' && list.hasOwnProperty(i)) {\n        cb(i, list[i]);\n      }\n    }\n  }\n  // Array-like\n  else {\n      for (; i < len; i++) {\n        cb(list[i]);\n      }\n    }\n}\n\nexports.default = each;\nmodule.exports = exports['default'];\n//# sourceMappingURL=each.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvYmFzZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy9kYXRlLXR5cGVhaGVhZC5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy90eXBlYWhlYWQuanMiLCJqcy9kaXN0L2hlbHBlcnMvZG9tL3BhcnNlLWF0dHJpYnV0ZS5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vdHJpZ2dlci1ldmVudC5qcyIsImpzL2Rpc3QvaGVscGVycy91dGlsL2VhY2guanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwWkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc31yZXR1cm4gZX0pKCkiLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfZWFjaCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdXRpbC9lYWNoJyk7XG5cbnZhciBfZWFjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9lYWNoKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH0gLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBCYXNlIENvbXBvbmVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFRoZSBiYXNlIGNsYXNzIGZvciBTcGFyayBKUyBjb21wb25lbnRzLiBUaGlzIGNsYXNzIHNob3VsZCBuZXZlciBiZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGluc3RhbnRpYXRlZCBkaXJlY3RseS5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGNvbXBvbmVudHMvYmFzZS5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxudmFyIEJhc2UgPSBmdW5jdGlvbiAoKSB7XG5cbiAgLyoqXG4gICAqIFNldCBwYXJhbWV0ZXJzIGFuZCBjYWNoZSBlbGVtZW50cy5cbiAgICovXG4gIGZ1bmN0aW9uIEJhc2UoZWwpIHtcbiAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCYXNlKTtcblxuICAgIGlmIChwYXJhbXMuZWxSZXF1aXJlZCAmJiAhZWwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0aGlzLnNldFBhcmFtcyh0aGlzLmRlZmF1bHRzIHx8IHt9LCB0cnVlKTtcbiAgICB0aGlzLnNldFBhcmFtcyhwYXJhbXMpO1xuICAgICh0aGlzLl9jYWNoZUVsZW1lbnRzIHx8IG5vb3ApLmNhbGwodGhpcywgZWwsIHBhcmFtcyk7XG4gICAgKHRoaXMuX3BhcnNlUGFyYW1zIHx8IG5vb3ApLmNhbGwodGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIHRoZSBjb21wb25lbnQgZnJvbSB0aGUgRE9NIGFuZCBwcmVwYXJlIGZvciBnYXJiYWdlIGNvbGxlY3Rpb24gYnkgZGVyZWZlcmVuY2luZyB2YWx1ZXMuXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gbGVhdmVFbGVtZW50IExlYXZlIHRoZSBlbGVtZW50IGludGFjdC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS5yZW1vdmUgPSBmdW5jdGlvbiByZW1vdmUobGVhdmVFbGVtZW50KSB7XG5cbiAgICBpZiAodGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgaWYgKCFsZWF2ZUVsZW1lbnQgJiYgdGhpcy5lbCAmJiB0aGlzLmVsLnBhcmVudE5vZGUpIHtcbiAgICAgIHRoaXMuZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLmVsKTtcbiAgICB9XG5cbiAgICB0aGlzLnVuc2V0UGFyYW1zKHRoaXMuZGVmYXVsdHMpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSB0aGUgY29tcG9uZW50IHRvIHVzZSBhIG5ldyBlbGVtZW50IG9yIHJlcGFyc2UgZnJvbVxuICAgKiB0aGUgZXhpc3RpbmcgZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbCBPcHRpb25hbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIE9wdGlvbmFsXG4gICAqL1xuXG5cbiAgQmFzZS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gdXBkYXRlKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cblxuICAgIGlmICh0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycykge1xuICAgICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9XG5cbiAgICAodGhpcy5fY2FjaGVFbGVtZW50cyB8fCBub29wKS5jYWxsKHRoaXMsIGVsIHx8IHRoaXMuZWwsIHBhcmFtcyk7XG4gICAgKHRoaXMuX3BhcnNlUGFyYW1zIHx8IG5vb3ApLmNhbGwodGhpcyk7XG5cbiAgICBpZiAodGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBhIGhhc2ggb2YgcGFyYW1ldGVycyBpZiB0aGV5J3JlIHdoaXRlbGlzdGVkIG9yIHdlJ3JlIHRvbGQgdG8gZm9yY2UgdGhlIHNldC5cbiAgICogVGhpcyBpcyB1c2VkIHRvIHNldCBpbml0aWFsIHZhbHVlcyBhcyB3ZWxsIGFzIHNldCBwYXNzZWQgcGFyYW1ldGVycy5cbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGZvcmNlIEZvcmNlIHNldHRpbmcgZXZlbiBpZiB0aGUgcGFyYW0gaXMgbm90IHdoaXRlbGlzdGVkLlxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnNldFBhcmFtcyA9IGZ1bmN0aW9uIHNldFBhcmFtcyhwYXJhbXMsIGZvcmNlKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkocGFyYW1zLCBmdW5jdGlvbiAoaywgdikge1xuICAgICAgaWYgKF90aGlzLl93aGl0ZWxpc3RlZFBhcmFtcy5pbmRleE9mKGspICE9PSAtMSB8fCBmb3JjZSkge1xuICAgICAgICBfdGhpc1trXSA9IHY7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogVW5zZXQgYWxsIHBhcmFtZXRlcnMuXG4gICAqIEBwYXJhbSB7QXJyYXl8T2JqZWN0fSBrZXlzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBzY29wZSBUaGUgb2JqZWN0IHRvIHVuc2V0IHRoZSBwYXJhbXMgZnJvbS4gRGVmYXVsdHMgdG8gYHRoaXNgLlxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnVuc2V0UGFyYW1zID0gZnVuY3Rpb24gdW5zZXRQYXJhbXMoa2V5cywgc2NvcGUpIHtcblxuICAgIGtleXMgPSBrZXlzIGluc3RhbmNlb2YgQXJyYXkgPyBrZXlzIDogT2JqZWN0LmtleXMoa2V5cyk7XG4gICAgc2NvcGUgPSBzY29wZSB8fCB0aGlzO1xuICAgICgwLCBfZWFjaDIuZGVmYXVsdCkoa2V5cywgZnVuY3Rpb24gKGspIHtcbiAgICAgIGRlbGV0ZSBzY29wZVtrXTtcbiAgICB9KTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIHJldHVybiBCYXNlO1xufSgpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5CYXNlLnByb3RvdHlwZS5fd2hpdGVsaXN0ZWRQYXJhbXMgPSBbXTtcblxuLyoqXG4gKiBEZWZhdWx0IHZhbHVlcyBmb3IgaW50ZXJuYWwgcHJvcGVydGllcyB3ZSB3aWxsIGJlIHNldHRpbmcuXG4gKiBUaGVzZSBhcmUgc2V0IG9uIGVhY2ggY29uc3RydWN0aW9uIHNvIHdlIGRvbid0IGxlYWsgcHJvcGVydGllc1xuICogaW50byB0aGUgcHJvdG90eXBlIGNoYWluLlxuICogQHR5cGUge09iamVjdH1cbiAqL1xuQmFzZS5wcm90b3R5cGUuZGVmYXVsdHMgPSB7fTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gQmFzZTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YmFzZS5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9iYXNlID0gcmVxdWlyZSgnLi9iYXNlJyk7XG5cbnZhciBfYmFzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9iYXNlKTtcblxudmFyIF90eXBlYWhlYWQgPSByZXF1aXJlKCcuL3R5cGVhaGVhZCcpO1xuXG52YXIgX3R5cGVhaGVhZDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90eXBlYWhlYWQpO1xuXG52YXIgX3BhcnNlQXR0cmlidXRlID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vcGFyc2UtYXR0cmlidXRlJyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAjIERhdGVUeXBlYWhlYWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpc3RlbiB0byBhbiBpbnB1dCBlbGVtZW50IGFuZCBmb3JtYXQgaXQgYXMgdGhlIHVzZXIgdHlwZXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldyBEYXRlVHlwZWFoZWFkKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGNvbXBvbmVudHMvZGF0ZS10eXBlYWhlYWQuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG5cbnZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9O1xuXG5mdW5jdGlvbiBjcmVhdGVEZWZhdWx0RWxlbWVudCgpIHtcbiAgdmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICBlbC5jbGFzc05hbWUgPSAnc3BhcmstaW5wdXQnO1xuICByZXR1cm4gZWw7XG59XG5cbnZhciBEYXRlVHlwZWFoZWFkID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhEYXRlVHlwZWFoZWFkLCBfQmFzZUNvbXBvbmVudCk7XG5cbiAgLyoqXG4gICAqIERhdGVUeXBlYWhlYWQgY29uc3RydWN0b3JcbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbCBPcHRpb25hbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zIE9wdGlvbmFsXG4gICAqL1xuICBmdW5jdGlvbiBEYXRlVHlwZWFoZWFkKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRGF0ZVR5cGVhaGVhZCk7XG5cbiAgICAvLyBJZiBvbmx5IG9uZSBhcmcgcGFzc2VkLCBhc3N1bWUgaXQgd2FzIGEgcGFyYW1ldGVyc1xuICAgIC8vIG9iamVjdCBzaW5jZSB0aGUgdXNlciBNVVNUIHByb3ZpZGUgdGhvc2UgYnV0IHRoZSBlbGVtZW50XG4gICAgLy8gaXMgb3B0aW9uYWwuIERvaW5nIGl0IHRoaXMgd2F5IHRvIGtlZXAgdGhlIGFyaXR5IHRoZSBzYW1lXG4gICAgLy8gYXMgb3RoZXIgY29tcG9uZW50cy5cbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHtcbiAgICAgIHBhcmFtcyA9IGVsIHx8IHt9O1xuICAgICAgZWwgPSBjcmVhdGVEZWZhdWx0RWxlbWVudCgpO1xuICAgIH1cblxuICAgIHZhciBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9CYXNlQ29tcG9uZW50LmNhbGwodGhpcywgZWwsIHBhcmFtcykpO1xuXG4gICAgX3RoaXMuX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzKCk7XG4gICAgX3RoaXMuX2NyZWF0ZVR5cGVhaGVhZChlbCwgcGFyYW1zKTtcbiAgICByZXR1cm4gX3RoaXM7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRoZSB2YWx1ZS5cbiAgICogQHBhcmFtIHtCb29sZWFufSBhc0ludCBHZXQgdGhlIHZhbHVlIGFzIGEgcGFyc2VkIGludGVnZXIuXG4gICAqIEByZXR1cm4ge01peGVkfVxuICAgKi9cblxuXG4gIERhdGVUeXBlYWhlYWQucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24gZ2V0VmFsdWUoYXNJbnQpIHtcbiAgICByZXR1cm4gdGhpcy50eXBlYWhlYWQuZ2V0VmFsdWUoYXNJbnQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHZhbHVlLlxuICAgKiBAcGFyYW0ge01peGVkfSB2YWxcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5zZXRWYWx1ZSA9IGZ1bmN0aW9uIHNldFZhbHVlKHZhbCkge1xuICAgIHJldHVybiB0aGlzLnR5cGVhaGVhZC5zZXRWYWx1ZSh2YWwpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgdmFsdWUuXG4gICAqL1xuXG5cbiAgRGF0ZVR5cGVhaGVhZC5wcm90b3R5cGUuY2xlYXJWYWx1ZSA9IGZ1bmN0aW9uIGNsZWFyVmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZWFoZWFkLmNsZWFyVmFsdWUoKTtcbiAgfTtcblxuICAvKipcbiAgICogRW5hYmxlIHRoZSBpbnB1dC5cbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5lbmFibGUgPSBmdW5jdGlvbiBlbmFibGUoKSB7XG4gICAgcmV0dXJuIHRoaXMudHlwZWFoZWFkLmVuYWJsZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIHRoZSBpbnB1dC5cbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24gZGlzYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpcy50eXBlYWhlYWQuZGlzYWJsZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSdW4gdGhlIHR5cGVhaGVhZCBjYWxjdWxhdGlvbnMuXG4gICAqL1xuXG5cbiAgRGF0ZVR5cGVhaGVhZC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gcnVuKCkge1xuICAgIHJldHVybiB0aGlzLnR5cGVhaGVhZC5ydW4oKTtcbiAgfTtcblxuICAvKipcbiAgICogUGF1c2UgdGhlIHR5cGVhaGVhZCBldmVudHMuXG4gICAqL1xuXG5cbiAgRGF0ZVR5cGVhaGVhZC5wcm90b3R5cGUucGF1c2UgPSBmdW5jdGlvbiBwYXVzZSgpIHtcbiAgICByZXR1cm4gdGhpcy50eXBlYWhlYWQucGF1c2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVzZXVtZSB0eXBlYWhlYWQgZXZlbnRzLlxuICAgKi9cblxuXG4gIERhdGVUeXBlYWhlYWQucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICByZXR1cm4gdGhpcy50eXBlYWhlYWQucmVzdW1lKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEF1Z21lbnQgZGVmYXVsdCByZW1vdmUgY2FsbCB3LyBoZWxwZXIgY2xlYW51cC5cbiAgICogQHBhcmFtIHtCb29sZWFufSBsZWF2ZUVsZW1lbnQgTGVhdmUgdGhlIGVsZW1lbnQgaW50YWN0LlxuICAgKi9cblxuXG4gIERhdGVUeXBlYWhlYWQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIHJlbW92ZShsZWF2ZUVsZW1lbnQpIHtcbiAgICB0aGlzLnR5cGVhaGVhZC5yZW1vdmUobGVhdmVFbGVtZW50KTtcbiAgICBfQmFzZUNvbXBvbmVudC5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcywgbGVhdmVFbGVtZW50KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQ2FjaGUgZWxlbWVudHMuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fY2FjaGVFbGVtZW50cyA9IGZ1bmN0aW9uIF9jYWNoZUVsZW1lbnRzKGVsKSB7XG4gICAgdGhpcy5lbCA9IGVsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSBwYXJhbWV0ZXJzIGZyb20gdGhlIGVsZW1lbnRzLlxuICAgKi9cblxuXG4gIERhdGVUeXBlYWhlYWQucHJvdG90eXBlLl9wYXJzZVBhcmFtcyA9IGZ1bmN0aW9uIF9wYXJzZVBhcmFtcygpIHtcblxuICAgIHRoaXMudHlwZSA9IHRoaXMudHlwZSAhPT0gbnVsbCA/IHRoaXMudHlwZSA6ICgwLCBfcGFyc2VBdHRyaWJ1dGUuc3RyaW5nKSh0aGlzLmVsLCAnZGF0YS10eXBlJywgJ2RheScpO1xuICAgIHRoaXMuZm9ybWF0ID0gdGhpcy5mb3JtYXQgIT09IG51bGwgPyB0aGlzLmZvcm1hdCA6ICgwLCBfcGFyc2VBdHRyaWJ1dGUuc3RyaW5nKSh0aGlzLmVsLCAnZGF0YS1mb3JtYXQnLCBudWxsKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyID0gdGhpcy5wbGFjZWhvbGRlciAhPT0gbnVsbCA/IHRoaXMucGxhY2Vob2xkZXIgOiAoMCwgX3BhcnNlQXR0cmlidXRlLnN0cmluZykodGhpcy5lbCwgJ2RhdGEtcGxhY2Vob2xkZXInLCBudWxsKTtcbiAgICB0aGlzLmxlbiA9IHRoaXMubGVuICE9PSBudWxsID8gdGhpcy5sZW4gOiAoMCwgX3BhcnNlQXR0cmlidXRlLm51bWJlcikodGhpcy5lbCwgJ2xlbmd0aCcsIG51bGwpO1xuICAgIHRoaXMuYXJpYUxhYmVsUHJlZml4ID0gdGhpcy5hcmlhTGFiZWxQcmVmaXggIT09IG51bGwgPyB0aGlzLmFyaWFMYWJlbFByZWZpeCA6IG51bGw7XG5cbiAgICBpZiAoIXRoaXMucGxhY2Vob2xkZXIpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3QgcHJvdmlkZSBhIHBsYWNlaG9sZGVyIHZhbHVlIGZvciBhIERhdGVUeXBlYWhlYWQuJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubGVuICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmZvcm1hdCA9IHRoaXMuX2xlbmd0aFRvRm9ybWF0KHRoaXMubGVuKTtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuZm9ybWF0KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ1lvdSBtdXN0IHByb3ZpZGUgYSBmb3JtYXQgdmFsdWUgZm9yIGEgRGF0ZVR5cGVhaGVhZC4nKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBhIHR5cGVhaGVhZCB3aXRoIHRoZSBnaXZlbiBmb3JtYXQuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlbFxuICAgKi9cblxuXG4gIERhdGVUeXBlYWhlYWQucHJvdG90eXBlLl9jcmVhdGVUeXBlYWhlYWQgPSBmdW5jdGlvbiBfY3JlYXRlVHlwZWFoZWFkKGVsKSB7XG5cbiAgICB0aGlzLnR5cGVhaGVhZCA9IG5ldyBfdHlwZWFoZWFkMi5kZWZhdWx0KGVsLCB7XG4gICAgICBwbGFjZWhvbGRlcjogdGhpcy5wbGFjZWhvbGRlcixcbiAgICAgIGZvcm1hdDogdGhpcy5mb3JtYXQsXG4gICAgICBtYXRjaFBsYWNlaG9sZGVyU2l6ZTogdHJ1ZSxcbiAgICAgIG9uQ2hhbmdlOiB0aGlzLl9vblR5cGVhaGVhZENoYW5nZUJvdW5kLFxuICAgICAgb25JbnB1dDogdGhpcy5fb25UeXBlYWhlYWRJbnB1dEJvdW5kLFxuICAgICAgb25Gb2N1czogdGhpcy5fb25UeXBlYWhlYWRGb2N1c0JvdW5kLFxuICAgICAgb25CbHVyOiB0aGlzLl9vblR5cGVhaGVhZEJsdXJCb3VuZCxcbiAgICAgIG9uQmFja3NwYWNlOiB0aGlzLl9vblR5cGVhaGVhZEJhY2tzcGFjZUJvdW5kLFxuICAgICAgb25FbmQ6IHRoaXMuX29uVHlwZWFoZWFkRW5kQm91bmRcbiAgICB9KTtcblxuICAgIC8vIEVuc3VyZSB3ZSBoYXZlIGFuIEFSSUEgbGFiZWxcbiAgICB2YXIgaW5wdXQgPSBlbC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuICAgIGlmIChpbnB1dCAmJiAhaW5wdXQuZ2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJykpIHtcbiAgICAgIGlucHV0LnNldEF0dHJpYnV0ZSgnYXJpYS1sYWJlbCcsIHRoaXMuYXJpYUxhYmVsUHJlZml4ICsgJyAnICsgdGhpcy50eXBlKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MgPSBmdW5jdGlvbiBfYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKSB7XG4gICAgdGhpcy5fb25UeXBlYWhlYWRDaGFuZ2VCb3VuZCA9IHRoaXMuX29uVHlwZWFoZWFkQ2hhbmdlLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25UeXBlYWhlYWRJbnB1dEJvdW5kID0gdGhpcy5fb25UeXBlYWhlYWRJbnB1dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uVHlwZWFoZWFkRm9jdXNCb3VuZCA9IHRoaXMuX29uVHlwZWFoZWFkRm9jdXMuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vblR5cGVhaGVhZEJsdXJCb3VuZCA9IHRoaXMuX29uVHlwZWFoZWFkQmx1ci5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uVHlwZWFoZWFkQmFja3NwYWNlQm91bmQgPSB0aGlzLl9vblR5cGVhaGVhZEJhY2tzcGFjZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uVHlwZWFoZWFkRW5kQm91bmQgPSB0aGlzLl9vblR5cGVhaGVhZEVuZC5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUYWtlIGEgbGVuZ3RoIGFuZCByZXR1cm4gYSBmb3JtYXQgc3RyaW5nIHdpdGggdGhhdCBtYW55IGRpZ2l0cy5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aFxuICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAqL1xuXG5cbiAgRGF0ZVR5cGVhaGVhZC5wcm90b3R5cGUuX2xlbmd0aFRvRm9ybWF0ID0gZnVuY3Rpb24gX2xlbmd0aFRvRm9ybWF0KGxlbmd0aCkge1xuXG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciByZXQgPSAnJztcblxuICAgIGZvciAoOyBpIDwgbGVuZ3RoOyBpKyspIHtcbiAgICAgIHJldCArPSAnXFxcXGQnO1xuICAgIH1cblxuICAgIHJldHVybiByZXQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIENoZWNrIHRvIHNlZSBpZiBhbiBpbnB1dCB2YWx1ZSBpcyB2YWxpZC5cbiAgICogQHBhcmFtIHtNaXhlZH0gdmFsXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gYWxsb3dFbXB0eSBBbGwgdGhlIHZhbHVlIHRvIGJlIGVtcHR5IGluc3RlYWQgb2YgMC5cbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fY2hlY2tWYWxpZGl0eSA9IGZ1bmN0aW9uIF9jaGVja1ZhbGlkaXR5KHZhbCwgYWxsb3dFbXB0eSkge1xuXG4gICAgdmFsID0gcGFyc2VJbnQodmFsLCAxMCk7XG5cbiAgICB2YXIgb3JpZ1ZhbCA9IHZhbDtcbiAgICB2YXIgaXNOdW1iZXIgPSAhaXNOYU4odmFsKTtcblxuICAgIC8vIElmIHdlIHdlcmUgcGFzc2VkIGFuIGVtcHR5IHN0cmluZyBvciBzb21ldGhpbmcsIGRvbid0IHRyeSB0byB2YWxpZGF0ZS5cbiAgICAvLyBUcmVhdCB6ZXJvcyBhcyBhIG5vbi1lbnRyeSBmb3IgZGF5cyBhbmQgbW9udGhzLlxuICAgIGlmIChpc051bWJlcikge1xuXG4gICAgICBpZiAodGhpcy50eXBlID09PSAneWVhcicpIHtcbiAgICAgICAgdmFsID0gdmFsID09PSAwID8gYWxsb3dFbXB0eSA/ICcnIDogMCA6IE1hdGgubWF4KHZhbCwgMCk7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMudHlwZSA9PT0gJ21vbnRoJykge1xuICAgICAgICB2YWwgPSB2YWwgPyBNYXRoLm1pbihNYXRoLm1heCh2YWwsIDEpLCAxMikgOiBhbGxvd0VtcHR5ID8gJycgOiAwO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsID0gdmFsID8gTWF0aC5taW4oTWF0aC5tYXgodmFsLCAxKSwgMzEpIDogYWxsb3dFbXB0eSA/ICcnIDogMDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBOZWVkIHRvIG1ha2Ugc3VyZSB3ZSBhcmVuJ3QgbG9vcGluZyBmb3JldmVyIG9uIHRoZXNlIHVwZGF0ZXMuXG4gICAgaWYgKGlzTnVtYmVyICYmIHZhbCAhPT0gb3JpZ1ZhbCkge1xuICAgICAgdGhpcy50eXBlYWhlYWQuc2V0VmFsdWUodmFsICsgJycpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHRoZSB0eXBlYWhlYWQgY2hhbmdlcywgbWFrZSBzdXJlIHRoZSB2YWx1ZSBpcyB2YWxpZC4gVGhpc1xuICAgKiBpcyB2ZXJ5IGJhc2ljIHZhbGlkYXRpb24uIE1vcmUgY29tcGxleCB2YWxpZGF0aW9uIGxpa2UgdGhlIG51bWJlclxuICAgKiBvZiBkYXlzIGluIGEgc3BlY2lmaWMgbW9udGggc2hvdWxkIGJlIGhhbmRsZWQgYnkgdGhlIGNhbGxiYWNrLlxuICAgKiBBbmQgcnVuIG91ciBjYWxsYmFjay5cbiAgICogQHBhcmFtIHtTdHJpbmd9IHZhbCBUaGUgdmFsdWUgb2YgdGhlIGlucHV0XG4gICAqIEBwYXJhbSB7U3RyaW5nfSBvbGRWYWwgVGhlIHByZXZpb3VzIHZhbHVlXG4gICAqL1xuXG5cbiAgRGF0ZVR5cGVhaGVhZC5wcm90b3R5cGUuX29uVHlwZWFoZWFkQ2hhbmdlID0gZnVuY3Rpb24gX29uVHlwZWFoZWFkQ2hhbmdlKHZhbCkge1xuICAgIGlmICh0aGlzLl9jaGVja1ZhbGlkaXR5KHZhbCkpIHtcbiAgICAgICh0aGlzLm9uQ2hhbmdlIHx8IG5vb3ApKHZhbCwgdGhpcyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgYGlucHV0YCBldmVudFxuICAgKiBAcGFyYW0ge1N0cmluZ30gdmFsIFRoZSB2YWx1ZSBvZiB0aGUgaW5wdXRcbiAgICogQHBhcmFtIHtTdHJpbmd9IG9sZFZhbCBUaGUgcHJldmlvdXMgdmFsdWVcbiAgICpcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fb25UeXBlYWhlYWRJbnB1dCA9IGZ1bmN0aW9uIF9vblR5cGVhaGVhZElucHV0KHZhbCkge1xuICAgICh0aGlzLm9uSW5wdXQgfHwgbm9vcCkodmFsLCB0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgdHlwZWFoZWFkIGdhaW5zIGZvY3VzLCBsZXQgYW55b25lIHdobyBpcyBpbnRlcmVzdGVkIGtub3cuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fb25UeXBlYWhlYWRGb2N1cyA9IGZ1bmN0aW9uIF9vblR5cGVhaGVhZEZvY3VzKHZhbCkge1xuICAgICh0aGlzLm9uRm9jdXMgfHwgbm9vcCkodmFsLCB0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgdHlwZWFoZWFkIGxvc2VzIGZvY3VzLCBsZXQgYW55b25lIHdobyBpcyBpbnRlcmVzdGVkIGtub3cuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fb25UeXBlYWhlYWRCbHVyID0gZnVuY3Rpb24gX29uVHlwZWFoZWFkQmx1cih2YWwpIHtcbiAgICB0aGlzLl9jaGVja1ZhbGlkaXR5KHZhbCwgdHJ1ZSk7XG4gICAgKHRoaXMub25CbHVyIHx8IG5vb3ApKHZhbCwgdGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHR5cGVhaGVhZCBmaXJlcyBhIGJhY2tzcGFjZSBldmVudCBiZWNhdXNlIGl0J3MgZW1wdHkgYW5kXG4gICAqIHRoZSB1c2VyIGlzIGhpdHRpbmcgYmFja3NwYWNlLCBsZXQgYW55b25lIHdobyBpcyBpbnRlcmVzdGVkIGtub3cuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWxcbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fb25UeXBlYWhlYWRCYWNrc3BhY2UgPSBmdW5jdGlvbiBfb25UeXBlYWhlYWRCYWNrc3BhY2UodmFsKSB7XG4gICAgKHRoaXMub25CYWNrc3BhY2UgfHwgbm9vcCkodmFsLCB0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgdHlwZWFoZWFkIGlzIGZ1bGwgYW5kIGF0IGl0cyBlbmQsIGxldCBhbnlvbmUgd2hvIGlzIGludGVyZXN0ZWQga25vdy5cbiAgICogQHBhcmFtIHtPYmplY3R9IHR5cGVhaGVhZFxuICAgKiBAcGFyYW0ge1N0cmluZ30gY2hhcmFjdGVyIE9wdGlvbmFsIFRoZSBjaGFyYWN0ZXIgdG8gcGFzcyB0byB0aGUgbmV4dCBpbnB1dC5cbiAgICovXG5cblxuICBEYXRlVHlwZWFoZWFkLnByb3RvdHlwZS5fb25UeXBlYWhlYWRFbmQgPSBmdW5jdGlvbiBfb25UeXBlYWhlYWRFbmQodHlwZWFoZWFkLCBjaGFyYWN0ZXIpIHtcbiAgICAodGhpcy5vbkVuZCB8fCBub29wKSh0aGlzLCBjaGFyYWN0ZXIpO1xuICB9O1xuXG4gIHJldHVybiBEYXRlVHlwZWFoZWFkO1xufShfYmFzZTIuZGVmYXVsdCk7XG5cbi8qKlxuICogV2hpdGVsaXN0ZWQgcGFyYW1ldGVycyB3aGljaCBjYW4gYmUgc2V0IG9uIGNvbnN0cnVjdGlvbi5cbiAqIEB0eXBlIHtBcnJheX1cbiAqL1xuXG5cbkRhdGVUeXBlYWhlYWQucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsndHlwZScsICdmb3JtYXQnLCAnYXJpYUxhYmVsUHJlZml4JywgJ3BsYWNlaG9sZGVyJywgJ2xlbicsICdvbkNoYW5nZScsICdvbklucHV0JywgJ29uRm9jdXMnLCAnb25CbHVyJywgJ29uQmFja3NwYWNlJywgJ29uRW5kJ107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkRhdGVUeXBlYWhlYWQucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbCxcbiAgdHlwZTogbnVsbCxcbiAgYXJpYUxhYmVsUHJlZml4OiBudWxsLFxuICB0eXBlYWhlYWQ6IG51bGwsXG4gIGZvcm1hdDogbnVsbCxcbiAgcGxhY2Vob2xkZXI6IG51bGwsXG4gIGxlbjogbnVsbCxcbiAgb25DaGFuZ2U6IG51bGwsXG4gIG9uSW5wdXQ6IG51bGwsXG4gIG9uRm9jdXM6IG51bGwsXG4gIG9uQmx1cjogbnVsbCxcbiAgb25CYWNrc3BhY2U6IG51bGwsXG4gIG9uRW5kOiBudWxsLFxuICBfb25UeXBlYWhlYWRDaGFuZ2VCb3VuZDogbnVsbCxcbiAgX29uVHlwZWFoZWFkSW5wdXRCb3VuZDogbnVsbCxcbiAgX29uVHlwZWFoZWFkRm9jdXNCb3VuZDogbnVsbCxcbiAgX29uVHlwZWFoZWFkQmx1ckJvdW5kOiBudWxsLFxuICBfb25UeXBlYWhlYWRCYWNrc3BhY2VCb3VuZDogbnVsbCxcbiAgX29uVHlwZWFoZWFkRW5kQm91bmQ6IG51bGxcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IERhdGVUeXBlYWhlYWQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGUtdHlwZWFoZWFkLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2Jhc2UgPSByZXF1aXJlKCcuL2Jhc2UnKTtcblxudmFyIF9iYXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jhc2UpO1xuXG52YXIgX3RyaWdnZXJFdmVudCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL3RyaWdnZXItZXZlbnQnKTtcblxudmFyIF90cmlnZ2VyRXZlbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdHJpZ2dlckV2ZW50KTtcblxudmFyIF9wYXJzZUF0dHJpYnV0ZSA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL3BhcnNlLWF0dHJpYnV0ZScpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBUeXBlYWhlYWRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIExpc3RlbiB0byBhbiBpbnB1dCBlbGVtZW50IGFuZCBmb3JtYXQgaXQgYXMgdGhlIHVzZXIgdHlwZXMuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldyBUeXBlYWhlYWQoZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBtb2R1bGUgY29tcG9uZW50cy90eXBlYWhlYWQuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxudmFyIFR5cGVhaGVhZCA9IGZ1bmN0aW9uIChfQmFzZUNvbXBvbmVudCkge1xuICBfaW5oZXJpdHMoVHlwZWFoZWFkLCBfQmFzZUNvbXBvbmVudCk7XG5cbiAgLyoqXG4gICAqIFR5cGVhaGVhZCBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAgICovXG4gIGZ1bmN0aW9uIFR5cGVhaGVhZChlbCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFR5cGVhaGVhZCk7XG5cbiAgICBwYXJhbXMuZWxSZXF1aXJlZCA9IHRydWU7XG5cbiAgICBpZiAoIShfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9CYXNlQ29tcG9uZW50LmNhbGwodGhpcywgZWwsIHBhcmFtcykpLCBfdGhpcykpIHtcbiAgICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihfdGhpcyk7XG4gICAgfVxuXG4gICAgX3RoaXMuX21haW50YWluRm9jdXMoZnVuY3Rpb24gKCkge1xuICAgICAgdGhpcy5fcGFyc2VQYXJhbXMoKTtcbiAgICAgIHRoaXMuX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzKCk7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH0pO1xuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihfdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogUnVuIHRoZSBmb3JtYXR0aW5nLlxuICAgKiBAcGFyYW0ge051bWJlcn0gY3Vyc29ySW5kZXhcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uIHJ1bihjdXJzb3JJbmRleCkge1xuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG5cbiAgICBpZiAodGhpcy5pc1J1bm5pbmcpIHJldHVybiB0aGlzO1xuXG4gICAgdGhpcy5pc1J1bm5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIG9sZFZhbCA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICB2YXIgdmFsID0gJyc7XG4gICAgdmFyIHBsYWNlaG9sZGVyID0gJyc7XG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBsZW4gPSB0aGlzLmZvcm1hdC5sZW5ndGg7XG4gICAgdmFyIHNraXBDb3VudCA9IDA7XG4gICAgdmFyIHZhbERvbmUgPSBmYWxzZTtcblxuICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcblxuICAgICAgLy8gQWRkIG51bWJlcnNcbiAgICAgIGlmICh0aGlzLmZvcm1hdFtpXSA9PT0gJ1xcXFxkJykge1xuXG4gICAgICAgIGlmICh0aGlzLmNoYXJhY3RlcnNbaSAtIHNraXBDb3VudF0pIHtcbiAgICAgICAgICB2YWwgKz0gdGhpcy5jaGFyYWN0ZXJzW2kgLSBza2lwQ291bnRdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHZhbERvbmUgPSB0cnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgcGxhY2Vob2xkZXIgKz0gdmFsRG9uZSA/IHRoaXMucGxhY2Vob2xkZXJbaV0gOiAnJm5ic3A7JztcbiAgICAgIH1cbiAgICAgIC8vIFBsYWNlaG9sZGVyIGNoYXJhY3RlcnNcbiAgICAgIGVsc2Uge1xuXG4gICAgICAgICAgaWYgKCF2YWxEb25lKSB7XG4gICAgICAgICAgICB2YWwgKz0gdGhpcy5mb3JtYXRbaV07XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcGxhY2Vob2xkZXIgKz0gdGhpcy5mb3JtYXRbaV07XG5cbiAgICAgICAgICBza2lwQ291bnQrKztcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICh0aGlzLmlzRm9jdXNlZCkge1xuICAgICAgY3Vyc29ySW5kZXggPSBjdXJzb3JJbmRleCA9PT0gdW5kZWZpbmVkID8gdGhpcy5fZ2V0Q2FyZXRFbmQoKSA6IGN1cnNvckluZGV4O1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlIGFyZSBubyBjaGFyYWN0ZXJzLCBzZXQgdGhlIGN1cnNvckluZGV4IHRvIGJlIHRoZSBsYXN0IHBsYWNlaG9sZGVyIGVudHJ5LlxuICAgIGlmICh0aGlzLmlzRm9jdXNlZCAmJiAhdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCkge1xuICAgICAgY3Vyc29ySW5kZXggPSB2YWwubGVuZ3RoO1xuICAgIH1cblxuICAgIC8vIE5vIGNoYXJhY3RlcnMgYW5kIHdlIHNob3VsZG4ndCB1c2UganVzdCBwbGFjZWhvbGRlciB2YWx1ZXNcbiAgICBpZiAoIXRoaXMuY2hhcmFjdGVycy5sZW5ndGggJiYgcGFyYW1zLm5vdE9ubHlQbGFjZWhvbGRlcnMpIHtcbiAgICAgIHZhbCA9ICcnO1xuICAgIH1cblxuICAgIHRoaXMuaW5wdXRFbC52YWx1ZSA9IHZhbDtcbiAgICB0aGlzLnBsYWNlaG9sZGVyRWwuaW5uZXJIVE1MID0gcGxhY2Vob2xkZXI7XG5cbiAgICB0aGlzLl91cGRhdGVXaWR0aCgpO1xuXG4gICAgaWYgKHRoaXMuaXNGb2N1c2VkKSB7XG4gICAgICB0aGlzLl9zZXRDYXJldFBvc2l0aW9uVHJhbnNsYXRlZChjdXJzb3JJbmRleCk7XG4gICAgfVxuXG4gICAgaWYgKHZhbCAhPT0gb2xkVmFsKSB7XG4gICAgICAoMCwgX3RyaWdnZXJFdmVudDIuZGVmYXVsdCkodGhpcy5pbnB1dEVsLCAnaW5wdXQnKTtcbiAgICB9XG5cbiAgICB0aGlzLmlzUnVubmluZyA9IGZhbHNlO1xuXG4gICAgaWYgKHZhbCAhPT0gb2xkVmFsKSB7XG4gICAgICAodGhpcy5vbkNoYW5nZSB8fCBub29wKSh2YWwsIG9sZFZhbCwgdGhpcyk7XG4gICAgfVxuXG4gICAgaWYgKCF0aGlzLl9hdEVuZCAmJiB0aGlzLmlzRm9jdXNlZCAmJiB0aGlzLmNoYXJhY3RlcnMubGVuZ3RoID09PSB0aGlzLm1heExlbmd0aCAmJiB0aGlzLl9jYXJldElzQXRFbmQoKSkge1xuICAgICAgdGhpcy5fYXRFbmQgPSB0cnVlO1xuICAgICAgKHRoaXMub25FbmQgfHwgbm9vcCkodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2F0RW5kID0gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEFkZCBhIGNoYXJhY3RlciB0byB0aGUgY2hhcmFjdGVycyBhcnJheSBhdCBhIGdpdmVuIGluZGV4LlxuICAgKiBAcGFyYW0ge1N0cmluZ30gY2hhcmFjdGVyXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydFxuICAgKiBAcGFyYW0ge051bWJlcn0gZW5kXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gc2tpcENoZWNrXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5hZGRDaGFyYWN0ZXJBdEluZGV4ID0gZnVuY3Rpb24gYWRkQ2hhcmFjdGVyQXRJbmRleChjaGFyYWN0ZXIsIHN0YXJ0LCBlbmQsIHNraXBDaGVjaykge1xuXG4gICAgLy8gRG9uJ3QgYWRkIGF0IGFuIGluZGV4IGJleW9uZCB3aGF0IHdlIGNhbiBzdXBwb3J0LlxuICAgIGlmICh0aGlzLm1heExlbmd0aCAmJiBzdGFydCA+PSB0aGlzLm1heExlbmd0aCkge1xuICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG4gICAgaWYgKCFza2lwQ2hlY2spIHtcblxuICAgICAgdmFyIHJlO1xuXG4gICAgICAvLyBUcnkgdG8gYnVpbGQgYSByZWdleCBmb3IgdGhpcyBmb3JtYXQgY2hhcmFjdGVyLlxuICAgICAgdHJ5IHtcbiAgICAgICAgcmUgPSBuZXcgUmVnRXhwKHRoaXMuZm9ybWF0W3N0YXJ0XSk7XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIC8vXG4gICAgICB9XG5cbiAgICAgIGlmICghcmUgfHwgIXJlLmV4ZWMoY2hhcmFjdGVyKSkge1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLmNoYXJhY3RlcnMuc3BsaWNlKHN0YXJ0LCBlbmQgLSBzdGFydCwgY2hhcmFjdGVyKTtcblxuICAgIC8vIElmIHdlJ3ZlIGFkZGVkIGF0IGFuIGluZGV4IHRoYXQgcHVzaGVzIHRoZSBsZW5ndGggYmV5b25kIHdoYXQgd2Ugc3VwcG9ydCxcbiAgICAvLyByZW1vdmUgdGhlIHRyYWlsaW5nIGNoYXJhY3RlcnMuXG4gICAgaWYgKHRoaXMubWF4TGVuZ3RoICYmIHRoaXMuY2hhcmFjdGVycy5sZW5ndGggPiB0aGlzLm1heExlbmd0aCkge1xuICAgICAgdGhpcy5jaGFyYWN0ZXJzLnNwbGljZSh0aGlzLm1heExlbmd0aCwgdGhpcy5jaGFyYWN0ZXJzLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgdGhpcy5ydW4oc3RhcnQgKyAxKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgYSBjaGFyYWN0ZXIgYXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjYXJldC5cbiAgICogQHBhcmFtIHtTdHJpbmd9IGNoYXJhY3RlclxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuYWRkQ2hhcmFjdGVyQXRDYXJldCA9IGZ1bmN0aW9uIGFkZENoYXJhY3RlckF0Q2FyZXQoY2hhcmFjdGVyKSB7XG5cbiAgICB2YXIgcG9zID0gdGhpcy5fZ2V0Q2FyZXRTdGFydCgpO1xuICAgIHZhciByZTtcblxuICAgIC8vIElmIHdlJ3JlIGJleW9uZCB0aGUgYm91bmRzIG9mIHRoZSBmb3JtYXQsIHN0b3AuXG4gICAgaWYgKHRoaXMuZm9ybWF0W3Bvc10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgKHRoaXMub25FbmQgfHwgbm9vcCkodGhpcywgY2hhcmFjdGVyKTtcbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIC8vIFRyeSB0byBidWlsZCBhIHJlZ2V4IGZvciB0aGlzIGZvcm1hdCBjaGFyYWN0ZXIuXG4gICAgdHJ5IHtcbiAgICAgIHJlID0gbmV3IFJlZ0V4cCh0aGlzLmZvcm1hdFtwb3NdKTtcbiAgICB9IGNhdGNoIChlKSB7fVxuICAgIC8vXG5cblxuICAgIC8vIFdlIGNvdWxkbid0IGJ1aWxkIGEgcmVnZXggKHNvIGl0J3MgaW52YWxpZCkgb3IgdGhlIHJlZ2V4IGZhaWxlZCAoc28gaXQncyBpbnZhbGlkKVxuICAgIGlmICghcmUgfHwgIXJlLmV4ZWMoY2hhcmFjdGVyKSkge1xuICAgICAgaWYgKHRoaXMuX21vdmVDYXJldCgncmlnaHQnKSkge1xuICAgICAgICB0aGlzLmFkZENoYXJhY3RlckF0Q2FyZXQoY2hhcmFjdGVyKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cblxuICAgIHRoaXMuYWRkQ2hhcmFjdGVyQXRJbmRleChjaGFyYWN0ZXIsIHRoaXMuX2dldENhcmV0U3RhcnRUcmFuc2xhdGVkKCksIHRoaXMuX2dldENhcmV0RW5kVHJhbnNsYXRlZCgpLCB0cnVlKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgYSBjaGFyYWN0ZXIgZnJvbSB0aGUgY2hhcmFjdGVyIGFycmF5IGJ5IGluZGV4LlxuICAgKiBAcGFyYW0ge051bWJlcn0gaW5kZXhcbiAgICogQHBhcmFtIHtOdW1iZXJ9IGxlbmd0aCBPcHRpb25hbFxuICAgKiBAcGFyYW0ge051bWJlcn0gb2Zmc2V0IE9wdGlvbmFsXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5yZW1vdmVDaGFyYWN0ZXJBdEluZGV4ID0gZnVuY3Rpb24gcmVtb3ZlQ2hhcmFjdGVyQXRJbmRleChpbmRleCwgbGVuZ3RoLCBvZmZzZXQpIHtcblxuICAgIC8vIERvbid0IHdhbnQgYSBuZWdhdGl2ZSBzcGxpY2UgbGVuZ3RoIG9yIGVsc2Ugd2Ugc3RhcnRcbiAgICAvLyByZW1vdmluZyBjaGFyYWN0ZXJzIGZyb20gdGhlIGVuZC5cbiAgICBpZiAoaW5kZXggKyBvZmZzZXQgPCAwKSB7XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbiAgICBsZW5ndGggPSBsZW5ndGggIT09IHVuZGVmaW5lZCA/IGxlbmd0aCA6IDE7XG4gICAgdGhpcy5jaGFyYWN0ZXJzLnNwbGljZShpbmRleCArIG9mZnNldCwgbGVuZ3RoKTtcbiAgICB0aGlzLnJ1bihpbmRleCArIChvZmZzZXQgfHwgMSkpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY2hhcmFjdGVyIGF0IHRoZSBjYXJldC5cbiAgICogQHBhcmFtIHtOdW1iZXJ9IG9mZnNldCBPcHRpb25hbCBBbiBvZmZzZXQgZnJvbSB0aGUgY3VycmVudCBwb3NpdGlvbi5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnJlbW92ZUNoYXJhY3RlckF0Q2FyZXQgPSBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXJBdENhcmV0KG9mZnNldCkge1xuXG4gICAgdmFyIHN0YXJ0ID0gdGhpcy5fZ2V0Q2FyZXRTdGFydFRyYW5zbGF0ZWQoKTtcbiAgICB2YXIgZW5kID0gdGhpcy5fZ2V0Q2FyZXRFbmRUcmFuc2xhdGVkKCk7XG4gICAgdmFyIGxlbmd0aCA9IDE7XG4gICAgdmFyIHRtcDtcblxuICAgIGlmIChzdGFydCAhPT0gZW5kKSB7XG5cbiAgICAgIC8vIElmIHRoZSBlbmQgaXMgbGVzcyB0aGFuIHRoZSBzdGFydCwgdGhlIHVzZXIgZHJhZ2dlZCBmcm9tIHJpZ2h0IHRvIGxlZnQuXG4gICAgICAvLyBKdXN0IHN3YXAgdGhlbSB0byBtYWtlIGl0IGVhc2llciB0byBoYW5kbGUuXG4gICAgICBpZiAoZW5kIDwgc3RhcnQpIHtcbiAgICAgICAgdG1wID0gc3RhcnQ7XG4gICAgICAgIHN0YXJ0ID0gZW5kO1xuICAgICAgICBlbmQgPSB0bXA7XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBsZW5ndGggb2YgY2hhcmFjdGVycyByZW1vdmVkXG4gICAgICBsZW5ndGggPSBlbmQgLSBzdGFydDtcblxuICAgICAgLy8gQnVtcCB0aGUgc3RhcnQgcG9zaXRpb24gQHRvZG86IGhhdmVuJ3QgdGhvdWdodCB0aHJvdWdoIHdoeSB0aGlzIGlzLCBidXQgaXQncyBuZWVkZWQuXG4gICAgICBzdGFydCsrO1xuICAgIH1cblxuICAgIHRoaXMucmVtb3ZlQ2hhcmFjdGVyQXRJbmRleChzdGFydCwgbGVuZ3RoLCBvZmZzZXQpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY2hhcmFjdGVyIGluIHRoZSBjdXJyZW50IHJhbmdlLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUucmVtb3ZlQ2hhcmFjdGVyc0luUmFuZ2UgPSBmdW5jdGlvbiByZW1vdmVDaGFyYWN0ZXJzSW5SYW5nZSgpIHtcbiAgICB0aGlzLnJlbW92ZUNoYXJhY3RlckF0SW5kZXgodGhpcy5fZ2V0Q2FyZXRTdGFydFRyYW5zbGF0ZWQoKSwgdGhpcy5fZ2V0Q2FyZXRFbmRUcmFuc2xhdGVkKCkpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHZhbHVlIG9mIHRoZSB0eXBlYWhlYWQuIE1haW50YWluIHRoZSBwb3NpdGlvbiBvZiB0aGUgY2FyZXQuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSB2YWx1ZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuc2V0VmFsdWUgPSBmdW5jdGlvbiBzZXRWYWx1ZSh2YWx1ZSkge1xuXG4gICAgdGhpcy5zZXR0aW5nVmFsdWUgPSB0cnVlO1xuICAgIHRoaXMucGF1c2UoKTtcblxuICAgIHRoaXMuY2hhcmFjdGVycyA9ICh2YWx1ZSArICcnKS5zcGxpdCgnJyk7XG4gICAgdGhpcy5ydW4oKTtcblxuICAgIGlmICh0aGlzLmlzRm9jdXNlZCkgdGhpcy5fc2V0Q2FyZXRQb3NpdGlvbih0aGlzLl9nZXRDYXJldFN0YXJ0KCkpO1xuXG4gICAgdGhpcy5yZXN1bWUoKTtcbiAgICB0aGlzLnNldHRpbmdWYWx1ZSA9IGZhbHNlO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgdmFsdWUgb2YgdGhlIHR5cGVhaGVhZC5cbiAgICogQHBhcmFtIHtCb29sZWFufSBhc0ludCBHZXQgdGhlIHZhbHVlIGFzIGEgcGFyc2VkIGludGVnZXIuXG4gICAqIEByZXR1cm4ge1N0cmluZ3xOdW1iZXJ9XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uIGdldFZhbHVlKGFzSW50KSB7XG4gICAgcmV0dXJuIGFzSW50ICYmIHRoaXMuaW5wdXRFbC52YWx1ZSA/IHBhcnNlSW50KHRoaXMuaW5wdXRFbC52YWx1ZSwgMTApIDogdGhpcy5pbnB1dEVsLnZhbHVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgc2VsZWN0ZWQgdmFsdWUuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5jbGVhclZhbHVlID0gZnVuY3Rpb24gY2xlYXJWYWx1ZSgpIHtcbiAgICB0aGlzLnBhdXNlKCk7XG4gICAgdGhpcy5jaGFyYWN0ZXJzID0gW107XG4gICAgdGhpcy5ydW4oMCwgeyBub3RPbmx5UGxhY2Vob2xkZXJzOiB0cnVlIH0pO1xuICAgIHJldHVybiB0aGlzLnJlc3VtZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBUYWtlIHRoZSBkYXRlIHZhbHVlcyBmcm9tIHRoZSBpbnB1dHMgYW5kIHNldCB0aGVtIGFzIGRhdGVzIG9uIHRoZSBjYWxlbmRhci5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnVwZGF0ZVZhbHVlID0gZnVuY3Rpb24gdXBkYXRlVmFsdWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2V0VmFsdWUodGhpcy5pbnB1dEVsLnZhbHVlKTtcbiAgfTtcblxuICAvKipcbiAgICogTW92ZSB0aGUgY2FyZXQgcG9zaXRpb24uXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBwb3NcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLm1vdmVDYXJldCA9IGZ1bmN0aW9uIG1vdmVDYXJldChwb3MpIHtcbiAgICB0aGlzLl9zZXRDYXJldFBvc2l0aW9uVHJhbnNsYXRlZChwb3MpO1xuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIHRoZSBjYXJldCB0byB0aGUgZW5kIG9mIHRoZSBpbnB1dC5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLm1vdmVDYXJldFRvRW5kID0gZnVuY3Rpb24gbW92ZUNhcmV0VG9FbmQoKSB7XG4gICAgcmV0dXJuIHRoaXMubW92ZUNhcmV0KHRoaXMuY2hhcmFjdGVycy5sZW5ndGgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBNb3ZlIHRoZSBjYXJldCB0byB0aGUgc3RhcnQgb2YgdGhlIGlucHV0LlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUubW92ZUNhcmV0VG9TdGFydCA9IGZ1bmN0aW9uIG1vdmVDYXJldFRvU3RhcnQoKSB7XG4gICAgcmV0dXJuIHRoaXMubW92ZUNhcmV0KDApO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXVzZSBldmVudHMuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5wYXVzZSA9IGZ1bmN0aW9uIHBhdXNlKCkge1xuICAgIHRoaXMucGF1c2VCbHVyRm9jdXMrKztcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogUmVzdW1lIGV2ZW50cy5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnJlc3VtZSA9IGZ1bmN0aW9uIHJlc3VtZSgpIHtcbiAgICB0aGlzLnBhdXNlQmx1ckZvY3VzLS07XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIERpc2FibGUgZW50cnkgaW50byB0aGUgaW5wdXQuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5kaXNhYmxlID0gZnVuY3Rpb24gZGlzYWJsZSgpIHtcbiAgICB0aGlzLmlucHV0RWwuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogRW5hYmxlIGVudHJ5IGludG8gdGhlIGlucHV0LlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuZW5hYmxlID0gZnVuY3Rpb24gZW5hYmxlKCkge1xuICAgIHRoaXMuaW5wdXRFbC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIENsZWFyIHRoZSB2YWx1ZS5cbiAgICogQ2hhbmdlZCB0byBjbGVhclZhbHVlIGluIHYyLjAuMC5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLmNsZWFyID0gZnVuY3Rpb24gY2xlYXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2xlYXJWYWx1ZSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBdWdtZW50IGRlZmF1bHQgcmVtb3ZlIGNhbGwgdy8gaGVscGVyIGNsZWFudXAuXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gbGVhdmVFbGVtZW50IExlYXZlIHRoZSBlbGVtZW50IGludGFjdC5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uIHJlbW92ZShsZWF2ZUVsZW1lbnQpIHtcbiAgICBfQmFzZUNvbXBvbmVudC5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcywgbGVhdmVFbGVtZW50KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogU3RvcmUgYSByZWZlcmVuY2UgdG8gdGhlIG5lZWRlZCBlbGVtZW50cy5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVsXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fY2FjaGVFbGVtZW50cyA9IGZ1bmN0aW9uIF9jYWNoZUVsZW1lbnRzKGVsKSB7XG4gICAgdGhpcy5lbCA9IGVsO1xuICAgIHRoaXMuaW5wdXRFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignW3R5cGU9XCJ0ZXh0XCJdLCBbdHlwZT1cImVtYWlsXCJdLCBbdHlwZT1cInBob25lXCJdLCB0ZXh0YXJlYScpIHx8IHRoaXMuX2NyZWF0ZURlZmF1bHRJbnB1dEVsZW1lbnQoKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1pbnB1dF9fcGxhY2Vob2xkZXInKSB8fCB0aGlzLl9jcmVhdGVEZWZhdWx0UGxhY2Vob2xkZXJFbGVtZW50KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIHBhcmFtZXRlcnMgZnJvbSB0aGUgZWxlbWVudHMuXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fcGFyc2VQYXJhbXMgPSBmdW5jdGlvbiBfcGFyc2VQYXJhbXMoKSB7XG5cbiAgICAvLyBTdG9yZSB0aGUgdmFsdWUgY2hhcmFjdGVyc1xuICAgIHRoaXMuY2hhcmFjdGVycyA9IHRoaXMuX3BhcnNlQ2hhcmFjdGVycyh0aGlzLmlucHV0RWwudmFsdWUpO1xuXG4gICAgLy8gU3RvcmUgZm9ybWF0XG4gICAgdGhpcy5mb3JtYXQgPSB0aGlzLl9wYXJzZUZvcm1hdCh0aGlzLmZvcm1hdCA/IHRoaXMuZm9ybWF0IDogdGhpcy5pbnB1dEVsLmdldEF0dHJpYnV0ZSgnZGF0YS10eXBlYWhlYWQtZm9ybWF0JykpO1xuXG4gICAgLy8gU3RvcmUgdGhlIG9yaWdpbmFsIHBsYWNlaG9sZGVyXG4gICAgdGhpcy5wbGFjZWhvbGRlciA9IHRoaXMucGxhY2Vob2xkZXIgPyB0aGlzLnBsYWNlaG9sZGVyIDogdGhpcy5pbnB1dEVsLmdldEF0dHJpYnV0ZSgncGxhY2Vob2xkZXInKS5zcGxpdCgnJyk7XG5cbiAgICAvLyBHZXQgdGhlIHRvdGFsIG51bWJlciBvZiBjaGFyYWN0ZXJzIHdlIGNhbiBoYXZlXG4gICAgdGhpcy5tYXhMZW5ndGggPSB0aGlzLl9nZXRDaGFyYWN0ZXJzQWxsb3dlZENvdW50KHRoaXMuZm9ybWF0KTtcblxuICAgIHRoaXMubWF0Y2hQbGFjZWhvbGRlclNpemUgPSB0aGlzLm1hdGNoUGxhY2Vob2xkZXJTaXplICE9PSBudWxsID8gdGhpcy5tYXRjaFBsYWNlaG9sZGVyU2l6ZSA6ICgwLCBfcGFyc2VBdHRyaWJ1dGUuYm9vbGVhbikodGhpcy5pbnB1dEVsLCAnZGF0YS1tYXRjaC1wbGFjZWhvbGRlci1zaXplJywgZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBQYXJzZSB0aGUgZm9ybWF0IHN0cmluZyBpbnRvIGFuIGFycmF5LlxuICAgKiBAcGFyYW0gIHtTdHJpbmd9IGZvcm1hdFxuICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9wYXJzZUZvcm1hdCA9IGZ1bmN0aW9uIF9wYXJzZUZvcm1hdChmb3JtYXQpIHtcblxuICAgIHZhciBpID0gMDtcbiAgICB2YXIgbGVuID0gZm9ybWF0Lmxlbmd0aDtcbiAgICB2YXIgYXJyID0gW107XG4gICAgdmFyIGxhc3RXYXNFc2NhcGUgPSBmYWxzZTtcblxuICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgIGlmIChmb3JtYXRbaV0gPT09ICdcXFxcJyAmJiAhbGFzdFdhc0VzY2FwZSkge1xuICAgICAgICBsYXN0V2FzRXNjYXBlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGFyci5wdXNoKChsYXN0V2FzRXNjYXBlID8gJ1xcXFwnIDogJycpICsgZm9ybWF0W2ldKTtcbiAgICAgICAgbGFzdFdhc0VzY2FwZSA9IGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBhcnI7XG4gIH07XG5cbiAgLyoqXG4gICAqIFBhcnNlIHRoZSBjaGFyYWN0ZXJzIHN0cmluZyBpbnRvIGFuIGFycmF5LCBpZ25vcmluZyBjaGFyYWN0ZXJzIHdoaWNoIGRvbid0XG4gICAqIG1hdGNoIHRoZSBmb3JtYXQgcmVxdWlyZW1lbnRzLlxuICAgKiBAcGFyYW0ge1N0cmluZ30gY2hhcmFjdGVyc1xuICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9wYXJzZUNoYXJhY3RlcnMgPSBmdW5jdGlvbiBfcGFyc2VDaGFyYWN0ZXJzKGNoYXJhY3RlcnMpIHtcblxuICAgIHZhciBjaGFycyA9IGNoYXJhY3RlcnMuc3BsaXQoJycpO1xuICAgIHZhciBpID0gMDtcbiAgICB2YXIgbGVuID0gY2hhcmFjdGVycy5sZW5ndGg7XG4gICAgdmFyIHJlZ2V4ZXMgPSBbXTtcbiAgICB2YXIgYXJyID0gW107XG5cbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG5cbiAgICAgIC8vIFRyeSB0byBidWlsZCBhIHJlZ2V4IGZvciB0aGlzIGZvcm1hdCBjaGFyYWN0ZXIuXG4gICAgICB0cnkge1xuICAgICAgICAvLyBNYWtlIHN1cmUgdGhpcyBmb3JtYXQgc3RhcnRzIHdpdGggYW4gZXNjYXBlIGNoYXJhY3Rlci5cbiAgICAgICAgcmVnZXhlc1tpXSA9IHRoaXMuZm9ybWF0W2ldWzBdID09PSAnXFxcXCcgPyBuZXcgUmVnRXhwKHRoaXMuZm9ybWF0W2ldKSA6IG51bGw7XG4gICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgLy9cblxuXG4gICAgICAvLyBJZiB3ZSB3ZXJlIGFibGUgdG8gY3JlYXRlIGEgcmVnZXggYW5kIG91ciBjaGFyIHBhc3NlcywgYWRkIGl0IHRvIHRoZSBhcnJheVxuICAgICAgLy8gb2YgY2hhcmFjdGVycyB0byByZXR1cm4uXG4gICAgICBpZiAocmVnZXhlc1tpXSAmJiByZWdleGVzW2ldLmV4ZWMoY2hhcnNbaV0pKSB7XG4gICAgICAgIGFyci5wdXNoKGNoYXJzW2ldKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gYXJyO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgdGhlIGRlZmF1bHQgaW5wdXQgZWxlbWVudC5cbiAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9jcmVhdGVEZWZhdWx0SW5wdXRFbGVtZW50ID0gZnVuY3Rpb24gX2NyZWF0ZURlZmF1bHRJbnB1dEVsZW1lbnQoKSB7XG5cbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGVsLmNsYXNzTmFtZSA9ICdzcGFyay1pbnB1dF9fZmllbGQnO1xuICAgIGVsLnNldEF0dHJpYnV0ZSgnZGF0YS10eXBlYWhlYWQnLCAnJyk7XG4gICAgZWwuc2V0QXR0cmlidXRlKCd0eXBlJywgJ3RlbCcpO1xuXG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZChlbCk7XG5cbiAgICByZXR1cm4gZWw7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSB0aGUgZGVmYXVsdCBpbnB1dCBlbGVtZW50LlxuICAgKiBAcmV0dXJuIHtFbGVtZW50fVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2NyZWF0ZURlZmF1bHRQbGFjZWhvbGRlckVsZW1lbnQgPSBmdW5jdGlvbiBfY3JlYXRlRGVmYXVsdFBsYWNlaG9sZGVyRWxlbWVudCgpIHtcbiAgICB2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7XG4gICAgZWwuY2xhc3NOYW1lID0gJ3NwYXJrLWlucHV0X19wbGFjZWhvbGRlcic7XG4gICAgdGhpcy5lbC5hcHBlbmRDaGlsZChlbCk7XG4gICAgcmV0dXJuIGVsO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIG1heGltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgYWxsb3dlZC5cbiAgICogQHBhcmFtIHtBcnJheX0gZm9ybWF0XG4gICAqIEByZXR1cm4ge051bWJlcn1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9nZXRDaGFyYWN0ZXJzQWxsb3dlZENvdW50ID0gZnVuY3Rpb24gX2dldENoYXJhY3RlcnNBbGxvd2VkQ291bnQoZm9ybWF0KSB7XG5cbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGxlbiA9IGZvcm1hdC5sZW5ndGg7XG4gICAgdmFyIGFsbG93ZWQgPSAwO1xuXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgaWYgKGZvcm1hdFtpXSA9PT0gJ1xcXFxkJykge1xuICAgICAgICBhbGxvd2VkKys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGFsbG93ZWQ7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIF9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpIHtcbiAgICB0aGlzLl9vbktleWRvd25Cb3VuZCA9IHRoaXMuX29uS2V5ZG93bi5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uS2V5cHJlc3NCb3VuZCA9IHRoaXMuX29uS2V5cHJlc3MuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkZvY3VzQm91bmQgPSB0aGlzLl9vbkZvY3VzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25CbHVyQm91bmQgPSB0aGlzLl9vbkJsdXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vblBsYWNlaG9sZGVyQ2xpY2tCb3VuZCA9IHRoaXMuX29uUGxhY2Vob2xkZXJDbGljay5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIHRvIGtleXByZXNzIGFuZCBrZXlkb3duLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2FkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX2FkZEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fb25LZXlkb3duQm91bmQsIGZhbHNlKTtcbiAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcigna2V5cHJlc3MnLCB0aGlzLl9vbktleXByZXNzQm91bmQsIGZhbHNlKTtcbiAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbkZvY3VzQm91bmQsIGZhbHNlKTtcbiAgICB0aGlzLnBsYWNlaG9sZGVyRWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vblBsYWNlaG9sZGVyQ2xpY2tCb3VuZCwgZmFsc2UpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIHRvIGtleXByZXNzIGFuZCBrZXlkb3duLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX3JlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuXG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleWRvd25Cb3VuZCk7XG4gICAgdGhpcy5pbnB1dEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXByZXNzJywgdGhpcy5fb25LZXlwcmVzc0JvdW5kKTtcbiAgICB0aGlzLmlucHV0RWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignZm9jdXMnLCB0aGlzLl9vbkZvY3VzQm91bmQpO1xuICAgIHRoaXMucGxhY2Vob2xkZXJFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uUGxhY2Vob2xkZXJDbGlja0JvdW5kKTtcblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQpO1xuICAgIHRoaXMuaW5wdXRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjYXJldCBpbiB0aGUgZWxlbWVudC5cbiAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgaW5kZXhcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9nZXRDYXJldFN0YXJ0ID0gZnVuY3Rpb24gX2dldENhcmV0U3RhcnQoKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fbWFpbnRhaW5Gb2N1cyhmdW5jdGlvbiAoKSB7XG5cbiAgICAgIHZhciBjYXJldFBvc2l0aW9uO1xuXG4gICAgICAvLyBJRSBzdXBwb3J0XG4gICAgICBpZiAoZG9jdW1lbnQuc2VsZWN0aW9uKSB7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICB2YXIgc2VsID0gZG9jdW1lbnQuc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHNlbC5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIC10aGlzLmlucHV0RWwudmFsdWUubGVuZ3RoKTtcbiAgICAgICAgY2FyZXRQb3NpdGlvbiA9IHNlbC50ZXh0Lmxlbmd0aDtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0IHx8IHRoaXMuaW5wdXRFbC5zZWxlY3Rpb25TdGFydCA9PT0gMCkge1xuICAgICAgICBjYXJldFBvc2l0aW9uID0gdGhpcy5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gY2FyZXRQb3NpdGlvbjtcbiAgICB9KTtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBlbmQgcG9zaXRpb24gb2YgdGhlIGNhcmV0IGluIHRoZSBlbGVtZW50LlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IFRoZSBpbmRleFxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENhcmV0RW5kID0gZnVuY3Rpb24gX2dldENhcmV0RW5kKCkge1xuXG4gICAgcmV0dXJuIHRoaXMuX21haW50YWluRm9jdXMoZnVuY3Rpb24gKCkge1xuXG4gICAgICB2YXIgY2FyZXRQb3NpdGlvbjtcblxuICAgICAgLy8gSUUgc3VwcG9ydFxuICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbikge1xuICAgICAgICB0aGlzLmlucHV0RWwuZm9jdXMoKTtcbiAgICAgICAgdmFyIHNlbCA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgICAgICBzZWwubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCAtdGhpcy5pbnB1dEVsLnZhbHVlLmxlbmd0aCk7XG4gICAgICAgIGNhcmV0UG9zaXRpb24gPSBzZWwudGV4dC5sZW5ndGg7XG4gICAgICB9IGVsc2UgaWYgKHRoaXMuaW5wdXRFbC5zZWxlY3Rpb25FbmQgfHwgdGhpcy5pbnB1dEVsLnNlbGVjdGlvbkVuZCA9PT0gMCkge1xuICAgICAgICBjYXJldFBvc2l0aW9uID0gdGhpcy5pbnB1dEVsLnNlbGVjdGlvbkVuZDtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGNhcmV0UG9zaXRpb247XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIElzIHRoZSBjYXJldCBhdCB0aGUgZW5kIG9mIHRoZSBpbnB1dD9cbiAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9jYXJldElzQXRFbmQgPSBmdW5jdGlvbiBfY2FyZXRJc0F0RW5kKCkge1xuICAgIHJldHVybiB0aGlzLl9nZXRDYXJldFN0YXJ0KCkgPT09IHRoaXMubWF4TGVuZ3RoO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjYXJldCBpbiB0aGUgZWxlbWVudC5cbiAgICogQHJldHVybiB7TnVtYmVyfSBUaGUgaW5kZXhcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9zZXRDYXJldFBvc2l0aW9uID0gZnVuY3Rpb24gX3NldENhcmV0UG9zaXRpb24ocG9zKSB7XG5cbiAgICByZXR1cm4gdGhpcy5fbWFpbnRhaW5Gb2N1cyhmdW5jdGlvbiAoKSB7XG5cbiAgICAgIC8vIElFIHN1cHBvcnRcbiAgICAgIGlmIChkb2N1bWVudC5zZWxlY3Rpb24pIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgIHZhciBzZWwgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgICAgICAgc2VsLm1vdmVTdGFydCgnY2hhcmFjdGVyJywgLXRoaXMuaW5wdXRFbC52YWx1ZS5sZW5ndGgpO1xuICAgICAgICBzZWwubW92ZVN0YXJ0KCdjaGFyYWN0ZXInLCBwb3MpO1xuICAgICAgICBzZWwubW92ZUVuZCgnY2hhcmFjdGVyJywgMCk7XG4gICAgICAgIHNlbC5zZWxlY3QoKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0IHx8IHRoaXMuaW5wdXRFbC5zZWxlY3Rpb25TdGFydCA9PT0gMCkge1xuICAgICAgICB0aGlzLmlucHV0RWwuc2VsZWN0aW9uU3RhcnQgPSBwb3M7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5zZWxlY3Rpb25FbmQgPSBwb3M7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdldCB0aGUgcG9zaXRpb24gb2YgdGhlIGNhcmV0IHRyYW5zbGF0ZWQgdG8gdGhlIGNvcnJlc3BvbmRpbmcgaW5kZXggaW4gdGhlXG4gICAqIGNoYXJhY3RlcnMgYXJyYXkuIFRoaXMgbWVhbnMgaWdub3JpbmcgZm9ybWF0IGNoYXJhY3RlcnMuXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBwb3NcbiAgICogQHJldHVybiB7TnVtYmVyfVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkID0gZnVuY3Rpb24gX2dldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkKHBvcykge1xuXG4gICAgdmFyIGkgPSAwO1xuICAgIHZhciBza2lwQ291bnQgPSAwO1xuXG4gICAgZm9yICg7IGkgPCBwb3M7IGkrKykge1xuXG4gICAgICAvLyBDb3VudCBub24tbnVtYmVycyBhcyBhIHNraXAuXG4gICAgICAvLyBAdG9kbzogdGhpcyBuZWVkcyB0byB3b3JrIHdpdGggbW9yZSB0aGFuIG51bWJlcnMuXG4gICAgICBpZiAodGhpcy5mb3JtYXRbaV0gIT09ICdcXFxcZCcpIHtcbiAgICAgICAgc2tpcENvdW50Kys7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHBvcyAtIHNraXBDb3VudDtcbiAgfTtcblxuICAvKipcbiAgICogR2V0IHRoZSBzdGFydGluZyBwb3NpdGlvbiBvZiB0aGUgY2FyZXQgdHJhbnNsYXRlZC5cbiAgICogQHJldHVybiB7TnVtYmVyfVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENhcmV0U3RhcnRUcmFuc2xhdGVkID0gZnVuY3Rpb24gX2dldENhcmV0U3RhcnRUcmFuc2xhdGVkKCkge1xuICAgIHJldHVybiB0aGlzLl9nZXRDYXJldFBvc2l0aW9uVHJhbnNsYXRlZCh0aGlzLl9nZXRDYXJldFN0YXJ0KCkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgdGhlIGVuZGluZyBwb3NpdGlvbiBvZiB0aGUgY2FyZXQgdHJhbnNsYXRlZC5cbiAgICogQHJldHVybiB7TnVtYmVyfVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2dldENhcmV0RW5kVHJhbnNsYXRlZCA9IGZ1bmN0aW9uIF9nZXRDYXJldEVuZFRyYW5zbGF0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2dldENhcmV0UG9zaXRpb25UcmFuc2xhdGVkKHRoaXMuX2dldENhcmV0RW5kKCkpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgdGhlIHBvc2l0aW9uIG9mIHRoZSBjYXJldCB0cmFuc2xhdGVkIHRvIHRoZSBjb3JyZXNwb25kaW5nIGluZGV4IGluIHRoZVxuICAgKiBjaGFyYWN0ZXJzIGFycmF5LiBUaGlzIG1lYW5zIGlnbm9yaW5nIGZvcm1hdCBjaGFyYWN0ZXJzLlxuICAgKiBAcGFyYW0ge051bWJlcn0gcG9zXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fc2V0Q2FyZXRQb3NpdGlvblRyYW5zbGF0ZWQgPSBmdW5jdGlvbiBfc2V0Q2FyZXRQb3NpdGlvblRyYW5zbGF0ZWQocG9zKSB7XG5cbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIHNraXBDb3VudCA9IDA7XG5cbiAgICBmb3IgKDsgaSA8IHBvcyArIHNraXBDb3VudDsgaSsrKSB7XG5cbiAgICAgIC8vIENvdW50IG5vbi1udW1iZXJzIGFzIGEgc2tpcC5cbiAgICAgIC8vIEB0b2RvOiB0aGlzIG5lZWRzIHRvIHdvcmsgd2l0aCBtb3JlIHRoYW4gbnVtYmVycy5cbiAgICAgIGlmICh0aGlzLmZvcm1hdFtpXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMuZm9ybWF0W2ldICE9PSAnXFxcXGQnKSB7XG4gICAgICAgIHNraXBDb3VudCsrO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX3NldENhcmV0UG9zaXRpb24ocG9zICsgc2tpcENvdW50KTtcbiAgfTtcblxuICAvKipcbiAgICogTW92ZSB0aGUgY2FyZXQgcG9zaXRpb25cbiAgICogQHBhcmFtICB7U3RyaW5nfSBkaXJlY3Rpb24gVGhlIGRpcmVjdGlvbiBvZiB0aGUgbW92ZW1lbnRcbiAgICogQHJldHVybiB7Qm9vbGVhbn0gICAgICAgICAgIFdhcyB0aGUgY2FyZXQgYWN0dWFsbHkgbW92ZWQ/XG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fbW92ZUNhcmV0ID0gZnVuY3Rpb24gX21vdmVDYXJldChkaXJlY3Rpb24pIHtcblxuICAgIHZhciBjdXJQb3MgPSB0aGlzLl9nZXRDYXJldFN0YXJ0KCk7XG5cbiAgICBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcpIHtcbiAgICAgIHRoaXMuX3NldENhcmV0UG9zaXRpb24oY3VyUG9zIC0gMSk7XG4gICAgfSBlbHNlIGlmIChkaXJlY3Rpb24gPT09ICdyaWdodCcpIHtcbiAgICAgIHRoaXMuX3NldENhcmV0UG9zaXRpb24oY3VyUG9zICsgMSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGN1clBvcyAhPT0gdGhpcy5fZ2V0Q2FyZXRTdGFydCgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBFbXB0eSB0aGUgaW5wdXQgd2hlbiB3ZSBvbmx5IGhhdmUgcGxhY2Vob2xkZXJzLlxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX2VtcHR5V2hlbk9ubHlQbGFjZWhvbGRlcnMgPSBmdW5jdGlvbiBfZW1wdHlXaGVuT25seVBsYWNlaG9sZGVycygpIHtcbiAgICBpZiAoIXRoaXMuY2hhcmFjdGVycy5sZW5ndGgpIHtcbiAgICAgIHRoaXMuY2xlYXIoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFJ1biBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgbWF5IGNoYW5nZSB0aGUgZm9jdXMgb2YgdGhlIGRvY3VtZW50LCBidXRcbiAgICogbWFrZSBzdXJlIGZvY3VzIGdvZXMgYmFjayB0byB3aGVyZSBpdCBuZWVkcyB0byBiZS4gQWxzbywgc2V0IHRoZSBzdGF0ZVxuICAgKiBzbyB0aGF0IGJsdXIvZm9jdXMgZXZlbnRzIGRvbid0IGZpcmUgZnJvbSB0aGlzIGluc3RhbmNlLlxuICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX21haW50YWluRm9jdXMgPSBmdW5jdGlvbiBfbWFpbnRhaW5Gb2N1cyhjYWxsYmFjaykge1xuXG4gICAgdGhpcy5wYXVzZSgpO1xuXG4gICAgdmFyIG9yaWdpbmFsQWN0aXZlRWxlbWVudCA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7XG5cbiAgICAvL0ZvciBJRVxuICAgIGlmICghb3JpZ2luYWxBY3RpdmVFbGVtZW50KSB7XG4gICAgICBvcmlnaW5hbEFjdGl2ZUVsZW1lbnQgPSBkb2N1bWVudC5ib2R5O1xuICAgIH1cblxuICAgIHZhciBvdXRwdXQgPSAoY2FsbGJhY2sgfHwgbm9vcCkuY2FsbCh0aGlzKTtcblxuICAgIC8vIElmIHdlIGRpZG4ndCBoYXZlIGZvY3VzLCBnbyBiYWNrIHRvIGZvY3VzaW5nIG9uIHRoZSBvcmlnaW5hbFxuICAgIGlmIChvcmlnaW5hbEFjdGl2ZUVsZW1lbnQgIT09IHRoaXMuaW5wdXRFbCkge1xuICAgICAgdGhpcy5pbnB1dEVsLmJsdXIoKTtcbiAgICAgIG9yaWdpbmFsQWN0aXZlRWxlbWVudCA/IG9yaWdpbmFsQWN0aXZlRWxlbWVudC5mb2N1cygpIDogbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnJlc3VtZSgpO1xuXG4gICAgcmV0dXJuIG91dHB1dDtcbiAgfTtcblxuICAvKipcbiAgICogVXBkYXRlIHRoZSB3aWR0aCBvZiB0aGUgdHlwZWFoZWFkLiBJZiB3ZSBzaG91bGQgYmUgbWF0Y2hpbmcgdGhlIHdpZHRoXG4gICAqIG9mIHRoZSBwbGFjZWhvbGRlciwgZG8gc28uIE90aGVyd2lzZSwgdGFrZSBubyBhY3Rpb24uXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fdXBkYXRlV2lkdGggPSBmdW5jdGlvbiBfdXBkYXRlV2lkdGgoKSB7XG5cbiAgICBpZiAodGhpcy5tYXRjaFBsYWNlaG9sZGVyU2l6ZSkge1xuICAgICAgdGhpcy5wbGFjZWhvbGRlckVsLnN0eWxlLndpZHRoID0gJ2F1dG8nO1xuICAgICAgLy8gQWRkIDJweCB0byBhY2NvdW50IGZvciBjYXJldCB3aWR0aCBpbiBJRS4uLlxuICAgICAgdGhpcy5pbnB1dEVsLnN0eWxlLndpZHRoID0gJ2F1dG8nO1xuICAgICAgdGhpcy5pbnB1dEVsLnN0eWxlLndpZHRoID0gdGhpcy5wbGFjZWhvbGRlckVsLm9mZnNldFdpZHRoICsgMiArICdweCc7XG4gICAgICB0aGlzLnBsYWNlaG9sZGVyRWwuc3R5bGUud2lkdGggPSAnJztcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgZGVsZXRlIGFuZCBhcnJvd3MuXG4gICAqIEBwYXJhbSAge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX29uS2V5ZG93biA9IGZ1bmN0aW9uIF9vbktleWRvd24oZSkge1xuXG4gICAgdmFyIGNvZGUgPSBlLmtleUNvZGUgfHwgZS53aGljaDtcblxuICAgIGlmIChjb2RlID09PSB0aGlzLnBhc3RlQ29kZSAmJiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoY29kZSA9PT0gdGhpcy5hY3Rpb25Db2Rlcy5CQUNLU1BBQ0UpIHtcbiAgICAgIHRoaXMucmVtb3ZlQ2hhcmFjdGVyQXRDYXJldCgtMSk7XG4gICAgICB0aGlzLl9vbkJhY2tzcGFjZSgpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0gZWxzZSBpZiAoY29kZSA9PT0gdGhpcy5hY3Rpb25Db2Rlcy5ERUxFVEUpIHtcbiAgICAgIHRoaXMucmVtb3ZlQ2hhcmFjdGVyQXRDYXJldCgwKTtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IHRoaXMuYWN0aW9uQ29kZXMuTEVGVCkge1xuICAgICAgaWYgKCF0aGlzLl9nZXRDYXJldFN0YXJ0KCkpIHtcbiAgICAgICAgKHRoaXMub25CYWNrc3BhY2UgfHwgbm9vcCkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGNvZGUgPT09IHRoaXMuYWN0aW9uQ29kZXMuUklHSFQpIHtcbiAgICAgIGlmICh0aGlzLl9nZXRDYXJldFN0YXJ0KCkgPT09IHRoaXMuY2hhcmFjdGVycy5sZW5ndGgpIHtcbiAgICAgICAgKHRoaXMub25FbmQgfHwgbm9vcCkoKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHRoaXMuaWdub3JlQ29kZXMuaW5kZXhPZihjb2RlKSA9PT0gLTEpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAgIC8vIEFjY291bnQgZm9yIE51bXBhZCBrZXlzXG4gICAgICAgIGlmIChjb2RlID49IDk2ICYmIGNvZGUgPD0gMTA1KSB7XG4gICAgICAgICAgY29kZSAtPSA0ODtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMuYWRkQ2hhcmFjdGVyQXRDYXJldChTdHJpbmcuZnJvbUNoYXJDb2RlKGNvZGUpKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIGtleXByZXNzIGV2ZW50IGZpcmVzLCB2YWxpZGF0ZS5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBUeXBlYWhlYWQucHJvdG90eXBlLl9vbktleXByZXNzID0gZnVuY3Rpb24gX29uS2V5cHJlc3MoZSkge1xuICAgIHZhciBjb2RlID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICBpZiAodGhpcy5pZ25vcmVDb2Rlcy5pbmRleE9mKGNvZGUpID09PSAtMSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5jaGFyYWN0ZXJzID0gdGhpcy5fcGFyc2VDaGFyYWN0ZXJzKHRoaXMuaW5wdXRFbC52YWx1ZSk7XG4gICAgICB0aGlzLnJ1bigpO1xuICAgICAgKHRoaXMub25DaGFuZ2UgfHwgbm9vcCkodGhpcy5nZXRWYWx1ZSgpLCB0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIGlucHV0IGV2ZW50IGZpcmVzLCB2YWxpZGF0ZS4gVGhpcyBoYXBwZW5zXG4gICAqIHdpdGggYSBjb3B5K3Bhc3RlLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX29uSW5wdXQgPSBmdW5jdGlvbiBfb25JbnB1dChlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuY2hhcmFjdGVycyA9IHRoaXMuX3BhcnNlQ2hhcmFjdGVycyh0aGlzLmlucHV0RWwudmFsdWUpO1xuICAgIHRoaXMucnVuKCk7XG4gICAgKHRoaXMub25JbnB1dCB8fCBub29wKSh0aGlzLmdldFZhbHVlKCksIHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHdlIGZvY3VzLCBydW4gdGhlIGZvcm1hdHRpbmcuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25Gb2N1cyA9IGZ1bmN0aW9uIF9vbkZvY3VzKCkge1xuXG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCk7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLl9vbkJsdXJCb3VuZCwgZmFsc2UpO1xuICAgIHRoaXMuaW5wdXRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQpO1xuICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQsIGZhbHNlKTtcblxuICAgIGlmICh0aGlzLmlzRm9jdXNlZCB8fCB0aGlzLnBhdXNlQmx1ckZvY3VzIHx8IHRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG5cbiAgICB0aGlzLnJ1bigpO1xuICAgICh0aGlzLm9uRm9jdXMgfHwgbm9vcCkodGhpcy5nZXRWYWx1ZSgpLCB0aGlzKTtcbiAgICB0aGlzLmlzRm9jdXNlZCA9IHRydWU7XG4gICAgdGhpcy5fb2xkVmFsID0gdGhpcy5pbnB1dEVsLnZhbHVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHdlIGJsdXIsIGlmIHdlIGhhdmUgbm8gY2hhcmFjdGVycywgcmVtb3ZlIHRoZSBwbGFjZWhvbGRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgVHlwZWFoZWFkLnByb3RvdHlwZS5fb25CbHVyID0gZnVuY3Rpb24gX29uQmx1cigpIHtcblxuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQpO1xuICAgIHRoaXMuaW5wdXRFbC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5fb25CbHVyQm91bmQpO1xuXG4gICAgdGhpcy5pc0ZvY3VzZWQgPSBmYWxzZTtcblxuICAgIGlmICh0aGlzLnBhdXNlQmx1ckZvY3VzIHx8IHRoaXMuaXNSdW5uaW5nKSByZXR1cm47XG5cbiAgICB0aGlzLl9lbXB0eVdoZW5Pbmx5UGxhY2Vob2xkZXJzKCk7XG5cbiAgICBpZiAodGhpcy5fb2xkVmFsICE9PSB0aGlzLmlucHV0RWwudmFsdWUpIHtcbiAgICAgICgwLCBfdHJpZ2dlckV2ZW50Mi5kZWZhdWx0KSh0aGlzLmlucHV0RWwsICdjaGFuZ2UnKTtcbiAgICB9XG5cbiAgICAodGhpcy5vbkJsdXIgfHwgbm9vcCkodGhpcy5nZXRWYWx1ZSgpLCB0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0aGUgcGxhY2Vob2xkZXIgcmVjZWl2ZXMgYSBjbGljayBldmVudCwgZm9jdXMgb24gdGhlIGlucHV0LiBUaGlzIGhhcHBlbnMgaW4gSUUxMCBmb3Igc29tZVxuICAgKiByZWFzb24gdGhhdCBJIGNhbm5vdCBmdWxseSBmYXRob20sIGJ1dCBpdCBoYXMgc29tZXRoaW5nIHRvIGRvIHdpdGggdGhlIGV4cGxpY2l0IHdpZHRoIGJlaW5nXG4gICAqIHNldCBvbiBhbiBlbXB0eSBlbGVtZW50LlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX29uUGxhY2Vob2xkZXJDbGljayA9IGZ1bmN0aW9uIF9vblBsYWNlaG9sZGVyQ2xpY2soZSkge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIHRoaXMuaW5wdXRFbC5mb2N1cygpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHdlIGJhY2tzcGFjZSwgaWYgd2UgaGF2ZSBubyBjaGFyYWN0ZXJzIGxlZnQgbGV0IGxpc3RlbmVycyBrbm93LlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIFR5cGVhaGVhZC5wcm90b3R5cGUuX29uQmFja3NwYWNlID0gZnVuY3Rpb24gX29uQmFja3NwYWNlKCkge1xuICAgIGlmICghdGhpcy5fZ2V0Q2FyZXRTdGFydCgpKSAodGhpcy5vbkJhY2tzcGFjZSB8fCBub29wKSgpO1xuICB9O1xuXG4gIHJldHVybiBUeXBlYWhlYWQ7XG59KF9iYXNlMi5kZWZhdWx0KTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5cblxuVHlwZWFoZWFkLnByb3RvdHlwZS5fd2hpdGVsaXN0ZWRQYXJhbXMgPSBbJ2Zvcm1hdCcsICdwbGFjZWhvbGRlcicsICdtYXRjaFBsYWNlaG9sZGVyU2l6ZScsICdvbkNoYW5nZScsICdvbkZvY3VzJywgJ29uQmx1cicsICdvbklucHV0JywgJ29uQmFja3NwYWNlJywgJ29uRW5kJ107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cblR5cGVhaGVhZC5wcm90b3R5cGUuZGVmYXVsdHMgPSB7XG4gIGVsOiBudWxsLFxuICBpbnB1dEVsOiBudWxsLFxuICBwbGFjZWhvbGRlckVsOiBudWxsLFxuICBwbGFjZWhvbGRlcjogbnVsbCxcbiAgY2hhcmFjdGVyczogbnVsbCxcbiAgZm9ybWF0OiBudWxsLFxuICBpZ25vcmVDb2RlczogWzksIC8vIFRhYlxuICAxNiwgLy8gU2hpZnRcbiAgMTcsIC8vIEN0cmxcbiAgMTgsIC8vIEFsdFxuICAyMCwgLy8gQ0FQU1xuICA5MSwgLy8gTWV0YVxuICA5MywgLy8gQWx0XG4gIDExMiwgMTEzLCAxMTQsIDExNSwgMTE2LCAxMTcsIDExOCwgMTE5LCAxMjAsIDEyMSwgMTIyLCAxMjMgLy8gRjEtRjEyXG4gIF0sXG4gIGFjdGlvbkNvZGVzOiB7XG4gICAgQkFDS1NQQUNFOiA4LFxuICAgIERFTEVURTogNDYsXG4gICAgTEVGVDogMzcsXG4gICAgUklHSFQ6IDM5XG4gIH0sXG4gIHBhc3RlQ29kZTogODYsIC8vIHZcbiAgcGF1c2VCbHVyRm9jdXM6IDAsXG4gIG1hdGNoUGxhY2Vob2xkZXJTaXplOiBudWxsLFxuICBtYXhMZW5ndGg6IG51bGwsXG4gIGlzRm9jdXNlZDogZmFsc2UsXG4gIGlzUnVubmluZzogZmFsc2UsXG4gIG9uQ2hhbmdlOiBudWxsLFxuICBvbkZvY3VzOiBudWxsLFxuICBvbkJsdXI6IG51bGwsXG4gIG9uSW5wdXQ6IG51bGwsXG4gIG9uQmFja3NwYWNlOiBudWxsLFxuICBvbkVuZDogbnVsbCxcbiAgX2F0RW5kOiBmYWxzZSxcbiAgX29sZFZhbDogbnVsbCxcbiAgX29uS2V5ZG93bkJvdW5kOiBudWxsLFxuICBfb25LZXlwcmVzc0JvdW5kOiBudWxsLFxuICBfb25Gb2N1c0JvdW5kOiBudWxsLFxuICBfb25CbHVyQm91bmQ6IG51bGwsXG4gIF9vblBsYWNlaG9sZGVyQ2xpY2tCb3VuZDogbnVsbFxufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gVHlwZWFoZWFkO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD10eXBlYWhlYWQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKipcbiAqICMgUGFyc2UgRE9NIGF0dHJpYnV0ZXNcbiAqIEdpdmVuIGFuIGVsZW1lbnQgYW5kIGFuIGF0dHJpYnV0ZSBuYW1lLCBwYXJzZSB0aGF0IGF0dHJpYnV0ZVxuICogaWYgaXQgZXhpc3RzIG9yIHJldHVybiBhIGRlZmF1bHQuXG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2RvbS9wYXJzZS1hdHRyaWJ1dGUuanNcbiAqL1xuXG4vKipcbiAqIEdldCB0aGUgYm9vbGVhbiB2YWx1ZSBvZiBhbiBhdHRyaWJ1dGUgb24gYW4gZWxlbWVudCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsXG4gKiBAcGFyYW0gIHtTdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSAge0Jvb2xlYW59IGRlZlxuICogQHJldHVybiB7Qm9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gYm9vbGVhbihlbCwgbmFtZSwgZGVmKSB7XG4gIHZhciB2YWwgPSBlbC5nZXRBdHRyaWJ1dGUobmFtZSk7XG4gIGlmICh2YWwgPT09IG51bGwpIHJldHVybiBkZWY7XG4gIHJldHVybiB2YWwgPT09ICd0cnVlJyB8fCB2YWwgPT09ICcnID8gdHJ1ZSA6IGZhbHNlO1xufVxuXG4vKipcbiAqIEdldCB0aGUgbnVtZXJpYyB2YWx1ZSBvZiBhbiBhdHRyaWJ1dGUgb24gYW4gZWxlbWVudCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsXG4gKiBAcGFyYW0gIHtTdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSAge0Jvb2xlYW59IGRlZlxuICogQHJldHVybiB7Qm9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gbnVtYmVyKGVsLCBuYW1lLCBkZWYpIHtcbiAgdmFyIHZhbCA9IGVsLmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgaWYgKHZhbCA9PT0gbnVsbCkgcmV0dXJuIGRlZjtcbiAgcmV0dXJuIHBhcnNlSW50KHZhbCwgMTApO1xufVxuXG4vKipcbiAqIEdldCB0aGUgYm9vbGVhbiB2YWx1ZSBvZiBhbiBhdHRyaWJ1dGUgb24gYW4gZWxlbWVudCxcbiAqIGZhbGxpbmcgYmFjayB0byB0aGUgZGVmYXVsdCB2YWx1ZS5cbiAqIEBwYXJhbSAge0VsZW1lbnR9IGVsXG4gKiBAcGFyYW0gIHtTdHJpbmd9IG5hbWVcbiAqIEBwYXJhbSAge0Jvb2xlYW59IGRlZlxuICogQHJldHVybiB7Qm9vbGVhbn1cbiAqL1xuZnVuY3Rpb24gc3RyaW5nKGVsLCBuYW1lLCBkZWYpIHtcbiAgdmFyIHZhbCA9IGVsLmdldEF0dHJpYnV0ZShuYW1lKTtcbiAgaWYgKHZhbCA9PT0gbnVsbCkgcmV0dXJuIGRlZjtcbiAgcmV0dXJuIHZhbDtcbn1cblxuZXhwb3J0cy5ib29sZWFuID0gYm9vbGVhbjtcbmV4cG9ydHMubnVtYmVyID0gbnVtYmVyO1xuZXhwb3J0cy5zdHJpbmcgPSBzdHJpbmc7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYXJzZS1hdHRyaWJ1dGUuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKipcbiAqICMgVHJpZ2dlciBFdmVudFxuICogVHJpZ2dlciBhIERPTSBldmVudCBvbiBhbiBlbGVtZW50LlxuICpcbiAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL2RvbS90cmlnZ2VyLWV2ZW50LmpzXG4gKi9cbmZ1bmN0aW9uIHRyaWdnZXJFdmVudChlbCwgbmFtZSkge1xuXG4gIHZhciBldmVudCA9IHZvaWQgMDtcblxuICBpZiAoZG9jdW1lbnQuY3JlYXRlRXZlbnQpIHtcbiAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdIVE1MRXZlbnRzJyk7XG4gICAgZXZlbnQuaW5pdEV2ZW50KG5hbWUsIHRydWUsIHRydWUpO1xuICAgIGV2ZW50LmV2ZW50TmFtZSA9IG5hbWU7XG4gICAgZWwuZGlzcGF0Y2hFdmVudChldmVudCk7XG4gIH0gZWxzZSB7XG4gICAgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudE9iamVjdCgpO1xuICAgIGV2ZW50LmV2ZW50VHlwZSA9IG5hbWU7XG4gICAgZXZlbnQuZXZlbnROYW1lID0gbmFtZTtcbiAgICBlbC5maXJlRXZlbnQoJ29uJyArIGV2ZW50LmV2ZW50VHlwZSwgZXZlbnQpO1xuICB9XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHRyaWdnZXJFdmVudDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJpZ2dlci1ldmVudC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBFYWNoXG4gKiBBcHBseSBhIGNhbGxiYWNrIGZ1bmN0aW9uIHRvIGEgbGlzdCBvZiBhbnkga2luZDogQXJyYXksIE5vZGVMaXN0LCBIVE1MQ29sbGVjdGlvbiBvciBPYmplY3QuXG4gKlxuICogQHBhcmFtIHtBcnJheXxOb2RlTGlzdHxIVE1MQ29sbGVjdGlvbnxPYmplY3R9IGxpc3RcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNiXG4gKlxuICogQGV4YW1wbGVcbiAqIGVhY2goW10sIGNhbGxiYWNrKTtcbiAqIGVhY2goZWwuY2hpbGRyZW4sIGNhbGxiYWNrKTtcbiAqIGVhY2goZWwuY2hpbGROb2RlcywgY2FsbGJhY2spO1xuICogZWFjaCh7fSwgY2FsbGJhY2spO1xuICpcbiAqIEBtb2R1bGUgaGVscGVycy91dGlsL2VhY2guanNcbiAqL1xuZnVuY3Rpb24gZWFjaChsaXN0LCBjYikge1xuXG4gIGlmICghbGlzdCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlmICh0eXBlb2YgY2IgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbnZva2UgYGVhY2hgIHdpdGhvdXQgYSBjYWxsYmFjayEnKTtcbiAgfVxuXG4gIHZhciBpID0gMDtcbiAgdmFyIGxlbiA9IGxpc3QubGVuZ3RoO1xuXG4gIC8vIE9iamVjdFxuICBpZiAobGVuID09PSB1bmRlZmluZWQpIHtcbiAgICBmb3IgKGkgaW4gbGlzdCkge1xuICAgICAgaWYgKGkgIT09ICdwcm90b3R5cGUnICYmIGxpc3QuaGFzT3duUHJvcGVydHkoaSkpIHtcbiAgICAgICAgY2IoaSwgbGlzdFtpXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIC8vIEFycmF5LWxpa2VcbiAgZWxzZSB7XG4gICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGNiKGxpc3RbaV0pO1xuICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gZWFjaDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZWFjaC5qcy5tYXBcbiJdfQ=="}