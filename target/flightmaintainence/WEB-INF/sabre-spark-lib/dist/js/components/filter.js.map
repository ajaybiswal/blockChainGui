{"version":3,"sources":["js/dist/components/node_modules/browser-pack/_prelude.js","js/dist/components/js/dist/components/base.js","js/dist/components/js/dist/components/expand.js","js/dist/components/js/dist/components/filter-module.js","js/dist/components/js/dist/components/filter.js","js/dist/components/js/dist/components/modal.js","js/dist/components/js/dist/helpers/animation/height.js","js/dist/components/js/dist/helpers/dom/add-class.js","js/dist/components/js/dist/helpers/dom/breakpoint.js","js/dist/components/js/dist/helpers/dom/has-class.js","js/dist/components/js/dist/helpers/dom/outer-height.js","js/dist/components/js/dist/helpers/dom/remove-class.js","js/dist/components/js/dist/helpers/dom/toggle-class.js","js/dist/components/js/dist/helpers/traversal/get-parent.js","js/dist/components/js/dist/helpers/traversal/matches.js","js/dist/components/js/dist/helpers/util/each.js","js/dist/components/js/dist/helpers/util/trim.js"],"names":[],"mappings":"AAAA;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9RA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/yBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3VA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"filter.js","sourcesContent":["(function(){function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}return e})()","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../helpers/util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } } /**\n                                                                                                                                                           * # Base Component\n                                                                                                                                                           * The base class for Spark JS components. This class should never be\n                                                                                                                                                           * instantiated directly.\n                                                                                                                                                           *\n                                                                                                                                                           * @param {Element} el\n                                                                                                                                                           * @param {Object} params\n                                                                                                                                                           *\n                                                                                                                                                           * @module components/base.js\n                                                                                                                                                           */\n\nvar noop = function noop() {};\n\nvar Base = function () {\n\n  /**\n   * Set parameters and cache elements.\n   */\n  function Base(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Base);\n\n    if (params.elRequired && !el) {\n      return;\n    }\n\n    this.setParams(this.defaults || {}, true);\n    this.setParams(params);\n    (this._cacheElements || noop).call(this, el, params);\n    (this._parseParams || noop).call(this);\n  }\n\n  /**\n   * Remove the component from the DOM and prepare for garbage collection by dereferencing values.\n   * @param {Boolean} leaveElement Leave the element intact.\n   */\n\n\n  Base.prototype.remove = function remove(leaveElement) {\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    if (!leaveElement && this.el && this.el.parentNode) {\n      this.el.parentNode.removeChild(this.el);\n    }\n\n    this.unsetParams(this.defaults);\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params Optional\n   */\n\n\n  Base.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    if (this._removeEventListeners) {\n      this._removeEventListeners();\n    }\n\n    (this._cacheElements || noop).call(this, el || this.el, params);\n    (this._parseParams || noop).call(this);\n\n    if (this._addEventListeners) {\n      this._addEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Set a hash of parameters if they're whitelisted or we're told to force the set.\n   * This is used to set initial values as well as set passed parameters.\n   * @param {Object} params\n   * @param {Boolean} force Force setting even if the param is not whitelisted.\n   */\n\n\n  Base.prototype.setParams = function setParams(params, force) {\n    var _this = this;\n\n    (0, _each2.default)(params, function (k, v) {\n      if (_this._whitelistedParams.indexOf(k) !== -1 || force) {\n        _this[k] = v;\n      }\n    });\n\n    return this;\n  };\n\n  /**\n   * Unset all parameters.\n   * @param {Array|Object} keys\n   * @param {Object} scope The object to unset the params from. Defaults to `this`.\n   */\n\n\n  Base.prototype.unsetParams = function unsetParams(keys, scope) {\n\n    keys = keys instanceof Array ? keys : Object.keys(keys);\n    scope = scope || this;\n    (0, _each2.default)(keys, function (k) {\n      delete scope[k];\n    });\n\n    return this;\n  };\n\n  return Base;\n}();\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nBase.prototype._whitelistedParams = [];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nBase.prototype.defaults = {};\n\nexports.default = Base;\nmodule.exports = exports['default'];\n//# sourceMappingURL=base.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _height = require('../helpers/animation/height');\n\nvar _height2 = _interopRequireDefault(_height);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _getParent = require('../helpers/traversal/get-parent');\n\nvar _getParent2 = _interopRequireDefault(_getParent);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Expand\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Expand and collapse an element.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Expand(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/expand.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nvar Expand = function (_BaseComponent) {\n  _inherits(Expand, _BaseComponent);\n\n  /**\n   * Expand constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Expand(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Expand);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Expand\n   */\n\n\n  Expand.prototype.expand = function expand() {\n\n    (this.onBeforeExpand || noop)();\n\n    (0, _height2.default)({\n      el: this.el,\n      toggleClass: 'expanded',\n      toggleEl: '.spark-expand__content, .spark-panel__content'\n    });\n\n    this.isExpanded = true;\n    this._updateClasses();\n    var e = document.createEvent('Event');\n    e.initEvent('spark.visible-children', true, true);\n    this.el.dispatchEvent(e);\n\n    // If the expand element have input, focus on the first one.\n    if (this.el.querySelector('input')) {\n      this.el.querySelector('input').focus();\n    }\n\n    (this.onAfterExpand || noop)();\n\n    return this;\n  };\n\n  /**\n   * Collapse\n   */\n\n\n  Expand.prototype.collapse = function collapse() {\n\n    (this.onBeforeCollapse || noop)();\n\n    (0, _height2.default)({\n      el: this.el,\n      toggleEl: '.spark-expand__content, .spark-panel__content',\n      toggleValue: 'none',\n      action: 'collapse'\n    });\n\n    this.isExpanded = false;\n    this._updateClasses();\n\n    (this.onAfterCollapse || noop)();\n\n    return this;\n  };\n\n  /**\n   * Toggle the expand state.\n   */\n\n\n  Expand.prototype.toggle = function toggle() {\n    return this[this.isExpanded ? 'collapse' : 'expand']();\n  };\n\n  /**\n   * Store a reference to the element.\n   * @param {Element} el\n   */\n\n\n  Expand.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.isExpanded = (0, _hasClass2.default)(this.el, 'expanded');\n\n    this.accordionHeading = this.el.querySelector('[role=\"heading\"]');\n    this.accordionContent = this.el.querySelector('.spark-panel__content');\n\n    this.panelContent = this.el.querySelector('.spark-expand__content');\n    this.panelCollapsedButton = this.el.querySelector('.spark-expand__hide--expanded');\n    this.panelExpandedButton = this.el.querySelector('.spark-expand__show--expanded');\n  };\n\n  /**\n   * Update classes for the expand or collapse state.\n   */\n\n\n  Expand.prototype._updateClasses = function _updateClasses() {\n    (0, _toggleClass2.default)(this.el, 'expanded', this.isExpanded);\n    this._updateAriaAttributes();\n  };\n\n  /**\n   * Update aria attributes for the expand or collapse state.\n   */\n\n\n  Expand.prototype._updateAriaAttributes = function _updateAriaAttributes() {\n    if (this.isExpanded) {\n      this.accordionHeading ? this.accordionHeading.setAttribute('aria-expanded', 'true') : null;\n      this.accordionContent ? this.accordionContent.setAttribute('aria-hidden', 'false') : null;\n\n      this.panelContent ? this.panelContent.setAttribute('aria-hidden', 'false') : null;\n      this.panelCollapsedButton ? this.panelCollapsedButton.setAttribute('aria-hidden', 'true') : null;\n      this.panelExpandedButton ? this.panelExpandedButton.setAttribute('aria-hidden', 'false') : null;\n    } else {\n      this.accordionHeading ? this.accordionHeading.setAttribute('aria-expanded', 'false') : null;\n      this.accordionContent ? this.accordionContent.setAttribute('aria-hidden', 'true') : null;\n\n      this.panelContent ? this.panelContent.setAttribute('aria-hidden', 'true') : null;\n      this.panelCollapsedButton ? this.panelCollapsedButton.setAttribute('aria-hidden', 'false') : null;\n      this.panelExpandedButton ? this.panelExpandedButton.setAttribute('aria-hidden', 'true') : null;\n    }\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Expand.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onClickBound = this._onClick.bind(this);\n    this._onKeydownBound = this._onKeydown.bind(this);\n  };\n\n  /**\n   * Add event listeners for DOM events.\n   */\n\n\n  Expand.prototype._addEventListeners = function _addEventListeners() {\n    this.el.addEventListener('click', this._onClickBound);\n    this.el.addEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n\n\n  Expand.prototype._removeEventListeners = function _removeEventListeners() {\n    this.el.removeEventListener('click', this._onClickBound);\n    this.el.removeEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * When we are clicked, toggle the expanded state.\n   * @param {Object} e\n   */\n\n\n  Expand.prototype._onClick = function _onClick(e) {\n\n    if (!(0, _getParent2.default)(e.target, '.spark-expand__toggle, [data-role=\"toggle\"], [role=\"heading\"]', this.el)) {\n      return;\n    }\n\n    e.preventDefault();\n    this.toggle();\n  };\n\n  /**\n   * When the space or enter key is pressed on the toggle, toggle!\n   * @param {Object} e\n   */\n\n\n  Expand.prototype._onKeydown = function _onKeydown(e) {\n\n    if (!(0, _getParent2.default)(e.target, '.spark-expand__toggle, [data-role=\"toggle\"], [role=\"heading\"]', this.el)) {\n      return;\n    }\n\n    var code = e.keyCode || e.which;\n\n    // Space or enter\n    if (code === 32 || code === 13) {\n      e.preventDefault();\n      this.toggle();\n    }\n  };\n\n  return Expand;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nExpand.prototype._whitelistedParams = ['onBeforeExpand', 'onAfterExpand', 'onBeforeCollapse', 'onAfterCollapse'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nExpand.prototype.defaults = {\n  el: null,\n  isExpanded: false,\n  onBeforeExpand: null,\n  onAfterExpand: null,\n  onBeforeCollapse: null,\n  onAfterCollapse: null,\n  _onClickBound: null,\n  _onKeydownBound: null\n};\n\nexports.default = Expand;\nmodule.exports = exports['default'];\n//# sourceMappingURL=expand.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _removeClass = require('../helpers/dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _addClass = require('../helpers/dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _expand = require('./expand');\n\nvar _expand2 = _interopRequireDefault(_expand);\n\nvar _modal = require('./modal');\n\nvar _modal2 = _interopRequireDefault(_modal);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Filter Module\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Module that contains an individual (or related) filters such as checkboxes\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new FilterModule(el, params);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/filter-module.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nvar FilterModule = function (_BaseComponent) {\n  _inherits(FilterModule, _BaseComponent);\n\n  /**\n   * Filter Module constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function FilterModule(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, FilterModule);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Store a reference to the need elements\n   * @param {Element} el\n   */\n\n\n  FilterModule.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this._showAllEl = this.el.querySelector('.spark-filter-module__show-all');\n    if (this._showAllEl) {\n      this._showAllToggleable = this._showAllEl.querySelector('span');\n    }\n\n    this._clearEls = this.el.querySelectorAll('.spark-filter-module__clear');\n    this._hiddenEls = Array.prototype.slice.call(this.el.querySelectorAll('.spark-filter-module--hide'));\n    this._headerEl = this.el.querySelector('.spark-filter-module__header');\n    this._bodyEl = this.el.querySelector('.spark-filter-module__body');\n    this._modalEl = this.el.querySelector('.spark-modal');\n    this._modalSaveBtn = this.el.querySelector('.spark-filter-module__show-all__modal-button');\n    this._modalClasses = [];\n\n    if (this.onShowAll === 'modal') {\n      this.modalInst = new _modal2.default(this._modalEl);\n    }\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  FilterModule.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onShowAllBound = this._onShowAll.bind(this);\n    this._onClearBound = this._onClear.bind(this);\n    this._onCloseModalBound = this._onCloseModal.bind(this);\n  };\n\n  /**\n   * Add event listeners for touchstart and mouse click.\n   */\n\n\n  FilterModule.prototype._addEventListeners = function _addEventListeners() {\n    !this._showAllEl || this._showAllEl.addEventListener('click', this._onShowAllBound);\n    !this._modalSaveBtn || this._modalSaveBtn.addEventListener('click', this._onCloseModalBound);\n\n    for (var i = 0; i < this._clearEls.length; i++) {\n      !this._clearEls[i] || this._clearEls[i].addEventListener('click', this._onClearBound);\n    }\n  };\n\n  /**\n   * Remove event listeners for touchstart and mouse click.\n   */\n\n\n  FilterModule.prototype._removeEventListeners = function _removeEventListeners() {\n    if (this._showAllEl) {\n      this._showAllEl.removeEventListener('click', this._onShowAllBound);\n      this._modalSaveBtn.removeEventListener('click', this._onCloseModalBound);\n\n      for (var i = 0; i < this._clearEls.length; i++) {\n        !this._clearEls[i] || this._clearEls[i].removeEventListener('click', this._onClearBound);\n      }\n    }\n  };\n\n  /**\n   * Show any hidden filters within a module or run provided function if available\n   */\n\n\n  FilterModule.prototype._onShowAll = function _onShowAll() {\n    if (typeof this.onShowAll === 'function') {\n      (this.onShowAll || noop)(this);\n    } else {\n      if (this.onShowAll === 'toggle' || this.onShowAll === 'modal' && this._isExpand) {\n        this._toggleShowAllLabel();\n        this.toggleHiddenContent();\n      } else if (this.onShowAll === 'modal' && !this._isExpand) {\n        this.modalInst.open();\n      }\n\n      (this.onShowAllComplete || noop)();\n    }\n  };\n\n  /**\n   * Toggle Show More label text\n   */\n\n\n  FilterModule.prototype._toggleShowAllLabel = function _toggleShowAllLabel() {\n    this._showAllToggleable.innerHTML = this._showAllToggleable.innerHTML === 'more' ? 'fewer' : 'more';\n  };\n\n  /**\n   * Callback after clicking `Clear` button\n   */\n\n\n  FilterModule.prototype._onClear = function _onClear() {\n    (this.onClear || noop)(this);\n  };\n\n  /**\n   * Callback after clicking `Save` button\n   */\n\n\n  FilterModule.prototype._onCloseModal = function _onCloseModal() {\n    (this.onModalClose || noop)();\n\n    this.modalInst.close();\n  };\n\n  /**\n   * Enable clear button\n   */\n\n\n  FilterModule.prototype.enableClearBtn = function enableClearBtn() {\n    for (var i = 0; i < this._clearEls.length; i++) {\n      (0, _removeClass2.default)(this._clearEls[i], 'spark-filter-module__clear--disabled');\n      (0, _removeClass2.default)(this._clearEls[i], 'spark-filter-module__clear--hidden');\n    }\n  };\n\n  /**\n   * Disable clear button\n   */\n\n\n  FilterModule.prototype.disableClearBtn = function disableClearBtn() {\n    for (var i = 0; i < this._clearEls.length; i++) {\n      (0, _addClass2.default)(this._clearEls[i], 'spark-filter-module__clear--disabled');\n    }\n  };\n\n  /**\n   * Hide clear button\n   */\n\n\n  FilterModule.prototype.hideClearBtn = function hideClearBtn() {\n    for (var i = 0; i < this._clearEls.length; i++) {\n      (0, _addClass2.default)(this._clearEls[i], 'spark-filter-module__clear--hidden');\n    }\n  };\n\n  /**\n   * Determine if Clear button is hidden or disabled\n   */\n\n\n  FilterModule.prototype.getClearButtonStatus = function getClearButtonStatus() {\n    var buttonEnabled = false;\n\n    for (var i = 0; i < this._clearEls.length; i++) {\n      if ((0, _hasClass2.default)(this._clearEls[i], 'spark-filter-module__clear--hidden') || (0, _hasClass2.default)(this._clearEls[i], 'spark-filter-module__clear--disabled')) {\n        buttonEnabled = false;\n      } else {\n        buttonEnabled = true;\n      }\n    }\n\n    return buttonEnabled;\n  };\n\n  /**\n   * Hide or show extra filters elements as triggered by Show more/fewer\n   */\n\n\n  FilterModule.prototype.toggleHiddenContent = function toggleHiddenContent() {\n    for (var i = 0; i < this._hiddenEls.length; i++) {\n      (0, _toggleClass2.default)(this._hiddenEls[i], 'show');\n    }\n  };\n\n  /**\n   * Change filter-module to expand/collapse variation\n   * This occurs when the filter is at the xs breakpoint\n   */\n\n\n  FilterModule.prototype._applyExpand = function _applyExpand() {\n    if (this._modalEl) {\n      var modalClsNames = ['spark-filter-module--hide', '', '', ''];\n\n      this._hiddenEls.push(this._modalEl);\n      var curEl = this._modalEl;\n\n      for (var i = 0; i < modalClsNames.length; i++) {\n        this._modalClasses[i] = curEl.className;\n        curEl.className = modalClsNames[i];\n        curEl = curEl.firstElementChild;\n      }\n\n      if ((0, _hasClass2.default)(document.body, 'spark-modal-open')) {\n        (0, _removeClass2.default)(document.body, 'spark-modal-open');\n      }\n\n      this.modalInst.remove(true);\n    }\n\n    (0, _addClass2.default)(this.el, 'spark-panel', 'spark-panel--expand');\n    (0, _addClass2.default)(this._headerEl, 'spark-panel__header');\n    this._headerEl.setAttribute('role', 'heading');\n    this._headerEl.setAttribute('tabindex', '0');\n    (0, _addClass2.default)(this._bodyEl, 'spark-panel__content');\n\n    this._expandInst = new _expand2.default(this.el, {\n      onAfterExpand: this.onAfterExpand,\n      onAfterCollapse: this.onAfterCollapse\n    });\n\n    this._isExpand = true;\n  };\n\n  /**\n   * Change filter-module from expand/collapse to horizontal variation\n   */\n\n\n  FilterModule.prototype._disapplyExpand = function _disapplyExpand() {\n    if (this._modalEl) {\n\n      if ((0, _hasClass2.default)(this._modalEl, 'show')) {\n        this._toggleShowAllLabel();\n      }\n\n      this._hiddenEls.pop();\n      var curEl = this._modalEl;\n\n      for (var i = 0; i < this._modalClasses.length; i++) {\n        curEl.className = this._modalClasses[i];\n        curEl = curEl.firstElementChild;\n      }\n\n      this.modalInst = new _modal2.default(this._modalEl);\n    }\n\n    (0, _removeClass2.default)(this.el, 'spark-panel', 'spark-panel--expand');\n    (0, _removeClass2.default)(this._headerEl, 'spark-panel__header');\n    this._headerEl.removeAttribute('role');\n    this._headerEl.removeAttribute('tabindex');\n    (0, _removeClass2.default)(this._bodyEl, 'spark-panel__content');\n    this._expandInst.remove(true);\n    this._isExpand = false;\n  };\n\n  return FilterModule;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nFilterModule.prototype._whitelistedParams = ['onShowAll', 'onShowAllComplete', 'onModalClose', 'onClear', 'onAfterExpand', 'onAfterCollapse'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nFilterModule.prototype.defaults = {\n  el: null,\n  onShowAll: noop,\n  onShowAllComplete: noop,\n  onModalClose: noop,\n  onClear: noop,\n  onAfterExpand: noop,\n  onAfterCollapse: noop,\n  modalInst: null,\n  _onShowAllBound: null,\n  _onClearBound: null,\n  _showAllEl: null,\n  _clearEl: null,\n  _hiddenEls: [],\n  _headerEl: null,\n  _bodyEl: null,\n  _modalEl: null,\n  _expandInst: null,\n  _isExpand: false,\n  dataSet: {}\n};\n\nexports.default = FilterModule;\nmodule.exports = exports['default'];\n//# sourceMappingURL=filter-module.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _addClass = require('../helpers/dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _removeClass = require('../helpers/dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _filterModule = require('./filter-module');\n\nvar _filterModule2 = _interopRequireDefault(_filterModule);\n\nvar _height = require('../helpers/animation/height');\n\nvar _height2 = _interopRequireDefault(_height);\n\nvar _breakpoint = require('../helpers/dom/breakpoint');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Filter\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * A container for a set of form fields used to filter a data set or search results\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Filter(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/filter.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar noop = function noop() {};\n\nvar Filter = function (_BaseComponent) {\n  _inherits(Filter, _BaseComponent);\n\n  /**\n   * Filter constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Filter(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Filter);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n    _this._initFilterDisplay();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Store a reference to the needed elements\n   * @param {Element} el\n   */\n\n\n  Filter.prototype._cacheElements = function _cacheElements(el) {\n    this.el = el;\n    this.moduleEls = this.el.querySelectorAll('.spark-filter-module');\n\n    // These options are here so that the modules can communicate with the filter to do certain tasks\n    var defaultOption = {\n      onAfterExpand: this._onAfterExpand.bind(this),\n      onAfterCollapse: this._onAfterCollapse.bind(this)\n      //onShowAllComplete: this._onShowAllComplete.bind(this),\n    };\n\n    if (this.moduleEls.length > 0) {\n      for (var i = 0; i < this.moduleEls.length; i++) {\n        if (typeof this.moduleOptions[i] !== 'undefined') {\n          for (var key in defaultOption) {\n            this.moduleOptions[i][key] = defaultOption[key];\n          }\n          this.moduleInsts[i] = new _filterModule2.default(this.moduleEls[i], this.moduleOptions[i]);\n        } else {\n          this.moduleInsts[i] = new _filterModule2.default(this.moduleEls[i], defaultOption);\n        }\n      }\n    }\n\n    this._filterToggleContainer = this.el.querySelector('.spark-filter__toggle-container');\n    this._toggleFilterButton = this.el.querySelector('.spark-filter__toggle-button');\n    this._toggleFilterLabel = this.el.querySelector('.spark-filter__toggle-button span');\n    this._tagsContainer = this.el.querySelector('.spark-filter__tags-container');\n    this._tagsCounter = this.el.querySelector('.spark-filter__applied-filters-counter');\n    this._clearAllButton = this.el.querySelector('.spark-filter__clear-all');\n    this._filterContent = this.el.querySelector('.spark-filter__content');\n    this._modulesContainer = this.el.querySelector('.spark-filter__modules-container');\n    this._viewMoreButton = this.el.querySelector('.spark-filter__view-more-filters');\n    this._viewLessButton = this.el.querySelector('.spark-filter__view-less-filters');\n    this._filterFooter = this.el.querySelector('.spark-filter__footer');\n    this._buttonGroupEl = this.el.querySelector('.spark-filter__apply-btn-container');\n    this._applyFiltersButton = this.el.querySelector('.spark-filter__btn-apply');\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Filter.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onResizeBound = this._onResize.bind(this);\n    this._toggleViewBound = this._toggleView.bind(this);\n    this._toggleFilterClickBound = this.toggleFilterClick.bind(this);\n    this._onClearAllBound = this._onClearAll.bind(this);\n    this._onScrollBound = this._onScroll.bind(this);\n  };\n\n  /**\n   * Add event listeners\n   */\n\n\n  Filter.prototype._addEventListeners = function _addEventListeners() {\n    window.addEventListener('resize', this._onResizeBound);\n    window.addEventListener('scroll', this._onScrollBound);\n    !this._viewMoreButton || this._viewMoreButton.addEventListener('click', this._toggleViewBound);\n    !this._viewLessButton || this._viewLessButton.addEventListener('click', this._toggleViewBound);\n    !this._toggleFilterButton || this._toggleFilterButton.addEventListener('click', this._toggleFilterClickBound);\n    !this._clearAllButton || this._clearAllButton.addEventListener('click', this._onClearAllBound);\n  };\n\n  /**\n   * Remove event listeners\n   */\n\n\n  Filter.prototype._removeEventListeners = function _removeEventListeners() {\n    window.removeEventListener('resize', this._onResizeBound);\n    window.removeEventListener('scroll', this._onScrollBound);\n    !this._viewMoreButton || this._viewMoreButton.removeEventListener('click', this._toggleViewBound);\n    !this._viewLessButton || this._viewLessButton.removeEventListener('click', this._toggleViewBound);\n    !this._toggleFilterButton || this._toggleFilterButton.removeEventListener('click', this._toggleFilterClickBound);\n    !this._clearAllButton || this._clearAllButton.removeEventListener('click', this._onClearAllBound);\n  };\n\n  /**\n   * Initialize filter\n   */\n\n\n  Filter.prototype._initFilterDisplay = function _initFilterDisplay() {\n    this.initializingFilter = true;\n\n    if (this.moduleEls.length > 0) {\n      this.extraModulesExpanded = false;\n    }\n\n    (0, _addClass2.default)(this.el, 'spark-filter--initializing');\n\n    this._determineFilterLayout();\n  };\n\n  /**\n   * Determine which filter layout should be displayed i.e. Expand/Collapse view or Wide view\n   */\n\n\n  Filter.prototype._determineFilterLayout = function _determineFilterLayout() {\n    this.currentBreakpoint = (0, _breakpoint.get)(window.innerWidth);\n\n    switch (this.currentBreakpoint) {\n      case 'xs':\n        this._curCol = 1;\n        break;\n      case 'sm':\n        this._curCol = 2;\n        break;\n      case 'md':\n        this._curCol = 3;\n        break;\n      default:\n        this._curCol = 4;\n        break;\n    }\n\n    if (this._curCol <= 1) {\n      // Display expand-collapse filter\n      if (!this._isDropdownState) {\n        this._applyExpandCollapseLayout();\n        this._showModule();\n      }\n    } else {\n      // Display wide-screen filter\n      if (this._expandCollapseState) {\n        this._removeExpandCollapseLayout();\n      }\n\n      if ((0, _hasClass2.default)(this._buttonGroupEl, 'is-fixed')) {\n        clearTimeout(this._timeout);\n        this._filterFooter.removeAttribute('style');\n        this._buttonGroupEl.removeAttribute('style');\n        (0, _removeClass2.default)(this._buttonGroupEl, 'is-fixed');\n      }\n\n      this._showModule();\n\n      if (!this.extraModulesExpanded) {\n        this._hideModule(this._curCol, this._maxCol - 1);\n      }\n    }\n\n    // Determine whether to show or hide View More/Less buttons\n    if (!this._isDropdownState) {\n      var hiddenModules = document.querySelectorAll('.spark-filter-module.hide');\n\n      if (!this.extraModulesExpanded && hiddenModules.length === 0) {\n        (0, _addClass2.default)(this._viewMoreButton, 'hide');\n      } else if (!this.extraModulesExpanded && hiddenModules.length > 0) {\n        (0, _removeClass2.default)(this._viewMoreButton, 'hide');\n      }\n    }\n  };\n\n  /**\n   * Update the filter layout as necessary\n   */\n\n\n  Filter.prototype._updateFilterLayout = function _updateFilterLayout() {\n    this._determineFilterLayout();\n  };\n\n  /**\n   * Expand or collapse extra filters\n   */\n\n\n  Filter.prototype._toggleView = function _toggleView() {\n    if (this._isFilterExpanded && !this.extraModulesExpanded) {\n      this._showModule();\n      this._dispatchVisibilityEvent();\n    } else if (this._isFilterExpanded && this.extraModulesExpanded) {\n      this._hideModule(this._curCol, this._maxCol - 1);\n    }\n\n    this.extraModulesExpanded = !this.extraModulesExpanded;\n    (0, _toggleClass2.default)(this._viewMoreButton, 'hide');\n    (0, _toggleClass2.default)(this._viewLessButton, 'hide');\n  };\n\n  /**\n   * Handle click event when filter toggles are clicked\n   */\n\n\n  Filter.prototype.toggleFilterClick = function toggleFilterClick() {\n    if (this.initializingFilter) {\n      this.initializingFilter = false;\n    }\n\n    this.toggleFilter();\n  };\n\n  /**\n   * To hide or show filter module\n   * @params {String} toggle; collapse; expand;\n   * @params {Boolean} Change the value of `this._isFilterExpanded` based on the boolean value\n   */\n\n\n  Filter.prototype.toggleFilter = function toggleFilter(option, noStateChange) {\n    if ((0, _hasClass2.default)(this.el, 'spark-filter--initializing') && !this.initializingFilter) {\n      (0, _removeClass2.default)(this.el, 'spark-filter--initializing');\n      (0, _addClass2.default)(this.el, 'spark-filter--initialized');\n    }\n\n    if (option === 'expand') {\n      if (!this.initializingFilter) {\n        (0, _removeClass2.default)(this._filterContent, 'hide');\n\n        (0, _height2.default)({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'expand'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Hide';\n      } else {\n        (0, _removeClass2.default)(this._filterContent, 'hide');\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = true;\n      }\n    } else if (option === 'collapse') {\n      if (!this.initializingFilter) {\n        (0, _addClass2.default)(this._filterContent, 'hide');\n\n        (0, _height2.default)({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'collapse'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Show';\n      } else {\n        (0, _addClass2.default)(this._filterContent, 'hide');\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = false;\n      }\n    } else {\n      (0, _toggleClass2.default)(this._filterContent, 'hide');\n\n      if ((0, _hasClass2.default)(this.el, 'filter-expanded')) {\n        (0, _height2.default)({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'collapse'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Show';\n      } else {\n        (0, _height2.default)({\n          el: this.el,\n          toggleEl: '.spark-filter__content',\n          toggleClass: 'filter-expanded',\n          action: 'expand'\n        });\n\n        this._toggleFilterLabel.innerHTML = 'Hide';\n      }\n\n      if (!noStateChange) {\n        this._isFilterExpanded = !this._isFilterExpanded;\n\n        if ((0, _hasClass2.default)(this.el, 'spark-filter--dropdown') && !(0, _hasClass2.default)(this._filterContent, 'hide')) {\n          this._calculateApplyBtnPosition();\n        }\n      }\n    }\n\n    if (!(0, _hasClass2.default)(this.el, 'spark-filter--dropdown') && (0, _hasClass2.default)(this._buttonGroupEl, 'is-fixed')) {\n      clearTimeout(this._timeout);\n      this._filterFooter.removeAttribute('style');\n      this._buttonGroupEl.removeAttribute('style');\n      (0, _removeClass2.default)(this._buttonGroupEl, 'is-fixed');\n    }\n\n    this._dispatchVisibilityEvent();\n  };\n\n  /**\n   * On-resize handler that updates layout as needed based on screen dimensions\n   */\n\n\n  Filter.prototype._onResize = function _onResize() {\n    this._updateFilterLayout();\n  };\n\n  /**\n   * On-scroll handler that determines Apply button positioning at the xs breakpoint\n   */\n\n\n  Filter.prototype._onScroll = function _onScroll() {\n    if (this._isDropdownState) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  };\n\n  /**\n   * Callback triggered after the expansion of a module at the xs breakpoint\n   */\n\n\n  Filter.prototype._onAfterExpand = function _onAfterExpand() {\n    if (!(0, _hasClass2.default)(this._buttonGroupEl, 'is-fixed')) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  };\n\n  /**\n   * Callback triggered after the collapse of a module at the xs breakpoint\n   */\n\n\n  Filter.prototype._onAfterCollapse = function _onAfterCollapse() {\n    this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n  };\n\n  /**\n   * Callback triggered after Show all is complete at the xs breakpoint\n   */\n\n  /* TODO: This is not required anymore as show all is not available at the xs breakpoint anymore\n  _onShowAllComplete() {\n    if(this._isDropdownState) {\n      this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n    }\n  }\n  */\n\n  /**\n   * Dispatch a custom event so content inside the Filter can respond\n   */\n\n\n  Filter.prototype._dispatchVisibilityEvent = function _dispatchVisibilityEvent() {\n    var e = document.createEvent('Event');\n    e.initEvent('spark.visible-children', true, true);\n    this.el.dispatchEvent(e);\n  };\n\n  /**\n   * Calculate the position of the Apply button at the xs breakpoint\n   */\n\n\n  Filter.prototype._calculateApplyBtnPosition = function _calculateApplyBtnPosition() {\n\n    var filterOffsets = this.el.getBoundingClientRect();\n\n    if (filterOffsets.height > 255) {\n      // 3 collapsed module heights + filter header height = 255\n      var windowHeight = window.innerHeight;\n      var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0;\n      var filterHiddenBefore = scrollTop - (filterOffsets.top + document.body.scrollTop);\n      var filterHiddenAfter = filterOffsets.top + document.body.scrollTop + filterOffsets.height - (scrollTop + windowHeight);\n\n      if (!(scrollTop > filterOffsets.top + document.body.scrollTop + filterOffsets.height || filterOffsets.top + document.body.scrollTop > scrollTop + window.innerHeight)) {\n        var percentInView = 100;\n        var inViewport;\n        var hiddenBefore = 0;\n        var hiddenAfter = 0;\n\n        if (filterHiddenBefore > 0) {\n          percentInView -= filterHiddenBefore * 100 / filterOffsets.height;\n          hiddenBefore = filterHiddenBefore;\n        }\n\n        if (filterHiddenAfter > 0) {\n          percentInView -= filterHiddenAfter * 100 / filterOffsets.height;\n          hiddenAfter = filterHiddenAfter;\n        }\n\n        inViewport = (filterOffsets.height - (hiddenAfter + hiddenBefore)) / windowHeight * 100;\n      }\n\n      if (filterOffsets.bottom > (window.innerHeight || document.documentElement.clientHeight) && (percentInView > 45 || inViewport > 50)) {\n        var buttonGroupHeight = this._buttonGroupEl.offsetHeight;\n        var filterWidth = filterOffsets.width;\n\n        this._filterFooter.style.height = buttonGroupHeight + 'px';\n        (0, _addClass2.default)(this._buttonGroupEl, 'is-fixed');\n        this._buttonGroupEl.style.width = filterWidth - 2 + 'px'; // accounting for border width\n        this._buttonGroupEl.style.left = filterOffsets.left + 1 + 'px'; // accounting for left border\n\n        this._applyBtnPositionFixed();\n      } else {\n        this._applyBtnPositionRelative();\n      }\n    }\n  };\n\n  /**\n   * Set position:relative for the Apply button\n   */\n\n\n  Filter.prototype._applyBtnPositionRelative = function _applyBtnPositionRelative() {\n\n    //function attachApplyBtn(){\n    var currentButtonPosition = parseInt(getComputedStyle(this._buttonGroupEl).bottom);\n    var listBottom = this._modulesContainer.getBoundingClientRect().bottom;\n    var viewportHeight = window.innerHeight || document.documentElement.clientHeight;\n    var buttonGroupHeight = this._buttonGroupEl.getBoundingClientRect().height;\n    var distanceToMove = viewportHeight - (listBottom + buttonGroupHeight);\n\n    if (!isNaN(currentButtonPosition)) {\n      var animationListener = function animationListener() {\n        this._filterFooter.removeAttribute('style');\n        this._buttonGroupEl.removeAttribute('style');\n        (0, _removeClass2.default)(this._buttonGroupEl, 'is-fixed');\n        (0, _removeClass2.default)(this._buttonGroupEl, 'spark-filter__apply-btn-container--animate');\n        this._buttonGroupEl.removeEventListener('animationend', animationListener);\n      };\n\n      this._buttonGroupEl.addEventListener('animationend', animationListener.bind(this), false);\n\n      var keyframe = '-webkit-transform: translateY(-' + distanceToMove + 'px); transform: translateY(-' + distanceToMove + 'px);';\n\n      this._buttonGroupEl.setAttribute('style', this._buttonGroupEl.getAttribute('style') + ' ' + keyframe);\n      (0, _addClass2.default)(this._buttonGroupEl, 'spark-filter__apply-btn-container--animate');\n    }\n  };\n\n  /**\n   * Set position:fixed for the Apply button\n   */\n\n\n  Filter.prototype._applyBtnPositionFixed = function _applyBtnPositionFixed() {\n    var requestID = requestAnimationFrame(moveApplyBtn.bind(this));\n    var incrementer = .1;\n\n    function moveApplyBtn() {\n      incrementer += .01;\n      var currentButtonPosition = parseInt(getComputedStyle(this._buttonGroupEl).bottom);\n      var buttonHeight = parseInt(getComputedStyle(this._buttonGroupEl).height);\n\n      if (currentButtonPosition < buttonHeight * -1) {\n        currentButtonPosition = buttonHeight * -1;\n      }\n\n      if (currentButtonPosition > -1) {\n        this._buttonGroupEl.style.bottom = '0px';\n        cancelAnimationFrame(requestID);\n      } else if (currentButtonPosition < 0) {\n        currentButtonPosition += 1 / incrementer;\n        this._buttonGroupEl.style.bottom = currentButtonPosition + 'px';\n        requestAnimationFrame(moveApplyBtn.bind(this));\n      }\n    }\n  };\n\n  /**\n   * Callback for Clear all\n   */\n\n\n  Filter.prototype._onClearAll = function _onClearAll() {\n    (this.onClearAll || noop)();\n  };\n\n  /**\n   * Show all modules\n   */\n\n\n  Filter.prototype._showModule = function _showModule() {\n    for (var i = 0; i < this.moduleEls.length; i++) {\n      (0, _removeClass2.default)(this.moduleEls[i], 'hide');\n    }\n  };\n\n  /**\n   * Hide certain modules\n   * @param {Number} start index\n   * @param {Number} end index\n   */\n\n\n  Filter.prototype._hideModule = function _hideModule(start, end) {\n    end = end || this.moduleEls.length - 1;\n    for (var i = start; i <= end; i++) {\n      (0, _addClass2.default)(this.moduleEls[i], 'hide');\n    }\n  };\n\n  /**\n   * Apply Expand/Collapse layout for the filter\n   * Used when the filter gets to the xs breakpoint\n   */\n\n\n  Filter.prototype._applyExpandCollapseLayout = function _applyExpandCollapseLayout() {\n    (0, _addClass2.default)(this.el, 'spark-filter--dropdown');\n    this._expandCollapseState = true;\n\n    var tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    if (tags.length > 0) {\n      for (var i = 0; i < tags.length; i++) {\n        (0, _addClass2.default)(tags[i], 'hide');\n      }\n      (0, _removeClass2.default)(this._tagsCounter, 'hide');\n    }\n\n    (0, _addClass2.default)(this._viewMoreButton, 'hide');\n    (0, _addClass2.default)(this._viewLessButton, 'hide');\n\n    if (this._applyFiltersButton) {\n      (0, _removeClass2.default)(this._applyFiltersButton, 'spark-btn--sm');\n      (0, _addClass2.default)(this._applyFiltersButton, 'spark-btn--block');\n    }\n\n    for (var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._applyExpand();\n    }\n\n    this._isDropdownState = true;\n    this._timeout = setTimeout(this._calculateApplyBtnPosition.bind(this), 300);\n  };\n\n  /**\n   * Remove Expand/Collapse layout and apply the horizontal layout for the filter\n   * Used when the screen size is larger than the xs breakpoint\n   */\n\n\n  Filter.prototype._removeExpandCollapseLayout = function _removeExpandCollapseLayout() {\n\n    (0, _removeClass2.default)(this.el, 'spark-filter--dropdown');\n    this._expandCollapseState = false;\n    this._filterFooter.removeAttribute('style');\n    this._buttonGroupEl.removeAttribute('style');\n    (0, _removeClass2.default)(this._buttonGroupEl, 'is-fixed');\n\n    var tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    if (tags.length > 0) {\n      for (var i = 0; i < tags.length; i++) {\n        (0, _removeClass2.default)(tags[i], 'hide');\n      }\n      (0, _addClass2.default)(this._tagsCounter, 'hide');\n    }\n\n    if (this.extraModulesExpanded) {\n      (0, _removeClass2.default)(this._viewLessButton, 'hide');\n    } else {\n      (0, _removeClass2.default)(this._viewMoreButton, 'hide');\n    }\n\n    if (this._applyFiltersButton) {\n      (0, _addClass2.default)(this._applyFiltersButton, 'spark-btn--sm');\n      (0, _removeClass2.default)(this._applyFiltersButton, 'spark-btn--block');\n    }\n\n    for (var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._disapplyExpand();\n    }\n    this._isDropdownState = false;\n  };\n\n  /**\n   * Generate a tag element in filter, which will be directly posted inside `.spark-filter__tags-container`\n   * @param {string} input name - Name of the input to allow any callbacks to target input specifically\n   * @param {string} tag label - The label to be displayed in the tag. This could be the input's label or another user defined label\n   * @param {function} callback function for `X` button\n   */\n\n\n  Filter.prototype.createTagEl = function createTagEl(input, label, clearCallback) {\n    var tagEl = document.createElement('div');\n    tagEl.className = (0, _hasClass2.default)(this.el, 'spark-filter--dropdown') ? 'spark-filter__tag hide' : 'spark-filter__tag';\n    tagEl.setAttribute('data-filter-name', input);\n    tagEl.innerHTML = '<span class=\"spark-filter__tag__label\">' + label + '</span><i class=\"spark-icon spark-filter__tag__close\"></i>';\n\n    this._tagsContainer.insertBefore(tagEl, this._clearAllButton);\n\n    // create event listener after adding element to DOM\n    tagEl.querySelector('.spark-filter__tag__close').addEventListener('click', clearCallback || noop);\n\n    (0, _removeClass2.default)(this._clearAllButton, 'hide');\n\n    // Show tag count if on small screen and this is initial application of filters\n    if ((0, _hasClass2.default)(this.el, 'spark-filter--dropdown')) (0, _removeClass2.default)(this._tagsCounter, 'hide');\n  };\n\n  /**\n   * Remove all tags\n   */\n\n\n  Filter.prototype.clearAllTagEls = function clearAllTagEls() {\n    var tags = this._tagsContainer.querySelectorAll('.spark-filter__tag');\n    for (var i = 0; i < tags.length; i++) {\n      this._tagsContainer.removeChild(tags[i]);\n    }\n\n    // Reset counter\n    var counter = this._tagsContainer.querySelector('span');\n    counter.innerHTML = '0';\n\n    (0, _addClass2.default)(this._clearAllButton, 'hide');\n    (0, _addClass2.default)(this._tagsCounter, 'hide');\n  };\n\n  /**\n   * Show Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n\n\n  Filter.prototype.showModuleClearButton = function showModuleClearButton(moduleName) {\n    for (var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        this.moduleInsts[i].enableClearBtn();\n      }\n    }\n  };\n\n  /**\n   * Disable Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n\n\n  Filter.prototype.disableModuleClearButton = function disableModuleClearButton(moduleName) {\n    for (var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        this.moduleInsts[i].disableClearBtn();\n      }\n    }\n  };\n\n  /**\n   * Hide Module Clear Button\n   * @param {Element} moduleName An identifier for the module being targeted\n   */\n\n\n  Filter.prototype.hideModuleClearButton = function hideModuleClearButton(moduleName) {\n    for (var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        this.moduleInsts[i].hideClearBtn();\n      }\n    }\n  };\n\n  /**\n   * Get Module Clear button status\n   *  @param {Element} moduleName An identifier for the module being targeted\n   */\n\n\n  Filter.prototype.moduleClearButtonStatus = function moduleClearButtonStatus(moduleName) {\n    for (var i = 0; i < this.moduleInsts.length; i++) {\n      if (this.moduleInsts[i].el.getAttribute('data-filter-module') === moduleName) {\n        return this.moduleInsts[i].getClearButtonStatus();\n      }\n    }\n  };\n\n  return Filter;\n}(_base2.default);\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\n\n\nFilter.prototype._whitelistedParams = ['onClearAll', 'moduleOptions'];\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nFilter.prototype.defaults = {\n  el: null,\n  moduleEls: [],\n  _filterToggleContainer: null,\n  _toggleFilterButton: null,\n  _toggleFilterLabel: null,\n  _tagsContainer: null,\n  _tagsCounter: null,\n  _clearAllButton: null,\n  _filterContent: null,\n  _modulesContainer: null,\n  _viewMoreButton: null,\n  _viewLessButton: null,\n  _filterFooter: null,\n  _buttonGroupEl: null,\n  _applyFiltersButton: null,\n  moduleInsts: [],\n  moduleOptions: [],\n  maxCol: 4,\n  onClearAll: noop,\n  extraModulesExpanded: false,\n  _isFilterExpanded: false,\n  _isDropdownState: false,\n  _isModuleExpand: true,\n  _curCol: 4,\n  _onResizeBound: null,\n  _toggleViewBound: null,\n  _toggleFilterClickBound: null,\n  _onClearAllBound: null,\n  _onScrollBound: null\n};\n\nexports.default = Filter;\nmodule.exports = exports['default'];\n//# sourceMappingURL=filter.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _base = require('./base');\n\nvar _base2 = _interopRequireDefault(_base);\n\nvar _toggleClass = require('../helpers/dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nvar _addClass = require('../helpers/dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('../helpers/dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _hasClass = require('../helpers/dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _getParent = require('../helpers/traversal/get-parent');\n\nvar _getParent2 = _interopRequireDefault(_getParent);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; } /**\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * # Modal\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * Show content in a modal.\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @example\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * new Modal(el);\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                *\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                * @module components/modal.js\n                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                */\n\n\nvar Modal = function (_BaseComponent) {\n  _inherits(Modal, _BaseComponent);\n\n  /**\n   * Modal constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  function Modal(el) {\n    var _this;\n\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    _classCallCheck(this, Modal);\n\n    params.elRequired = true;\n\n    if (!(_this = _possibleConstructorReturn(this, _BaseComponent.call(this, el, params)), _this)) {\n      return _possibleConstructorReturn(_this);\n    }\n\n    _this._bindEventListenerCallbacks();\n    _this._addEventListeners();\n    return _possibleConstructorReturn(_this);\n  }\n\n  /**\n   * Open\n   */\n\n\n  Modal.prototype.open = function open() {\n\n    this.isActive = true;\n    document.activeElement ? this.focusedElBeforeOpen = document.activeElement : null;\n\n    var modalFocusableEls = this.modalEl.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), [tabindex=\"0\"]');\n    if (modalFocusableEls.length > 0) {\n      this.modalFocusableEls = Array.prototype.slice.call(modalFocusableEls);\n      this.firstModalFocusableEl = this.modalFocusableEls[0];\n      this.lastModalFocusableEl = this.modalFocusableEls[this.modalFocusableEls.length - 1];\n    }\n\n    this._addWindowEventListeners();\n    this._updateClasses();\n    (0, _addClass2.default)(document.body, 'spark-modal-open');\n\n    // Set focus to close button once modal has been displayed\n    if (modalFocusableEls.length > 0) {\n      this.firstModalFocusableEl.focus();\n    }\n\n    return this;\n  };\n\n  /**\n   * Close\n   */\n\n\n  Modal.prototype.close = function close() {\n\n    this.isActive = false;\n    this.focusedElBeforeOpen ? this.focusedElBeforeOpen.focus() : null;\n    this._removeWindowEventListeners();\n    this._updateClasses();\n    (0, _removeClass2.default)(document.body, 'spark-modal-open');\n\n    return this;\n  };\n\n  /**\n   * Update the component to use a new element or reparse from\n   * the existing element.\n   * @param {Element} el Optional\n   * @param {Object} params\n   */\n\n\n  Modal.prototype.update = function update(el) {\n    var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n\n    this._removeEventListeners();\n    this._cacheElements(el || this.el, params);\n    this._addEventListeners();\n    this._updateClasses();\n    this._removeWindowEventListeners();\n\n    if (this.isActive) {\n      this._addWindowEventListeners();\n    }\n\n    return this;\n  };\n\n  /**\n   * Store a reference to the element. Either a modal itself\n   * or a button referencing a modal may be passed.\n   * @param {Element} el\n   * @param {Element} params @optional\n   */\n\n\n  Modal.prototype._cacheElements = function _cacheElements(el, params) {\n\n    var modalPassed = (0, _hasClass2.default)(el, 'spark-modal');\n    var modalEl = params.modalEl;\n\n    if (modalPassed) {\n      this.modalEl = el;\n    } else {\n      this.el = el;\n      this.modalEl = modalEl || document.querySelector(el.getAttribute('data-modal'));\n    }\n\n    this.scrollEl = this.modalEl.querySelector('.spark-modal__scroll') || this.modalEl;\n\n    this.isActive = (0, _hasClass2.default)(this.el || this.modalEl, 'active');\n  };\n\n  /**\n   * Update classes for the open or close state.\n   */\n\n\n  Modal.prototype._updateClasses = function _updateClasses() {\n    (0, _toggleClass2.default)(this.modalEl, 'active', this.isActive);\n  };\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n\n\n  Modal.prototype._bindEventListenerCallbacks = function _bindEventListenerCallbacks() {\n    this._onClickBound = this._onClick.bind(this);\n    this._onKeyupBound = this._onKeyup.bind(this);\n    this._onKeydownBound = this._onKeydown.bind(this);\n    this._onModalClickBound = this._onModalClick.bind(this);\n  };\n\n  /**\n   * Add event listeners for DOM events.\n   */\n\n\n  Modal.prototype._addEventListeners = function _addEventListeners() {\n    if (this.el) this.el.addEventListener('click', this._onClickBound);\n    if (this.modalEl) this.modalEl.addEventListener('click', this._onModalClickBound);\n  };\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n\n\n  Modal.prototype._removeEventListeners = function _removeEventListeners() {\n    if (this.el) this.el.removeEventListener('click', this._onClickBound);\n    if (this.modalEl) this.modalEl.removeEventListener('click', this._onModalClickBound);\n  };\n\n  /**\n   * Add event listeners for DOM events.\n   */\n\n\n  Modal.prototype._addWindowEventListeners = function _addWindowEventListeners() {\n    this._removeWindowEventListeners();\n    window.addEventListener('keyup', this._onKeyupBound);\n    window.addEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n\n\n  Modal.prototype._removeWindowEventListeners = function _removeWindowEventListeners() {\n    window.removeEventListener('keyup', this._onKeyupBound);\n    window.removeEventListener('keydown', this._onKeydownBound);\n  };\n\n  /**\n   * When the button is clicked.\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onClick = function _onClick() {\n    this.open();\n  };\n\n  /**\n   * When we are clicked, toggle the opened state.\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onModalClick = function _onModalClick(e) {\n\n    // The close button is clicked or the actual modal (gray area)\n    if (e.target === this.scrollEl || e.target === this.modalEl || (0, _getParent2.default)(e.target, '.spark-modal__close, .spark-modal__dismiss', this.scrollEl)) {\n      e.preventDefault();\n      this.close();\n    }\n  };\n\n  /**\n   * When tabbing backwards, localize traversal to modal elements only\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onBackwardTab = function _onBackwardTab(e) {\n    if (document.activeElement === this.firstModalFocusableEl) {\n      e.preventDefault();\n      this.lastModalFocusableEl.focus();\n    }\n  };\n\n  /**\n   * When tabbing forwards, localize traversal to modal elements only\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onForwardTab = function _onForwardTab(e) {\n    if (document.activeElement === this.lastModalFocusableEl) {\n      e.preventDefault();\n      this.firstModalFocusableEl.focus();\n    }\n  };\n\n  /**\n   * When a key is pressed on the window and it's an ESC, close the modal.\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onKeyup = function _onKeyup(e) {\n    if (e.keyCode === 27) {\n      this.close();\n    }\n  };\n\n  /**\n   * When a key is pressed and it is the Tab key or Shift+Tab keys, determine whether to adjust focus\n   * @param {Object} e\n   */\n\n\n  Modal.prototype._onKeydown = function _onKeydown(e) {\n    if (e.keyCode === 9) {\n      if (this.modalFocusableEls.length === 1) {\n        e.preventDefault();\n      }\n\n      if (e.shiftKey) {\n        this._onBackwardTab(e);\n      } else {\n        this._onForwardTab(e);\n      }\n    }\n\n    if (e.keyCode === 13) {\n      if (e.target === document.querySelector('.spark-modal__close') || e.target === document.querySelector('.spark-modal__dismiss')) {\n        e.preventDefault();\n        this.close();\n      }\n    }\n  };\n\n  return Modal;\n}(_base2.default);\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\n\n\nModal.prototype.defaults = {\n  el: null,\n  modalEl: null,\n  scrollEl: null,\n  isActive: false,\n  _onClickBound: null,\n  _onKeyupBound: null,\n  _onKeydownBound: null,\n  _onModalClickBound: null\n};\n\nexports.default = Modal;\nmodule.exports = exports['default'];\n//# sourceMappingURL=modal.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _outerHeight = require('../dom/outer-height');\n\nvar _outerHeight2 = _interopRequireDefault(_outerHeight);\n\nvar _addClass = require('../dom/add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('../dom/remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nvar _hasClass = require('../dom/has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _toggleClass = require('../dom/toggle-class');\n\nvar _toggleClass2 = _interopRequireDefault(_toggleClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar noop = function noop() {}; /**\n                                * # Animate Height\n                                * Animate the height of an element since we can't do this w/ pure CSS. Sigh.\n                                *\n                                * @example\n                                * animateHeight({\n                                *   el: ...,\n                                *   toggleEl: ...,\n                                *   // Optional params\n                                *   action: 'collapse'|'expand',\n                                *   heightAnimationClass: 'spark-animate-height',\n                                *   opacityAnimationClass: 'spark-animate-opacity',\n                                *   toggleProperty: 'display'|'overflow'|'visibility',\n                                *   toggleValue: 'block'|'none'|'visible'|'hidden',\n                                *   animationDuration: 250\n                                * });\n                                *\n                                * @module helpers/animation/height.js\n                                */\n\nvar runningAnimations = {\n  els: [],\n  completeCallbacks: []\n};\n\n/**\n * Get the inverse toggle value\n * @param  {String} property\n * @param  {String} originalValue\n * @return {String}\n */\nfunction getInverseToggleValue(el, property, originalValue) {\n\n  // Get the value to toggle to for the given property\n  switch (property) {\n    case 'overflow':\n    case 'visibility':\n      return originalValue === 'visible' ? 'hidden' : 'visible';\n    default:\n      return originalValue === 'block' || originalValue === 'inline-block' ? 'none' : 'block';\n  }\n}\n\n/**\n * When an animation is complete, clean up and run the callback.\n * @param  {Object} params\n */\nfunction onComplete(params) {\n\n  // Reset toggle el visibility\n  if (params.toggleClassName) {\n    (0, _toggleClass2.default)(params.el, params.toggleClassName, !params.collapse);\n  } else {\n    params.toggleEl.style[params.toggleProperty] = '';\n  }\n\n  // Remove the height property\n  params.el.style.height = '';\n  params.toggleEl.style.height = '';\n  params.toggleEl.style.marginBottom = '';\n  params.toggleEl.style.marginTop = '';\n\n  // Remove the spark-animate-height class so the transitions no longer apply\n  (0, _removeClass2.default)(params.el, params.heightAnimationClass);\n  (0, _removeClass2.default)(params.toggleEl, params.heightAnimationClass);\n\n  // Run the callback\n  params.onComplete();\n\n  // Remove the element and callback from their respective arrays\n  var runningIndex = runningAnimations.els.indexOf(params.el);\n  runningAnimations.els.splice(runningIndex, 1);\n  runningAnimations.completeCallbacks.splice(runningIndex, 1);\n}\n\n/**\n * @param {Object} params\n */\nfunction animateHeight(params) {\n\n  params = params || {};\n\n  var el = params.el;\n\n  if (!el) {\n    return;\n  }\n\n  var collapse = params.action && params.action === 'collapse';\n  var heightAnimationClass = params.heightAnimationClass || 'spark-animate-height';\n\n  // Allow for elements to be passed or selector strings\n  var toggleEl = typeof params.toggleEl === 'string' ? el.querySelector(params.toggleEl) : params.toggleEl;\n\n  // No element to be switching with toggling so we can't determine the desired height to animate to.\n  if (!toggleEl || (0, _hasClass2.default)(el, 'spark-no-animate')) {\n    return;\n  }\n\n  var toggleClassName = params.toggleClass;\n\n  // The style property to use when toggling visibility\n  var toggleProperty = params.toggleProperty || 'display';\n  var toggleStyles = window.getComputedStyle(toggleEl);\n  var originalToggleValue = toggleStyles[toggleProperty];\n  var toggleValue = params.toggleValue || getInverseToggleValue(toggleProperty, originalToggleValue);\n\n  // If we are already animating, stop now.\n  var runningIndex = runningAnimations.els.indexOf(el);\n  if (runningIndex !== -1) {\n\n    var completeCallback = runningAnimations.completeCallbacks[runningIndex];\n    if (completeCallback) {\n      clearTimeout(completeCallback);\n    }\n\n    onComplete({\n      el: el,\n      toggleEl: toggleEl,\n      onComplete: params.onComplete || noop,\n      collapse: collapse,\n      toggleProperty: toggleProperty,\n      toggleClassName: toggleClassName,\n      toggleValue: toggleValue,\n      heightAnimationClass: heightAnimationClass\n    });\n  }\n\n  // Store the current height\n  var originalHeight = (0, _outerHeight2.default)(el);\n\n  // Toggle the visible property\n  if (toggleClassName) {\n    (0, _toggleClass2.default)(el, toggleClassName, !collapse);\n  } else {\n    toggleEl.style[toggleProperty] = toggleValue;\n  }\n\n  // When measuring the size for a collapse, we have to wait a tic for it to be\n  // accurate. Not sure why. Ugh.\n  if (collapse) {\n    setTimeout(runAnimation, 0);\n  } else {\n    runAnimation();\n  }\n\n  function runAnimation() {\n\n    // Now that the toggle el is taking up space, get the new height which we will be animating to\n    var targetElHeight = (0, _outerHeight2.default)(el);\n\n    // We need to store the original and target toggle element heights. They differ depending on\n    // whether we are going to expand or collapse.\n    var targetToggleElHeight = void 0;\n    var originalToggleElHeight = void 0;\n\n    // If we are collapsing, reset the toggle style and set it when we're done. Set the height so\n    // that we can animate down to 0 or up to the target height.\n    if (collapse) {\n\n      if (toggleClassName) {\n        (0, _removeClass2.default)(el, toggleClassName);\n      } else {\n        toggleEl.style[toggleProperty] = originalToggleValue;\n      }\n\n      originalToggleElHeight = (0, _outerHeight2.default)(toggleEl, toggleStyles);\n      targetToggleElHeight = 0;\n    } else {\n      targetToggleElHeight = (0, _outerHeight2.default)(toggleEl, toggleStyles);\n      originalToggleElHeight = 0;\n    }\n\n    // Set the original height\n    el.style.height = originalHeight + 'px';\n    toggleEl.style.height = originalToggleElHeight + 'px';\n    toggleEl.style.marginBottom = '0px';\n    toggleEl.style.marginTop = '0px';\n\n    // Add the spark-animate-height class which will setup the transition-property and duration\n    (0, _addClass2.default)(el, heightAnimationClass);\n    (0, _addClass2.default)(toggleEl, heightAnimationClass);\n\n    runningAnimations.els.push(el);\n\n    // We need to wait a tick to toggle the height or else the animation class won't function\n    setTimeout(function () {\n\n      // Set the height to the target height\n      el.style.height = targetElHeight + 'px';\n      toggleEl.style.height = targetToggleElHeight + 'px';\n\n      // Remove inline styles after the animation is complete\n      runningAnimations.completeCallbacks.push(setTimeout(function () {\n        onComplete({\n          el: el,\n          toggleEl: toggleEl,\n          onComplete: params.onComplete || noop,\n          collapse: collapse,\n          toggleProperty: toggleProperty,\n          toggleClassName: toggleClassName,\n          toggleValue: toggleValue,\n          heightAnimationClass: heightAnimationClass\n        });\n      }, params.animationDuration !== undefined ? params.animationDuration : 201));\n    }, 0);\n  }\n}\n\nexports.default = animateHeight;\nmodule.exports = exports['default'];\n//# sourceMappingURL=height.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nvar _hasClass = require('./has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * # Add Class\n * Add a class on an element.\n *\n * @param {Element|Array} el An element or array of elements to update.\n * @param {String} name\n * @return {Element}\n *\n * @module helpers/dom/add-class.js\n */\n\nvar ws = /\\s+/;\nvar cleanup = /\\s{2,}/g;\n\nfunction addClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) {\n      el.classList.add(name[0]);\n    }\n    return el;\n  }\n\n  var toAdd = [];\n  var i = 0;\n  var l = name.length;\n  var item = void 0;\n  var clsName = typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '';\n\n  // see if we have anything to add\n  for (; i < l; i++) {\n    item = name[i];\n    if (item && !(0, _hasClass2.default)(clsName, item)) {\n      toAdd.push(item);\n    }\n  }\n\n  if (toAdd.length) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)((clsName + ' ' + toAdd.join(' ')).replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = addClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=add-class.js.map\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Breakpoint Helpers\n * Find the active breakpoint.\n *\n * @param {Number} width\n *\n * @module helpers/dom/breakpoint.js\n */\n\n/**\n * Breakpoints being used in the CSS.\n * @type {Object}\n */\nvar defaultBreakpoints = {\n  xs: {\n    min: 0,\n    max: 543\n  },\n  sm: {\n    min: 544,\n    max: 795\n  },\n  md: {\n    min: 796,\n    max: 1047\n  },\n  lg: {\n    min: 1048,\n    max: 1799\n  },\n  xl: {\n    min: 1800,\n    max: Infinity\n  }\n};\n\nfunction get(width, breakpoints) {\n\n  breakpoints = breakpoints || defaultBreakpoints;\n\n  var i = void 0;\n\n  for (i in breakpoints) {\n    if (width >= breakpoints[i].min && width <= breakpoints[i].max) {\n      return i;\n    }\n  }\n}\n\nexports.get = get;\n//# sourceMappingURL=breakpoint.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n/**\n * # Has Class\n * See if an element has a class.\n *\n * @param {Element|String} el\n * @param {String} name\n * @return {Boolean}\n *\n * @module helpers/dom/has-class.js\n */\nfunction hasClass(el, name) {\n  var cName = ((typeof el === 'undefined' ? 'undefined' : _typeof(el)) === 'object' ? el.className || el.getAttribute && el.getAttribute('class') || '' : el || '').replace(/[\\t\\r\\n\\f]/g, ' ');\n  return (' ' + cName + ' ').indexOf(' ' + name + ' ') !== -1;\n}\n\nexports.default = hasClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=has-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _each = require('../util/each');\n\nvar _each2 = _interopRequireDefault(_each);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar props = ['marginTop', 'marginBottom', 'borderTop', 'borderBottom']; /**\n                                                                         * # Outer Height\n                                                                         * Get the outer height of an element (including margin and border)\n                                                                         *\n                                                                         * @param {Element} el\n                                                                         * @param {Object} styles Optional Already have computed styles? Pass them in.\n                                                                         *\n                                                                         * @example\n                                                                         * outerHeight(el, computedStyles);\n                                                                         *\n                                                                         * @module helpers/outer-height.js\n                                                                         */\n\n\nfunction outerHeight(el, styles) {\n\n  styles = styles || window.getComputedStyle(el);\n\n  var height = el.clientHeight;\n\n  (0, _each2.default)(props, function (prop) {\n    height += parseInt(styles[prop] || 0, 10);\n  });\n\n  return height;\n}\n\nexports.default = outerHeight;\nmodule.exports = exports['default'];\n//# sourceMappingURL=outer-height.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _trim = require('../util/trim');\n\nvar _trim2 = _interopRequireDefault(_trim);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar ws = /\\s+/; /**\n                 * # Remove Class\n                 * Remove a class on an element.\n                 *\n                 * @param {Element|Array} el An element or array of elements to update.\n                 * @param {String} name\n                 * @return {Element}\n                 *\n                 * @module helpers/dom/remove-class.js\n                 */\n\nvar cleanup = /\\s{2,}/g;\n\nfunction removeClass(el, name) {\n\n  if (arguments.length === 2 && typeof name === 'string') {\n    name = (0, _trim2.default)(name).split(ws);\n  } else {\n    name = name instanceof Array ? name : Array.prototype.slice.call(arguments, 1);\n  }\n\n  // optimize for best, most common case\n  if (name.length === 1 && el.classList) {\n    if (name[0]) el.classList.remove(name[0]);\n    return el;\n  }\n\n  // store two copies\n  var clsName = ' ' + (typeof el.className === 'string' ? el.className : el.getAttribute ? el.getAttribute('class') : '') + ' ';\n  var result = clsName;\n  var current = void 0;\n  var start = void 0;\n  for (var i = 0, l = name.length; i < l; i++) {\n    current = name[i];\n    start = current ? result.indexOf(' ' + current + ' ') : -1;\n    if (start !== -1) {\n      start += 1;\n      result = result.slice(0, start) + result.slice(start + current.length);\n    }\n  }\n\n  // only write if modified\n  if (clsName !== result) {\n    if (typeof el.className === 'string') {\n      el.className = (0, _trim2.default)(result.replace(cleanup, ' '));\n    } else if (el.setAttribute) {\n      el.setAttribute('class', (0, _trim2.default)(result.replace(cleanup, ' ')));\n    }\n  }\n\n  return el;\n}\n\nexports.default = removeClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=remove-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _hasClass = require('./has-class');\n\nvar _hasClass2 = _interopRequireDefault(_hasClass);\n\nvar _addClass = require('./add-class');\n\nvar _addClass2 = _interopRequireDefault(_addClass);\n\nvar _removeClass = require('./remove-class');\n\nvar _removeClass2 = _interopRequireDefault(_removeClass);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction toggleClass(el, name, enable) {\n\n  if (!el) {\n    return;\n  }\n\n  // If we're passed an array, toggle the class on each.\n  if (el instanceof NodeList || el instanceof Array) {\n\n    for (var i = 0, len = el.length; i < len; i++) {\n      toggleClass(el[i], name, enable);\n    }\n\n    return;\n  }\n\n  var action = void 0;\n  if (enable !== undefined) {\n    enable = typeof enable === 'function' ? enable.call(null, el) : enable;\n    action = enable ? 'add' : 'remove';\n  } else {\n    action = (0, _hasClass2.default)(el, name) ? 'remove' : 'add';\n  }\n\n  return (action === 'add' ? _addClass2.default : _removeClass2.default)(el, name);\n} /**\n   * # Toggle Class\n   * Toggle a class on an element given a condition.\n   *\n   * @param {Element|Array} el An element or array of elements to update.\n   * @param {String} name\n   * @param {Boolean} enable\n   * @return {Element}\n   *\n   * @module  helpers/dom/toggle-class.js\n   */\n\nexports.default = toggleClass;\nmodule.exports = exports['default'];\n//# sourceMappingURL=toggle-class.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _matches = require('./matches');\n\nvar _matches2 = _interopRequireDefault(_matches);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction getParent(parent, query, limitEl) {\n\n  limitEl = limitEl instanceof Array ? limitEl : [limitEl || document.body];\n\n  while (parent) {\n\n    if ((0, _matches2.default)(parent, query)) {\n      return parent;\n    }\n\n    if (limitEl.indexOf(parent) !== -1) {\n      return false;\n    }\n\n    parent = parent.parentNode;\n  }\n\n  return false;\n} /**\n   * # Get Parent\n   * See if an element has another element for a parent.\n   *\n   * @param {Element} parent\n   * @param {String} query\n   * @param {Array|Element} limitEl The last element we should check.\n   * @return {Boolean|Element}\n   *\n   * @module helpers/traversal/get-parent.js\n   */\n\nexports.default = getParent;\nmodule.exports = exports['default'];\n//# sourceMappingURL=get-parent.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Matches\n * See if an element matches a query selector.\n *\n * @param {Element} el\n * @param {String} query\n * @return {Boolean}\n *\n * @module helpers/traversal/matches.js\n */\nvar vendorMatch = typeof Element !== 'undefined' && (Element.prototype.matches || Element.prototype.matchesSelector || Element.prototype.webkitMatchesSelector || Element.prototype.mozMatchesSelector || Element.prototype.msMatchesSelector || Element.prototype.oMatchesSelector);\n\nfunction matches(el, query) {\n\n  if (vendorMatch) return vendorMatch.call(el, query);\n\n  var nodes = el.parentNode ? el.parentNode.querySelectorAll(query) : [];\n\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i] === el) return true;\n  }\n\n  return false;\n}\n\nexports.default = matches;\nmodule.exports = exports['default'];\n//# sourceMappingURL=matches.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Each\n * Apply a callback function to a list of any kind: Array, NodeList, HTMLCollection or Object.\n *\n * @param {Array|NodeList|HTMLCollection|Object} list\n * @param {Function} cb\n *\n * @example\n * each([], callback);\n * each(el.children, callback);\n * each(el.childNodes, callback);\n * each({}, callback);\n *\n * @module helpers/util/each.js\n */\nfunction each(list, cb) {\n\n  if (!list) {\n    return;\n  }\n\n  if (typeof cb !== 'function') {\n    throw new Error('Cannot invoke `each` without a callback!');\n  }\n\n  var i = 0;\n  var len = list.length;\n\n  // Object\n  if (len === undefined) {\n    for (i in list) {\n      if (i !== 'prototype' && list.hasOwnProperty(i)) {\n        cb(i, list[i]);\n      }\n    }\n  }\n  // Array-like\n  else {\n      for (; i < len; i++) {\n        cb(list[i]);\n      }\n    }\n}\n\nexports.default = each;\nmodule.exports = exports['default'];\n//# sourceMappingURL=each.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * # Trim\n * Trim whitespace on a string.\n *\n * @param {String} str\n *\n * @module helpers/util/trim.js\n */\n\nvar trimRE = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g;\n\nfunction trim(str) {\n  return str.replace(trimRE, '');\n}\n\nexports.default = trim;\nmodule.exports = exports['default'];\n//# sourceMappingURL=trim.js.map\n"],"preExistingComment":"//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvYmFzZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy9leHBhbmQuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvZmlsdGVyLW1vZHVsZS5qcyIsImpzL2Rpc3QvY29tcG9uZW50cy9maWx0ZXIuanMiLCJqcy9kaXN0L2NvbXBvbmVudHMvbW9kYWwuanMiLCJqcy9kaXN0L2hlbHBlcnMvYW5pbWF0aW9uL2hlaWdodC5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vYWRkLWNsYXNzLmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS9icmVha3BvaW50LmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS9oYXMtY2xhc3MuanMiLCJqcy9kaXN0L2hlbHBlcnMvZG9tL291dGVyLWhlaWdodC5qcyIsImpzL2Rpc3QvaGVscGVycy9kb20vcmVtb3ZlLWNsYXNzLmpzIiwianMvZGlzdC9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MuanMiLCJqcy9kaXN0L2hlbHBlcnMvdHJhdmVyc2FsL2dldC1wYXJlbnQuanMiLCJqcy9kaXN0L2hlbHBlcnMvdHJhdmVyc2FsL21hdGNoZXMuanMiLCJqcy9kaXN0L2hlbHBlcnMvdXRpbC9lYWNoLmpzIiwianMvZGlzdC9oZWxwZXJzL3V0aWwvdHJpbS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5UkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdlhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMveUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9cmV0dXJuIGV9KSgpIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2VhY2ggPSByZXF1aXJlKCcuLi9oZWxwZXJzL3V0aWwvZWFjaCcpO1xuXG52YXIgX2VhY2gyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZWFjaCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgQmFzZSBDb21wb25lbnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBUaGUgYmFzZSBjbGFzcyBmb3IgU3BhcmsgSlMgY29tcG9uZW50cy4gVGhpcyBjbGFzcyBzaG91bGQgbmV2ZXIgYmVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBpbnN0YW50aWF0ZWQgZGlyZWN0bHkuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2Jhc2UuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBCYXNlID0gZnVuY3Rpb24gKCkge1xuXG4gIC8qKlxuICAgKiBTZXQgcGFyYW1ldGVycyBhbmQgY2FjaGUgZWxlbWVudHMuXG4gICAqL1xuICBmdW5jdGlvbiBCYXNlKGVsKSB7XG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQmFzZSk7XG5cbiAgICBpZiAocGFyYW1zLmVsUmVxdWlyZWQgJiYgIWVsKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5zZXRQYXJhbXModGhpcy5kZWZhdWx0cyB8fCB7fSwgdHJ1ZSk7XG4gICAgdGhpcy5zZXRQYXJhbXMocGFyYW1zKTtcbiAgICAodGhpcy5fY2FjaGVFbGVtZW50cyB8fCBub29wKS5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZSB0aGUgY29tcG9uZW50IGZyb20gdGhlIERPTSBhbmQgcHJlcGFyZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uIGJ5IGRlcmVmZXJlbmNpbmcgdmFsdWVzLlxuICAgKiBAcGFyYW0ge0Jvb2xlYW59IGxlYXZlRWxlbWVudCBMZWF2ZSB0aGUgZWxlbWVudCBpbnRhY3QuXG4gICAqL1xuXG5cbiAgQmFzZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gcmVtb3ZlKGxlYXZlRWxlbWVudCkge1xuXG4gICAgaWYgKHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIGlmICghbGVhdmVFbGVtZW50ICYmIHRoaXMuZWwgJiYgdGhpcy5lbC5wYXJlbnROb2RlKSB7XG4gICAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5lbCk7XG4gICAgfVxuXG4gICAgdGhpcy51bnNldFBhcmFtcyh0aGlzLmRlZmF1bHRzKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtcyBPcHRpb25hbFxuICAgKi9cblxuXG4gIEJhc2UucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uIHVwZGF0ZShlbCkge1xuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG5cbiAgICBpZiAodGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMpIHtcbiAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMuX2NhY2hlRWxlbWVudHMgfHwgbm9vcCkuY2FsbCh0aGlzLCBlbCB8fCB0aGlzLmVsLCBwYXJhbXMpO1xuICAgICh0aGlzLl9wYXJzZVBhcmFtcyB8fCBub29wKS5jYWxsKHRoaXMpO1xuXG4gICAgaWYgKHRoaXMuX2FkZEV2ZW50TGlzdGVuZXJzKSB7XG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTZXQgYSBoYXNoIG9mIHBhcmFtZXRlcnMgaWYgdGhleSdyZSB3aGl0ZWxpc3RlZCBvciB3ZSdyZSB0b2xkIHRvIGZvcmNlIHRoZSBzZXQuXG4gICAqIFRoaXMgaXMgdXNlZCB0byBzZXQgaW5pdGlhbCB2YWx1ZXMgYXMgd2VsbCBhcyBzZXQgcGFzc2VkIHBhcmFtZXRlcnMuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXNcbiAgICogQHBhcmFtIHtCb29sZWFufSBmb3JjZSBGb3JjZSBzZXR0aW5nIGV2ZW4gaWYgdGhlIHBhcmFtIGlzIG5vdCB3aGl0ZWxpc3RlZC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS5zZXRQYXJhbXMgPSBmdW5jdGlvbiBzZXRQYXJhbXMocGFyYW1zLCBmb3JjZSkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKHBhcmFtcywgZnVuY3Rpb24gKGssIHYpIHtcbiAgICAgIGlmIChfdGhpcy5fd2hpdGVsaXN0ZWRQYXJhbXMuaW5kZXhPZihrKSAhPT0gLTEgfHwgZm9yY2UpIHtcbiAgICAgICAgX3RoaXNba10gPSB2O1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVuc2V0IGFsbCBwYXJhbWV0ZXJzLlxuICAgKiBAcGFyYW0ge0FycmF5fE9iamVjdH0ga2V5c1xuICAgKiBAcGFyYW0ge09iamVjdH0gc2NvcGUgVGhlIG9iamVjdCB0byB1bnNldCB0aGUgcGFyYW1zIGZyb20uIERlZmF1bHRzIHRvIGB0aGlzYC5cbiAgICovXG5cblxuICBCYXNlLnByb3RvdHlwZS51bnNldFBhcmFtcyA9IGZ1bmN0aW9uIHVuc2V0UGFyYW1zKGtleXMsIHNjb3BlKSB7XG5cbiAgICBrZXlzID0ga2V5cyBpbnN0YW5jZW9mIEFycmF5ID8ga2V5cyA6IE9iamVjdC5rZXlzKGtleXMpO1xuICAgIHNjb3BlID0gc2NvcGUgfHwgdGhpcztcbiAgICAoMCwgX2VhY2gyLmRlZmF1bHQpKGtleXMsIGZ1bmN0aW9uIChrKSB7XG4gICAgICBkZWxldGUgc2NvcGVba107XG4gICAgfSk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICByZXR1cm4gQmFzZTtcbn0oKTtcblxuLyoqXG4gKiBXaGl0ZWxpc3RlZCBwYXJhbWV0ZXJzIHdoaWNoIGNhbiBiZSBzZXQgb24gY29uc3RydWN0aW9uLlxuICogQHR5cGUge0FycmF5fVxuICovXG5cblxuQmFzZS5wcm90b3R5cGUuX3doaXRlbGlzdGVkUGFyYW1zID0gW107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkJhc2UucHJvdG90eXBlLmRlZmF1bHRzID0ge307XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEJhc2U7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWJhc2UuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfaGVpZ2h0ID0gcmVxdWlyZSgnLi4vaGVscGVycy9hbmltYXRpb24vaGVpZ2h0Jyk7XG5cbnZhciBfaGVpZ2h0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlaWdodCk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MnKTtcblxudmFyIF90b2dnbGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90b2dnbGVDbGFzcyk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfZ2V0UGFyZW50ID0gcmVxdWlyZSgnLi4vaGVscGVycy90cmF2ZXJzYWwvZ2V0LXBhcmVudCcpO1xuXG52YXIgX2dldFBhcmVudDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9nZXRQYXJlbnQpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG5mdW5jdGlvbiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihzZWxmLCBjYWxsKSB7IGlmICghc2VsZikgeyB0aHJvdyBuZXcgUmVmZXJlbmNlRXJyb3IoXCJ0aGlzIGhhc24ndCBiZWVuIGluaXRpYWxpc2VkIC0gc3VwZXIoKSBoYXNuJ3QgYmVlbiBjYWxsZWRcIik7IH0gcmV0dXJuIGNhbGwgJiYgKHR5cGVvZiBjYWxsID09PSBcIm9iamVjdFwiIHx8IHR5cGVvZiBjYWxsID09PSBcImZ1bmN0aW9uXCIpID8gY2FsbCA6IHNlbGY7IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gXCJmdW5jdGlvblwiICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgXCIgKyB0eXBlb2Ygc3VwZXJDbGFzcyk7IH0gc3ViQ2xhc3MucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShzdXBlckNsYXNzICYmIHN1cGVyQ2xhc3MucHJvdG90eXBlLCB7IGNvbnN0cnVjdG9yOiB7IHZhbHVlOiBzdWJDbGFzcywgZW51bWVyYWJsZTogZmFsc2UsIHdyaXRhYmxlOiB0cnVlLCBjb25maWd1cmFibGU6IHRydWUgfSB9KTsgaWYgKHN1cGVyQ2xhc3MpIE9iamVjdC5zZXRQcm90b3R5cGVPZiA/IE9iamVjdC5zZXRQcm90b3R5cGVPZihzdWJDbGFzcywgc3VwZXJDbGFzcykgOiBzdWJDbGFzcy5fX3Byb3RvX18gPSBzdXBlckNsYXNzOyB9IC8qKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBFeHBhbmRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEV4cGFuZCBhbmQgY29sbGFwc2UgYW4gZWxlbWVudC5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogbmV3IEV4cGFuZChlbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2V4cGFuZC5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cblxudmFyIG5vb3AgPSBmdW5jdGlvbiBub29wKCkge307XG5cbnZhciBFeHBhbmQgPSBmdW5jdGlvbiAoX0Jhc2VDb21wb25lbnQpIHtcbiAgX2luaGVyaXRzKEV4cGFuZCwgX0Jhc2VDb21wb25lbnQpO1xuXG4gIC8qKlxuICAgKiBFeHBhbmQgY29uc3RydWN0b3IuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKi9cbiAgZnVuY3Rpb24gRXhwYW5kKGVsKSB7XG4gICAgdmFyIF90aGlzO1xuXG4gICAgdmFyIHBhcmFtcyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhwYW5kKTtcblxuICAgIHBhcmFtcy5lbFJlcXVpcmVkID0gdHJ1ZTtcblxuICAgIGlmICghKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0Jhc2VDb21wb25lbnQuY2FsbCh0aGlzLCBlbCwgcGFyYW1zKSksIF90aGlzKSkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKTtcbiAgICBfdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIEV4cGFuZFxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuZXhwYW5kID0gZnVuY3Rpb24gZXhwYW5kKCkge1xuXG4gICAgKHRoaXMub25CZWZvcmVFeHBhbmQgfHwgbm9vcCkoKTtcblxuICAgICgwLCBfaGVpZ2h0Mi5kZWZhdWx0KSh7XG4gICAgICBlbDogdGhpcy5lbCxcbiAgICAgIHRvZ2dsZUNsYXNzOiAnZXhwYW5kZWQnLFxuICAgICAgdG9nZ2xlRWw6ICcuc3BhcmstZXhwYW5kX19jb250ZW50LCAuc3BhcmstcGFuZWxfX2NvbnRlbnQnXG4gICAgfSk7XG5cbiAgICB0aGlzLmlzRXhwYW5kZWQgPSB0cnVlO1xuICAgIHRoaXMuX3VwZGF0ZUNsYXNzZXMoKTtcbiAgICB2YXIgZSA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdFdmVudCcpO1xuICAgIGUuaW5pdEV2ZW50KCdzcGFyay52aXNpYmxlLWNoaWxkcmVuJywgdHJ1ZSwgdHJ1ZSk7XG4gICAgdGhpcy5lbC5kaXNwYXRjaEV2ZW50KGUpO1xuXG4gICAgLy8gSWYgdGhlIGV4cGFuZCBlbGVtZW50IGhhdmUgaW5wdXQsIGZvY3VzIG9uIHRoZSBmaXJzdCBvbmUuXG4gICAgaWYgKHRoaXMuZWwucXVlcnlTZWxlY3RvcignaW5wdXQnKSkge1xuICAgICAgdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpLmZvY3VzKCk7XG4gICAgfVxuXG4gICAgKHRoaXMub25BZnRlckV4cGFuZCB8fCBub29wKSgpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgLyoqXG4gICAqIENvbGxhcHNlXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS5jb2xsYXBzZSA9IGZ1bmN0aW9uIGNvbGxhcHNlKCkge1xuXG4gICAgKHRoaXMub25CZWZvcmVDb2xsYXBzZSB8fCBub29wKSgpO1xuXG4gICAgKDAsIF9oZWlnaHQyLmRlZmF1bHQpKHtcbiAgICAgIGVsOiB0aGlzLmVsLFxuICAgICAgdG9nZ2xlRWw6ICcuc3BhcmstZXhwYW5kX19jb250ZW50LCAuc3BhcmstcGFuZWxfX2NvbnRlbnQnLFxuICAgICAgdG9nZ2xlVmFsdWU6ICdub25lJyxcbiAgICAgIGFjdGlvbjogJ2NvbGxhcHNlJ1xuICAgIH0pO1xuXG4gICAgdGhpcy5pc0V4cGFuZGVkID0gZmFsc2U7XG4gICAgdGhpcy5fdXBkYXRlQ2xhc3NlcygpO1xuXG4gICAgKHRoaXMub25BZnRlckNvbGxhcHNlIHx8IG5vb3ApKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIHRoZSBleHBhbmQgc3RhdGUuXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiB0b2dnbGUoKSB7XG4gICAgcmV0dXJuIHRoaXNbdGhpcy5pc0V4cGFuZGVkID8gJ2NvbGxhcHNlJyA6ICdleHBhbmQnXSgpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZSBhIHJlZmVyZW5jZSB0byB0aGUgZWxlbWVudC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX2NhY2hlRWxlbWVudHMgPSBmdW5jdGlvbiBfY2FjaGVFbGVtZW50cyhlbCkge1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLmlzRXhwYW5kZWQgPSAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnZXhwYW5kZWQnKTtcblxuICAgIHRoaXMuYWNjb3JkaW9uSGVhZGluZyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignW3JvbGU9XCJoZWFkaW5nXCJdJyk7XG4gICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstcGFuZWxfX2NvbnRlbnQnKTtcblxuICAgIHRoaXMucGFuZWxDb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZXhwYW5kX19jb250ZW50Jyk7XG4gICAgdGhpcy5wYW5lbENvbGxhcHNlZEJ1dHRvbiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWV4cGFuZF9faGlkZS0tZXhwYW5kZWQnKTtcbiAgICB0aGlzLnBhbmVsRXhwYW5kZWRCdXR0b24gPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1leHBhbmRfX3Nob3ctLWV4cGFuZGVkJyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBjbGFzc2VzIGZvciB0aGUgZXhwYW5kIG9yIGNvbGxhcHNlIHN0YXRlLlxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX3VwZGF0ZUNsYXNzZXMgPSBmdW5jdGlvbiBfdXBkYXRlQ2xhc3NlcygpIHtcbiAgICAoMCwgX3RvZ2dsZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnZXhwYW5kZWQnLCB0aGlzLmlzRXhwYW5kZWQpO1xuICAgIHRoaXMuX3VwZGF0ZUFyaWFBdHRyaWJ1dGVzKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBhcmlhIGF0dHJpYnV0ZXMgZm9yIHRoZSBleHBhbmQgb3IgY29sbGFwc2Ugc3RhdGUuXG4gICAqL1xuXG5cbiAgRXhwYW5kLnByb3RvdHlwZS5fdXBkYXRlQXJpYUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiBfdXBkYXRlQXJpYUF0dHJpYnV0ZXMoKSB7XG4gICAgaWYgKHRoaXMuaXNFeHBhbmRlZCkge1xuICAgICAgdGhpcy5hY2NvcmRpb25IZWFkaW5nID8gdGhpcy5hY2NvcmRpb25IZWFkaW5nLnNldEF0dHJpYnV0ZSgnYXJpYS1leHBhbmRlZCcsICd0cnVlJykgOiBudWxsO1xuICAgICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID8gdGhpcy5hY2NvcmRpb25Db250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAnZmFsc2UnKSA6IG51bGw7XG5cbiAgICAgIHRoaXMucGFuZWxDb250ZW50ID8gdGhpcy5wYW5lbENvbnRlbnQuc2V0QXR0cmlidXRlKCdhcmlhLWhpZGRlbicsICdmYWxzZScpIDogbnVsbDtcbiAgICAgIHRoaXMucGFuZWxDb2xsYXBzZWRCdXR0b24gPyB0aGlzLnBhbmVsQ29sbGFwc2VkQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcbiAgICAgIHRoaXMucGFuZWxFeHBhbmRlZEJ1dHRvbiA/IHRoaXMucGFuZWxFeHBhbmRlZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmFjY29yZGlvbkhlYWRpbmcgPyB0aGlzLmFjY29yZGlvbkhlYWRpbmcuc2V0QXR0cmlidXRlKCdhcmlhLWV4cGFuZGVkJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgICAgdGhpcy5hY2NvcmRpb25Db250ZW50ID8gdGhpcy5hY2NvcmRpb25Db250ZW50LnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcblxuICAgICAgdGhpcy5wYW5lbENvbnRlbnQgPyB0aGlzLnBhbmVsQ29udGVudC5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ3RydWUnKSA6IG51bGw7XG4gICAgICB0aGlzLnBhbmVsQ29sbGFwc2VkQnV0dG9uID8gdGhpcy5wYW5lbENvbGxhcHNlZEJ1dHRvbi5zZXRBdHRyaWJ1dGUoJ2FyaWEtaGlkZGVuJywgJ2ZhbHNlJykgOiBudWxsO1xuICAgICAgdGhpcy5wYW5lbEV4cGFuZGVkQnV0dG9uID8gdGhpcy5wYW5lbEV4cGFuZGVkQnV0dG9uLnNldEF0dHJpYnV0ZSgnYXJpYS1oaWRkZW4nLCAndHJ1ZScpIDogbnVsbDtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIF9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpIHtcbiAgICB0aGlzLl9vbkNsaWNrQm91bmQgPSB0aGlzLl9vbkNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25LZXlkb3duQm91bmQgPSB0aGlzLl9vbktleWRvd24uYmluZCh0aGlzKTtcbiAgfTtcblxuICAvKipcbiAgICogQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgRE9NIGV2ZW50cy5cbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9hZGRFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGlja0JvdW5kKTtcbiAgICB0aGlzLmVsLmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleWRvd25Cb3VuZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBldmVudCBsaXN0ZW5lcnMgZm9yIERPTSBldmVudHMuLlxuICAgKi9cblxuXG4gIEV4cGFuZC5wcm90b3R5cGUuX3JlbW92ZUV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsaWNrQm91bmQpO1xuICAgIHRoaXMuZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX29uS2V5ZG93bkJvdW5kKTtcbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB3ZSBhcmUgY2xpY2tlZCwgdG9nZ2xlIHRoZSBleHBhbmRlZCBzdGF0ZS5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9vbkNsaWNrID0gZnVuY3Rpb24gX29uQ2xpY2soZSkge1xuXG4gICAgaWYgKCEoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkoZS50YXJnZXQsICcuc3BhcmstZXhwYW5kX190b2dnbGUsIFtkYXRhLXJvbGU9XCJ0b2dnbGVcIl0sIFtyb2xlPVwiaGVhZGluZ1wiXScsIHRoaXMuZWwpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMudG9nZ2xlKCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIHNwYWNlIG9yIGVudGVyIGtleSBpcyBwcmVzc2VkIG9uIHRoZSB0b2dnbGUsIHRvZ2dsZSFcbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBFeHBhbmQucHJvdG90eXBlLl9vbktleWRvd24gPSBmdW5jdGlvbiBfb25LZXlkb3duKGUpIHtcblxuICAgIGlmICghKDAsIF9nZXRQYXJlbnQyLmRlZmF1bHQpKGUudGFyZ2V0LCAnLnNwYXJrLWV4cGFuZF9fdG9nZ2xlLCBbZGF0YS1yb2xlPVwidG9nZ2xlXCJdLCBbcm9sZT1cImhlYWRpbmdcIl0nLCB0aGlzLmVsKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHZhciBjb2RlID0gZS5rZXlDb2RlIHx8IGUud2hpY2g7XG5cbiAgICAvLyBTcGFjZSBvciBlbnRlclxuICAgIGlmIChjb2RlID09PSAzMiB8fCBjb2RlID09PSAxMykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy50b2dnbGUoKTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEV4cGFuZDtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5FeHBhbmQucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsnb25CZWZvcmVFeHBhbmQnLCAnb25BZnRlckV4cGFuZCcsICdvbkJlZm9yZUNvbGxhcHNlJywgJ29uQWZ0ZXJDb2xsYXBzZSddO1xuXG4vKipcbiAqIERlZmF1bHQgdmFsdWVzIGZvciBpbnRlcm5hbCBwcm9wZXJ0aWVzIHdlIHdpbGwgYmUgc2V0dGluZy5cbiAqIFRoZXNlIGFyZSBzZXQgb24gZWFjaCBjb25zdHJ1Y3Rpb24gc28gd2UgZG9uJ3QgbGVhayBwcm9wZXJ0aWVzXG4gKiBpbnRvIHRoZSBwcm90b3R5cGUgY2hhaW4uXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5FeHBhbmQucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbCxcbiAgaXNFeHBhbmRlZDogZmFsc2UsXG4gIG9uQmVmb3JlRXhwYW5kOiBudWxsLFxuICBvbkFmdGVyRXhwYW5kOiBudWxsLFxuICBvbkJlZm9yZUNvbGxhcHNlOiBudWxsLFxuICBvbkFmdGVyQ29sbGFwc2U6IG51bGwsXG4gIF9vbkNsaWNrQm91bmQ6IG51bGwsXG4gIF9vbktleWRvd25Cb3VuZDogbnVsbFxufTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gRXhwYW5kO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1leHBhbmQuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MnKTtcblxudmFyIF90b2dnbGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90b2dnbGVDbGFzcyk7XG5cbnZhciBfcmVtb3ZlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9yZW1vdmUtY2xhc3MnKTtcblxudmFyIF9yZW1vdmVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1vdmVDbGFzcyk7XG5cbnZhciBfYWRkQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9hZGQtY2xhc3MnKTtcblxudmFyIF9hZGRDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hZGRDbGFzcyk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfZXhwYW5kID0gcmVxdWlyZSgnLi9leHBhbmQnKTtcblxudmFyIF9leHBhbmQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZXhwYW5kKTtcblxudmFyIF9tb2RhbCA9IHJlcXVpcmUoJy4vbW9kYWwnKTtcblxudmFyIF9tb2RhbDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tb2RhbCk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTsgfSB9XG5cbmZ1bmN0aW9uIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHNlbGYsIGNhbGwpIHsgaWYgKCFzZWxmKSB7IHRocm93IG5ldyBSZWZlcmVuY2VFcnJvcihcInRoaXMgaGFzbid0IGJlZW4gaW5pdGlhbGlzZWQgLSBzdXBlcigpIGhhc24ndCBiZWVuIGNhbGxlZFwiKTsgfSByZXR1cm4gY2FsbCAmJiAodHlwZW9mIGNhbGwgPT09IFwib2JqZWN0XCIgfHwgdHlwZW9mIGNhbGwgPT09IFwiZnVuY3Rpb25cIikgPyBjYWxsIDogc2VsZjsgfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSBcImZ1bmN0aW9uXCIgJiYgc3VwZXJDbGFzcyAhPT0gbnVsbCkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCBcIiArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH0gLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAjIEZpbHRlciBNb2R1bGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIE1vZHVsZSB0aGF0IGNvbnRhaW5zIGFuIGluZGl2aWR1YWwgKG9yIHJlbGF0ZWQpIGZpbHRlcnMgc3VjaCBhcyBjaGVja2JveGVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQGV4YW1wbGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIG5ldyBGaWx0ZXJNb2R1bGUoZWwsIHBhcmFtcyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBjb21wb25lbnRzL2ZpbHRlci1tb2R1bGUuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG5cbnZhciBub29wID0gZnVuY3Rpb24gbm9vcCgpIHt9O1xuXG52YXIgRmlsdGVyTW9kdWxlID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhGaWx0ZXJNb2R1bGUsIF9CYXNlQ29tcG9uZW50KTtcblxuICAvKipcbiAgICogRmlsdGVyIE1vZHVsZSBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAqL1xuICBmdW5jdGlvbiBGaWx0ZXJNb2R1bGUoZWwpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGaWx0ZXJNb2R1bGUpO1xuXG4gICAgcGFyYW1zLmVsUmVxdWlyZWQgPSB0cnVlO1xuXG4gICAgaWYgKCEoX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfQmFzZUNvbXBvbmVudC5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpKSwgX3RoaXMpKSB7XG4gICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICAgIH1cblxuICAgIF90aGlzLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpO1xuICAgIF90aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihfdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcmUgYSByZWZlcmVuY2UgdG8gdGhlIG5lZWQgZWxlbWVudHNcbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKi9cblxuXG4gIEZpbHRlck1vZHVsZS5wcm90b3R5cGUuX2NhY2hlRWxlbWVudHMgPSBmdW5jdGlvbiBfY2FjaGVFbGVtZW50cyhlbCkge1xuICAgIHRoaXMuZWwgPSBlbDtcbiAgICB0aGlzLl9zaG93QWxsRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1maWx0ZXItbW9kdWxlX19zaG93LWFsbCcpO1xuICAgIGlmICh0aGlzLl9zaG93QWxsRWwpIHtcbiAgICAgIHRoaXMuX3Nob3dBbGxUb2dnbGVhYmxlID0gdGhpcy5fc2hvd0FsbEVsLnF1ZXJ5U2VsZWN0b3IoJ3NwYW4nKTtcbiAgICB9XG5cbiAgICB0aGlzLl9jbGVhckVscyA9IHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCgnLnNwYXJrLWZpbHRlci1tb2R1bGVfX2NsZWFyJyk7XG4gICAgdGhpcy5faGlkZGVuRWxzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstZmlsdGVyLW1vZHVsZS0taGlkZScpKTtcbiAgICB0aGlzLl9oZWFkZXJFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlci1tb2R1bGVfX2hlYWRlcicpO1xuICAgIHRoaXMuX2JvZHlFbCA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlci1tb2R1bGVfX2JvZHknKTtcbiAgICB0aGlzLl9tb2RhbEVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstbW9kYWwnKTtcbiAgICB0aGlzLl9tb2RhbFNhdmVCdG4gPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1maWx0ZXItbW9kdWxlX19zaG93LWFsbF9fbW9kYWwtYnV0dG9uJyk7XG4gICAgdGhpcy5fbW9kYWxDbGFzc2VzID0gW107XG5cbiAgICBpZiAodGhpcy5vblNob3dBbGwgPT09ICdtb2RhbCcpIHtcbiAgICAgIHRoaXMubW9kYWxJbnN0ID0gbmV3IF9tb2RhbDIuZGVmYXVsdCh0aGlzLl9tb2RhbEVsKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcyA9IGZ1bmN0aW9uIF9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpIHtcbiAgICB0aGlzLl9vblNob3dBbGxCb3VuZCA9IHRoaXMuX29uU2hvd0FsbC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uQ2xlYXJCb3VuZCA9IHRoaXMuX29uQ2xlYXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbkNsb3NlTW9kYWxCb3VuZCA9IHRoaXMuX29uQ2xvc2VNb2RhbC5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciB0b3VjaHN0YXJ0IGFuZCBtb3VzZSBjbGljay5cbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLl9hZGRFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIF9hZGRFdmVudExpc3RlbmVycygpIHtcbiAgICAhdGhpcy5fc2hvd0FsbEVsIHx8IHRoaXMuX3Nob3dBbGxFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uU2hvd0FsbEJvdW5kKTtcbiAgICAhdGhpcy5fbW9kYWxTYXZlQnRuIHx8IHRoaXMuX21vZGFsU2F2ZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uQ2xvc2VNb2RhbEJvdW5kKTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2xlYXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICF0aGlzLl9jbGVhckVsc1tpXSB8fCB0aGlzLl9jbGVhckVsc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uQ2xlYXJCb3VuZCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZvciB0b3VjaHN0YXJ0IGFuZCBtb3VzZSBjbGljay5cbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLl9yZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIF9yZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICBpZiAodGhpcy5fc2hvd0FsbEVsKSB7XG4gICAgICB0aGlzLl9zaG93QWxsRWwucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vblNob3dBbGxCb3VuZCk7XG4gICAgICB0aGlzLl9tb2RhbFNhdmVCdG4ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsb3NlTW9kYWxCb3VuZCk7XG5cbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2xlYXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgIXRoaXMuX2NsZWFyRWxzW2ldIHx8IHRoaXMuX2NsZWFyRWxzW2ldLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25DbGVhckJvdW5kKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFNob3cgYW55IGhpZGRlbiBmaWx0ZXJzIHdpdGhpbiBhIG1vZHVsZSBvciBydW4gcHJvdmlkZWQgZnVuY3Rpb24gaWYgYXZhaWxhYmxlXG4gICAqL1xuXG5cbiAgRmlsdGVyTW9kdWxlLnByb3RvdHlwZS5fb25TaG93QWxsID0gZnVuY3Rpb24gX29uU2hvd0FsbCgpIHtcbiAgICBpZiAodHlwZW9mIHRoaXMub25TaG93QWxsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAodGhpcy5vblNob3dBbGwgfHwgbm9vcCkodGhpcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGlmICh0aGlzLm9uU2hvd0FsbCA9PT0gJ3RvZ2dsZScgfHwgdGhpcy5vblNob3dBbGwgPT09ICdtb2RhbCcgJiYgdGhpcy5faXNFeHBhbmQpIHtcbiAgICAgICAgdGhpcy5fdG9nZ2xlU2hvd0FsbExhYmVsKCk7XG4gICAgICAgIHRoaXMudG9nZ2xlSGlkZGVuQ29udGVudCgpO1xuICAgICAgfSBlbHNlIGlmICh0aGlzLm9uU2hvd0FsbCA9PT0gJ21vZGFsJyAmJiAhdGhpcy5faXNFeHBhbmQpIHtcbiAgICAgICAgdGhpcy5tb2RhbEluc3Qub3BlbigpO1xuICAgICAgfVxuXG4gICAgICAodGhpcy5vblNob3dBbGxDb21wbGV0ZSB8fCBub29wKSgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVG9nZ2xlIFNob3cgTW9yZSBsYWJlbCB0ZXh0XG4gICAqL1xuXG5cbiAgRmlsdGVyTW9kdWxlLnByb3RvdHlwZS5fdG9nZ2xlU2hvd0FsbExhYmVsID0gZnVuY3Rpb24gX3RvZ2dsZVNob3dBbGxMYWJlbCgpIHtcbiAgICB0aGlzLl9zaG93QWxsVG9nZ2xlYWJsZS5pbm5lckhUTUwgPSB0aGlzLl9zaG93QWxsVG9nZ2xlYWJsZS5pbm5lckhUTUwgPT09ICdtb3JlJyA/ICdmZXdlcicgOiAnbW9yZSc7XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGFmdGVyIGNsaWNraW5nIGBDbGVhcmAgYnV0dG9uXG4gICAqL1xuXG5cbiAgRmlsdGVyTW9kdWxlLnByb3RvdHlwZS5fb25DbGVhciA9IGZ1bmN0aW9uIF9vbkNsZWFyKCkge1xuICAgICh0aGlzLm9uQ2xlYXIgfHwgbm9vcCkodGhpcyk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIGFmdGVyIGNsaWNraW5nIGBTYXZlYCBidXR0b25cbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLl9vbkNsb3NlTW9kYWwgPSBmdW5jdGlvbiBfb25DbG9zZU1vZGFsKCkge1xuICAgICh0aGlzLm9uTW9kYWxDbG9zZSB8fCBub29wKSgpO1xuXG4gICAgdGhpcy5tb2RhbEluc3QuY2xvc2UoKTtcbiAgfTtcblxuICAvKipcbiAgICogRW5hYmxlIGNsZWFyIGJ1dHRvblxuICAgKi9cblxuXG4gIEZpbHRlck1vZHVsZS5wcm90b3R5cGUuZW5hYmxlQ2xlYXJCdG4gPSBmdW5jdGlvbiBlbmFibGVDbGVhckJ0bigpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2NsZWFyRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl9jbGVhckVsc1tpXSwgJ3NwYXJrLWZpbHRlci1tb2R1bGVfX2NsZWFyLS1kaXNhYmxlZCcpO1xuICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5fY2xlYXJFbHNbaV0sICdzcGFyay1maWx0ZXItbW9kdWxlX19jbGVhci0taGlkZGVuJyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIGNsZWFyIGJ1dHRvblxuICAgKi9cblxuXG4gIEZpbHRlck1vZHVsZS5wcm90b3R5cGUuZGlzYWJsZUNsZWFyQnRuID0gZnVuY3Rpb24gZGlzYWJsZUNsZWFyQnRuKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2xlYXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2NsZWFyRWxzW2ldLCAnc3BhcmstZmlsdGVyLW1vZHVsZV9fY2xlYXItLWRpc2FibGVkJyk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBIaWRlIGNsZWFyIGJ1dHRvblxuICAgKi9cblxuXG4gIEZpbHRlck1vZHVsZS5wcm90b3R5cGUuaGlkZUNsZWFyQnRuID0gZnVuY3Rpb24gaGlkZUNsZWFyQnRuKCkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2xlYXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2NsZWFyRWxzW2ldLCAnc3BhcmstZmlsdGVyLW1vZHVsZV9fY2xlYXItLWhpZGRlbicpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lIGlmIENsZWFyIGJ1dHRvbiBpcyBoaWRkZW4gb3IgZGlzYWJsZWRcbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLmdldENsZWFyQnV0dG9uU3RhdHVzID0gZnVuY3Rpb24gZ2V0Q2xlYXJCdXR0b25TdGF0dXMoKSB7XG4gICAgdmFyIGJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcblxuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5fY2xlYXJFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICgoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLl9jbGVhckVsc1tpXSwgJ3NwYXJrLWZpbHRlci1tb2R1bGVfX2NsZWFyLS1oaWRkZW4nKSB8fCAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLl9jbGVhckVsc1tpXSwgJ3NwYXJrLWZpbHRlci1tb2R1bGVfX2NsZWFyLS1kaXNhYmxlZCcpKSB7XG4gICAgICAgIGJ1dHRvbkVuYWJsZWQgPSBmYWxzZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ1dHRvbkVuYWJsZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBidXR0b25FbmFibGVkO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIaWRlIG9yIHNob3cgZXh0cmEgZmlsdGVycyBlbGVtZW50cyBhcyB0cmlnZ2VyZWQgYnkgU2hvdyBtb3JlL2Zld2VyXG4gICAqL1xuXG5cbiAgRmlsdGVyTW9kdWxlLnByb3RvdHlwZS50b2dnbGVIaWRkZW5Db250ZW50ID0gZnVuY3Rpb24gdG9nZ2xlSGlkZGVuQ29udGVudCgpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX2hpZGRlbkVscy5sZW5ndGg7IGkrKykge1xuICAgICAgKDAsIF90b2dnbGVDbGFzczIuZGVmYXVsdCkodGhpcy5faGlkZGVuRWxzW2ldLCAnc2hvdycpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQ2hhbmdlIGZpbHRlci1tb2R1bGUgdG8gZXhwYW5kL2NvbGxhcHNlIHZhcmlhdGlvblxuICAgKiBUaGlzIG9jY3VycyB3aGVuIHRoZSBmaWx0ZXIgaXMgYXQgdGhlIHhzIGJyZWFrcG9pbnRcbiAgICovXG5cblxuICBGaWx0ZXJNb2R1bGUucHJvdG90eXBlLl9hcHBseUV4cGFuZCA9IGZ1bmN0aW9uIF9hcHBseUV4cGFuZCgpIHtcbiAgICBpZiAodGhpcy5fbW9kYWxFbCkge1xuICAgICAgdmFyIG1vZGFsQ2xzTmFtZXMgPSBbJ3NwYXJrLWZpbHRlci1tb2R1bGUtLWhpZGUnLCAnJywgJycsICcnXTtcblxuICAgICAgdGhpcy5faGlkZGVuRWxzLnB1c2godGhpcy5fbW9kYWxFbCk7XG4gICAgICB2YXIgY3VyRWwgPSB0aGlzLl9tb2RhbEVsO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZGFsQ2xzTmFtZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgdGhpcy5fbW9kYWxDbGFzc2VzW2ldID0gY3VyRWwuY2xhc3NOYW1lO1xuICAgICAgICBjdXJFbC5jbGFzc05hbWUgPSBtb2RhbENsc05hbWVzW2ldO1xuICAgICAgICBjdXJFbCA9IGN1ckVsLmZpcnN0RWxlbWVudENoaWxkO1xuICAgICAgfVxuXG4gICAgICBpZiAoKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkoZG9jdW1lbnQuYm9keSwgJ3NwYXJrLW1vZGFsLW9wZW4nKSkge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShkb2N1bWVudC5ib2R5LCAnc3BhcmstbW9kYWwtb3BlbicpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLm1vZGFsSW5zdC5yZW1vdmUodHJ1ZSk7XG4gICAgfVxuXG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLXBhbmVsJywgJ3NwYXJrLXBhbmVsLS1leHBhbmQnKTtcbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl9oZWFkZXJFbCwgJ3NwYXJrLXBhbmVsX19oZWFkZXInKTtcbiAgICB0aGlzLl9oZWFkZXJFbC5zZXRBdHRyaWJ1dGUoJ3JvbGUnLCAnaGVhZGluZycpO1xuICAgIHRoaXMuX2hlYWRlckVsLnNldEF0dHJpYnV0ZSgndGFiaW5kZXgnLCAnMCcpO1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2JvZHlFbCwgJ3NwYXJrLXBhbmVsX19jb250ZW50Jyk7XG5cbiAgICB0aGlzLl9leHBhbmRJbnN0ID0gbmV3IF9leHBhbmQyLmRlZmF1bHQodGhpcy5lbCwge1xuICAgICAgb25BZnRlckV4cGFuZDogdGhpcy5vbkFmdGVyRXhwYW5kLFxuICAgICAgb25BZnRlckNvbGxhcHNlOiB0aGlzLm9uQWZ0ZXJDb2xsYXBzZVxuICAgIH0pO1xuXG4gICAgdGhpcy5faXNFeHBhbmQgPSB0cnVlO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDaGFuZ2UgZmlsdGVyLW1vZHVsZSBmcm9tIGV4cGFuZC9jb2xsYXBzZSB0byBob3Jpem9udGFsIHZhcmlhdGlvblxuICAgKi9cblxuXG4gIEZpbHRlck1vZHVsZS5wcm90b3R5cGUuX2Rpc2FwcGx5RXhwYW5kID0gZnVuY3Rpb24gX2Rpc2FwcGx5RXhwYW5kKCkge1xuICAgIGlmICh0aGlzLl9tb2RhbEVsKSB7XG5cbiAgICAgIGlmICgoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLl9tb2RhbEVsLCAnc2hvdycpKSB7XG4gICAgICAgIHRoaXMuX3RvZ2dsZVNob3dBbGxMYWJlbCgpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9oaWRkZW5FbHMucG9wKCk7XG4gICAgICB2YXIgY3VyRWwgPSB0aGlzLl9tb2RhbEVsO1xuXG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuX21vZGFsQ2xhc3Nlcy5sZW5ndGg7IGkrKykge1xuICAgICAgICBjdXJFbC5jbGFzc05hbWUgPSB0aGlzLl9tb2RhbENsYXNzZXNbaV07XG4gICAgICAgIGN1ckVsID0gY3VyRWwuZmlyc3RFbGVtZW50Q2hpbGQ7XG4gICAgICB9XG5cbiAgICAgIHRoaXMubW9kYWxJbnN0ID0gbmV3IF9tb2RhbDIuZGVmYXVsdCh0aGlzLl9tb2RhbEVsKTtcbiAgICB9XG5cbiAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnc3BhcmstcGFuZWwnLCAnc3BhcmstcGFuZWwtLWV4cGFuZCcpO1xuICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2hlYWRlckVsLCAnc3BhcmstcGFuZWxfX2hlYWRlcicpO1xuICAgIHRoaXMuX2hlYWRlckVsLnJlbW92ZUF0dHJpYnV0ZSgncm9sZScpO1xuICAgIHRoaXMuX2hlYWRlckVsLnJlbW92ZUF0dHJpYnV0ZSgndGFiaW5kZXgnKTtcbiAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl9ib2R5RWwsICdzcGFyay1wYW5lbF9fY29udGVudCcpO1xuICAgIHRoaXMuX2V4cGFuZEluc3QucmVtb3ZlKHRydWUpO1xuICAgIHRoaXMuX2lzRXhwYW5kID0gZmFsc2U7XG4gIH07XG5cbiAgcmV0dXJuIEZpbHRlck1vZHVsZTtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5GaWx0ZXJNb2R1bGUucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsnb25TaG93QWxsJywgJ29uU2hvd0FsbENvbXBsZXRlJywgJ29uTW9kYWxDbG9zZScsICdvbkNsZWFyJywgJ29uQWZ0ZXJFeHBhbmQnLCAnb25BZnRlckNvbGxhcHNlJ107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkZpbHRlck1vZHVsZS5wcm90b3R5cGUuZGVmYXVsdHMgPSB7XG4gIGVsOiBudWxsLFxuICBvblNob3dBbGw6IG5vb3AsXG4gIG9uU2hvd0FsbENvbXBsZXRlOiBub29wLFxuICBvbk1vZGFsQ2xvc2U6IG5vb3AsXG4gIG9uQ2xlYXI6IG5vb3AsXG4gIG9uQWZ0ZXJFeHBhbmQ6IG5vb3AsXG4gIG9uQWZ0ZXJDb2xsYXBzZTogbm9vcCxcbiAgbW9kYWxJbnN0OiBudWxsLFxuICBfb25TaG93QWxsQm91bmQ6IG51bGwsXG4gIF9vbkNsZWFyQm91bmQ6IG51bGwsXG4gIF9zaG93QWxsRWw6IG51bGwsXG4gIF9jbGVhckVsOiBudWxsLFxuICBfaGlkZGVuRWxzOiBbXSxcbiAgX2hlYWRlckVsOiBudWxsLFxuICBfYm9keUVsOiBudWxsLFxuICBfbW9kYWxFbDogbnVsbCxcbiAgX2V4cGFuZEluc3Q6IG51bGwsXG4gIF9pc0V4cGFuZDogZmFsc2UsXG4gIGRhdGFTZXQ6IHt9XG59O1xuXG5leHBvcnRzLmRlZmF1bHQgPSBGaWx0ZXJNb2R1bGU7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZpbHRlci1tb2R1bGUuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfYmFzZSA9IHJlcXVpcmUoJy4vYmFzZScpO1xuXG52YXIgX2Jhc2UyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYmFzZSk7XG5cbnZhciBfYWRkQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9hZGQtY2xhc3MnKTtcblxudmFyIF9hZGRDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9hZGRDbGFzcyk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS90b2dnbGUtY2xhc3MnKTtcblxudmFyIF90b2dnbGVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90b2dnbGVDbGFzcyk7XG5cbnZhciBfcmVtb3ZlQ2xhc3MgPSByZXF1aXJlKCcuLi9oZWxwZXJzL2RvbS9yZW1vdmUtY2xhc3MnKTtcblxudmFyIF9yZW1vdmVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1vdmVDbGFzcyk7XG5cbnZhciBfZmlsdGVyTW9kdWxlID0gcmVxdWlyZSgnLi9maWx0ZXItbW9kdWxlJyk7XG5cbnZhciBfZmlsdGVyTW9kdWxlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2ZpbHRlck1vZHVsZSk7XG5cbnZhciBfaGVpZ2h0ID0gcmVxdWlyZSgnLi4vaGVscGVycy9hbmltYXRpb24vaGVpZ2h0Jyk7XG5cbnZhciBfaGVpZ2h0MiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hlaWdodCk7XG5cbnZhciBfYnJlYWtwb2ludCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvZG9tL2JyZWFrcG9pbnQnKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgRmlsdGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBBIGNvbnRhaW5lciBmb3IgYSBzZXQgb2YgZm9ybSBmaWVsZHMgdXNlZCB0byBmaWx0ZXIgYSBkYXRhIHNldCBvciBzZWFyY2ggcmVzdWx0c1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBuZXcgRmlsdGVyKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAbW9kdWxlIGNvbXBvbmVudHMvZmlsdGVyLmpzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTtcblxudmFyIEZpbHRlciA9IGZ1bmN0aW9uIChfQmFzZUNvbXBvbmVudCkge1xuICBfaW5oZXJpdHMoRmlsdGVyLCBfQmFzZUNvbXBvbmVudCk7XG5cbiAgLyoqXG4gICAqIEZpbHRlciBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAqL1xuICBmdW5jdGlvbiBGaWx0ZXIoZWwpIHtcbiAgICB2YXIgX3RoaXM7XG5cbiAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBGaWx0ZXIpO1xuXG4gICAgcGFyYW1zLmVsUmVxdWlyZWQgPSB0cnVlO1xuXG4gICAgaWYgKCEoX3RoaXMgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfQmFzZUNvbXBvbmVudC5jYWxsKHRoaXMsIGVsLCBwYXJhbXMpKSwgX3RoaXMpKSB7XG4gICAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICAgIH1cblxuICAgIF90aGlzLl9iaW5kRXZlbnRMaXN0ZW5lckNhbGxiYWNrcygpO1xuICAgIF90aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIF90aGlzLl9pbml0RmlsdGVyRGlzcGxheSgpO1xuICAgIHJldHVybiBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybihfdGhpcyk7XG4gIH1cblxuICAvKipcbiAgICogU3RvcmUgYSByZWZlcmVuY2UgdG8gdGhlIG5lZWRlZCBlbGVtZW50c1xuICAgKiBAcGFyYW0ge0VsZW1lbnR9IGVsXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fY2FjaGVFbGVtZW50cyA9IGZ1bmN0aW9uIF9jYWNoZUVsZW1lbnRzKGVsKSB7XG4gICAgdGhpcy5lbCA9IGVsO1xuICAgIHRoaXMubW9kdWxlRWxzID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstZmlsdGVyLW1vZHVsZScpO1xuXG4gICAgLy8gVGhlc2Ugb3B0aW9ucyBhcmUgaGVyZSBzbyB0aGF0IHRoZSBtb2R1bGVzIGNhbiBjb21tdW5pY2F0ZSB3aXRoIHRoZSBmaWx0ZXIgdG8gZG8gY2VydGFpbiB0YXNrc1xuICAgIHZhciBkZWZhdWx0T3B0aW9uID0ge1xuICAgICAgb25BZnRlckV4cGFuZDogdGhpcy5fb25BZnRlckV4cGFuZC5iaW5kKHRoaXMpLFxuICAgICAgb25BZnRlckNvbGxhcHNlOiB0aGlzLl9vbkFmdGVyQ29sbGFwc2UuYmluZCh0aGlzKVxuICAgICAgLy9vblNob3dBbGxDb21wbGV0ZTogdGhpcy5fb25TaG93QWxsQ29tcGxldGUuYmluZCh0aGlzKSxcbiAgICB9O1xuXG4gICAgaWYgKHRoaXMubW9kdWxlRWxzLmxlbmd0aCA+IDApIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tb2R1bGVFbHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm1vZHVsZU9wdGlvbnNbaV0gIT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgZm9yICh2YXIga2V5IGluIGRlZmF1bHRPcHRpb24pIHtcbiAgICAgICAgICAgIHRoaXMubW9kdWxlT3B0aW9uc1tpXVtrZXldID0gZGVmYXVsdE9wdGlvbltrZXldO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLm1vZHVsZUluc3RzW2ldID0gbmV3IF9maWx0ZXJNb2R1bGUyLmRlZmF1bHQodGhpcy5tb2R1bGVFbHNbaV0sIHRoaXMubW9kdWxlT3B0aW9uc1tpXSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5tb2R1bGVJbnN0c1tpXSA9IG5ldyBfZmlsdGVyTW9kdWxlMi5kZWZhdWx0KHRoaXMubW9kdWxlRWxzW2ldLCBkZWZhdWx0T3B0aW9uKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX2ZpbHRlclRvZ2dsZUNvbnRhaW5lciA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fdG9nZ2xlLWNvbnRhaW5lcicpO1xuICAgIHRoaXMuX3RvZ2dsZUZpbHRlckJ1dHRvbiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fdG9nZ2xlLWJ1dHRvbicpO1xuICAgIHRoaXMuX3RvZ2dsZUZpbHRlckxhYmVsID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZmlsdGVyX190b2dnbGUtYnV0dG9uIHNwYW4nKTtcbiAgICB0aGlzLl90YWdzQ29udGFpbmVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZmlsdGVyX190YWdzLWNvbnRhaW5lcicpO1xuICAgIHRoaXMuX3RhZ3NDb3VudGVyID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZmlsdGVyX19hcHBsaWVkLWZpbHRlcnMtY291bnRlcicpO1xuICAgIHRoaXMuX2NsZWFyQWxsQnV0dG9uID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZmlsdGVyX19jbGVhci1hbGwnKTtcbiAgICB0aGlzLl9maWx0ZXJDb250ZW50ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstZmlsdGVyX19jb250ZW50Jyk7XG4gICAgdGhpcy5fbW9kdWxlc0NvbnRhaW5lciA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fbW9kdWxlcy1jb250YWluZXInKTtcbiAgICB0aGlzLl92aWV3TW9yZUJ1dHRvbiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fdmlldy1tb3JlLWZpbHRlcnMnKTtcbiAgICB0aGlzLl92aWV3TGVzc0J1dHRvbiA9IHRoaXMuZWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fdmlldy1sZXNzLWZpbHRlcnMnKTtcbiAgICB0aGlzLl9maWx0ZXJGb290ZXIgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1maWx0ZXJfX2Zvb3RlcicpO1xuICAgIHRoaXMuX2J1dHRvbkdyb3VwRWwgPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1maWx0ZXJfX2FwcGx5LWJ0bi1jb250YWluZXInKTtcbiAgICB0aGlzLl9hcHBseUZpbHRlcnNCdXR0b24gPSB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1maWx0ZXJfX2J0bi1hcHBseScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBDcmVhdGUgYm91bmQgdmVyc2lvbnMgb2YgZXZlbnQgbGlzdGVuZXIgY2FsbGJhY2tzIGFuZCBzdG9yZSB0aGVtLlxuICAgKiBPdGhlcndpc2Ugd2UgY2FuJ3QgdW5iaW5kIGZyb20gdGhlc2UgZXZlbnRzIGxhdGVyIGJlY2F1c2UgdGhlXG4gICAqIGZ1bmN0aW9uIHNpZ25hdHVyZXMgd29uJ3QgbWF0Y2guXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MgPSBmdW5jdGlvbiBfYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKSB7XG4gICAgdGhpcy5fb25SZXNpemVCb3VuZCA9IHRoaXMuX29uUmVzaXplLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fdG9nZ2xlVmlld0JvdW5kID0gdGhpcy5fdG9nZ2xlVmlldy5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX3RvZ2dsZUZpbHRlckNsaWNrQm91bmQgPSB0aGlzLnRvZ2dsZUZpbHRlckNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25DbGVhckFsbEJvdW5kID0gdGhpcy5fb25DbGVhckFsbC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuX29uU2Nyb2xsQm91bmQgPSB0aGlzLl9vblNjcm9sbC5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuX29uUmVzaXplQm91bmQpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9vblNjcm9sbEJvdW5kKTtcbiAgICAhdGhpcy5fdmlld01vcmVCdXR0b24gfHwgdGhpcy5fdmlld01vcmVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVWaWV3Qm91bmQpO1xuICAgICF0aGlzLl92aWV3TGVzc0J1dHRvbiB8fCB0aGlzLl92aWV3TGVzc0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX3RvZ2dsZVZpZXdCb3VuZCk7XG4gICAgIXRoaXMuX3RvZ2dsZUZpbHRlckJ1dHRvbiB8fCB0aGlzLl90b2dnbGVGaWx0ZXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVGaWx0ZXJDbGlja0JvdW5kKTtcbiAgICAhdGhpcy5fY2xlYXJBbGxCdXR0b24gfHwgdGhpcy5fY2xlYXJBbGxCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsZWFyQWxsQm91bmQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIHRoaXMuX29uUmVzaXplQm91bmQpO1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdzY3JvbGwnLCB0aGlzLl9vblNjcm9sbEJvdW5kKTtcbiAgICAhdGhpcy5fdmlld01vcmVCdXR0b24gfHwgdGhpcy5fdmlld01vcmVCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVWaWV3Qm91bmQpO1xuICAgICF0aGlzLl92aWV3TGVzc0J1dHRvbiB8fCB0aGlzLl92aWV3TGVzc0J1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX3RvZ2dsZVZpZXdCb3VuZCk7XG4gICAgIXRoaXMuX3RvZ2dsZUZpbHRlckJ1dHRvbiB8fCB0aGlzLl90b2dnbGVGaWx0ZXJCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl90b2dnbGVGaWx0ZXJDbGlja0JvdW5kKTtcbiAgICAhdGhpcy5fY2xlYXJBbGxCdXR0b24gfHwgdGhpcy5fY2xlYXJBbGxCdXR0b24ucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsZWFyQWxsQm91bmQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIGZpbHRlclxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX2luaXRGaWx0ZXJEaXNwbGF5ID0gZnVuY3Rpb24gX2luaXRGaWx0ZXJEaXNwbGF5KCkge1xuICAgIHRoaXMuaW5pdGlhbGl6aW5nRmlsdGVyID0gdHJ1ZTtcblxuICAgIGlmICh0aGlzLm1vZHVsZUVscy5sZW5ndGggPiAwKSB7XG4gICAgICB0aGlzLmV4dHJhTW9kdWxlc0V4cGFuZGVkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLWZpbHRlci0taW5pdGlhbGl6aW5nJyk7XG5cbiAgICB0aGlzLl9kZXRlcm1pbmVGaWx0ZXJMYXlvdXQoKTtcbiAgfTtcblxuICAvKipcbiAgICogRGV0ZXJtaW5lIHdoaWNoIGZpbHRlciBsYXlvdXQgc2hvdWxkIGJlIGRpc3BsYXllZCBpLmUuIEV4cGFuZC9Db2xsYXBzZSB2aWV3IG9yIFdpZGUgdmlld1xuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX2RldGVybWluZUZpbHRlckxheW91dCA9IGZ1bmN0aW9uIF9kZXRlcm1pbmVGaWx0ZXJMYXlvdXQoKSB7XG4gICAgdGhpcy5jdXJyZW50QnJlYWtwb2ludCA9ICgwLCBfYnJlYWtwb2ludC5nZXQpKHdpbmRvdy5pbm5lcldpZHRoKTtcblxuICAgIHN3aXRjaCAodGhpcy5jdXJyZW50QnJlYWtwb2ludCkge1xuICAgICAgY2FzZSAneHMnOlxuICAgICAgICB0aGlzLl9jdXJDb2wgPSAxO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ3NtJzpcbiAgICAgICAgdGhpcy5fY3VyQ29sID0gMjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlICdtZCc6XG4gICAgICAgIHRoaXMuX2N1ckNvbCA9IDM7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhpcy5fY3VyQ29sID0gNDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2N1ckNvbCA8PSAxKSB7XG4gICAgICAvLyBEaXNwbGF5IGV4cGFuZC1jb2xsYXBzZSBmaWx0ZXJcbiAgICAgIGlmICghdGhpcy5faXNEcm9wZG93blN0YXRlKSB7XG4gICAgICAgIHRoaXMuX2FwcGx5RXhwYW5kQ29sbGFwc2VMYXlvdXQoKTtcbiAgICAgICAgdGhpcy5fc2hvd01vZHVsZSgpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAvLyBEaXNwbGF5IHdpZGUtc2NyZWVuIGZpbHRlclxuICAgICAgaWYgKHRoaXMuX2V4cGFuZENvbGxhcHNlU3RhdGUpIHtcbiAgICAgICAgdGhpcy5fcmVtb3ZlRXhwYW5kQ29sbGFwc2VMYXlvdXQoKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2J1dHRvbkdyb3VwRWwsICdpcy1maXhlZCcpKSB7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aGlzLl90aW1lb3V0KTtcbiAgICAgICAgdGhpcy5fZmlsdGVyRm9vdGVyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uR3JvdXBFbC5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2J1dHRvbkdyb3VwRWwsICdpcy1maXhlZCcpO1xuICAgICAgfVxuXG4gICAgICB0aGlzLl9zaG93TW9kdWxlKCk7XG5cbiAgICAgIGlmICghdGhpcy5leHRyYU1vZHVsZXNFeHBhbmRlZCkge1xuICAgICAgICB0aGlzLl9oaWRlTW9kdWxlKHRoaXMuX2N1ckNvbCwgdGhpcy5fbWF4Q29sIC0gMSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRGV0ZXJtaW5lIHdoZXRoZXIgdG8gc2hvdyBvciBoaWRlIFZpZXcgTW9yZS9MZXNzIGJ1dHRvbnNcbiAgICBpZiAoIXRoaXMuX2lzRHJvcGRvd25TdGF0ZSkge1xuICAgICAgdmFyIGhpZGRlbk1vZHVsZXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstZmlsdGVyLW1vZHVsZS5oaWRlJyk7XG5cbiAgICAgIGlmICghdGhpcy5leHRyYU1vZHVsZXNFeHBhbmRlZCAmJiBoaWRkZW5Nb2R1bGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl92aWV3TW9yZUJ1dHRvbiwgJ2hpZGUnKTtcbiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuZXh0cmFNb2R1bGVzRXhwYW5kZWQgJiYgaGlkZGVuTW9kdWxlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX3ZpZXdNb3JlQnV0dG9uLCAnaGlkZScpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogVXBkYXRlIHRoZSBmaWx0ZXIgbGF5b3V0IGFzIG5lY2Vzc2FyeVxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX3VwZGF0ZUZpbHRlckxheW91dCA9IGZ1bmN0aW9uIF91cGRhdGVGaWx0ZXJMYXlvdXQoKSB7XG4gICAgdGhpcy5fZGV0ZXJtaW5lRmlsdGVyTGF5b3V0KCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIEV4cGFuZCBvciBjb2xsYXBzZSBleHRyYSBmaWx0ZXJzXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fdG9nZ2xlVmlldyA9IGZ1bmN0aW9uIF90b2dnbGVWaWV3KCkge1xuICAgIGlmICh0aGlzLl9pc0ZpbHRlckV4cGFuZGVkICYmICF0aGlzLmV4dHJhTW9kdWxlc0V4cGFuZGVkKSB7XG4gICAgICB0aGlzLl9zaG93TW9kdWxlKCk7XG4gICAgICB0aGlzLl9kaXNwYXRjaFZpc2liaWxpdHlFdmVudCgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5faXNGaWx0ZXJFeHBhbmRlZCAmJiB0aGlzLmV4dHJhTW9kdWxlc0V4cGFuZGVkKSB7XG4gICAgICB0aGlzLl9oaWRlTW9kdWxlKHRoaXMuX2N1ckNvbCwgdGhpcy5fbWF4Q29sIC0gMSk7XG4gICAgfVxuXG4gICAgdGhpcy5leHRyYU1vZHVsZXNFeHBhbmRlZCA9ICF0aGlzLmV4dHJhTW9kdWxlc0V4cGFuZGVkO1xuICAgICgwLCBfdG9nZ2xlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX3ZpZXdNb3JlQnV0dG9uLCAnaGlkZScpO1xuICAgICgwLCBfdG9nZ2xlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX3ZpZXdMZXNzQnV0dG9uLCAnaGlkZScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBIYW5kbGUgY2xpY2sgZXZlbnQgd2hlbiBmaWx0ZXIgdG9nZ2xlcyBhcmUgY2xpY2tlZFxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUudG9nZ2xlRmlsdGVyQ2xpY2sgPSBmdW5jdGlvbiB0b2dnbGVGaWx0ZXJDbGljaygpIHtcbiAgICBpZiAodGhpcy5pbml0aWFsaXppbmdGaWx0ZXIpIHtcbiAgICAgIHRoaXMuaW5pdGlhbGl6aW5nRmlsdGVyID0gZmFsc2U7XG4gICAgfVxuXG4gICAgdGhpcy50b2dnbGVGaWx0ZXIoKTtcbiAgfTtcblxuICAvKipcbiAgICogVG8gaGlkZSBvciBzaG93IGZpbHRlciBtb2R1bGVcbiAgICogQHBhcmFtcyB7U3RyaW5nfSB0b2dnbGU7IGNvbGxhcHNlOyBleHBhbmQ7XG4gICAqIEBwYXJhbXMge0Jvb2xlYW59IENoYW5nZSB0aGUgdmFsdWUgb2YgYHRoaXMuX2lzRmlsdGVyRXhwYW5kZWRgIGJhc2VkIG9uIHRoZSBib29sZWFuIHZhbHVlXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS50b2dnbGVGaWx0ZXIgPSBmdW5jdGlvbiB0b2dnbGVGaWx0ZXIob3B0aW9uLCBub1N0YXRlQ2hhbmdlKSB7XG4gICAgaWYgKCgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdzcGFyay1maWx0ZXItLWluaXRpYWxpemluZycpICYmICF0aGlzLmluaXRpYWxpemluZ0ZpbHRlcikge1xuICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLWZpbHRlci0taW5pdGlhbGl6aW5nJyk7XG4gICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnc3BhcmstZmlsdGVyLS1pbml0aWFsaXplZCcpO1xuICAgIH1cblxuICAgIGlmIChvcHRpb24gPT09ICdleHBhbmQnKSB7XG4gICAgICBpZiAoIXRoaXMuaW5pdGlhbGl6aW5nRmlsdGVyKSB7XG4gICAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2ZpbHRlckNvbnRlbnQsICdoaWRlJyk7XG5cbiAgICAgICAgKDAsIF9oZWlnaHQyLmRlZmF1bHQpKHtcbiAgICAgICAgICBlbDogdGhpcy5lbCxcbiAgICAgICAgICB0b2dnbGVFbDogJy5zcGFyay1maWx0ZXJfX2NvbnRlbnQnLFxuICAgICAgICAgIHRvZ2dsZUNsYXNzOiAnZmlsdGVyLWV4cGFuZGVkJyxcbiAgICAgICAgICBhY3Rpb246ICdleHBhbmQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3RvZ2dsZUZpbHRlckxhYmVsLmlubmVySFRNTCA9ICdIaWRlJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2ZpbHRlckNvbnRlbnQsICdoaWRlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghbm9TdGF0ZUNoYW5nZSkge1xuICAgICAgICB0aGlzLl9pc0ZpbHRlckV4cGFuZGVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG9wdGlvbiA9PT0gJ2NvbGxhcHNlJykge1xuICAgICAgaWYgKCF0aGlzLmluaXRpYWxpemluZ0ZpbHRlcikge1xuICAgICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl9maWx0ZXJDb250ZW50LCAnaGlkZScpO1xuXG4gICAgICAgICgwLCBfaGVpZ2h0Mi5kZWZhdWx0KSh7XG4gICAgICAgICAgZWw6IHRoaXMuZWwsXG4gICAgICAgICAgdG9nZ2xlRWw6ICcuc3BhcmstZmlsdGVyX19jb250ZW50JyxcbiAgICAgICAgICB0b2dnbGVDbGFzczogJ2ZpbHRlci1leHBhbmRlZCcsXG4gICAgICAgICAgYWN0aW9uOiAnY29sbGFwc2UnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3RvZ2dsZUZpbHRlckxhYmVsLmlubmVySFRNTCA9ICdTaG93JztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2ZpbHRlckNvbnRlbnQsICdoaWRlJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghbm9TdGF0ZUNoYW5nZSkge1xuICAgICAgICB0aGlzLl9pc0ZpbHRlckV4cGFuZGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICgwLCBfdG9nZ2xlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2ZpbHRlckNvbnRlbnQsICdoaWRlJyk7XG5cbiAgICAgIGlmICgoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnZmlsdGVyLWV4cGFuZGVkJykpIHtcbiAgICAgICAgKDAsIF9oZWlnaHQyLmRlZmF1bHQpKHtcbiAgICAgICAgICBlbDogdGhpcy5lbCxcbiAgICAgICAgICB0b2dnbGVFbDogJy5zcGFyay1maWx0ZXJfX2NvbnRlbnQnLFxuICAgICAgICAgIHRvZ2dsZUNsYXNzOiAnZmlsdGVyLWV4cGFuZGVkJyxcbiAgICAgICAgICBhY3Rpb246ICdjb2xsYXBzZSdcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fdG9nZ2xlRmlsdGVyTGFiZWwuaW5uZXJIVE1MID0gJ1Nob3cnO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgKDAsIF9oZWlnaHQyLmRlZmF1bHQpKHtcbiAgICAgICAgICBlbDogdGhpcy5lbCxcbiAgICAgICAgICB0b2dnbGVFbDogJy5zcGFyay1maWx0ZXJfX2NvbnRlbnQnLFxuICAgICAgICAgIHRvZ2dsZUNsYXNzOiAnZmlsdGVyLWV4cGFuZGVkJyxcbiAgICAgICAgICBhY3Rpb246ICdleHBhbmQnXG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX3RvZ2dsZUZpbHRlckxhYmVsLmlubmVySFRNTCA9ICdIaWRlJztcbiAgICAgIH1cblxuICAgICAgaWYgKCFub1N0YXRlQ2hhbmdlKSB7XG4gICAgICAgIHRoaXMuX2lzRmlsdGVyRXhwYW5kZWQgPSAhdGhpcy5faXNGaWx0ZXJFeHBhbmRlZDtcblxuICAgICAgICBpZiAoKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLWZpbHRlci0tZHJvcGRvd24nKSAmJiAhKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkodGhpcy5fZmlsdGVyQ29udGVudCwgJ2hpZGUnKSkge1xuICAgICAgICAgIHRoaXMuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24oKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICghKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLWZpbHRlci0tZHJvcGRvd24nKSAmJiAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLl9idXR0b25Hcm91cEVsLCAnaXMtZml4ZWQnKSkge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3RpbWVvdXQpO1xuICAgICAgdGhpcy5fZmlsdGVyRm9vdGVyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAgIHRoaXMuX2J1dHRvbkdyb3VwRWwucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5fYnV0dG9uR3JvdXBFbCwgJ2lzLWZpeGVkJyk7XG4gICAgfVxuXG4gICAgdGhpcy5fZGlzcGF0Y2hWaXNpYmlsaXR5RXZlbnQoKTtcbiAgfTtcblxuICAvKipcbiAgICogT24tcmVzaXplIGhhbmRsZXIgdGhhdCB1cGRhdGVzIGxheW91dCBhcyBuZWVkZWQgYmFzZWQgb24gc2NyZWVuIGRpbWVuc2lvbnNcbiAgICovXG5cblxuICBGaWx0ZXIucHJvdG90eXBlLl9vblJlc2l6ZSA9IGZ1bmN0aW9uIF9vblJlc2l6ZSgpIHtcbiAgICB0aGlzLl91cGRhdGVGaWx0ZXJMYXlvdXQoKTtcbiAgfTtcblxuICAvKipcbiAgICogT24tc2Nyb2xsIGhhbmRsZXIgdGhhdCBkZXRlcm1pbmVzIEFwcGx5IGJ1dHRvbiBwb3NpdGlvbmluZyBhdCB0aGUgeHMgYnJlYWtwb2ludFxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX29uU2Nyb2xsID0gZnVuY3Rpb24gX29uU2Nyb2xsKCkge1xuICAgIGlmICh0aGlzLl9pc0Ryb3Bkb3duU3RhdGUpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24uYmluZCh0aGlzKSwgMzAwKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIHRyaWdnZXJlZCBhZnRlciB0aGUgZXhwYW5zaW9uIG9mIGEgbW9kdWxlIGF0IHRoZSB4cyBicmVha3BvaW50XG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fb25BZnRlckV4cGFuZCA9IGZ1bmN0aW9uIF9vbkFmdGVyRXhwYW5kKCkge1xuICAgIGlmICghKDAsIF9oYXNDbGFzczIuZGVmYXVsdCkodGhpcy5fYnV0dG9uR3JvdXBFbCwgJ2lzLWZpeGVkJykpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24uYmluZCh0aGlzKSwgMzAwKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGxiYWNrIHRyaWdnZXJlZCBhZnRlciB0aGUgY29sbGFwc2Ugb2YgYSBtb2R1bGUgYXQgdGhlIHhzIGJyZWFrcG9pbnRcbiAgICovXG5cblxuICBGaWx0ZXIucHJvdG90eXBlLl9vbkFmdGVyQ29sbGFwc2UgPSBmdW5jdGlvbiBfb25BZnRlckNvbGxhcHNlKCkge1xuICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24uYmluZCh0aGlzKSwgMzAwKTtcbiAgfTtcblxuICAvKipcbiAgICogQ2FsbGJhY2sgdHJpZ2dlcmVkIGFmdGVyIFNob3cgYWxsIGlzIGNvbXBsZXRlIGF0IHRoZSB4cyBicmVha3BvaW50XG4gICAqL1xuXG4gIC8qIFRPRE86IFRoaXMgaXMgbm90IHJlcXVpcmVkIGFueW1vcmUgYXMgc2hvdyBhbGwgaXMgbm90IGF2YWlsYWJsZSBhdCB0aGUgeHMgYnJlYWtwb2ludCBhbnltb3JlXG4gIF9vblNob3dBbGxDb21wbGV0ZSgpIHtcbiAgICBpZih0aGlzLl9pc0Ryb3Bkb3duU3RhdGUpIHtcbiAgICAgIHRoaXMuX3RpbWVvdXQgPSBzZXRUaW1lb3V0KHRoaXMuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24uYmluZCh0aGlzKSwgMzAwKTtcbiAgICB9XG4gIH1cbiAgKi9cblxuICAvKipcbiAgICogRGlzcGF0Y2ggYSBjdXN0b20gZXZlbnQgc28gY29udGVudCBpbnNpZGUgdGhlIEZpbHRlciBjYW4gcmVzcG9uZFxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX2Rpc3BhdGNoVmlzaWJpbGl0eUV2ZW50ID0gZnVuY3Rpb24gX2Rpc3BhdGNoVmlzaWJpbGl0eUV2ZW50KCkge1xuICAgIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgZS5pbml0RXZlbnQoJ3NwYXJrLnZpc2libGUtY2hpbGRyZW4nLCB0cnVlLCB0cnVlKTtcbiAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENhbGN1bGF0ZSB0aGUgcG9zaXRpb24gb2YgdGhlIEFwcGx5IGJ1dHRvbiBhdCB0aGUgeHMgYnJlYWtwb2ludFxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX2NhbGN1bGF0ZUFwcGx5QnRuUG9zaXRpb24gPSBmdW5jdGlvbiBfY2FsY3VsYXRlQXBwbHlCdG5Qb3NpdGlvbigpIHtcblxuICAgIHZhciBmaWx0ZXJPZmZzZXRzID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgIGlmIChmaWx0ZXJPZmZzZXRzLmhlaWdodCA+IDI1NSkge1xuICAgICAgLy8gMyBjb2xsYXBzZWQgbW9kdWxlIGhlaWdodHMgKyBmaWx0ZXIgaGVhZGVyIGhlaWdodCA9IDI1NVxuICAgICAgdmFyIHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgIHZhciBzY3JvbGxUb3AgPSB3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCB8fCBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCB8fCAwO1xuICAgICAgdmFyIGZpbHRlckhpZGRlbkJlZm9yZSA9IHNjcm9sbFRvcCAtIChmaWx0ZXJPZmZzZXRzLnRvcCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wKTtcbiAgICAgIHZhciBmaWx0ZXJIaWRkZW5BZnRlciA9IGZpbHRlck9mZnNldHMudG9wICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgKyBmaWx0ZXJPZmZzZXRzLmhlaWdodCAtIChzY3JvbGxUb3AgKyB3aW5kb3dIZWlnaHQpO1xuXG4gICAgICBpZiAoIShzY3JvbGxUb3AgPiBmaWx0ZXJPZmZzZXRzLnRvcCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgZmlsdGVyT2Zmc2V0cy5oZWlnaHQgfHwgZmlsdGVyT2Zmc2V0cy50b3AgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCA+IHNjcm9sbFRvcCArIHdpbmRvdy5pbm5lckhlaWdodCkpIHtcbiAgICAgICAgdmFyIHBlcmNlbnRJblZpZXcgPSAxMDA7XG4gICAgICAgIHZhciBpblZpZXdwb3J0O1xuICAgICAgICB2YXIgaGlkZGVuQmVmb3JlID0gMDtcbiAgICAgICAgdmFyIGhpZGRlbkFmdGVyID0gMDtcblxuICAgICAgICBpZiAoZmlsdGVySGlkZGVuQmVmb3JlID4gMCkge1xuICAgICAgICAgIHBlcmNlbnRJblZpZXcgLT0gZmlsdGVySGlkZGVuQmVmb3JlICogMTAwIC8gZmlsdGVyT2Zmc2V0cy5oZWlnaHQ7XG4gICAgICAgICAgaGlkZGVuQmVmb3JlID0gZmlsdGVySGlkZGVuQmVmb3JlO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZpbHRlckhpZGRlbkFmdGVyID4gMCkge1xuICAgICAgICAgIHBlcmNlbnRJblZpZXcgLT0gZmlsdGVySGlkZGVuQWZ0ZXIgKiAxMDAgLyBmaWx0ZXJPZmZzZXRzLmhlaWdodDtcbiAgICAgICAgICBoaWRkZW5BZnRlciA9IGZpbHRlckhpZGRlbkFmdGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgaW5WaWV3cG9ydCA9IChmaWx0ZXJPZmZzZXRzLmhlaWdodCAtIChoaWRkZW5BZnRlciArIGhpZGRlbkJlZm9yZSkpIC8gd2luZG93SGVpZ2h0ICogMTAwO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmlsdGVyT2Zmc2V0cy5ib3R0b20gPiAod2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpICYmIChwZXJjZW50SW5WaWV3ID4gNDUgfHwgaW5WaWV3cG9ydCA+IDUwKSkge1xuICAgICAgICB2YXIgYnV0dG9uR3JvdXBIZWlnaHQgPSB0aGlzLl9idXR0b25Hcm91cEVsLm9mZnNldEhlaWdodDtcbiAgICAgICAgdmFyIGZpbHRlcldpZHRoID0gZmlsdGVyT2Zmc2V0cy53aWR0aDtcblxuICAgICAgICB0aGlzLl9maWx0ZXJGb290ZXIuc3R5bGUuaGVpZ2h0ID0gYnV0dG9uR3JvdXBIZWlnaHQgKyAncHgnO1xuICAgICAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl9idXR0b25Hcm91cEVsLCAnaXMtZml4ZWQnKTtcbiAgICAgICAgdGhpcy5fYnV0dG9uR3JvdXBFbC5zdHlsZS53aWR0aCA9IGZpbHRlcldpZHRoIC0gMiArICdweCc7IC8vIGFjY291bnRpbmcgZm9yIGJvcmRlciB3aWR0aFxuICAgICAgICB0aGlzLl9idXR0b25Hcm91cEVsLnN0eWxlLmxlZnQgPSBmaWx0ZXJPZmZzZXRzLmxlZnQgKyAxICsgJ3B4JzsgLy8gYWNjb3VudGluZyBmb3IgbGVmdCBib3JkZXJcblxuICAgICAgICB0aGlzLl9hcHBseUJ0blBvc2l0aW9uRml4ZWQoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuX2FwcGx5QnRuUG9zaXRpb25SZWxhdGl2ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogU2V0IHBvc2l0aW9uOnJlbGF0aXZlIGZvciB0aGUgQXBwbHkgYnV0dG9uXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fYXBwbHlCdG5Qb3NpdGlvblJlbGF0aXZlID0gZnVuY3Rpb24gX2FwcGx5QnRuUG9zaXRpb25SZWxhdGl2ZSgpIHtcblxuICAgIC8vZnVuY3Rpb24gYXR0YWNoQXBwbHlCdG4oKXtcbiAgICB2YXIgY3VycmVudEJ1dHRvblBvc2l0aW9uID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLl9idXR0b25Hcm91cEVsKS5ib3R0b20pO1xuICAgIHZhciBsaXN0Qm90dG9tID0gdGhpcy5fbW9kdWxlc0NvbnRhaW5lci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b207XG4gICAgdmFyIHZpZXdwb3J0SGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgdmFyIGJ1dHRvbkdyb3VwSGVpZ2h0ID0gdGhpcy5fYnV0dG9uR3JvdXBFbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5oZWlnaHQ7XG4gICAgdmFyIGRpc3RhbmNlVG9Nb3ZlID0gdmlld3BvcnRIZWlnaHQgLSAobGlzdEJvdHRvbSArIGJ1dHRvbkdyb3VwSGVpZ2h0KTtcblxuICAgIGlmICghaXNOYU4oY3VycmVudEJ1dHRvblBvc2l0aW9uKSkge1xuICAgICAgdmFyIGFuaW1hdGlvbkxpc3RlbmVyID0gZnVuY3Rpb24gYW5pbWF0aW9uTGlzdGVuZXIoKSB7XG4gICAgICAgIHRoaXMuX2ZpbHRlckZvb3Rlci5yZW1vdmVBdHRyaWJ1dGUoJ3N0eWxlJyk7XG4gICAgICAgIHRoaXMuX2J1dHRvbkdyb3VwRWwucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpO1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl9idXR0b25Hcm91cEVsLCAnaXMtZml4ZWQnKTtcbiAgICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5fYnV0dG9uR3JvdXBFbCwgJ3NwYXJrLWZpbHRlcl9fYXBwbHktYnRuLWNvbnRhaW5lci0tYW5pbWF0ZScpO1xuICAgICAgICB0aGlzLl9idXR0b25Hcm91cEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2FuaW1hdGlvbmVuZCcsIGFuaW1hdGlvbkxpc3RlbmVyKTtcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX2J1dHRvbkdyb3VwRWwuYWRkRXZlbnRMaXN0ZW5lcignYW5pbWF0aW9uZW5kJywgYW5pbWF0aW9uTGlzdGVuZXIuYmluZCh0aGlzKSwgZmFsc2UpO1xuXG4gICAgICB2YXIga2V5ZnJhbWUgPSAnLXdlYmtpdC10cmFuc2Zvcm06IHRyYW5zbGF0ZVkoLScgKyBkaXN0YW5jZVRvTW92ZSArICdweCk7IHRyYW5zZm9ybTogdHJhbnNsYXRlWSgtJyArIGRpc3RhbmNlVG9Nb3ZlICsgJ3B4KTsnO1xuXG4gICAgICB0aGlzLl9idXR0b25Hcm91cEVsLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCB0aGlzLl9idXR0b25Hcm91cEVsLmdldEF0dHJpYnV0ZSgnc3R5bGUnKSArICcgJyArIGtleWZyYW1lKTtcbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2J1dHRvbkdyb3VwRWwsICdzcGFyay1maWx0ZXJfX2FwcGx5LWJ0bi1jb250YWluZXItLWFuaW1hdGUnKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFNldCBwb3NpdGlvbjpmaXhlZCBmb3IgdGhlIEFwcGx5IGJ1dHRvblxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX2FwcGx5QnRuUG9zaXRpb25GaXhlZCA9IGZ1bmN0aW9uIF9hcHBseUJ0blBvc2l0aW9uRml4ZWQoKSB7XG4gICAgdmFyIHJlcXVlc3RJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShtb3ZlQXBwbHlCdG4uYmluZCh0aGlzKSk7XG4gICAgdmFyIGluY3JlbWVudGVyID0gLjE7XG5cbiAgICBmdW5jdGlvbiBtb3ZlQXBwbHlCdG4oKSB7XG4gICAgICBpbmNyZW1lbnRlciArPSAuMDE7XG4gICAgICB2YXIgY3VycmVudEJ1dHRvblBvc2l0aW9uID0gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZSh0aGlzLl9idXR0b25Hcm91cEVsKS5ib3R0b20pO1xuICAgICAgdmFyIGJ1dHRvbkhlaWdodCA9IHBhcnNlSW50KGdldENvbXB1dGVkU3R5bGUodGhpcy5fYnV0dG9uR3JvdXBFbCkuaGVpZ2h0KTtcblxuICAgICAgaWYgKGN1cnJlbnRCdXR0b25Qb3NpdGlvbiA8IGJ1dHRvbkhlaWdodCAqIC0xKSB7XG4gICAgICAgIGN1cnJlbnRCdXR0b25Qb3NpdGlvbiA9IGJ1dHRvbkhlaWdodCAqIC0xO1xuICAgICAgfVxuXG4gICAgICBpZiAoY3VycmVudEJ1dHRvblBvc2l0aW9uID4gLTEpIHtcbiAgICAgICAgdGhpcy5fYnV0dG9uR3JvdXBFbC5zdHlsZS5ib3R0b20gPSAnMHB4JztcbiAgICAgICAgY2FuY2VsQW5pbWF0aW9uRnJhbWUocmVxdWVzdElEKTtcbiAgICAgIH0gZWxzZSBpZiAoY3VycmVudEJ1dHRvblBvc2l0aW9uIDwgMCkge1xuICAgICAgICBjdXJyZW50QnV0dG9uUG9zaXRpb24gKz0gMSAvIGluY3JlbWVudGVyO1xuICAgICAgICB0aGlzLl9idXR0b25Hcm91cEVsLnN0eWxlLmJvdHRvbSA9IGN1cnJlbnRCdXR0b25Qb3NpdGlvbiArICdweCc7XG4gICAgICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZShtb3ZlQXBwbHlCdG4uYmluZCh0aGlzKSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBDYWxsYmFjayBmb3IgQ2xlYXIgYWxsXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fb25DbGVhckFsbCA9IGZ1bmN0aW9uIF9vbkNsZWFyQWxsKCkge1xuICAgICh0aGlzLm9uQ2xlYXJBbGwgfHwgbm9vcCkoKTtcbiAgfTtcblxuICAvKipcbiAgICogU2hvdyBhbGwgbW9kdWxlc1xuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX3Nob3dNb2R1bGUgPSBmdW5jdGlvbiBfc2hvd01vZHVsZSgpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubW9kdWxlRWxzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLm1vZHVsZUVsc1tpXSwgJ2hpZGUnKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIEhpZGUgY2VydGFpbiBtb2R1bGVzXG4gICAqIEBwYXJhbSB7TnVtYmVyfSBzdGFydCBpbmRleFxuICAgKiBAcGFyYW0ge051bWJlcn0gZW5kIGluZGV4XG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5faGlkZU1vZHVsZSA9IGZ1bmN0aW9uIF9oaWRlTW9kdWxlKHN0YXJ0LCBlbmQpIHtcbiAgICBlbmQgPSBlbmQgfHwgdGhpcy5tb2R1bGVFbHMubGVuZ3RoIC0gMTtcbiAgICBmb3IgKHZhciBpID0gc3RhcnQ7IGkgPD0gZW5kOyBpKyspIHtcbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMubW9kdWxlRWxzW2ldLCAnaGlkZScpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogQXBwbHkgRXhwYW5kL0NvbGxhcHNlIGxheW91dCBmb3IgdGhlIGZpbHRlclxuICAgKiBVc2VkIHdoZW4gdGhlIGZpbHRlciBnZXRzIHRvIHRoZSB4cyBicmVha3BvaW50XG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5fYXBwbHlFeHBhbmRDb2xsYXBzZUxheW91dCA9IGZ1bmN0aW9uIF9hcHBseUV4cGFuZENvbGxhcHNlTGF5b3V0KCkge1xuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdzcGFyay1maWx0ZXItLWRyb3Bkb3duJyk7XG4gICAgdGhpcy5fZXhwYW5kQ29sbGFwc2VTdGF0ZSA9IHRydWU7XG5cbiAgICB2YXIgdGFncyA9IHRoaXMuX3RhZ3NDb250YWluZXIucXVlcnlTZWxlY3RvckFsbCgnLnNwYXJrLWZpbHRlcl9fdGFnJyk7XG4gICAgaWYgKHRhZ3MubGVuZ3RoID4gMCkge1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YWdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRhZ3NbaV0sICdoaWRlJyk7XG4gICAgICB9XG4gICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl90YWdzQ291bnRlciwgJ2hpZGUnKTtcbiAgICB9XG5cbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl92aWV3TW9yZUJ1dHRvbiwgJ2hpZGUnKTtcbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl92aWV3TGVzc0J1dHRvbiwgJ2hpZGUnKTtcblxuICAgIGlmICh0aGlzLl9hcHBseUZpbHRlcnNCdXR0b24pIHtcbiAgICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2FwcGx5RmlsdGVyc0J1dHRvbiwgJ3NwYXJrLWJ0bi0tc20nKTtcbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2FwcGx5RmlsdGVyc0J1dHRvbiwgJ3NwYXJrLWJ0bi0tYmxvY2snKTtcbiAgICB9XG5cbiAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubW9kdWxlSW5zdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgIHRoaXMubW9kdWxlSW5zdHNbal0uX2FwcGx5RXhwYW5kKCk7XG4gICAgfVxuXG4gICAgdGhpcy5faXNEcm9wZG93blN0YXRlID0gdHJ1ZTtcbiAgICB0aGlzLl90aW1lb3V0ID0gc2V0VGltZW91dCh0aGlzLl9jYWxjdWxhdGVBcHBseUJ0blBvc2l0aW9uLmJpbmQodGhpcyksIDMwMCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFJlbW92ZSBFeHBhbmQvQ29sbGFwc2UgbGF5b3V0IGFuZCBhcHBseSB0aGUgaG9yaXpvbnRhbCBsYXlvdXQgZm9yIHRoZSBmaWx0ZXJcbiAgICogVXNlZCB3aGVuIHRoZSBzY3JlZW4gc2l6ZSBpcyBsYXJnZXIgdGhhbiB0aGUgeHMgYnJlYWtwb2ludFxuICAgKi9cblxuXG4gIEZpbHRlci5wcm90b3R5cGUuX3JlbW92ZUV4cGFuZENvbGxhcHNlTGF5b3V0ID0gZnVuY3Rpb24gX3JlbW92ZUV4cGFuZENvbGxhcHNlTGF5b3V0KCkge1xuXG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5lbCwgJ3NwYXJrLWZpbHRlci0tZHJvcGRvd24nKTtcbiAgICB0aGlzLl9leHBhbmRDb2xsYXBzZVN0YXRlID0gZmFsc2U7XG4gICAgdGhpcy5fZmlsdGVyRm9vdGVyLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICB0aGlzLl9idXR0b25Hcm91cEVsLnJlbW92ZUF0dHJpYnV0ZSgnc3R5bGUnKTtcbiAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl9idXR0b25Hcm91cEVsLCAnaXMtZml4ZWQnKTtcblxuICAgIHZhciB0YWdzID0gdGhpcy5fdGFnc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstZmlsdGVyX190YWcnKTtcbiAgICBpZiAodGFncy5sZW5ndGggPiAwKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGFnc1tpXSwgJ2hpZGUnKTtcbiAgICAgIH1cbiAgICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX3RhZ3NDb3VudGVyLCAnaGlkZScpO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmV4dHJhTW9kdWxlc0V4cGFuZGVkKSB7XG4gICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl92aWV3TGVzc0J1dHRvbiwgJ2hpZGUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5fdmlld01vcmVCdXR0b24sICdoaWRlJyk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuX2FwcGx5RmlsdGVyc0J1dHRvbikge1xuICAgICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodGhpcy5fYXBwbHlGaWx0ZXJzQnV0dG9uLCAnc3BhcmstYnRuLS1zbScpO1xuICAgICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkodGhpcy5fYXBwbHlGaWx0ZXJzQnV0dG9uLCAnc3BhcmstYnRuLS1ibG9jaycpO1xuICAgIH1cblxuICAgIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5tb2R1bGVJbnN0cy5sZW5ndGg7IGorKykge1xuICAgICAgdGhpcy5tb2R1bGVJbnN0c1tqXS5fZGlzYXBwbHlFeHBhbmQoKTtcbiAgICB9XG4gICAgdGhpcy5faXNEcm9wZG93blN0YXRlID0gZmFsc2U7XG4gIH07XG5cbiAgLyoqXG4gICAqIEdlbmVyYXRlIGEgdGFnIGVsZW1lbnQgaW4gZmlsdGVyLCB3aGljaCB3aWxsIGJlIGRpcmVjdGx5IHBvc3RlZCBpbnNpZGUgYC5zcGFyay1maWx0ZXJfX3RhZ3MtY29udGFpbmVyYFxuICAgKiBAcGFyYW0ge3N0cmluZ30gaW5wdXQgbmFtZSAtIE5hbWUgb2YgdGhlIGlucHV0IHRvIGFsbG93IGFueSBjYWxsYmFja3MgdG8gdGFyZ2V0IGlucHV0IHNwZWNpZmljYWxseVxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGFnIGxhYmVsIC0gVGhlIGxhYmVsIHRvIGJlIGRpc3BsYXllZCBpbiB0aGUgdGFnLiBUaGlzIGNvdWxkIGJlIHRoZSBpbnB1dCdzIGxhYmVsIG9yIGFub3RoZXIgdXNlciBkZWZpbmVkIGxhYmVsXG4gICAqIEBwYXJhbSB7ZnVuY3Rpb259IGNhbGxiYWNrIGZ1bmN0aW9uIGZvciBgWGAgYnV0dG9uXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5jcmVhdGVUYWdFbCA9IGZ1bmN0aW9uIGNyZWF0ZVRhZ0VsKGlucHV0LCBsYWJlbCwgY2xlYXJDYWxsYmFjaykge1xuICAgIHZhciB0YWdFbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHRhZ0VsLmNsYXNzTmFtZSA9ICgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKHRoaXMuZWwsICdzcGFyay1maWx0ZXItLWRyb3Bkb3duJykgPyAnc3BhcmstZmlsdGVyX190YWcgaGlkZScgOiAnc3BhcmstZmlsdGVyX190YWcnO1xuICAgIHRhZ0VsLnNldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXItbmFtZScsIGlucHV0KTtcbiAgICB0YWdFbC5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9XCJzcGFyay1maWx0ZXJfX3RhZ19fbGFiZWxcIj4nICsgbGFiZWwgKyAnPC9zcGFuPjxpIGNsYXNzPVwic3BhcmstaWNvbiBzcGFyay1maWx0ZXJfX3RhZ19fY2xvc2VcIj7vhKM8L2k+JztcblxuICAgIHRoaXMuX3RhZ3NDb250YWluZXIuaW5zZXJ0QmVmb3JlKHRhZ0VsLCB0aGlzLl9jbGVhckFsbEJ1dHRvbik7XG5cbiAgICAvLyBjcmVhdGUgZXZlbnQgbGlzdGVuZXIgYWZ0ZXIgYWRkaW5nIGVsZW1lbnQgdG8gRE9NXG4gICAgdGFnRWwucXVlcnlTZWxlY3RvcignLnNwYXJrLWZpbHRlcl9fdGFnX19jbG9zZScpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2xlYXJDYWxsYmFjayB8fCBub29wKTtcblxuICAgICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHRoaXMuX2NsZWFyQWxsQnV0dG9uLCAnaGlkZScpO1xuXG4gICAgLy8gU2hvdyB0YWcgY291bnQgaWYgb24gc21hbGwgc2NyZWVuIGFuZCB0aGlzIGlzIGluaXRpYWwgYXBwbGljYXRpb24gb2YgZmlsdGVyc1xuICAgIGlmICgoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsLCAnc3BhcmstZmlsdGVyLS1kcm9wZG93bicpKSAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KSh0aGlzLl90YWdzQ291bnRlciwgJ2hpZGUnKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGFsbCB0YWdzXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5jbGVhckFsbFRhZ0VscyA9IGZ1bmN0aW9uIGNsZWFyQWxsVGFnRWxzKCkge1xuICAgIHZhciB0YWdzID0gdGhpcy5fdGFnc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yQWxsKCcuc3BhcmstZmlsdGVyX190YWcnKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRhZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuX3RhZ3NDb250YWluZXIucmVtb3ZlQ2hpbGQodGFnc1tpXSk7XG4gICAgfVxuXG4gICAgLy8gUmVzZXQgY291bnRlclxuICAgIHZhciBjb3VudGVyID0gdGhpcy5fdGFnc0NvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCdzcGFuJyk7XG4gICAgY291bnRlci5pbm5lckhUTUwgPSAnMCc7XG5cbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl9jbGVhckFsbEJ1dHRvbiwgJ2hpZGUnKTtcbiAgICAoMCwgX2FkZENsYXNzMi5kZWZhdWx0KSh0aGlzLl90YWdzQ291bnRlciwgJ2hpZGUnKTtcbiAgfTtcblxuICAvKipcbiAgICogU2hvdyBNb2R1bGUgQ2xlYXIgQnV0dG9uXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gbW9kdWxlTmFtZSBBbiBpZGVudGlmaWVyIGZvciB0aGUgbW9kdWxlIGJlaW5nIHRhcmdldGVkXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5zaG93TW9kdWxlQ2xlYXJCdXR0b24gPSBmdW5jdGlvbiBzaG93TW9kdWxlQ2xlYXJCdXR0b24obW9kdWxlTmFtZSkge1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5tb2R1bGVJbnN0cy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMubW9kdWxlSW5zdHNbaV0uZWwuZ2V0QXR0cmlidXRlKCdkYXRhLWZpbHRlci1tb2R1bGUnKSA9PT0gbW9kdWxlTmFtZSkge1xuICAgICAgICB0aGlzLm1vZHVsZUluc3RzW2ldLmVuYWJsZUNsZWFyQnRuKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBEaXNhYmxlIE1vZHVsZSBDbGVhciBCdXR0b25cbiAgICogQHBhcmFtIHtFbGVtZW50fSBtb2R1bGVOYW1lIEFuIGlkZW50aWZpZXIgZm9yIHRoZSBtb2R1bGUgYmVpbmcgdGFyZ2V0ZWRcbiAgICovXG5cblxuICBGaWx0ZXIucHJvdG90eXBlLmRpc2FibGVNb2R1bGVDbGVhckJ1dHRvbiA9IGZ1bmN0aW9uIGRpc2FibGVNb2R1bGVDbGVhckJ1dHRvbihtb2R1bGVOYW1lKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1vZHVsZUluc3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5tb2R1bGVJbnN0c1tpXS5lbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyLW1vZHVsZScpID09PSBtb2R1bGVOYW1lKSB7XG4gICAgICAgIHRoaXMubW9kdWxlSW5zdHNbaV0uZGlzYWJsZUNsZWFyQnRuKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBIaWRlIE1vZHVsZSBDbGVhciBCdXR0b25cbiAgICogQHBhcmFtIHtFbGVtZW50fSBtb2R1bGVOYW1lIEFuIGlkZW50aWZpZXIgZm9yIHRoZSBtb2R1bGUgYmVpbmcgdGFyZ2V0ZWRcbiAgICovXG5cblxuICBGaWx0ZXIucHJvdG90eXBlLmhpZGVNb2R1bGVDbGVhckJ1dHRvbiA9IGZ1bmN0aW9uIGhpZGVNb2R1bGVDbGVhckJ1dHRvbihtb2R1bGVOYW1lKSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm1vZHVsZUluc3RzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5tb2R1bGVJbnN0c1tpXS5lbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtZmlsdGVyLW1vZHVsZScpID09PSBtb2R1bGVOYW1lKSB7XG4gICAgICAgIHRoaXMubW9kdWxlSW5zdHNbaV0uaGlkZUNsZWFyQnRuKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBHZXQgTW9kdWxlIENsZWFyIGJ1dHRvbiBzdGF0dXNcbiAgICogIEBwYXJhbSB7RWxlbWVudH0gbW9kdWxlTmFtZSBBbiBpZGVudGlmaWVyIGZvciB0aGUgbW9kdWxlIGJlaW5nIHRhcmdldGVkXG4gICAqL1xuXG5cbiAgRmlsdGVyLnByb3RvdHlwZS5tb2R1bGVDbGVhckJ1dHRvblN0YXR1cyA9IGZ1bmN0aW9uIG1vZHVsZUNsZWFyQnV0dG9uU3RhdHVzKG1vZHVsZU5hbWUpIHtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubW9kdWxlSW5zdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmICh0aGlzLm1vZHVsZUluc3RzW2ldLmVsLmdldEF0dHJpYnV0ZSgnZGF0YS1maWx0ZXItbW9kdWxlJykgPT09IG1vZHVsZU5hbWUpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMubW9kdWxlSW5zdHNbaV0uZ2V0Q2xlYXJCdXR0b25TdGF0dXMoKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIEZpbHRlcjtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIFdoaXRlbGlzdGVkIHBhcmFtZXRlcnMgd2hpY2ggY2FuIGJlIHNldCBvbiBjb25zdHJ1Y3Rpb24uXG4gKiBAdHlwZSB7QXJyYXl9XG4gKi9cblxuXG5GaWx0ZXIucHJvdG90eXBlLl93aGl0ZWxpc3RlZFBhcmFtcyA9IFsnb25DbGVhckFsbCcsICdtb2R1bGVPcHRpb25zJ107XG5cbi8qKlxuICogRGVmYXVsdCB2YWx1ZXMgZm9yIGludGVybmFsIHByb3BlcnRpZXMgd2Ugd2lsbCBiZSBzZXR0aW5nLlxuICogVGhlc2UgYXJlIHNldCBvbiBlYWNoIGNvbnN0cnVjdGlvbiBzbyB3ZSBkb24ndCBsZWFrIHByb3BlcnRpZXNcbiAqIGludG8gdGhlIHByb3RvdHlwZSBjaGFpbi5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbkZpbHRlci5wcm90b3R5cGUuZGVmYXVsdHMgPSB7XG4gIGVsOiBudWxsLFxuICBtb2R1bGVFbHM6IFtdLFxuICBfZmlsdGVyVG9nZ2xlQ29udGFpbmVyOiBudWxsLFxuICBfdG9nZ2xlRmlsdGVyQnV0dG9uOiBudWxsLFxuICBfdG9nZ2xlRmlsdGVyTGFiZWw6IG51bGwsXG4gIF90YWdzQ29udGFpbmVyOiBudWxsLFxuICBfdGFnc0NvdW50ZXI6IG51bGwsXG4gIF9jbGVhckFsbEJ1dHRvbjogbnVsbCxcbiAgX2ZpbHRlckNvbnRlbnQ6IG51bGwsXG4gIF9tb2R1bGVzQ29udGFpbmVyOiBudWxsLFxuICBfdmlld01vcmVCdXR0b246IG51bGwsXG4gIF92aWV3TGVzc0J1dHRvbjogbnVsbCxcbiAgX2ZpbHRlckZvb3RlcjogbnVsbCxcbiAgX2J1dHRvbkdyb3VwRWw6IG51bGwsXG4gIF9hcHBseUZpbHRlcnNCdXR0b246IG51bGwsXG4gIG1vZHVsZUluc3RzOiBbXSxcbiAgbW9kdWxlT3B0aW9uczogW10sXG4gIG1heENvbDogNCxcbiAgb25DbGVhckFsbDogbm9vcCxcbiAgZXh0cmFNb2R1bGVzRXhwYW5kZWQ6IGZhbHNlLFxuICBfaXNGaWx0ZXJFeHBhbmRlZDogZmFsc2UsXG4gIF9pc0Ryb3Bkb3duU3RhdGU6IGZhbHNlLFxuICBfaXNNb2R1bGVFeHBhbmQ6IHRydWUsXG4gIF9jdXJDb2w6IDQsXG4gIF9vblJlc2l6ZUJvdW5kOiBudWxsLFxuICBfdG9nZ2xlVmlld0JvdW5kOiBudWxsLFxuICBfdG9nZ2xlRmlsdGVyQ2xpY2tCb3VuZDogbnVsbCxcbiAgX29uQ2xlYXJBbGxCb3VuZDogbnVsbCxcbiAgX29uU2Nyb2xsQm91bmQ6IG51bGxcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IEZpbHRlcjtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9ZmlsdGVyLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX2Jhc2UgPSByZXF1aXJlKCcuL2Jhc2UnKTtcblxudmFyIF9iYXNlMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2Jhc2UpO1xuXG52YXIgX3RvZ2dsZUNsYXNzID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vdG9nZ2xlLWNsYXNzJyk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdG9nZ2xlQ2xhc3MpO1xuXG52YXIgX2FkZENsYXNzID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vYWRkLWNsYXNzJyk7XG5cbnZhciBfYWRkQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYWRkQ2xhc3MpO1xuXG52YXIgX3JlbW92ZUNsYXNzID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vcmVtb3ZlLWNsYXNzJyk7XG5cbnZhciBfcmVtb3ZlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfcmVtb3ZlQ2xhc3MpO1xuXG52YXIgX2hhc0NsYXNzID0gcmVxdWlyZSgnLi4vaGVscGVycy9kb20vaGFzLWNsYXNzJyk7XG5cbnZhciBfaGFzQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFzQ2xhc3MpO1xuXG52YXIgX2dldFBhcmVudCA9IHJlcXVpcmUoJy4uL2hlbHBlcnMvdHJhdmVyc2FsL2dldC1wYXJlbnQnKTtcblxudmFyIF9nZXRQYXJlbnQyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfZ2V0UGFyZW50KTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKFwiQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uXCIpOyB9IH1cblxuZnVuY3Rpb24gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oc2VsZiwgY2FsbCkgeyBpZiAoIXNlbGYpIHsgdGhyb3cgbmV3IFJlZmVyZW5jZUVycm9yKFwidGhpcyBoYXNuJ3QgYmVlbiBpbml0aWFsaXNlZCAtIHN1cGVyKCkgaGFzbid0IGJlZW4gY2FsbGVkXCIpOyB9IHJldHVybiBjYWxsICYmICh0eXBlb2YgY2FsbCA9PT0gXCJvYmplY3RcIiB8fCB0eXBlb2YgY2FsbCA9PT0gXCJmdW5jdGlvblwiKSA/IGNhbGwgOiBzZWxmOyB9XG5cbmZ1bmN0aW9uIF9pbmhlcml0cyhzdWJDbGFzcywgc3VwZXJDbGFzcykgeyBpZiAodHlwZW9mIHN1cGVyQ2xhc3MgIT09IFwiZnVuY3Rpb25cIiAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJTdXBlciBleHByZXNzaW9uIG11c3QgZWl0aGVyIGJlIG51bGwgb3IgYSBmdW5jdGlvbiwgbm90IFwiICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfSAvKipcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICMgTW9kYWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIFNob3cgY29udGVudCBpbiBhIG1vZGFsLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBuZXcgTW9kYWwoZWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBtb2R1bGUgY29tcG9uZW50cy9tb2RhbC5qc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG5cblxudmFyIE1vZGFsID0gZnVuY3Rpb24gKF9CYXNlQ29tcG9uZW50KSB7XG4gIF9pbmhlcml0cyhNb2RhbCwgX0Jhc2VDb21wb25lbnQpO1xuXG4gIC8qKlxuICAgKiBNb2RhbCBjb25zdHJ1Y3Rvci5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge09iamVjdH0gcGFyYW1zXG4gICAqL1xuICBmdW5jdGlvbiBNb2RhbChlbCkge1xuICAgIHZhciBfdGhpcztcblxuICAgIHZhciBwYXJhbXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9O1xuXG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1vZGFsKTtcblxuICAgIHBhcmFtcy5lbFJlcXVpcmVkID0gdHJ1ZTtcblxuICAgIGlmICghKF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX0Jhc2VDb21wb25lbnQuY2FsbCh0aGlzLCBlbCwgcGFyYW1zKSksIF90aGlzKSkge1xuICAgICAgcmV0dXJuIF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKF90aGlzKTtcbiAgICB9XG5cbiAgICBfdGhpcy5fYmluZEV2ZW50TGlzdGVuZXJDYWxsYmFja3MoKTtcbiAgICBfdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4oX3RoaXMpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW5cbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUub3BlbiA9IGZ1bmN0aW9uIG9wZW4oKSB7XG5cbiAgICB0aGlzLmlzQWN0aXZlID0gdHJ1ZTtcbiAgICBkb2N1bWVudC5hY3RpdmVFbGVtZW50ID8gdGhpcy5mb2N1c2VkRWxCZWZvcmVPcGVuID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA6IG51bGw7XG5cbiAgICB2YXIgbW9kYWxGb2N1c2FibGVFbHMgPSB0aGlzLm1vZGFsRWwucXVlcnlTZWxlY3RvckFsbCgnYVtocmVmXSwgYXJlYVtocmVmXSwgaW5wdXQ6bm90KFtkaXNhYmxlZF0pLCBzZWxlY3Q6bm90KFtkaXNhYmxlZF0pLCB0ZXh0YXJlYTpub3QoW2Rpc2FibGVkXSksIGJ1dHRvbjpub3QoW2Rpc2FibGVkXSksIFt0YWJpbmRleD1cIjBcIl0nKTtcbiAgICBpZiAobW9kYWxGb2N1c2FibGVFbHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5tb2RhbEZvY3VzYWJsZUVscyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKG1vZGFsRm9jdXNhYmxlRWxzKTtcbiAgICAgIHRoaXMuZmlyc3RNb2RhbEZvY3VzYWJsZUVsID0gdGhpcy5tb2RhbEZvY3VzYWJsZUVsc1swXTtcbiAgICAgIHRoaXMubGFzdE1vZGFsRm9jdXNhYmxlRWwgPSB0aGlzLm1vZGFsRm9jdXNhYmxlRWxzW3RoaXMubW9kYWxGb2N1c2FibGVFbHMubGVuZ3RoIC0gMV07XG4gICAgfVxuXG4gICAgdGhpcy5fYWRkV2luZG93RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl91cGRhdGVDbGFzc2VzKCk7XG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkoZG9jdW1lbnQuYm9keSwgJ3NwYXJrLW1vZGFsLW9wZW4nKTtcblxuICAgIC8vIFNldCBmb2N1cyB0byBjbG9zZSBidXR0b24gb25jZSBtb2RhbCBoYXMgYmVlbiBkaXNwbGF5ZWRcbiAgICBpZiAobW9kYWxGb2N1c2FibGVFbHMubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5maXJzdE1vZGFsRm9jdXNhYmxlRWwuZm9jdXMoKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAvKipcbiAgICogQ2xvc2VcbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbiBjbG9zZSgpIHtcblxuICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmZvY3VzZWRFbEJlZm9yZU9wZW4gPyB0aGlzLmZvY3VzZWRFbEJlZm9yZU9wZW4uZm9jdXMoKSA6IG51bGw7XG4gICAgdGhpcy5fcmVtb3ZlV2luZG93RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl91cGRhdGVDbGFzc2VzKCk7XG4gICAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkoZG9jdW1lbnQuYm9keSwgJ3NwYXJrLW1vZGFsLW9wZW4nKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgdGhlIGNvbXBvbmVudCB0byB1c2UgYSBuZXcgZWxlbWVudCBvciByZXBhcnNlIGZyb21cbiAgICogdGhlIGV4aXN0aW5nIGVsZW1lbnQuXG4gICAqIEBwYXJhbSB7RWxlbWVudH0gZWwgT3B0aW9uYWxcbiAgICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICAgKi9cblxuXG4gIE1vZGFsLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiB1cGRhdGUoZWwpIHtcbiAgICB2YXIgcGFyYW1zID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTtcblxuXG4gICAgdGhpcy5fcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9jYWNoZUVsZW1lbnRzKGVsIHx8IHRoaXMuZWwsIHBhcmFtcyk7XG4gICAgdGhpcy5fYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl91cGRhdGVDbGFzc2VzKCk7XG4gICAgdGhpcy5fcmVtb3ZlV2luZG93RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIGlmICh0aGlzLmlzQWN0aXZlKSB7XG4gICAgICB0aGlzLl9hZGRXaW5kb3dFdmVudExpc3RlbmVycygpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9O1xuXG4gIC8qKlxuICAgKiBTdG9yZSBhIHJlZmVyZW5jZSB0byB0aGUgZWxlbWVudC4gRWl0aGVyIGEgbW9kYWwgaXRzZWxmXG4gICAqIG9yIGEgYnV0dG9uIHJlZmVyZW5jaW5nIGEgbW9kYWwgbWF5IGJlIHBhc3NlZC5cbiAgICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICAgKiBAcGFyYW0ge0VsZW1lbnR9IHBhcmFtcyBAb3B0aW9uYWxcbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuX2NhY2hlRWxlbWVudHMgPSBmdW5jdGlvbiBfY2FjaGVFbGVtZW50cyhlbCwgcGFyYW1zKSB7XG5cbiAgICB2YXIgbW9kYWxQYXNzZWQgPSAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KShlbCwgJ3NwYXJrLW1vZGFsJyk7XG4gICAgdmFyIG1vZGFsRWwgPSBwYXJhbXMubW9kYWxFbDtcblxuICAgIGlmIChtb2RhbFBhc3NlZCkge1xuICAgICAgdGhpcy5tb2RhbEVsID0gZWw7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZWwgPSBlbDtcbiAgICAgIHRoaXMubW9kYWxFbCA9IG1vZGFsRWwgfHwgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihlbC5nZXRBdHRyaWJ1dGUoJ2RhdGEtbW9kYWwnKSk7XG4gICAgfVxuXG4gICAgdGhpcy5zY3JvbGxFbCA9IHRoaXMubW9kYWxFbC5xdWVyeVNlbGVjdG9yKCcuc3BhcmstbW9kYWxfX3Njcm9sbCcpIHx8IHRoaXMubW9kYWxFbDtcblxuICAgIHRoaXMuaXNBY3RpdmUgPSAoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KSh0aGlzLmVsIHx8IHRoaXMubW9kYWxFbCwgJ2FjdGl2ZScpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBVcGRhdGUgY2xhc3NlcyBmb3IgdGhlIG9wZW4gb3IgY2xvc2Ugc3RhdGUuXG4gICAqL1xuXG5cbiAgTW9kYWwucHJvdG90eXBlLl91cGRhdGVDbGFzc2VzID0gZnVuY3Rpb24gX3VwZGF0ZUNsYXNzZXMoKSB7XG4gICAgKDAsIF90b2dnbGVDbGFzczIuZGVmYXVsdCkodGhpcy5tb2RhbEVsLCAnYWN0aXZlJywgdGhpcy5pc0FjdGl2ZSk7XG4gIH07XG5cbiAgLyoqXG4gICAqIENyZWF0ZSBib3VuZCB2ZXJzaW9ucyBvZiBldmVudCBsaXN0ZW5lciBjYWxsYmFja3MgYW5kIHN0b3JlIHRoZW0uXG4gICAqIE90aGVyd2lzZSB3ZSBjYW4ndCB1bmJpbmQgZnJvbSB0aGVzZSBldmVudHMgbGF0ZXIgYmVjYXVzZSB0aGVcbiAgICogZnVuY3Rpb24gc2lnbmF0dXJlcyB3b24ndCBtYXRjaC5cbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzID0gZnVuY3Rpb24gX2JpbmRFdmVudExpc3RlbmVyQ2FsbGJhY2tzKCkge1xuICAgIHRoaXMuX29uQ2xpY2tCb3VuZCA9IHRoaXMuX29uQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbktleXVwQm91bmQgPSB0aGlzLl9vbktleXVwLmJpbmQodGhpcyk7XG4gICAgdGhpcy5fb25LZXlkb3duQm91bmQgPSB0aGlzLl9vbktleWRvd24uYmluZCh0aGlzKTtcbiAgICB0aGlzLl9vbk1vZGFsQ2xpY2tCb3VuZCA9IHRoaXMuX29uTW9kYWxDbGljay5iaW5kKHRoaXMpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBET00gZXZlbnRzLlxuICAgKi9cblxuXG4gIE1vZGFsLnByb3RvdHlwZS5fYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkRXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgaWYgKHRoaXMuZWwpIHRoaXMuZWwuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLl9vbkNsaWNrQm91bmQpO1xuICAgIGlmICh0aGlzLm1vZGFsRWwpIHRoaXMubW9kYWxFbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uTW9kYWxDbGlja0JvdW5kKTtcbiAgfTtcblxuICAvKipcbiAgICogUmVtb3ZlIGV2ZW50IGxpc3RlbmVycyBmb3IgRE9NIGV2ZW50cy4uXG4gICAqL1xuXG5cbiAgTW9kYWwucHJvdG90eXBlLl9yZW1vdmVFdmVudExpc3RlbmVycyA9IGZ1bmN0aW9uIF9yZW1vdmVFdmVudExpc3RlbmVycygpIHtcbiAgICBpZiAodGhpcy5lbCkgdGhpcy5lbC5yZW1vdmVFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMuX29uQ2xpY2tCb3VuZCk7XG4gICAgaWYgKHRoaXMubW9kYWxFbCkgdGhpcy5tb2RhbEVsLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5fb25Nb2RhbENsaWNrQm91bmQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBET00gZXZlbnRzLlxuICAgKi9cblxuXG4gIE1vZGFsLnByb3RvdHlwZS5fYWRkV2luZG93RXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiBfYWRkV2luZG93RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcmVtb3ZlV2luZG93RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9vbktleXVwQm91bmQpO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5fb25LZXlkb3duQm91bmQpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBSZW1vdmUgZXZlbnQgbGlzdGVuZXJzIGZvciBET00gZXZlbnRzLi5cbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuX3JlbW92ZVdpbmRvd0V2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gX3JlbW92ZVdpbmRvd0V2ZW50TGlzdGVuZXJzKCkge1xuICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX29uS2V5dXBCb3VuZCk7XG4gICAgd2luZG93LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9vbktleWRvd25Cb3VuZCk7XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gdGhlIGJ1dHRvbiBpcyBjbGlja2VkLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIE1vZGFsLnByb3RvdHlwZS5fb25DbGljayA9IGZ1bmN0aW9uIF9vbkNsaWNrKCkge1xuICAgIHRoaXMub3BlbigpO1xuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHdlIGFyZSBjbGlja2VkLCB0b2dnbGUgdGhlIG9wZW5lZCBzdGF0ZS5cbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuX29uTW9kYWxDbGljayA9IGZ1bmN0aW9uIF9vbk1vZGFsQ2xpY2soZSkge1xuXG4gICAgLy8gVGhlIGNsb3NlIGJ1dHRvbiBpcyBjbGlja2VkIG9yIHRoZSBhY3R1YWwgbW9kYWwgKGdyYXkgYXJlYSlcbiAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMuc2Nyb2xsRWwgfHwgZS50YXJnZXQgPT09IHRoaXMubW9kYWxFbCB8fCAoMCwgX2dldFBhcmVudDIuZGVmYXVsdCkoZS50YXJnZXQsICcuc3BhcmstbW9kYWxfX2Nsb3NlLCAuc3BhcmstbW9kYWxfX2Rpc21pc3MnLCB0aGlzLnNjcm9sbEVsKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiB0YWJiaW5nIGJhY2t3YXJkcywgbG9jYWxpemUgdHJhdmVyc2FsIHRvIG1vZGFsIGVsZW1lbnRzIG9ubHlcbiAgICogQHBhcmFtIHtPYmplY3R9IGVcbiAgICovXG5cblxuICBNb2RhbC5wcm90b3R5cGUuX29uQmFja3dhcmRUYWIgPSBmdW5jdGlvbiBfb25CYWNrd2FyZFRhYihlKSB7XG4gICAgaWYgKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQgPT09IHRoaXMuZmlyc3RNb2RhbEZvY3VzYWJsZUVsKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLmxhc3RNb2RhbEZvY3VzYWJsZUVsLmZvY3VzKCk7XG4gICAgfVxuICB9O1xuXG4gIC8qKlxuICAgKiBXaGVuIHRhYmJpbmcgZm9yd2FyZHMsIGxvY2FsaXplIHRyYXZlcnNhbCB0byBtb2RhbCBlbGVtZW50cyBvbmx5XG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgTW9kYWwucHJvdG90eXBlLl9vbkZvcndhcmRUYWIgPSBmdW5jdGlvbiBfb25Gb3J3YXJkVGFiKGUpIHtcbiAgICBpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCA9PT0gdGhpcy5sYXN0TW9kYWxGb2N1c2FibGVFbCkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5maXJzdE1vZGFsRm9jdXNhYmxlRWwuZm9jdXMoKTtcbiAgICB9XG4gIH07XG5cbiAgLyoqXG4gICAqIFdoZW4gYSBrZXkgaXMgcHJlc3NlZCBvbiB0aGUgd2luZG93IGFuZCBpdCdzIGFuIEVTQywgY2xvc2UgdGhlIG1vZGFsLlxuICAgKiBAcGFyYW0ge09iamVjdH0gZVxuICAgKi9cblxuXG4gIE1vZGFsLnByb3RvdHlwZS5fb25LZXl1cCA9IGZ1bmN0aW9uIF9vbktleXVwKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09PSAyNykge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICAvKipcbiAgICogV2hlbiBhIGtleSBpcyBwcmVzc2VkIGFuZCBpdCBpcyB0aGUgVGFiIGtleSBvciBTaGlmdCtUYWIga2V5cywgZGV0ZXJtaW5lIHdoZXRoZXIgdG8gYWRqdXN0IGZvY3VzXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBlXG4gICAqL1xuXG5cbiAgTW9kYWwucHJvdG90eXBlLl9vbktleWRvd24gPSBmdW5jdGlvbiBfb25LZXlkb3duKGUpIHtcbiAgICBpZiAoZS5rZXlDb2RlID09PSA5KSB7XG4gICAgICBpZiAodGhpcy5tb2RhbEZvY3VzYWJsZUVscy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZS5zaGlmdEtleSkge1xuICAgICAgICB0aGlzLl9vbkJhY2t3YXJkVGFiKGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fb25Gb3J3YXJkVGFiKGUpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChlLmtleUNvZGUgPT09IDEzKSB7XG4gICAgICBpZiAoZS50YXJnZXQgPT09IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zcGFyay1tb2RhbF9fY2xvc2UnKSB8fCBlLnRhcmdldCA9PT0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNwYXJrLW1vZGFsX19kaXNtaXNzJykpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiBNb2RhbDtcbn0oX2Jhc2UyLmRlZmF1bHQpO1xuXG4vKipcbiAqIERlZmF1bHQgdmFsdWVzIGZvciBpbnRlcm5hbCBwcm9wZXJ0aWVzIHdlIHdpbGwgYmUgc2V0dGluZy5cbiAqIFRoZXNlIGFyZSBzZXQgb24gZWFjaCBjb25zdHJ1Y3Rpb24gc28gd2UgZG9uJ3QgbGVhayBwcm9wZXJ0aWVzXG4gKiBpbnRvIHRoZSBwcm90b3R5cGUgY2hhaW4uXG4gKiBAdHlwZSB7T2JqZWN0fVxuICovXG5cblxuTW9kYWwucHJvdG90eXBlLmRlZmF1bHRzID0ge1xuICBlbDogbnVsbCxcbiAgbW9kYWxFbDogbnVsbCxcbiAgc2Nyb2xsRWw6IG51bGwsXG4gIGlzQWN0aXZlOiBmYWxzZSxcbiAgX29uQ2xpY2tCb3VuZDogbnVsbCxcbiAgX29uS2V5dXBCb3VuZDogbnVsbCxcbiAgX29uS2V5ZG93bkJvdW5kOiBudWxsLFxuICBfb25Nb2RhbENsaWNrQm91bmQ6IG51bGxcbn07XG5cbmV4cG9ydHMuZGVmYXVsdCA9IE1vZGFsO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tb2RhbC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9vdXRlckhlaWdodCA9IHJlcXVpcmUoJy4uL2RvbS9vdXRlci1oZWlnaHQnKTtcblxudmFyIF9vdXRlckhlaWdodDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9vdXRlckhlaWdodCk7XG5cbnZhciBfYWRkQ2xhc3MgPSByZXF1aXJlKCcuLi9kb20vYWRkLWNsYXNzJyk7XG5cbnZhciBfYWRkQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYWRkQ2xhc3MpO1xuXG52YXIgX3JlbW92ZUNsYXNzID0gcmVxdWlyZSgnLi4vZG9tL3JlbW92ZS1jbGFzcycpO1xuXG52YXIgX3JlbW92ZUNsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3JlbW92ZUNsYXNzKTtcblxudmFyIF9oYXNDbGFzcyA9IHJlcXVpcmUoJy4uL2RvbS9oYXMtY2xhc3MnKTtcblxudmFyIF9oYXNDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9oYXNDbGFzcyk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MgPSByZXF1aXJlKCcuLi9kb20vdG9nZ2xlLWNsYXNzJyk7XG5cbnZhciBfdG9nZ2xlQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfdG9nZ2xlQ2xhc3MpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgbm9vcCA9IGZ1bmN0aW9uIG5vb3AoKSB7fTsgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogIyBBbmltYXRlIEhlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEFuaW1hdGUgdGhlIGhlaWdodCBvZiBhbiBlbGVtZW50IHNpbmNlIHdlIGNhbid0IGRvIHRoaXMgdy8gcHVyZSBDU1MuIFNpZ2guXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIGFuaW1hdGVIZWlnaHQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgZWw6IC4uLixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIHRvZ2dsZUVsOiAuLi4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICAvLyBPcHRpb25hbCBwYXJhbXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGFjdGlvbjogJ2NvbGxhcHNlJ3wnZXhwYW5kJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIGhlaWdodEFuaW1hdGlvbkNsYXNzOiAnc3BhcmstYW5pbWF0ZS1oZWlnaHQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgb3BhY2l0eUFuaW1hdGlvbkNsYXNzOiAnc3BhcmstYW5pbWF0ZS1vcGFjaXR5JyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAgIHRvZ2dsZVByb3BlcnR5OiAnZGlzcGxheSd8J292ZXJmbG93J3wndmlzaWJpbGl0eScsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogICB0b2dnbGVWYWx1ZTogJ2Jsb2NrJ3wnbm9uZSd8J3Zpc2libGUnfCdoaWRkZW4nLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqICAgYW5pbWF0aW9uRHVyYXRpb246IDI1MFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogQG1vZHVsZSBoZWxwZXJzL2FuaW1hdGlvbi9oZWlnaHQuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cblxudmFyIHJ1bm5pbmdBbmltYXRpb25zID0ge1xuICBlbHM6IFtdLFxuICBjb21wbGV0ZUNhbGxiYWNrczogW11cbn07XG5cbi8qKlxuICogR2V0IHRoZSBpbnZlcnNlIHRvZ2dsZSB2YWx1ZVxuICogQHBhcmFtICB7U3RyaW5nfSBwcm9wZXJ0eVxuICogQHBhcmFtICB7U3RyaW5nfSBvcmlnaW5hbFZhbHVlXG4gKiBAcmV0dXJuIHtTdHJpbmd9XG4gKi9cbmZ1bmN0aW9uIGdldEludmVyc2VUb2dnbGVWYWx1ZShlbCwgcHJvcGVydHksIG9yaWdpbmFsVmFsdWUpIHtcblxuICAvLyBHZXQgdGhlIHZhbHVlIHRvIHRvZ2dsZSB0byBmb3IgdGhlIGdpdmVuIHByb3BlcnR5XG4gIHN3aXRjaCAocHJvcGVydHkpIHtcbiAgICBjYXNlICdvdmVyZmxvdyc6XG4gICAgY2FzZSAndmlzaWJpbGl0eSc6XG4gICAgICByZXR1cm4gb3JpZ2luYWxWYWx1ZSA9PT0gJ3Zpc2libGUnID8gJ2hpZGRlbicgOiAndmlzaWJsZSc7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBvcmlnaW5hbFZhbHVlID09PSAnYmxvY2snIHx8IG9yaWdpbmFsVmFsdWUgPT09ICdpbmxpbmUtYmxvY2snID8gJ25vbmUnIDogJ2Jsb2NrJztcbiAgfVxufVxuXG4vKipcbiAqIFdoZW4gYW4gYW5pbWF0aW9uIGlzIGNvbXBsZXRlLCBjbGVhbiB1cCBhbmQgcnVuIHRoZSBjYWxsYmFjay5cbiAqIEBwYXJhbSAge09iamVjdH0gcGFyYW1zXG4gKi9cbmZ1bmN0aW9uIG9uQ29tcGxldGUocGFyYW1zKSB7XG5cbiAgLy8gUmVzZXQgdG9nZ2xlIGVsIHZpc2liaWxpdHlcbiAgaWYgKHBhcmFtcy50b2dnbGVDbGFzc05hbWUpIHtcbiAgICAoMCwgX3RvZ2dsZUNsYXNzMi5kZWZhdWx0KShwYXJhbXMuZWwsIHBhcmFtcy50b2dnbGVDbGFzc05hbWUsICFwYXJhbXMuY29sbGFwc2UpO1xuICB9IGVsc2Uge1xuICAgIHBhcmFtcy50b2dnbGVFbC5zdHlsZVtwYXJhbXMudG9nZ2xlUHJvcGVydHldID0gJyc7XG4gIH1cblxuICAvLyBSZW1vdmUgdGhlIGhlaWdodCBwcm9wZXJ0eVxuICBwYXJhbXMuZWwuc3R5bGUuaGVpZ2h0ID0gJyc7XG4gIHBhcmFtcy50b2dnbGVFbC5zdHlsZS5oZWlnaHQgPSAnJztcbiAgcGFyYW1zLnRvZ2dsZUVsLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcnO1xuICBwYXJhbXMudG9nZ2xlRWwuc3R5bGUubWFyZ2luVG9wID0gJyc7XG5cbiAgLy8gUmVtb3ZlIHRoZSBzcGFyay1hbmltYXRlLWhlaWdodCBjbGFzcyBzbyB0aGUgdHJhbnNpdGlvbnMgbm8gbG9uZ2VyIGFwcGx5XG4gICgwLCBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKHBhcmFtcy5lbCwgcGFyYW1zLmhlaWdodEFuaW1hdGlvbkNsYXNzKTtcbiAgKDAsIF9yZW1vdmVDbGFzczIuZGVmYXVsdCkocGFyYW1zLnRvZ2dsZUVsLCBwYXJhbXMuaGVpZ2h0QW5pbWF0aW9uQ2xhc3MpO1xuXG4gIC8vIFJ1biB0aGUgY2FsbGJhY2tcbiAgcGFyYW1zLm9uQ29tcGxldGUoKTtcblxuICAvLyBSZW1vdmUgdGhlIGVsZW1lbnQgYW5kIGNhbGxiYWNrIGZyb20gdGhlaXIgcmVzcGVjdGl2ZSBhcnJheXNcbiAgdmFyIHJ1bm5pbmdJbmRleCA9IHJ1bm5pbmdBbmltYXRpb25zLmVscy5pbmRleE9mKHBhcmFtcy5lbCk7XG4gIHJ1bm5pbmdBbmltYXRpb25zLmVscy5zcGxpY2UocnVubmluZ0luZGV4LCAxKTtcbiAgcnVubmluZ0FuaW1hdGlvbnMuY29tcGxldGVDYWxsYmFja3Muc3BsaWNlKHJ1bm5pbmdJbmRleCwgMSk7XG59XG5cbi8qKlxuICogQHBhcmFtIHtPYmplY3R9IHBhcmFtc1xuICovXG5mdW5jdGlvbiBhbmltYXRlSGVpZ2h0KHBhcmFtcykge1xuXG4gIHBhcmFtcyA9IHBhcmFtcyB8fCB7fTtcblxuICB2YXIgZWwgPSBwYXJhbXMuZWw7XG5cbiAgaWYgKCFlbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjb2xsYXBzZSA9IHBhcmFtcy5hY3Rpb24gJiYgcGFyYW1zLmFjdGlvbiA9PT0gJ2NvbGxhcHNlJztcbiAgdmFyIGhlaWdodEFuaW1hdGlvbkNsYXNzID0gcGFyYW1zLmhlaWdodEFuaW1hdGlvbkNsYXNzIHx8ICdzcGFyay1hbmltYXRlLWhlaWdodCc7XG5cbiAgLy8gQWxsb3cgZm9yIGVsZW1lbnRzIHRvIGJlIHBhc3NlZCBvciBzZWxlY3RvciBzdHJpbmdzXG4gIHZhciB0b2dnbGVFbCA9IHR5cGVvZiBwYXJhbXMudG9nZ2xlRWwgPT09ICdzdHJpbmcnID8gZWwucXVlcnlTZWxlY3RvcihwYXJhbXMudG9nZ2xlRWwpIDogcGFyYW1zLnRvZ2dsZUVsO1xuXG4gIC8vIE5vIGVsZW1lbnQgdG8gYmUgc3dpdGNoaW5nIHdpdGggdG9nZ2xpbmcgc28gd2UgY2FuJ3QgZGV0ZXJtaW5lIHRoZSBkZXNpcmVkIGhlaWdodCB0byBhbmltYXRlIHRvLlxuICBpZiAoIXRvZ2dsZUVsIHx8ICgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKGVsLCAnc3Bhcmstbm8tYW5pbWF0ZScpKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHRvZ2dsZUNsYXNzTmFtZSA9IHBhcmFtcy50b2dnbGVDbGFzcztcblxuICAvLyBUaGUgc3R5bGUgcHJvcGVydHkgdG8gdXNlIHdoZW4gdG9nZ2xpbmcgdmlzaWJpbGl0eVxuICB2YXIgdG9nZ2xlUHJvcGVydHkgPSBwYXJhbXMudG9nZ2xlUHJvcGVydHkgfHwgJ2Rpc3BsYXknO1xuICB2YXIgdG9nZ2xlU3R5bGVzID0gd2luZG93LmdldENvbXB1dGVkU3R5bGUodG9nZ2xlRWwpO1xuICB2YXIgb3JpZ2luYWxUb2dnbGVWYWx1ZSA9IHRvZ2dsZVN0eWxlc1t0b2dnbGVQcm9wZXJ0eV07XG4gIHZhciB0b2dnbGVWYWx1ZSA9IHBhcmFtcy50b2dnbGVWYWx1ZSB8fCBnZXRJbnZlcnNlVG9nZ2xlVmFsdWUodG9nZ2xlUHJvcGVydHksIG9yaWdpbmFsVG9nZ2xlVmFsdWUpO1xuXG4gIC8vIElmIHdlIGFyZSBhbHJlYWR5IGFuaW1hdGluZywgc3RvcCBub3cuXG4gIHZhciBydW5uaW5nSW5kZXggPSBydW5uaW5nQW5pbWF0aW9ucy5lbHMuaW5kZXhPZihlbCk7XG4gIGlmIChydW5uaW5nSW5kZXggIT09IC0xKSB7XG5cbiAgICB2YXIgY29tcGxldGVDYWxsYmFjayA9IHJ1bm5pbmdBbmltYXRpb25zLmNvbXBsZXRlQ2FsbGJhY2tzW3J1bm5pbmdJbmRleF07XG4gICAgaWYgKGNvbXBsZXRlQ2FsbGJhY2spIHtcbiAgICAgIGNsZWFyVGltZW91dChjb21wbGV0ZUNhbGxiYWNrKTtcbiAgICB9XG5cbiAgICBvbkNvbXBsZXRlKHtcbiAgICAgIGVsOiBlbCxcbiAgICAgIHRvZ2dsZUVsOiB0b2dnbGVFbCxcbiAgICAgIG9uQ29tcGxldGU6IHBhcmFtcy5vbkNvbXBsZXRlIHx8IG5vb3AsXG4gICAgICBjb2xsYXBzZTogY29sbGFwc2UsXG4gICAgICB0b2dnbGVQcm9wZXJ0eTogdG9nZ2xlUHJvcGVydHksXG4gICAgICB0b2dnbGVDbGFzc05hbWU6IHRvZ2dsZUNsYXNzTmFtZSxcbiAgICAgIHRvZ2dsZVZhbHVlOiB0b2dnbGVWYWx1ZSxcbiAgICAgIGhlaWdodEFuaW1hdGlvbkNsYXNzOiBoZWlnaHRBbmltYXRpb25DbGFzc1xuICAgIH0pO1xuICB9XG5cbiAgLy8gU3RvcmUgdGhlIGN1cnJlbnQgaGVpZ2h0XG4gIHZhciBvcmlnaW5hbEhlaWdodCA9ICgwLCBfb3V0ZXJIZWlnaHQyLmRlZmF1bHQpKGVsKTtcblxuICAvLyBUb2dnbGUgdGhlIHZpc2libGUgcHJvcGVydHlcbiAgaWYgKHRvZ2dsZUNsYXNzTmFtZSkge1xuICAgICgwLCBfdG9nZ2xlQ2xhc3MyLmRlZmF1bHQpKGVsLCB0b2dnbGVDbGFzc05hbWUsICFjb2xsYXBzZSk7XG4gIH0gZWxzZSB7XG4gICAgdG9nZ2xlRWwuc3R5bGVbdG9nZ2xlUHJvcGVydHldID0gdG9nZ2xlVmFsdWU7XG4gIH1cblxuICAvLyBXaGVuIG1lYXN1cmluZyB0aGUgc2l6ZSBmb3IgYSBjb2xsYXBzZSwgd2UgaGF2ZSB0byB3YWl0IGEgdGljIGZvciBpdCB0byBiZVxuICAvLyBhY2N1cmF0ZS4gTm90IHN1cmUgd2h5LiBVZ2guXG4gIGlmIChjb2xsYXBzZSkge1xuICAgIHNldFRpbWVvdXQocnVuQW5pbWF0aW9uLCAwKTtcbiAgfSBlbHNlIHtcbiAgICBydW5BbmltYXRpb24oKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJ1bkFuaW1hdGlvbigpIHtcblxuICAgIC8vIE5vdyB0aGF0IHRoZSB0b2dnbGUgZWwgaXMgdGFraW5nIHVwIHNwYWNlLCBnZXQgdGhlIG5ldyBoZWlnaHQgd2hpY2ggd2Ugd2lsbCBiZSBhbmltYXRpbmcgdG9cbiAgICB2YXIgdGFyZ2V0RWxIZWlnaHQgPSAoMCwgX291dGVySGVpZ2h0Mi5kZWZhdWx0KShlbCk7XG5cbiAgICAvLyBXZSBuZWVkIHRvIHN0b3JlIHRoZSBvcmlnaW5hbCBhbmQgdGFyZ2V0IHRvZ2dsZSBlbGVtZW50IGhlaWdodHMuIFRoZXkgZGlmZmVyIGRlcGVuZGluZyBvblxuICAgIC8vIHdoZXRoZXIgd2UgYXJlIGdvaW5nIHRvIGV4cGFuZCBvciBjb2xsYXBzZS5cbiAgICB2YXIgdGFyZ2V0VG9nZ2xlRWxIZWlnaHQgPSB2b2lkIDA7XG4gICAgdmFyIG9yaWdpbmFsVG9nZ2xlRWxIZWlnaHQgPSB2b2lkIDA7XG5cbiAgICAvLyBJZiB3ZSBhcmUgY29sbGFwc2luZywgcmVzZXQgdGhlIHRvZ2dsZSBzdHlsZSBhbmQgc2V0IGl0IHdoZW4gd2UncmUgZG9uZS4gU2V0IHRoZSBoZWlnaHQgc29cbiAgICAvLyB0aGF0IHdlIGNhbiBhbmltYXRlIGRvd24gdG8gMCBvciB1cCB0byB0aGUgdGFyZ2V0IGhlaWdodC5cbiAgICBpZiAoY29sbGFwc2UpIHtcblxuICAgICAgaWYgKHRvZ2dsZUNsYXNzTmFtZSkge1xuICAgICAgICAoMCwgX3JlbW92ZUNsYXNzMi5kZWZhdWx0KShlbCwgdG9nZ2xlQ2xhc3NOYW1lKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRvZ2dsZUVsLnN0eWxlW3RvZ2dsZVByb3BlcnR5XSA9IG9yaWdpbmFsVG9nZ2xlVmFsdWU7XG4gICAgICB9XG5cbiAgICAgIG9yaWdpbmFsVG9nZ2xlRWxIZWlnaHQgPSAoMCwgX291dGVySGVpZ2h0Mi5kZWZhdWx0KSh0b2dnbGVFbCwgdG9nZ2xlU3R5bGVzKTtcbiAgICAgIHRhcmdldFRvZ2dsZUVsSGVpZ2h0ID0gMDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGFyZ2V0VG9nZ2xlRWxIZWlnaHQgPSAoMCwgX291dGVySGVpZ2h0Mi5kZWZhdWx0KSh0b2dnbGVFbCwgdG9nZ2xlU3R5bGVzKTtcbiAgICAgIG9yaWdpbmFsVG9nZ2xlRWxIZWlnaHQgPSAwO1xuICAgIH1cblxuICAgIC8vIFNldCB0aGUgb3JpZ2luYWwgaGVpZ2h0XG4gICAgZWwuc3R5bGUuaGVpZ2h0ID0gb3JpZ2luYWxIZWlnaHQgKyAncHgnO1xuICAgIHRvZ2dsZUVsLnN0eWxlLmhlaWdodCA9IG9yaWdpbmFsVG9nZ2xlRWxIZWlnaHQgKyAncHgnO1xuICAgIHRvZ2dsZUVsLnN0eWxlLm1hcmdpbkJvdHRvbSA9ICcwcHgnO1xuICAgIHRvZ2dsZUVsLnN0eWxlLm1hcmdpblRvcCA9ICcwcHgnO1xuXG4gICAgLy8gQWRkIHRoZSBzcGFyay1hbmltYXRlLWhlaWdodCBjbGFzcyB3aGljaCB3aWxsIHNldHVwIHRoZSB0cmFuc2l0aW9uLXByb3BlcnR5IGFuZCBkdXJhdGlvblxuICAgICgwLCBfYWRkQ2xhc3MyLmRlZmF1bHQpKGVsLCBoZWlnaHRBbmltYXRpb25DbGFzcyk7XG4gICAgKDAsIF9hZGRDbGFzczIuZGVmYXVsdCkodG9nZ2xlRWwsIGhlaWdodEFuaW1hdGlvbkNsYXNzKTtcblxuICAgIHJ1bm5pbmdBbmltYXRpb25zLmVscy5wdXNoKGVsKTtcblxuICAgIC8vIFdlIG5lZWQgdG8gd2FpdCBhIHRpY2sgdG8gdG9nZ2xlIHRoZSBoZWlnaHQgb3IgZWxzZSB0aGUgYW5pbWF0aW9uIGNsYXNzIHdvbid0IGZ1bmN0aW9uXG4gICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cbiAgICAgIC8vIFNldCB0aGUgaGVpZ2h0IHRvIHRoZSB0YXJnZXQgaGVpZ2h0XG4gICAgICBlbC5zdHlsZS5oZWlnaHQgPSB0YXJnZXRFbEhlaWdodCArICdweCc7XG4gICAgICB0b2dnbGVFbC5zdHlsZS5oZWlnaHQgPSB0YXJnZXRUb2dnbGVFbEhlaWdodCArICdweCc7XG5cbiAgICAgIC8vIFJlbW92ZSBpbmxpbmUgc3R5bGVzIGFmdGVyIHRoZSBhbmltYXRpb24gaXMgY29tcGxldGVcbiAgICAgIHJ1bm5pbmdBbmltYXRpb25zLmNvbXBsZXRlQ2FsbGJhY2tzLnB1c2goc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICAgIG9uQ29tcGxldGUoe1xuICAgICAgICAgIGVsOiBlbCxcbiAgICAgICAgICB0b2dnbGVFbDogdG9nZ2xlRWwsXG4gICAgICAgICAgb25Db21wbGV0ZTogcGFyYW1zLm9uQ29tcGxldGUgfHwgbm9vcCxcbiAgICAgICAgICBjb2xsYXBzZTogY29sbGFwc2UsXG4gICAgICAgICAgdG9nZ2xlUHJvcGVydHk6IHRvZ2dsZVByb3BlcnR5LFxuICAgICAgICAgIHRvZ2dsZUNsYXNzTmFtZTogdG9nZ2xlQ2xhc3NOYW1lLFxuICAgICAgICAgIHRvZ2dsZVZhbHVlOiB0b2dnbGVWYWx1ZSxcbiAgICAgICAgICBoZWlnaHRBbmltYXRpb25DbGFzczogaGVpZ2h0QW5pbWF0aW9uQ2xhc3NcbiAgICAgICAgfSk7XG4gICAgICB9LCBwYXJhbXMuYW5pbWF0aW9uRHVyYXRpb24gIT09IHVuZGVmaW5lZCA/IHBhcmFtcy5hbmltYXRpb25EdXJhdGlvbiA6IDIwMSkpO1xuICAgIH0sIDApO1xuICB9XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IGFuaW1hdGVIZWlnaHQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhlaWdodC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90cmltID0gcmVxdWlyZSgnLi4vdXRpbC90cmltJyk7XG5cbnZhciBfdHJpbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmltKTtcblxudmFyIF9oYXNDbGFzcyA9IHJlcXVpcmUoJy4vaGFzLWNsYXNzJyk7XG5cbnZhciBfaGFzQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfaGFzQ2xhc3MpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG4vKipcbiAqICMgQWRkIENsYXNzXG4gKiBBZGQgYSBjbGFzcyBvbiBhbiBlbGVtZW50LlxuICpcbiAqIEBwYXJhbSB7RWxlbWVudHxBcnJheX0gZWwgQW4gZWxlbWVudCBvciBhcnJheSBvZiBlbGVtZW50cyB0byB1cGRhdGUuXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHJldHVybiB7RWxlbWVudH1cbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvZG9tL2FkZC1jbGFzcy5qc1xuICovXG5cbnZhciB3cyA9IC9cXHMrLztcbnZhciBjbGVhbnVwID0gL1xcc3syLH0vZztcblxuZnVuY3Rpb24gYWRkQ2xhc3MoZWwsIG5hbWUpIHtcblxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiB0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICBuYW1lID0gKDAsIF90cmltMi5kZWZhdWx0KShuYW1lKS5zcGxpdCh3cyk7XG4gIH0gZWxzZSB7XG4gICAgbmFtZSA9IG5hbWUgaW5zdGFuY2VvZiBBcnJheSA/IG5hbWUgOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICB9XG5cbiAgLy8gb3B0aW1pemUgZm9yIGJlc3QsIG1vc3QgY29tbW9uIGNhc2VcbiAgaWYgKG5hbWUubGVuZ3RoID09PSAxICYmIGVsLmNsYXNzTGlzdCkge1xuICAgIGlmIChuYW1lWzBdKSB7XG4gICAgICBlbC5jbGFzc0xpc3QuYWRkKG5hbWVbMF0pO1xuICAgIH1cbiAgICByZXR1cm4gZWw7XG4gIH1cblxuICB2YXIgdG9BZGQgPSBbXTtcbiAgdmFyIGkgPSAwO1xuICB2YXIgbCA9IG5hbWUubGVuZ3RoO1xuICB2YXIgaXRlbSA9IHZvaWQgMDtcbiAgdmFyIGNsc05hbWUgPSB0eXBlb2YgZWwuY2xhc3NOYW1lID09PSAnc3RyaW5nJyA/IGVsLmNsYXNzTmFtZSA6IGVsLmdldEF0dHJpYnV0ZSA/IGVsLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSA6ICcnO1xuXG4gIC8vIHNlZSBpZiB3ZSBoYXZlIGFueXRoaW5nIHRvIGFkZFxuICBmb3IgKDsgaSA8IGw7IGkrKykge1xuICAgIGl0ZW0gPSBuYW1lW2ldO1xuICAgIGlmIChpdGVtICYmICEoMCwgX2hhc0NsYXNzMi5kZWZhdWx0KShjbHNOYW1lLCBpdGVtKSkge1xuICAgICAgdG9BZGQucHVzaChpdGVtKTtcbiAgICB9XG4gIH1cblxuICBpZiAodG9BZGQubGVuZ3RoKSB7XG4gICAgaWYgKHR5cGVvZiBlbC5jbGFzc05hbWUgPT09ICdzdHJpbmcnKSB7XG4gICAgICBlbC5jbGFzc05hbWUgPSAoMCwgX3RyaW0yLmRlZmF1bHQpKChjbHNOYW1lICsgJyAnICsgdG9BZGQuam9pbignICcpKS5yZXBsYWNlKGNsZWFudXAsICcgJykpO1xuICAgIH0gZWxzZSBpZiAoZWwuc2V0QXR0cmlidXRlKSB7XG4gICAgICBlbC5zZXRBdHRyaWJ1dGUoJ2NsYXNzJywgKDAsIF90cmltMi5kZWZhdWx0KSgoY2xzTmFtZSArICcgJyArIHRvQWRkLmpvaW4oJyAnKSkucmVwbGFjZShjbGVhbnVwLCAnICcpKSk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIGVsO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBhZGRDbGFzcztcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9YWRkLWNsYXNzLmpzLm1hcFxuIiwiXCJ1c2Ugc3RyaWN0XCI7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKipcbiAqICMgQnJlYWtwb2ludCBIZWxwZXJzXG4gKiBGaW5kIHRoZSBhY3RpdmUgYnJlYWtwb2ludC5cbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gd2lkdGhcbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvZG9tL2JyZWFrcG9pbnQuanNcbiAqL1xuXG4vKipcbiAqIEJyZWFrcG9pbnRzIGJlaW5nIHVzZWQgaW4gdGhlIENTUy5cbiAqIEB0eXBlIHtPYmplY3R9XG4gKi9cbnZhciBkZWZhdWx0QnJlYWtwb2ludHMgPSB7XG4gIHhzOiB7XG4gICAgbWluOiAwLFxuICAgIG1heDogNTQzXG4gIH0sXG4gIHNtOiB7XG4gICAgbWluOiA1NDQsXG4gICAgbWF4OiA3OTVcbiAgfSxcbiAgbWQ6IHtcbiAgICBtaW46IDc5NixcbiAgICBtYXg6IDEwNDdcbiAgfSxcbiAgbGc6IHtcbiAgICBtaW46IDEwNDgsXG4gICAgbWF4OiAxNzk5XG4gIH0sXG4gIHhsOiB7XG4gICAgbWluOiAxODAwLFxuICAgIG1heDogSW5maW5pdHlcbiAgfVxufTtcblxuZnVuY3Rpb24gZ2V0KHdpZHRoLCBicmVha3BvaW50cykge1xuXG4gIGJyZWFrcG9pbnRzID0gYnJlYWtwb2ludHMgfHwgZGVmYXVsdEJyZWFrcG9pbnRzO1xuXG4gIHZhciBpID0gdm9pZCAwO1xuXG4gIGZvciAoaSBpbiBicmVha3BvaW50cykge1xuICAgIGlmICh3aWR0aCA+PSBicmVha3BvaW50c1tpXS5taW4gJiYgd2lkdGggPD0gYnJlYWtwb2ludHNbaV0ubWF4KSB7XG4gICAgICByZXR1cm4gaTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0cy5nZXQgPSBnZXQ7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1icmVha3BvaW50LmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuXG52YXIgX3R5cGVvZiA9IHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgU3ltYm9sLml0ZXJhdG9yID09PSBcInN5bWJvbFwiID8gZnVuY3Rpb24gKG9iaikgeyByZXR1cm4gdHlwZW9mIG9iajsgfSA6IGZ1bmN0aW9uIChvYmopIHsgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7IH07XG5cbi8qKlxuICogIyBIYXMgQ2xhc3NcbiAqIFNlZSBpZiBhbiBlbGVtZW50IGhhcyBhIGNsYXNzLlxuICpcbiAqIEBwYXJhbSB7RWxlbWVudHxTdHJpbmd9IGVsXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxuICogQHJldHVybiB7Qm9vbGVhbn1cbiAqXG4gKiBAbW9kdWxlIGhlbHBlcnMvZG9tL2hhcy1jbGFzcy5qc1xuICovXG5mdW5jdGlvbiBoYXNDbGFzcyhlbCwgbmFtZSkge1xuICB2YXIgY05hbWUgPSAoKHR5cGVvZiBlbCA9PT0gJ3VuZGVmaW5lZCcgPyAndW5kZWZpbmVkJyA6IF90eXBlb2YoZWwpKSA9PT0gJ29iamVjdCcgPyBlbC5jbGFzc05hbWUgfHwgZWwuZ2V0QXR0cmlidXRlICYmIGVsLmdldEF0dHJpYnV0ZSgnY2xhc3MnKSB8fCAnJyA6IGVsIHx8ICcnKS5yZXBsYWNlKC9bXFx0XFxyXFxuXFxmXS9nLCAnICcpO1xuICByZXR1cm4gKCcgJyArIGNOYW1lICsgJyAnKS5pbmRleE9mKCcgJyArIG5hbWUgKyAnICcpICE9PSAtMTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gaGFzQ2xhc3M7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWhhcy1jbGFzcy5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9lYWNoID0gcmVxdWlyZSgnLi4vdXRpbC9lYWNoJyk7XG5cbnZhciBfZWFjaDIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9lYWNoKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHByb3BzID0gWydtYXJnaW5Ub3AnLCAnbWFyZ2luQm90dG9tJywgJ2JvcmRlclRvcCcsICdib3JkZXJCb3R0b20nXTsgLyoqXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiAjIE91dGVyIEhlaWdodFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICogR2V0IHRoZSBvdXRlciBoZWlnaHQgb2YgYW4gZWxlbWVudCAoaW5jbHVkaW5nIG1hcmdpbiBhbmQgYm9yZGVyKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7RWxlbWVudH0gZWxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7T2JqZWN0fSBzdHlsZXMgT3B0aW9uYWwgQWxyZWFkeSBoYXZlIGNvbXB1dGVkIHN0eWxlcz8gUGFzcyB0aGVtIGluLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBleGFtcGxlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKiBvdXRlckhlaWdodChlbCwgY29tcHV0ZWRTdHlsZXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqIEBtb2R1bGUgaGVscGVycy9vdXRlci1oZWlnaHQuanNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuXG5cbmZ1bmN0aW9uIG91dGVySGVpZ2h0KGVsLCBzdHlsZXMpIHtcblxuICBzdHlsZXMgPSBzdHlsZXMgfHwgd2luZG93LmdldENvbXB1dGVkU3R5bGUoZWwpO1xuXG4gIHZhciBoZWlnaHQgPSBlbC5jbGllbnRIZWlnaHQ7XG5cbiAgKDAsIF9lYWNoMi5kZWZhdWx0KShwcm9wcywgZnVuY3Rpb24gKHByb3ApIHtcbiAgICBoZWlnaHQgKz0gcGFyc2VJbnQoc3R5bGVzW3Byb3BdIHx8IDAsIDEwKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGhlaWdodDtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gb3V0ZXJIZWlnaHQ7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPW91dGVyLWhlaWdodC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF90cmltID0gcmVxdWlyZSgnLi4vdXRpbC90cmltJyk7XG5cbnZhciBfdHJpbTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF90cmltKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHdzID0gL1xccysvOyAvKipcbiAgICAgICAgICAgICAgICAgKiAjIFJlbW92ZSBDbGFzc1xuICAgICAgICAgICAgICAgICAqIFJlbW92ZSBhIGNsYXNzIG9uIGFuIGVsZW1lbnQuXG4gICAgICAgICAgICAgICAgICpcbiAgICAgICAgICAgICAgICAgKiBAcGFyYW0ge0VsZW1lbnR8QXJyYXl9IGVsIEFuIGVsZW1lbnQgb3IgYXJyYXkgb2YgZWxlbWVudHMgdG8gdXBkYXRlLlxuICAgICAgICAgICAgICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAgICAgICAgICAgICAgICogQHJldHVybiB7RWxlbWVudH1cbiAgICAgICAgICAgICAgICAgKlxuICAgICAgICAgICAgICAgICAqIEBtb2R1bGUgaGVscGVycy9kb20vcmVtb3ZlLWNsYXNzLmpzXG4gICAgICAgICAgICAgICAgICovXG5cbnZhciBjbGVhbnVwID0gL1xcc3syLH0vZztcblxuZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWwsIG5hbWUpIHtcblxuICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMiAmJiB0eXBlb2YgbmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICBuYW1lID0gKDAsIF90cmltMi5kZWZhdWx0KShuYW1lKS5zcGxpdCh3cyk7XG4gIH0gZWxzZSB7XG4gICAgbmFtZSA9IG5hbWUgaW5zdGFuY2VvZiBBcnJheSA/IG5hbWUgOiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuICB9XG5cbiAgLy8gb3B0aW1pemUgZm9yIGJlc3QsIG1vc3QgY29tbW9uIGNhc2VcbiAgaWYgKG5hbWUubGVuZ3RoID09PSAxICYmIGVsLmNsYXNzTGlzdCkge1xuICAgIGlmIChuYW1lWzBdKSBlbC5jbGFzc0xpc3QucmVtb3ZlKG5hbWVbMF0pO1xuICAgIHJldHVybiBlbDtcbiAgfVxuXG4gIC8vIHN0b3JlIHR3byBjb3BpZXNcbiAgdmFyIGNsc05hbWUgPSAnICcgKyAodHlwZW9mIGVsLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycgPyBlbC5jbGFzc05hbWUgOiBlbC5nZXRBdHRyaWJ1dGUgPyBlbC5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykgOiAnJykgKyAnICc7XG4gIHZhciByZXN1bHQgPSBjbHNOYW1lO1xuICB2YXIgY3VycmVudCA9IHZvaWQgMDtcbiAgdmFyIHN0YXJ0ID0gdm9pZCAwO1xuICBmb3IgKHZhciBpID0gMCwgbCA9IG5hbWUubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgY3VycmVudCA9IG5hbWVbaV07XG4gICAgc3RhcnQgPSBjdXJyZW50ID8gcmVzdWx0LmluZGV4T2YoJyAnICsgY3VycmVudCArICcgJykgOiAtMTtcbiAgICBpZiAoc3RhcnQgIT09IC0xKSB7XG4gICAgICBzdGFydCArPSAxO1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnNsaWNlKDAsIHN0YXJ0KSArIHJlc3VsdC5zbGljZShzdGFydCArIGN1cnJlbnQubGVuZ3RoKTtcbiAgICB9XG4gIH1cblxuICAvLyBvbmx5IHdyaXRlIGlmIG1vZGlmaWVkXG4gIGlmIChjbHNOYW1lICE9PSByZXN1bHQpIHtcbiAgICBpZiAodHlwZW9mIGVsLmNsYXNzTmFtZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGVsLmNsYXNzTmFtZSA9ICgwLCBfdHJpbTIuZGVmYXVsdCkocmVzdWx0LnJlcGxhY2UoY2xlYW51cCwgJyAnKSk7XG4gICAgfSBlbHNlIGlmIChlbC5zZXRBdHRyaWJ1dGUpIHtcbiAgICAgIGVsLnNldEF0dHJpYnV0ZSgnY2xhc3MnLCAoMCwgX3RyaW0yLmRlZmF1bHQpKHJlc3VsdC5yZXBsYWNlKGNsZWFudXAsICcgJykpKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gZWw7XG59XG5cbmV4cG9ydHMuZGVmYXVsdCA9IHJlbW92ZUNsYXNzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1yZW1vdmUtY2xhc3MuanMubWFwXG4iLCIndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG5cbnZhciBfaGFzQ2xhc3MgPSByZXF1aXJlKCcuL2hhcy1jbGFzcycpO1xuXG52YXIgX2hhc0NsYXNzMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX2hhc0NsYXNzKTtcblxudmFyIF9hZGRDbGFzcyA9IHJlcXVpcmUoJy4vYWRkLWNsYXNzJyk7XG5cbnZhciBfYWRkQ2xhc3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYWRkQ2xhc3MpO1xuXG52YXIgX3JlbW92ZUNsYXNzID0gcmVxdWlyZSgnLi9yZW1vdmUtY2xhc3MnKTtcblxudmFyIF9yZW1vdmVDbGFzczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9yZW1vdmVDbGFzcyk7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbmZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsLCBuYW1lLCBlbmFibGUpIHtcblxuICBpZiAoIWVsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gSWYgd2UncmUgcGFzc2VkIGFuIGFycmF5LCB0b2dnbGUgdGhlIGNsYXNzIG9uIGVhY2guXG4gIGlmIChlbCBpbnN0YW5jZW9mIE5vZGVMaXN0IHx8IGVsIGluc3RhbmNlb2YgQXJyYXkpIHtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSBlbC5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgdG9nZ2xlQ2xhc3MoZWxbaV0sIG5hbWUsIGVuYWJsZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGFjdGlvbiA9IHZvaWQgMDtcbiAgaWYgKGVuYWJsZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgZW5hYmxlID0gdHlwZW9mIGVuYWJsZSA9PT0gJ2Z1bmN0aW9uJyA/IGVuYWJsZS5jYWxsKG51bGwsIGVsKSA6IGVuYWJsZTtcbiAgICBhY3Rpb24gPSBlbmFibGUgPyAnYWRkJyA6ICdyZW1vdmUnO1xuICB9IGVsc2Uge1xuICAgIGFjdGlvbiA9ICgwLCBfaGFzQ2xhc3MyLmRlZmF1bHQpKGVsLCBuYW1lKSA/ICdyZW1vdmUnIDogJ2FkZCc7XG4gIH1cblxuICByZXR1cm4gKGFjdGlvbiA9PT0gJ2FkZCcgPyBfYWRkQ2xhc3MyLmRlZmF1bHQgOiBfcmVtb3ZlQ2xhc3MyLmRlZmF1bHQpKGVsLCBuYW1lKTtcbn0gLyoqXG4gICAqICMgVG9nZ2xlIENsYXNzXG4gICAqIFRvZ2dsZSBhIGNsYXNzIG9uIGFuIGVsZW1lbnQgZ2l2ZW4gYSBjb25kaXRpb24uXG4gICAqXG4gICAqIEBwYXJhbSB7RWxlbWVudHxBcnJheX0gZWwgQW4gZWxlbWVudCBvciBhcnJheSBvZiBlbGVtZW50cyB0byB1cGRhdGUuXG4gICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lXG4gICAqIEBwYXJhbSB7Qm9vbGVhbn0gZW5hYmxlXG4gICAqIEByZXR1cm4ge0VsZW1lbnR9XG4gICAqXG4gICAqIEBtb2R1bGUgIGhlbHBlcnMvZG9tL3RvZ2dsZS1jbGFzcy5qc1xuICAgKi9cblxuZXhwb3J0cy5kZWZhdWx0ID0gdG9nZ2xlQ2xhc3M7XG5tb2R1bGUuZXhwb3J0cyA9IGV4cG9ydHNbJ2RlZmF1bHQnXTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXRvZ2dsZS1jbGFzcy5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcblxudmFyIF9tYXRjaGVzID0gcmVxdWlyZSgnLi9tYXRjaGVzJyk7XG5cbnZhciBfbWF0Y2hlczIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9tYXRjaGVzKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxuZnVuY3Rpb24gZ2V0UGFyZW50KHBhcmVudCwgcXVlcnksIGxpbWl0RWwpIHtcblxuICBsaW1pdEVsID0gbGltaXRFbCBpbnN0YW5jZW9mIEFycmF5ID8gbGltaXRFbCA6IFtsaW1pdEVsIHx8IGRvY3VtZW50LmJvZHldO1xuXG4gIHdoaWxlIChwYXJlbnQpIHtcblxuICAgIGlmICgoMCwgX21hdGNoZXMyLmRlZmF1bHQpKHBhcmVudCwgcXVlcnkpKSB7XG4gICAgICByZXR1cm4gcGFyZW50O1xuICAgIH1cblxuICAgIGlmIChsaW1pdEVsLmluZGV4T2YocGFyZW50KSAhPT0gLTEpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50Tm9kZTtcbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn0gLyoqXG4gICAqICMgR2V0IFBhcmVudFxuICAgKiBTZWUgaWYgYW4gZWxlbWVudCBoYXMgYW5vdGhlciBlbGVtZW50IGZvciBhIHBhcmVudC5cbiAgICpcbiAgICogQHBhcmFtIHtFbGVtZW50fSBwYXJlbnRcbiAgICogQHBhcmFtIHtTdHJpbmd9IHF1ZXJ5XG4gICAqIEBwYXJhbSB7QXJyYXl8RWxlbWVudH0gbGltaXRFbCBUaGUgbGFzdCBlbGVtZW50IHdlIHNob3VsZCBjaGVjay5cbiAgICogQHJldHVybiB7Qm9vbGVhbnxFbGVtZW50fVxuICAgKlxuICAgKiBAbW9kdWxlIGhlbHBlcnMvdHJhdmVyc2FsL2dldC1wYXJlbnQuanNcbiAgICovXG5cbmV4cG9ydHMuZGVmYXVsdCA9IGdldFBhcmVudDtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z2V0LXBhcmVudC5qcy5tYXBcbiIsIid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qKlxuICogIyBNYXRjaGVzXG4gKiBTZWUgaWYgYW4gZWxlbWVudCBtYXRjaGVzIGEgcXVlcnkgc2VsZWN0b3IuXG4gKlxuICogQHBhcmFtIHtFbGVtZW50fSBlbFxuICogQHBhcmFtIHtTdHJpbmd9IHF1ZXJ5XG4gKiBAcmV0dXJuIHtCb29sZWFufVxuICpcbiAqIEBtb2R1bGUgaGVscGVycy90cmF2ZXJzYWwvbWF0Y2hlcy5qc1xuICovXG52YXIgdmVuZG9yTWF0Y2ggPSB0eXBlb2YgRWxlbWVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgKEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXMgfHwgRWxlbWVudC5wcm90b3R5cGUubWF0Y2hlc1NlbGVjdG9yIHx8IEVsZW1lbnQucHJvdG90eXBlLndlYmtpdE1hdGNoZXNTZWxlY3RvciB8fCBFbGVtZW50LnByb3RvdHlwZS5tb3pNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUubXNNYXRjaGVzU2VsZWN0b3IgfHwgRWxlbWVudC5wcm90b3R5cGUub01hdGNoZXNTZWxlY3Rvcik7XG5cbmZ1bmN0aW9uIG1hdGNoZXMoZWwsIHF1ZXJ5KSB7XG5cbiAgaWYgKHZlbmRvck1hdGNoKSByZXR1cm4gdmVuZG9yTWF0Y2guY2FsbChlbCwgcXVlcnkpO1xuXG4gIHZhciBub2RlcyA9IGVsLnBhcmVudE5vZGUgPyBlbC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwocXVlcnkpIDogW107XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBub2Rlcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChub2Rlc1tpXSA9PT0gZWwpIHJldHVybiB0cnVlO1xuICB9XG5cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBtYXRjaGVzO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tYXRjaGVzLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIEVhY2hcbiAqIEFwcGx5IGEgY2FsbGJhY2sgZnVuY3Rpb24gdG8gYSBsaXN0IG9mIGFueSBraW5kOiBBcnJheSwgTm9kZUxpc3QsIEhUTUxDb2xsZWN0aW9uIG9yIE9iamVjdC5cbiAqXG4gKiBAcGFyYW0ge0FycmF5fE5vZGVMaXN0fEhUTUxDb2xsZWN0aW9ufE9iamVjdH0gbGlzdFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2JcbiAqXG4gKiBAZXhhbXBsZVxuICogZWFjaChbXSwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZHJlbiwgY2FsbGJhY2spO1xuICogZWFjaChlbC5jaGlsZE5vZGVzLCBjYWxsYmFjayk7XG4gKiBlYWNoKHt9LCBjYWxsYmFjayk7XG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvZWFjaC5qc1xuICovXG5mdW5jdGlvbiBlYWNoKGxpc3QsIGNiKSB7XG5cbiAgaWYgKCFsaXN0KSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHR5cGVvZiBjYiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgIHRocm93IG5ldyBFcnJvcignQ2Fubm90IGludm9rZSBgZWFjaGAgd2l0aG91dCBhIGNhbGxiYWNrIScpO1xuICB9XG5cbiAgdmFyIGkgPSAwO1xuICB2YXIgbGVuID0gbGlzdC5sZW5ndGg7XG5cbiAgLy8gT2JqZWN0XG4gIGlmIChsZW4gPT09IHVuZGVmaW5lZCkge1xuICAgIGZvciAoaSBpbiBsaXN0KSB7XG4gICAgICBpZiAoaSAhPT0gJ3Byb3RvdHlwZScgJiYgbGlzdC5oYXNPd25Qcm9wZXJ0eShpKSkge1xuICAgICAgICBjYihpLCBsaXN0W2ldKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gQXJyYXktbGlrZVxuICBlbHNlIHtcbiAgICAgIGZvciAoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgY2IobGlzdFtpXSk7XG4gICAgICB9XG4gICAgfVxufVxuXG5leHBvcnRzLmRlZmF1bHQgPSBlYWNoO1xubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzWydkZWZhdWx0J107XG4vLyMgc291cmNlTWFwcGluZ1VSTD1lYWNoLmpzLm1hcFxuIiwiJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuLyoqXG4gKiAjIFRyaW1cbiAqIFRyaW0gd2hpdGVzcGFjZSBvbiBhIHN0cmluZy5cbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyXG4gKlxuICogQG1vZHVsZSBoZWxwZXJzL3V0aWwvdHJpbS5qc1xuICovXG5cbnZhciB0cmltUkUgPSAvXltcXHNcXHVGRUZGXFx4QTBdK3xbXFxzXFx1RkVGRlxceEEwXSskL2c7XG5cbmZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSh0cmltUkUsICcnKTtcbn1cblxuZXhwb3J0cy5kZWZhdWx0ID0gdHJpbTtcbm1vZHVsZS5leHBvcnRzID0gZXhwb3J0c1snZGVmYXVsdCddO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dHJpbS5qcy5tYXBcbiJdfQ=="}