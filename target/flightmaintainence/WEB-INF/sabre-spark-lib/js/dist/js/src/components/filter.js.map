{"version":3,"sources":["filter.js"],"names":["noop","Filter","el","params","elRequired","_bindEventListenerCallbacks","_addEventListeners","_calculateStyle","_cacheElements","moduleEls","querySelectorAll","defaultOption","onAfterExpand","_onAfterExpand","bind","onAfterCollapse","_onAfterCollapse","i","length","moduleOptions","key","moduleInsts","_listEl","querySelector","_btnGroupEl","_viewMoreEl","_viewLessEl","_viewGrpEl","_toggleHideEl","_toggleShowEl","_tagSectionEl","_clearAllEl","_headerEl","_headerExpandEl","_headerCollapseEl","_applyBtnEl","_onResizeBound","_onResize","_toggleViewBound","_toggleView","_toggleModuleBound","toggleModule","_onClearAllBound","_onClearAll","_onVisibleBound","_onVisible","_onScrollBound","_onScroll","window","addEventListener","document","_removeEventListeners","removeEventListener","_dropdownState","_disapplyListDropdown","_showModule","style","_resetModuleStyle","_curCol","maxCol","_hideModule","modulesLength","listLength","offsetWidth","_applyListDropdown","_maxCol","_setModuleWidth","_isExpand","j","_updateModuleExpand","option","noStateChange","_isModuleExpand","_isDropdownState","_calDropdownBtn","setTimeout","viewportOffset","getBoundingClientRect","innerHeight","offsetHeight","headerHeight","x","y","left","width","onClearAll","start","end","percentage","clearAllEl","cloneNode","appendChild","_applyExpand","removeChild","_disapplyExpand","createTagEl","title","value","clearCallback","tagEl","createElement","className","innerHTML","insertBefore","clearAllTagEls","tags","prototype","_whitelistedParams","defaults","dataSet","_curModuleWidth","_listModalInst","_toggleEl","_toggleViewMoreBound"],"mappings":"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","file":"filter.js","sourcesContent":["/**\n * # Filter\n * A filter for search result or table etc.\n *\n * @example\n * new Filter(el);\n *\n * @module components/filter.js\n */\nimport BaseComponent from './base';\nimport addClass from '../helpers/dom/add-class';\nimport toggleClass from '../helpers/dom/toggle-class';\nimport removeClass from '../helpers/dom/remove-class';\nimport FilterModule from './filter-module';\nimport Modal from './modal';\n\nconst noop = function() {};\n\nclass Filter extends BaseComponent {\n\n  /**\n   * Filter constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  constructor(el, params = {}) {\n\n    params.elRequired = true;\n\n    if (!super(el, params)) {\n      return;\n    }\n\n    this._bindEventListenerCallbacks();\n    this._addEventListeners();\n    this._calculateStyle();\n  }\n\n  /**\n   * Store a reference to the whole filter\n   * @param {Element} el\n   */\n  _cacheElements(el) {\n    this.el = el;\n    this.moduleEls = this.el.querySelectorAll('.spark-filter-module');\n    var defaultOption = {\n      onAfterExpand: this._onAfterExpand.bind(this),\n      onAfterCollapse: this._onAfterCollapse.bind(this),\n    };\n    for(var i = 0; i < this.moduleEls.length; i ++) {\n      if(typeof this.moduleOptions[i] !== 'undefined') {\n        for(var key in defaultOption) {\n          this.moduleOptions[i][key] = defaultOption[key];\n        }\n        this.moduleInsts[i] = new FilterModule(this.moduleEls[i], this.moduleOptions[i]);\n      }\n      else {\n        this.moduleInsts[i] = new FilterModule(this.moduleEls[i], defaultOption);\n      }\n    }\n    this._listEl = this.el.querySelector('.spark-filter__list');\n    this._btnGroupEl = this.el.querySelector('.spark-filter__btn-group');\n    this._viewMoreEl = this.el.querySelector('.spark-filter__view-more');\n    this._viewLessEl = this.el.querySelector('.spark-filter__view-less');\n    this._viewGrpEl = this.el.querySelector('.spark-filter__view-group');\n    this._toggleHideEl = this.el.querySelector('.spark-filter__toggle-hide');\n    this._toggleShowEl = this.el.querySelector('.spark-filter__toggle-show');\n    this._tagSectionEl = this.el.querySelector('.spark-filter__tag-section');\n    this._clearAllEl = this.el.querySelector('.spark-filter__clear-all');\n    this._headerEl = this.el.querySelector('.spark-filter__header');\n    this._headerExpandEl = this.el.querySelector('.spark-filter__header--expand');\n    this._headerCollapseEl = this.el.querySelector('.spark-filter__header--collapse');\n    this._applyBtnEl = this.el.querySelector('.spark-filter__btn-apply');\n  }\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n  _bindEventListenerCallbacks() {\n    this._onResizeBound = this._onResize.bind(this);\n    this._toggleViewBound = this._toggleView.bind(this);\n    this._toggleModuleBound = this.toggleModule.bind(this);\n    this._onClearAllBound = this._onClearAll.bind(this);\n    this._onVisibleBound = this._onVisible.bind(this);\n    this._onScrollBound = this._onScroll.bind(this);\n  }\n\n\n  /**\n   * Add event listeners for touchstart and mouse click.\n   */\n  _addEventListeners() {\n    window.addEventListener('resize', this._onResizeBound);\n    window.addEventListener('scroll', this._onScrollBound);\n    document.addEventListener('spark.visible-children', this._onVisibleBound, true);\n    !this._viewMoreEl || this._viewMoreEl.addEventListener('click', this._toggleViewBound);\n    !this._viewLessEl || this._viewLessEl.addEventListener('click', this._toggleViewBound);\n    !this._toggleHideEl || this._toggleHideEl.addEventListener('click', this._toggleModuleBound);\n    !this._toggleShowEl || this._toggleShowEl.addEventListener('click', this._toggleModuleBound);\n    !this._clearAllEl || this._clearAllEl.addEventListener('click', this._onClearAllBound);\n  }\n\n\n  /**\n   * Remove event listeners for touchstart and mouse click.\n   */\n  _removeEventListeners() {\n    window.removeEventListener('resize', this._onResizeBound);\n    window.removeEventListener('scroll', this._onScrollBound);\n    document.removeEventListener('spark.visible-children', this._onVisibleBound, true);\n    !this._viewMoreEl || this._viewMoreEl.removeEventListener('click', this._toggleViewBound);\n    !this._viewLessEl || this._viewLessEl.removeEventListener('click', this._toggleViewBound);\n    !this._toggleHideEl || this._toggleHideEl.removeEventListener('click', this._toggleModuleBound);\n    !this._toggleShowEl || this._toggleShowEl.removeEventListener('click', this._toggleModuleBound);\n    !this._clearAllEl || this._clearAllEl.removeEventListener('click', this._onClearAllBound);\n  }\n\n  /**\n   * Calculate style\n   */\n  _calculateStyle() {\n    if(this._dropdownState) {\n      this._disapplyListDropdown();\n    }\n    this.toggleModule('expand', true);\n    this._showModule();\n    this._listEl.style['flex-wrap'] = 'nowrap';\n    this._listEl.style['justify-content'] = 'center';\n    this._resetModuleStyle();\n    this._curCol = this.maxCol;\n    this._hideModule(this.maxCol);\n    var modulesLength = 0;\n    var listLength = this._listEl.offsetWidth;\n    for(var i = 0; i < this._curCol; i++) {\n      modulesLength += this.moduleEls[i].offsetWidth;\n      if(modulesLength > listLength + 2) {\n        this._curCol = i;\n        break;\n      }\n    }\n    if(this._curCol <= 1) {\n      this._applyListDropdown();\n      this._showModule();\n    }\n    else {\n      this._hideModule(this._curCol, this._maxCol - 1);\n      if(this.moduleEls.length) {\n        this._setModuleWidth(100/this._curCol);\n      }\n      if(this._isExpand) {\n        this._listEl.style['flex-wrap'] = 'wrap';\n        this._listEl.style['justify-content'] = 'flex-start';\n        this._showModule();\n      }\n\n      // Hide border line of ends module of each line\n      for(var j = this._curCol - 1; j < this.moduleEls.length; j += this._curCol) {\n        addClass(this.moduleEls[j], 'noline');\n      }\n    }\n    this._updateModuleExpand();\n  }\n\n  /**\n   * Callback for event `spark.visible-children`\n   */\n  _onVisible() {\n    //this._calculateStyle();\n  }\n\n  /**\n   * To expand or collapse extra filters\n   *\n   */\n  _toggleView() {\n    this._isExpand = !this._isExpand;\n    this._calculateStyle();\n    toggleClass(this._viewMoreEl, 'hide');\n    toggleClass(this._viewLessEl, 'hide');\n  }\n\n  /**\n   * To hide or show filter module\n   * @params {String} toggle; collapse; expand;\n   * @params {String} whether change value of `this._isModuleExpand`, default is to change\n   */\n  toggleModule(option, noStateChange) {\n    if(option === 'expand') {\n      removeClass(this._listEl, 'hide');\n      removeClass(this._headerExpandEl, 'hide');\n      addClass(this._headerCollapseEl,'hide');\n      removeClass(this._btnGroupEl, 'hide');\n      if(!noStateChange) {\n        this._isModuleExpand = true;\n      }\n    }\n    else if(option === 'collapse'){\n      addClass(this._listEl, 'hide');\n      addClass(this._headerExpandEl, 'hide');\n      removeClass(this._headerCollapseEl,'hide');\n      addClass(this._btnGroupEl, 'hide');\n      if(!noStateChange) {\n        this._isModuleExpand = false;\n      }\n    }\n    else {\n      toggleClass(this._listEl, 'hide');\n      toggleClass(this._headerExpandEl, 'hide');\n      toggleClass(this._headerCollapseEl,'hide');\n      toggleClass(this._btnGroupEl, 'hide');\n      if(!noStateChange) {\n        this._isModuleExpand = !this._isModuleExpand;\n      }\n    }\n  }\n\n  /**\n   * Update/toggle Module based on this._isModuleExpand\n   */\n  _updateModuleExpand() {\n    if(this._isModuleExpand) {\n      this.toggleModule('expand');\n    }\n    else {\n      this.toggleModule('collapse');\n    }\n  }\n\n  /**\n   * When the window is resized, base on params make some reponsive change.\n   */\n  _onResize() {\n    this._calculateStyle();\n  }\n\n  /**\n   * When the window scroll. Implement for dropdown fixed button\n   *\n   */\n  _onScroll() {\n    if(this._isDropdownState && this._isModuleExpand) {\n      this._calDropdownBtn();\n    }\n  }\n\n  /*\n   * Callback of expand, when after expand in dropdown variation\n   */\n  _onAfterExpand() {\n    setTimeout(this._calDropdownBtn.bind(this), 300);\n  }\n\n  /*\n   * Callback of collapse, when after collapse in dropdown variation\n   */\n  _onAfterCollapse() {\n    setTimeout(this._calDropdownBtn.bind(this), 300);\n  }\n\n  /**\n   * calculate dropdown button position\n   */\n  _calDropdownBtn() {\n    var viewportOffset = this.el.getBoundingClientRect();\n    var innerHeight = window.innerHeight;\n    var offsetHeight = this.el.offsetHeight;\n    var headerHeight = this._headerEl.offsetHeight;\n    var x = viewportOffset.x;\n    var y = viewportOffset.y;\n    if(y > innerHeight - headerHeight || y + offsetHeight < innerHeight) {\n      removeClass(this._btnGroupEl, 'fixed');\n      this._btnGroupEl.style.left = '';\n      this._btnGroupEl.style.width = '';\n    }\n    else {\n      addClass(this._btnGroupEl, 'fixed');\n      this._btnGroupEl.style.left = x + 'px';\n      this._btnGroupEl.style.width = this.el.offsetWidth + 'px';\n    }\n  }\n\n  /**\n   * Callback for button clear-all\n   */\n  _onClearAll() {\n    (this.onClearAll || noop)();\n  }\n\n  /**\n   * Show all modules\n   */\n  _showModule() {\n    for(var i = 0; i < this.moduleEls.length; i++) {\n      removeClass(this.moduleEls[i], 'hide');\n    }\n  }\n\n  /**\n   * Hide certain modules\n   * @param {Number} start index\n   * @param {Number} end index\n   */\n  _hideModule(start, end) {\n    end = end || this.moduleEls.length - 1;\n    for(var i = start; i <= end; i++) {\n      addClass(this.moduleEls[i], 'hide');\n    }\n  }\n\n  /**\n   * Set width of all filter module\n   * @param {Number} percentage\n   */\n  _setModuleWidth(percentage) {\n    for(var i = 0; i < this.moduleEls.length; i++) {\n      this.moduleEls[i].style['flex-basis'] = percentage + '%';\n      this.moduleEls[i].style['flex-grow'] = 0;\n    }\n  }\n\n  /**\n   * Reset style of filter module\n   */\n  _resetModuleStyle() {\n    for(var i = 0; i < this.moduleEls.length; i++) {\n      this.moduleEls[i].style['flex-basis'] = '';\n      this.moduleEls[i].style['flex-grow'] = 1;\n      removeClass(this.moduleEls[i], 'noline');\n    }\n  }\n\n  /**\n   * Apply dropdown style of filter list\n   * Use when switch variation from large -> xs\n   */\n  _applyListDropdown() {\n    addClass(this.el,'spark-filter--dropdown');\n    this._dropdownState = true;\n\n    var clearAllEl = this._clearAllEl.cloneNode(true);\n    clearAllEl.addEventListener('click', this._onClearAllBound);\n    removeClass(clearAllEl, 'hide');\n    this._headerExpandEl.appendChild(clearAllEl);\n\n    if(this._toggleShowEl) {\n      //this.toggleModule('collapse');\n      addClass(this._viewGrpEl, 'hide');\n      addClass(this._tagSectionEl, 'hide');\n    }\n\n    if(this._applyBtnEl) {\n      removeClass(this._applyBtnEl, 'spark-btn--sm');\n    }\n\n    for(var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._applyExpand();\n    }\n    this._isDropdownState = true;\n    this._calDropdownBtn();\n  }\n\n  /**\n   * Disapply dropdown style for filter list\n   * Use when switch from xs -> large\n   */\n  _disapplyListDropdown() {\n    removeClass(this.el,'spark-filter--dropdown');\n    this._dropdownState = false;\n\n    var clearAllEl = this._headerExpandEl.querySelector('.spark-filter__clear-all');\n    this._headerExpandEl.removeChild(clearAllEl);\n\n    if(this._toggleShowEl) {\n      removeClass(this._viewGrpEl, 'hide');\n      removeClass(this._tagSectionEl, 'hide');\n    }\n\n    if(this._applyBtnEl) {\n      addClass(this._applyBtnEl, 'spark-btn--sm');\n    }\n\n    for(var j = 0; j < this.moduleInsts.length; j++) {\n      this.moduleInsts[j]._disapplyExpand();\n    }\n    this._isDropdownState = false;\n  }\n\n  /**\n   * Generate tag element in filter, will directly post content under `.spark-filter__tag-section`\n   * @param {string} tag title\n   * @param {string} tag value\n   * @param {function} callback function for `X` button\n   */\n  createTagEl(title, value, clearCallback) {\n    var tagEl = document.createElement('div');\n    tagEl.className = 'spark-filter__tag';\n    tagEl.innerHTML = '<span class=\"spark-filter__tag__title\">' + title +\n                      ': </span><span class=\"spark-filter__tag__value\">'+ value +\n                      '</span><i class=\"spark-icon spark-filter__tag__close\"></i>';\n    tagEl.querySelector('.spark-filter__tag__close').addEventListener('click', (clearCallback || noop));\n    this._tagSectionEl.insertBefore(tagEl, this._clearAllEl);\n    removeClass(this._clearAllEl, 'hide');\n  }\n\n  /**\n   * Clear All tags\n   */\n  clearAllTagEls() {\n    var tags = this._tagSectionEl.querySelectorAll('.spark-filter__tag');\n    for(var i=0; i < tags.length; i ++) {\n      this._tagSectionEl.removeChild(tags[i]);\n    }\n    addClass(this._clearAllEl, 'hide');\n  }\n}\n\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\nFilter.prototype._whitelistedParams = ['onClearAll', 'moduleOptions'];\n\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nFilter.prototype.defaults = {\n  el: null,\n  dataSet: {},\n  moduleEls: [],\n  moduleInsts: [],\n  moduleOptions: [],\n  maxCol: 4,\n  onClearAll: noop,\n  _dropdownState: false,\n  _curCol: 4,\n  _curModuleWidth: null,\n  _isExpand: false,\n  _listEl: null,\n  _listModalInst: null,\n  _btnGroupEl: null,\n  _viewMoreEl: null,\n  _viewLessEl: null,\n  _viewGrpEl: null,\n  _headerEl: null,\n  _headerExpandEl: null,\n  _headerCollapseEl: null,\n  _toggleEl: null,\n  _tagSectionEl: null,\n  _clearAllEl: null,\n  _applyBtnEl: null,\n  _toggleViewMoreBound: null,\n  _toggleModuleBound: null,\n  _onResizeBound: null,\n  _onVisibleBound: null,\n  _onScrollBound: null,\n  _onClearAllBound: null,\n  _isDropdownState: false,\n  _isModuleExpand: true,\n};\n\nexport default Filter;\n"]}