{"version":3,"sources":["components/menu.js"],"names":["noop","Menu","el","params","elRequired","_bindEventListenerCallbacks","_addEventListeners","_checkAnimation","_cacheElements","toggleEl","querySelector","_onClickBound","_onClick","bind","_onFocusBound","_onFocus","_onBlurBound","_onBlur","_onKeydownBound","_onKeydown","addEventListener","_removeEventListeners","removeEventListener","_toggleItem","item","_closeItem","_openItem","_toggleAriaCheckedState","hasAttribute","ariaState","getAttribute","setAttribute","String","cachedList","_createMenuAnimationWrapper","_animateListChange","wrapperEl","document","createElement","noAnimate","length","setTimeout","_appendList","newList","cloneNode","removeAttribute","appendChild","push","_removeLastList","removeElement","pop","window","parentNode","removeChild","_removeAllCachedLists","_getNextList","toggleValue","action","_activateItem","parents","_deactivateItems","_deactivateItemSiblings","_activateItemParents","limitEl","i","len","actives","querySelectorAll","_openActiveParents","activeItem","parentItems","itemLinks","nextList","_cachedListContainsID","id","e","target","toggle","onToggle","open","next","back","code","keyCode","which","preventDefault","parent","lastParent","prototype","_whitelistedParams","defaults"],"mappings":"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","file":"menu.js","sourcesContent":["/**\n * # Menu\n *\n * @example\n * new Menu(el, {\n *   // Optional. Callback method for when the menu toggles.\n *   onToggle: function(){}\n * });\n *\n * @module components/menu.js\n */\nimport BaseComponent from './base';\nimport animateHeight from '../helpers/animation/height';\nimport transform from '../helpers/css/transform';\nimport addClass from '../helpers/dom/add-class';\nimport removeClass from '../helpers/dom/remove-class';\nimport hasClass from '../helpers/dom/has-class';\nimport hasParent from '../helpers/traversal/has-parent';\nimport getParent from '../helpers/traversal/get-parent';\nimport getParents from '../helpers/traversal/get-parents';\nimport getChild from '../helpers/traversal/get-child';\nimport wrapElement from '../helpers/manipulation/wrap-element';\n\nconst noop = function() {};\n\nclass Menu extends BaseComponent {\n\n  /**\n   * Menu constructor.\n   * @param {Element} el\n   * @param {Object} params\n   */\n  constructor(el, params = {}) {\n\n    params.elRequired = true;\n\n    if (!super(el, params)) {\n      return;\n    }\n\n    this._bindEventListenerCallbacks();\n    this._addEventListeners();\n    this._checkAnimation();\n  }\n\n\n  /**\n   * Store a reference to the tabs list, each tab and each panel.\n   * Set which tab is active, or use the first.\n   * @param {Element} el\n   */\n  _cacheElements(el) {\n    this.el = el;\n    this.toggleEl = this.el.querySelector('.spark-menu__toggle');\n  }\n\n\n  /**\n   * Create bound versions of event listener callbacks and store them.\n   * Otherwise we can't unbind from these events later because the\n   * function signatures won't match.\n   */\n  _bindEventListenerCallbacks() {\n    this._onClickBound = this._onClick.bind(this);\n    this._onFocusBound = this._onFocus.bind(this);\n    this._onBlurBound = this._onBlur.bind(this);\n    this._onKeydownBound = this._onKeydown.bind(this);\n  }\n\n\n  /**\n   * Add event listeners for DOM events.\n   */\n  _addEventListeners() {\n    this.el.addEventListener('click', this._onClickBound);\n    this.el.addEventListener('focus', this._onFocusBound, true);\n    this.el.addEventListener('blur', this._onBlurBound, true);\n    this.el.addEventListener('keydown', this._onKeydownBound);\n  }\n\n\n  /**\n   * Remove event listeners for DOM events..\n   */\n  _removeEventListeners() {\n    this.el.removeEventListener('click', this._onClickBound);\n    this.el.removeEventListener('focus', this._onFocusBound);\n    this.el.removeEventListener('blur', this._onBlurBound);\n    this.el.removeEventListener('keydown', this._onKeydownBound);\n  }\n\n  /**\n   * Toggle the open state of an item.\n   * @param {Element} item\n   */\n  _toggleItem(item) {\n\n    if (hasClass(item, 'open')) {\n      this._closeItem(item);\n    } else {\n      this._openItem(item);\n    }\n  }\n\n  /**\n   * Toggle aria-checked state of the Expand/Collapse toggle carets\n   * @param {Element} item\n   */\n  _toggleAriaCheckedState(item) {\n    if (item.hasAttribute('aria-checked')) {\n      let ariaState = item.getAttribute('aria-checked') === 'true';\n      item.setAttribute('aria-checked', String(!ariaState));\n    }\n  }\n\n  /**\n   * Check for a nested list and create the wrappers needed\n   * for animating the lists\n   *\n   */\n  _checkAnimation() {\n    if (this.el.querySelector('.spark-menu__list-next')) {\n      this.cachedList = this.cachedList || [];\n      this._createMenuAnimationWrapper();\n      this._animateListChange();\n    }\n  }\n\n  /**\n   * Create wrapper class to help with animation of sliding lists\n   *\n   */\n  _createMenuAnimationWrapper() {\n    if (this.wrapperEl) {\n      return;\n    }\n\n    var wrapperEl = document.createElement('div');\n    addClass(wrapperEl, 'spark-menu__animation-wrapper');\n    wrapElement(this.el.querySelector('.spark-menu__list'), wrapperEl);\n    this.wrapperEl = wrapperEl;\n  }\n\n\n  /**\n   * Animate the position of the animation wrapper. Optionally, do\n   * so immediately without waiting for an animation.\n   * @param {Boolean} noAnimate\n   */\n  _animateListChange(noAnimate) {\n\n    if (noAnimate) {\n      addClass(this.wrapperEl, 'no-animate');\n    }\n\n    this.wrapperEl.setAttribute('style', transform('translateX', '-' + (this.cachedList.length * 100) + '%'));\n\n    if (noAnimate) {\n      setTimeout(function() {\n        removeClass(this.wrapperEl, 'no-animate');\n      }.bind(this), 1);\n    }\n  }\n\n  /**\n   * Append list to menu element\n   * @param {Element} list\n   * @param {Boolean} noAnimate\n   */\n  _appendList(item, noAnimate) {\n\n    // Create wrapper\n    this._createMenuAnimationWrapper();\n\n    var newList = item.cloneNode(true);\n    addClass(newList, 'nestedList');\n    newList.setAttribute('data-nested-list-id', newList.getAttribute('id'));\n    newList.removeAttribute('id');\n\n    if (this.wrapperEl) {\n      // Add child node to wrapper\n      this.wrapperEl.appendChild(newList);\n      // Add to cached Array to keep track of all added lists\n      this.cachedList.push(newList);\n      // Slide navigation\n      this._animateListChange(noAnimate);\n    }\n  }\n\n  /**\n   * Remove list to nav\n   *\n   */\n  _removeLastList() {\n    // If there are any items to remove\n    if (this.cachedList.length) {\n      // Retrieve last item from list\n      var removeElement = this.cachedList.pop();\n      if (this.wrapperEl) {\n        // Slide navigation\n        this._animateListChange();\n      }\n      window.setTimeout(function() {\n        // Remove itself from DOM\n        removeElement.parentNode.removeChild(removeElement);\n      }, 250);\n    }\n  }\n\n  /**\n   * Remove all lists from panel menu\n   *\n   */\n  _removeAllCachedLists() {\n    if (this.cachedList) {\n      // If there are any items to remove\n      while (this.cachedList.length) {\n        // While there are still items, remove them\n        this._removeLastList();\n      }\n    }\n  }\n\n  /**\n   * Finds and returns the next nested list\n   * @param {Object} item\n   * @return {Object}\n   */\n  _getNextList(item) {\n    return item.querySelector('.spark-menu__list-next') ? document.querySelector(item.querySelector('.spark-menu__list-next').getAttribute('data-menu')) : null;\n  }\n\n\n  /**\n   * Open an item by animating it.\n   * @param {Object} item\n   */\n  _openItem(item) {\n\n    // Item is already open\n    if (hasClass(item, 'open')) {\n      return;\n    }\n\n    animateHeight({\n      el: item,\n      toggleEl: '.spark-menu__list'\n    });\n\n    addClass(item, 'open');\n  }\n\n\n  /**\n   * Close an item by animating it shut.\n   * @param {Object} item\n   */\n  _closeItem(item) {\n\n    // Item is already closed\n    if (!hasClass(item, 'open')) {\n      return;\n    }\n\n    animateHeight({\n      el: item,\n      toggleEl: '.spark-menu__list',\n      toggleValue: 'none',\n      action: 'collapse'\n    });\n\n    removeClass(item, 'open');\n  }\n\n\n  /**\n   * Make an item active.\n   * @param {Element} item\n   */\n  _activateItem(item) {\n\n    // Item is already active\n    if (hasClass(item, 'active')) {\n      return;\n    }\n\n    // Deactivate any active items\n    var parents = getParents(item, '.spark-menu__list', this.el);\n    this._deactivateItems(parents[parents.length - 1]);\n    this._deactivateItemSiblings(item);\n\n    // Add the active class\n    addClass(item, 'active');\n\n    // If there is a parent that is also a list item, open it.\n    this._activateItemParents(item, this.el);\n  }\n\n\n  /**\n   * Activate parent items.\n   * @param {Element} el\n   * @param {Element} limitEl\n   */\n  _activateItemParents(el, limitEl) {\n\n    var parents = getParents(el.parentNode, '[class*=\"list-item\"]', limitEl);\n\n    var i = 0;\n    var len = parents.length;\n\n    // Add the active class\n    for (; i < len; i++) {\n      this._openItem(parents[i]);\n      addClass(parents[i], 'child-active');\n    }\n  }\n\n\n  /**\n   * Deactivate items.\n   * @param {Element} el\n   */\n  _deactivateItems(el) {\n\n    var actives = el.querySelectorAll('[class*=\"list-item\"].active');\n    var i = 0;\n    var len = actives.length;\n\n    // Remove the active class\n    for (; i < len; i++) {\n      removeClass(actives.item(i), 'active');\n    }\n  }\n\n  /**\n   * Deactivate siblings items.\n   * @param {Element} el\n   */\n  _deactivateItemSiblings(el) {\n\n    var actives = el.parentNode.querySelectorAll('[class*=\"list-item\"].child-active');\n    var i = 0;\n    var len = actives.length;\n\n    // Remove the active class\n    for (; i < len; i++) {\n      removeClass(actives[i], 'child-active');\n      removeClass(actives[i], 'open');\n    }\n  }\n\n\n  /**\n   * Open the parents of the active item.\n   *\n   */\n  _openActiveParents() {\n\n    var activeItem = this.el.querySelector('.active');\n    if (activeItem) {\n      var parentItems = getParents(activeItem, '.spark-menu__list-item', this.el);\n      var itemLinks;\n      var nextList;\n\n      for (var i = parentItems.length - 1; i >= 0; i--) {\n        itemLinks = getChild(parentItems[i], '.spark-menu__list-links');\n        if (itemLinks && itemLinks.querySelector('.spark-menu__list-next')) {\n          nextList = this._getNextList(parentItems[i]);\n          if (nextList && !this._cachedListContainsID(nextList.getAttribute('id'))) {\n            this._appendList(nextList, true);\n          }\n        } else {\n          addClass(parentItems[i], 'open');\n        }\n      }\n    }\n  }\n\n\n  /**\n   * Check if the cached list contains a certain ID\n   * @param {String} id\n   * @return {Boolean}\n   */\n  _cachedListContainsID(id) {\n    var i = this.cachedList.length;\n    while (i--) {\n      if (this.cachedList[i].getAttribute('data-nested-list-id') === id) {\n        return true;\n      }\n    }\n    return false;\n  }\n\n  /**\n   * When an item is clicked, make it active. Determine if the click was on an expand\n   * button and open the list if so.\n   * @todo: It should be possible to opt out of this behavior.\n   * @param {Object} e\n   */\n  _onClick(e) {\n\n    // Don't make forms active\n    if (getParent(e.target, 'form', this.el)) {\n      return;\n    }\n\n    // Toggle the visibility of the menu?\n    var toggle = e.target === this.toggleEl || hasParent(e.target, this.toggleEl);\n    if (toggle) {\n      return (this.onToggle || noop)(e, this);\n    }\n\n    // Is there a parent to open and an item?\n    var open = getParent(e.target, '.spark-menu__list-expand', this.el);\n    var item = getParent(e.target, '.spark-menu__list-item', this.el);\n\n    // If we have no item or have been told to ignore the item\n    if (!item || getParent(e.target, '.spark-menu__ignore', this.el)) {\n      return;\n    }\n    if (open) {\n      this._toggleAriaCheckedState(open);\n      return this._toggleItem(item);\n    }\n\n    // Check if we have a valid item and we aren't inside the expanded header\n    if (item && !hasParent(e.target, document.querySelector('.spark-header--visible'))) {\n\n      var next = this._getNextList(item);\n\n      if (next && hasClass(e.target, 'spark-menu__list-next')) {\n        // Active item\n        this._activateItem(item);\n        this._appendList(next);\n        return;\n      }\n\n      var back = getParent(e.target, '.spark-menu__list-back', item);\n\n      if (back && hasClass(e.target, 'spark-menu__list-back')) {\n        this._removeLastList();\n        return;\n      }\n    }\n\n    // Active item\n    this._activateItem(item);\n  }\n\n\n  /**\n   * When the space or enter key is pressed on a focused item, make it active.\n   * Determine if the click was on an expand button or link and open the list if so.\n   * @todo: It should be possible to opt out of this behavior.\n   * @param {Object} e\n   */\n  _onKeydown(e) {\n    var code = e.keyCode || e.which;\n\n    // Don't make forms active\n    if (getParent(e.target, 'form', this.el)) {\n      return;\n    }\n\n    // Toggle the visibility of the menu?\n    var toggle = e.target === this.toggleEl || hasParent(e.target, this.toggleEl);\n    if (toggle) {\n      return (this.onToggle || noop)(e, this);\n    }\n\n    // Is there a parent to open and an item?\n    var open = getParent(e.target, '.spark-menu__list-expand', this.el);\n    var item = getParent(e.target, '.spark-menu__list-item', this.el);\n\n    // If we have no item or have been told to ignore the item\n    if (!item || getParent(e.target, '.spark-menu__ignore', this.el)) {\n      return;\n    }\n    if (open) {\n      if (code === 32 || code === 13) {\n        e.preventDefault();\n        this._toggleAriaCheckedState(open);\n        return this._toggleItem(item);\n      }\n    }\n\n    // Check if we have a valid item and we aren't inside the expanded header\n    if (item && !hasParent(e.target, document.querySelector('.spark-header--visible'))) {\n\n      var next = this._getNextList(item);\n\n      if (next && hasClass(e.target, 'spark-menu__list-next')) {\n        if (code === 32 || code === 13) {\n          e.preventDefault();\n          // Active item\n          this._activateItem(item);\n          this._appendList(next);\n          return;\n        }\n      }\n\n      var back = getParent(e.target, '.spark-menu__list-back', item);\n\n      if (back && hasClass(e.target, 'spark-menu__list-back')) {\n        if (code === 32 || code === 13) {\n          e.preventDefault();\n\n          this._removeLastList();\n          return;\n        }\n      }\n    }\n\n    if (code === 32 || code === 13) {\n      this._activateItem(item);\n    }\n  }\n\n  /**\n   * Keep track of when items have focus.\n   * @param {Object} e\n   */\n  _onFocus(e) {\n\n    var parent = e.target;\n    var lastParent = parent;\n\n    while(parent) {\n      parent = getParent(lastParent.parentNode, '.spark-menu__list-item', this.el);\n      if (!parent || parent === lastParent) break;\n      addClass(parent, 'has-focus');\n      lastParent = parent;\n    }\n  }\n\n\n  /**\n   * Keep track of when items lose focus.\n   * @param {Object} e\n   */\n  _onBlur(e) {\n\n    var parent = e.target;\n    var lastParent = parent;\n\n    while(parent) {\n      parent = getParent(lastParent.parentNode, '.spark-menu__list-item', this.el);\n      if (!parent || parent === lastParent) break;\n      removeClass(parent, 'has-focus');\n      lastParent = parent;\n    }\n  }\n}\n\n\n/**\n * Whitelisted parameters which can be set on construction.\n * @type {Array}\n */\nMenu.prototype._whitelistedParams = ['onToggle'];\n\n\n/**\n * Default values for internal properties we will be setting.\n * These are set on each construction so we don't leak properties\n * into the prototype chain.\n * @type {Object}\n */\nMenu.prototype.defaults = {\n  cachedList: null,\n  el: null,\n  toggleEl: null,\n  wrapperEl: null,\n  onToggle: null,\n  _onClickBound: null,\n  _onFocusBound: null,\n  _onBlurBound: null,\n  _onKeydownBound: null\n};\n\nexport default Menu;\n"]}